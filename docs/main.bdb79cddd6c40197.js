var xV=Object.defineProperty,FV=Object.defineProperties,VV=Object.getOwnPropertyDescriptors,cS=Object.getOwnPropertySymbols,UV=Object.prototype.hasOwnProperty,BV=Object.prototype.propertyIsEnumerable,hS=(ie,K,F)=>K in ie?xV(ie,K,{enumerable:!0,configurable:!0,writable:!0,value:F}):ie[K]=F,H=(ie,K)=>{for(var F in K||(K={}))UV.call(K,F)&&hS(ie,F,K[F]);if(cS)for(var F of cS(K))BV.call(K,F)&&hS(ie,F,K[F]);return ie},Qe=(ie,K)=>FV(ie,VV(K));(self.webpackChunkAutoBlocklyApp=self.webpackChunkAutoBlocklyApp||[]).push([[179],{369:(ie,K,F)=>{"use strict";function M(n){return"function"==typeof n}function N(n){const i=n(s=>{Error.call(s),s.stack=(new Error).stack});return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i}const t=N(n=>function(i){n(this),this.message=i?`${i.length} errors occurred during unsubscription:\n${i.map((s,l)=>`${l+1}) ${s.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=i});function e(n,o){if(n){const i=n.indexOf(o);0<=i&&n.splice(i,1)}}class r{constructor(o){this.initialTeardown=o,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let o;if(!this.closed){this.closed=!0;const{_parentage:i}=this;if(i)if(this._parentage=null,Array.isArray(i))for(const u of i)u.remove(this);else i.remove(this);const{initialTeardown:s}=this;if(M(s))try{s()}catch(u){o=u instanceof t?u.errors:[u]}const{_teardowns:l}=this;if(l){this._teardowns=null;for(const u of l)try{p(u)}catch(h){o=null!=o?o:[],h instanceof t?o=[...o,...h.errors]:o.push(h)}}if(o)throw new t(o)}}add(o){var i;if(o&&o!==this)if(this.closed)p(o);else{if(o instanceof r){if(o.closed||o._hasParent(this))return;o._addParent(this)}(this._teardowns=null!==(i=this._teardowns)&&void 0!==i?i:[]).push(o)}}_hasParent(o){const{_parentage:i}=this;return i===o||Array.isArray(i)&&i.includes(o)}_addParent(o){const{_parentage:i}=this;this._parentage=Array.isArray(i)?(i.push(o),i):i?[i,o]:o}_removeParent(o){const{_parentage:i}=this;i===o?this._parentage=null:Array.isArray(i)&&e(i,o)}remove(o){const{_teardowns:i}=this;i&&e(i,o),o instanceof r&&o._removeParent(this)}}r.EMPTY=(()=>{const n=new r;return n.closed=!0,n})();const a=r.EMPTY;function c(n){return n instanceof r||n&&"closed"in n&&M(n.remove)&&M(n.add)&&M(n.unsubscribe)}function p(n){M(n)?n():n.unsubscribe()}const f={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},T={setTimeout(...n){const{delegate:o}=T;return((null==o?void 0:o.setTimeout)||setTimeout)(...n)},clearTimeout(n){const{delegate:o}=T;return((null==o?void 0:o.clearTimeout)||clearTimeout)(n)},delegate:void 0};function y(n){T.setTimeout(()=>{const{onUnhandledError:o}=f;if(!o)throw n;o(n)})}function D(){}const k=De("C",void 0,void 0);function De(n,o,i){return{kind:n,value:o,error:i}}let dt=null;function qt(n){if(f.useDeprecatedSynchronousErrorHandling){const o=!dt;if(o&&(dt={errorThrown:!1,error:null}),n(),o){const{errorThrown:i,error:s}=dt;if(dt=null,i)throw s}}else n()}class cr extends r{constructor(o){super(),this.isStopped=!1,o?(this.destination=o,c(o)&&o.add(this)):this.destination=dS}static create(o,i,s){return new hr(o,i,s)}next(o){this.isStopped?ql(De("N",o,void 0),this):this._next(o)}error(o){this.isStopped?ql(De("E",void 0,o),this):(this.isStopped=!0,this._error(o))}complete(){this.isStopped?ql(k,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(o){this.destination.next(o)}_error(o){try{this.destination.error(o)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class hr extends cr{constructor(o,i,s){let l;if(super(),M(o))l=o;else if(o){let u;({next:l,error:i,complete:s}=o),this&&f.useDeprecatedNextContext?(u=Object.create(o),u.unsubscribe=()=>this.unsubscribe()):u=o,l=null==l?void 0:l.bind(u),i=null==i?void 0:i.bind(u),s=null==s?void 0:s.bind(u)}this.destination={next:l?$l(l):D,error:$l(null!=i?i:Sp),complete:s?$l(s):D}}}function $l(n,o){return(...i)=>{try{n(...i)}catch(s){f.useDeprecatedSynchronousErrorHandling?function(n){f.useDeprecatedSynchronousErrorHandling&&dt&&(dt.errorThrown=!0,dt.error=n)}(s):y(s)}}}function Sp(n){throw n}function ql(n,o){const{onStoppedNotification:i}=f;i&&T.setTimeout(()=>i(n,o))}const dS={closed:!0,next:D,error:Sp,complete:D},Zl="function"==typeof Symbol&&Symbol.observable||"@@observable";function bo(n){return n}let Ae=(()=>{class n{constructor(i){i&&(this._subscribe=i)}lift(i){const s=new n;return s.source=this,s.operator=i,s}subscribe(i,s,l){const u=function(n){return n&&n instanceof cr||function(n){return n&&M(n.next)&&M(n.error)&&M(n.complete)}(n)&&c(n)}(i)?i:new hr(i,s,l);return qt(()=>{const{operator:h,source:d}=this;u.add(h?h.call(u,d):d?this._subscribe(u):this._trySubscribe(u))}),u}_trySubscribe(i){try{return this._subscribe(i)}catch(s){i.error(s)}}forEach(i,s){return new(s=bp(s))((l,u)=>{let h;h=this.subscribe(d=>{try{i(d)}catch(g){u(g),null==h||h.unsubscribe()}},u,l)})}_subscribe(i){var s;return null===(s=this.source)||void 0===s?void 0:s.subscribe(i)}[Zl](){return this}pipe(...i){return function(n){return 0===n.length?bo:1===n.length?n[0]:function(i){return n.reduce((s,l)=>l(s),i)}}(i)(this)}toPromise(i){return new(i=bp(i))((s,l)=>{let u;this.subscribe(h=>u=h,h=>l(h),()=>s(u))})}}return n.create=o=>new n(o),n})();function bp(n){var o;return null!==(o=null!=n?n:f.Promise)&&void 0!==o?o:Promise}const fS=N(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let xn=(()=>{class n extends Ae{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(i){const s=new Rp(this,this);return s.operator=i,s}_throwIfClosed(){if(this.closed)throw new fS}next(i){qt(()=>{if(this._throwIfClosed(),!this.isStopped){const s=this.observers.slice();for(const l of s)l.next(i)}})}error(i){qt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=i;const{observers:s}=this;for(;s.length;)s.shift().error(i)}})}complete(){qt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:i}=this;for(;i.length;)i.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var i;return(null===(i=this.observers)||void 0===i?void 0:i.length)>0}_trySubscribe(i){return this._throwIfClosed(),super._trySubscribe(i)}_subscribe(i){return this._throwIfClosed(),this._checkFinalizedStatuses(i),this._innerSubscribe(i)}_innerSubscribe(i){const{hasError:s,isStopped:l,observers:u}=this;return s||l?a:(u.push(i),new r(()=>e(u,i)))}_checkFinalizedStatuses(i){const{hasError:s,thrownError:l,isStopped:u}=this;s?i.error(l):u&&i.complete()}asObservable(){const i=new Ae;return i.source=this,i}}return n.create=(o,i)=>new Rp(o,i),n})();class Rp extends xn{constructor(o,i){super(),this.destination=o,this.source=i}next(o){var i,s;null===(s=null===(i=this.destination)||void 0===i?void 0:i.next)||void 0===s||s.call(i,o)}error(o){var i,s;null===(s=null===(i=this.destination)||void 0===i?void 0:i.error)||void 0===s||s.call(i,o)}complete(){var o,i;null===(i=null===(o=this.destination)||void 0===o?void 0:o.complete)||void 0===i||i.call(o)}_subscribe(o){var i,s;return null!==(s=null===(i=this.source)||void 0===i?void 0:i.subscribe(o))&&void 0!==s?s:a}}function Dp(n){return M(null==n?void 0:n.lift)}function et(n){return o=>{if(Dp(o))return o.lift(function(i){try{return n(i,this)}catch(s){this.error(s)}});throw new TypeError("Unable to lift unknown Observable type")}}class Ye extends cr{constructor(o,i,s,l,u){super(o),this.onFinalize=u,this._next=i?function(h){try{i(h)}catch(d){o.error(d)}}:super._next,this._error=l?function(h){try{l(h)}catch(d){o.error(d)}finally{this.unsubscribe()}}:super._error,this._complete=s?function(){try{s()}catch(h){o.error(h)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var o;const{closed:i}=this;super.unsubscribe(),!i&&(null===(o=this.onFinalize)||void 0===o||o.call(this))}}function Ee(n,o){return et((i,s)=>{let l=0;i.subscribe(new Ye(s,u=>{s.next(n.call(o,u,l++))}))})}function Ro(n){return this instanceof Ro?(this.v=n,this):new Ro(n)}function ES(n,o,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l,s=i.apply(n,o||[]),u=[];return l={},h("next"),h("throw"),h("return"),l[Symbol.asyncIterator]=function(){return this},l;function h(v){s[v]&&(l[v]=function(C){return new Promise(function(S,b){u.push([v,C,S,b])>1||d(v,C)})})}function d(v,C){try{!function(v){v.value instanceof Ro?Promise.resolve(v.value.v).then(_,m):E(u[0][2],v)}(s[v](C))}catch(S){E(u[0][3],S)}}function _(v){d("next",v)}function m(v){d("throw",v)}function E(v,C){v(C),u.shift(),u.length&&d(u[0][0],u[0][1])}}function TS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,o=n[Symbol.asyncIterator];return o?o.call(n):(n=function(n){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&n[o],s=0;if(i)return i.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(u){i[u]=n[u]&&function(h){return new Promise(function(d,g){!function(u,h,d,g){Promise.resolve(g).then(function(_){u({value:_,done:d})},h)}(d,g,(h=n[u](h)).done,h.value)})}}}const Mp=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Np(n){return M(null==n?void 0:n.then)}function kp(n){return M(n[Zl])}function Lp(n){return Symbol.asyncIterator&&M(null==n?void 0:n[Symbol.asyncIterator])}function Pp(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const xp="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Fp(n){return M(null==n?void 0:n[xp])}function Vp(n){return ES(this,arguments,function*(){const i=n.getReader();try{for(;;){const{value:s,done:l}=yield Ro(i.read());if(l)return yield Ro(void 0);yield yield Ro(s)}}finally{i.releaseLock()}})}function Up(n){return M(null==n?void 0:n.getReader)}function mn(n){if(n instanceof Ae)return n;if(null!=n){if(kp(n))return function(n){return new Ae(o=>{const i=n[Zl]();if(M(i.subscribe))return i.subscribe(o);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Mp(n))return function(n){return new Ae(o=>{for(let i=0;i<n.length&&!o.closed;i++)o.next(n[i]);o.complete()})}(n);if(Np(n))return function(n){return new Ae(o=>{n.then(i=>{o.closed||(o.next(i),o.complete())},i=>o.error(i)).then(null,y)})}(n);if(Lp(n))return Bp(n);if(Fp(n))return function(n){return new Ae(o=>{for(const i of n)if(o.next(i),o.closed)return;o.complete()})}(n);if(Up(n))return function(n){return Bp(Vp(n))}(n)}throw Pp(n)}function Bp(n){return new Ae(o=>{(function(n,o){var i,s,l,u;return function(n,o,i,s){return new(i||(i=Promise))(function(u,h){function d(m){try{_(s.next(m))}catch(E){h(E)}}function g(m){try{_(s.throw(m))}catch(E){h(E)}}function _(m){m.done?u(m.value):function(u){return u instanceof i?u:new i(function(h){h(u)})}(m.value).then(d,g)}_((s=s.apply(n,o||[])).next())})}(this,void 0,void 0,function*(){try{for(i=TS(n);!(s=yield i.next()).done;)if(o.next(s.value),o.closed)return}catch(h){l={error:h}}finally{try{s&&!s.done&&(u=i.return)&&(yield u.call(i))}finally{if(l)throw l.error}}o.complete()})})(n,o).catch(i=>o.error(i))})}function Fn(n,o,i,s=0,l=!1){const u=o.schedule(function(){i(),l?n.add(this.schedule(null,s)):this.unsubscribe()},s);if(n.add(u),!l)return u}function Ke(n,o,i=1/0){return M(o)?Ke((s,l)=>Ee((u,h)=>o(s,u,l,h))(mn(n(s,l))),i):("number"==typeof o&&(i=o),et((s,l)=>function(n,o,i,s,l,u,h,d){const g=[];let _=0,m=0,E=!1;const v=()=>{E&&!g.length&&!_&&o.complete()},C=b=>_<s?S(b):g.push(b),S=b=>{_++;let I=!1;mn(i(b,m++)).subscribe(new Ye(o,A=>{o.next(A)},()=>{I=!0},void 0,()=>{if(I)try{for(_--;g.length&&_<s;){const A=g.shift();S(A)}v()}catch(A){o.error(A)}}))};return n.subscribe(new Ye(o,C,()=>{E=!0,v()})),()=>{}}(s,l,n,i)))}function dr(n=1/0){return Ke(bo,n)}const Vn=new Ae(n=>n.complete());function eu(n){return n[n.length-1]}function Hp(n){return M(eu(n))?n.pop():void 0}function pr(n){return function(n){return n&&M(n.schedule)}(eu(n))?n.pop():void 0}function Gp(n,o=0){return et((i,s)=>{i.subscribe(new Ye(s,l=>Fn(s,n,()=>s.next(l),o),()=>Fn(s,n,()=>s.complete(),o),l=>Fn(s,n,()=>s.error(l),o)))})}function Wp(n,o=0){return et((i,s)=>{s.add(n.schedule(()=>i.subscribe(s),o))})}function jp(n,o){if(!n)throw new Error("Iterable cannot be null");return new Ae(i=>{Fn(i,o,()=>{const s=n[Symbol.asyncIterator]();Fn(i,o,()=>{s.next().then(l=>{l.done?i.complete():i.next(l.value)})},0,!0)})})}function ze(n,o){return o?function(n,o){if(null!=n){if(kp(n))return function(n,o){return mn(n).pipe(Wp(o),Gp(o))}(n,o);if(Mp(n))return function(n,o){return new Ae(i=>{let s=0;return o.schedule(function(){s===n.length?i.complete():(i.next(n[s++]),i.closed||this.schedule())})})}(n,o);if(Np(n))return function(n,o){return mn(n).pipe(Wp(o),Gp(o))}(n,o);if(Lp(n))return jp(n,o);if(Fp(n))return function(n,o){return new Ae(i=>{let s;return Fn(i,o,()=>{s=n[xp](),Fn(i,o,()=>{let l,u;try{({value:l,done:u}=s.next())}catch(h){return void i.error(h)}u?i.complete():i.next(l)},0,!0)}),()=>M(null==s?void 0:s.return)&&s.return()})}(n,o);if(Up(n))return function(n,o){return jp(Vp(n),o)}(n,o)}throw Pp(n)}(n,o):mn(n)}function Bs(n){return n<=0?()=>Vn:et((o,i)=>{let s=0;o.subscribe(new Ye(i,l=>{++s<=n&&(i.next(l),n<=s&&i.complete())}))})}function tu(n,o,...i){return!0===o?(n(),null):!1===o?null:o(...i).pipe(Bs(1)).subscribe(()=>n())}function ge(n){for(let o in n)if(n[o]===ge)return o;throw Error("Could not find renamed property on target object.")}function nu(n,o){for(const i in o)o.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&(n[i]=o[i])}function oe(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(oe).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const o=n.toString();if(null==o)return""+o;const i=o.indexOf("\n");return-1===i?o:o.substring(0,i)}function ou(n,o){return null==n||""===n?null===o?"":o:null==o||""===o?n:n+" "+o}const BS=ge({__forward_ref__:ge});function Te(n){return n.__forward_ref__=Te,n.toString=function(){return oe(this())},n}function U(n){return Xp(n)?n():n}function Xp(n){return"function"==typeof n&&n.hasOwnProperty(BS)&&n.__forward_ref__===Te}class Do extends Error{constructor(o,i){super(function(n,o){return`${n?`NG0${n}: `:""}${o}`}(o,i)),this.code=o}}function pt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():function(n){return"string"==typeof n?n:null==n?"":String(n)}(n)}function Hs(n,o){const i=o?` in ${o}`:"";throw new Do("201",`No provider for ${pt(n)} found${i}`)}function Rt(n,o){null==n&&function(n,o,i,s){throw new Error(`ASSERTION ERROR: ${n}`+(null==s?"":` [Expected=> ${i} ${s} ${o} <=Actual]`))}(o,n,null,"!=")}function re(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function xt(n){return{providers:n.providers||[],imports:n.imports||[]}}function Bn(n){return Yp(n,Gs)||Yp(n,zp)}function Yp(n,o){return n.hasOwnProperty(o)?n[o]:null}function Kp(n){return n&&(n.hasOwnProperty(ru)||n.hasOwnProperty(KS))?n[ru]:null}const Gs=ge({\u0275prov:ge}),ru=ge({\u0275inj:ge}),zp=ge({ngInjectableDef:ge}),KS=ge({ngInjectorDef:ge});var W=(()=>((W=W||{})[W.Default=0]="Default",W[W.Host=1]="Host",W[W.Self=2]="Self",W[W.SkipSelf=4]="SkipSelf",W[W.Optional=8]="Optional",W))();let su;function no(n){const o=su;return su=n,o}function Jp(n,o,i){const s=Bn(n);return s&&"root"==s.providedIn?void 0===s.value?s.value=s.factory():s.value:i&W.Optional?null:void 0!==o?o:void Hs(oe(n),"Injector")}function oo(n){return{toString:n}.toString()}var Ft=(()=>((Ft=Ft||{})[Ft.OnPush=0]="OnPush",Ft[Ft.Default=1]="Default",Ft))(),Dt=(()=>{return(n=Dt||(Dt={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Dt;var n})();const JS="undefined"!=typeof globalThis&&globalThis,$S="undefined"!=typeof window&&window,qS="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,de=JS||"undefined"!=typeof global&&global||$S||qS,ei={},_e=[],Ws=ge({\u0275cmp:ge}),au=ge({\u0275dir:ge}),lu=ge({\u0275pipe:ge}),$p=ge({\u0275mod:ge}),Hn=ge({\u0275fac:ge}),gr=ge({__NG_ELEMENT_ID__:ge});let ZS=0;function fr(n){return oo(()=>{const i={},s={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ft.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||_e,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Dt.Emulated,id:"c",styles:n.styles||_e,_:null,setInput:null,schemas:n.schemas||null,tView:null},l=n.directives,u=n.features,h=n.pipes;return s.id+=ZS++,s.inputs=eg(n.inputs,i),s.outputs=eg(n.outputs),u&&u.forEach(d=>d(s)),s.directiveDefs=l?()=>("function"==typeof l?l():l).map(qp):null,s.pipeDefs=h?()=>("function"==typeof h?h():h).map(Zp):null,s})}function qp(n){return it(n)||function(n){return n[au]||null}(n)}function Zp(n){return function(n){return n[lu]||null}(n)}const Qp={};function En(n){return oo(()=>{const o={type:n.type,bootstrap:n.bootstrap||_e,declarations:n.declarations||_e,imports:n.imports||_e,exports:n.exports||_e,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(Qp[n.id]=n.type),o})}function eg(n,o){if(null==n)return ei;const i={};for(const s in n)if(n.hasOwnProperty(s)){let l=n[s],u=l;Array.isArray(l)&&(u=l[1],l=l[0]),i[l]=s,o&&(o[l]=u)}return i}const Y=fr;function it(n){return n[Ws]||null}function Vt(n,o){const i=n[$p]||null;if(!i&&!0===o)throw new Error(`Type ${oe(n)} does not have '\u0275mod' property.`);return i}function Tn(n){return Array.isArray(n)&&"object"==typeof n[1]}function Qt(n){return Array.isArray(n)&&!0===n[1]}function hu(n){return 0!=(8&n.flags)}function Ks(n){return 2==(2&n.flags)}function zs(n){return 1==(1&n.flags)}function en(n){return null!==n.template}function iI(n){return 0!=(512&n[2])}function No(n,o){return n.hasOwnProperty(Hn)?n[Hn]:null}class ng{constructor(o,i,s){this.previousValue=o,this.currentValue=i,this.firstChange=s}isFirstChange(){return this.firstChange}}function st(){return og}function og(n){return n.type.prototype.ngOnChanges&&(n.setInput=lI),aI}function aI(){const n=rg(this),o=null==n?void 0:n.current;if(o){const i=n.previous;if(i===ei)n.previous=o;else for(let s in o)i[s]=o[s];n.current=null,this.ngOnChanges(o)}}function lI(n,o,i,s){const l=rg(n)||function(n,o){return n[ig]=o}(n,{previous:ei,current:null}),u=l.current||(l.current={}),h=l.previous,d=this.declaredInputs[i],g=h[d];u[d]=new ng(g&&g.currentValue,o,h===ei),n[s]=o}st.ngInherit=!0;const ig="__ngSimpleChanges__";function rg(n){return n[ig]||null}let gu;function Me(n){return!!n.listen}const lg={createRenderer:(n,o)=>void 0!==gu?gu:"undefined"!=typeof document?document:void 0};function Fe(n){for(;Array.isArray(n);)n=n[0];return n}function Ht(n,o){return Fe(o[n.index])}function _u(n,o){return n.data[o]}function wt(n,o){const i=o[n];return Tn(i)?i:i[0]}function mu(n){return 128==(128&n[2])}function ro(n,o){return null==o?null:n[o]}function cg(n){n[18]=0}function Eu(n,o){n[5]+=o;let i=n,s=n[3];for(;null!==s&&(1===o&&1===i[5]||-1===o&&0===i[5]);)s[5]+=o,i=s,s=s[3]}const z={lFrame:Eg(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function hg(){return z.bindingsEnabled}function w(){return z.lFrame.lView}function he(){return z.lFrame.tView}function He(){let n=dg();for(;null!==n&&64===n.type;)n=n.parent;return n}function dg(){return z.lFrame.currentTNode}function vn(n,o){const i=z.lFrame;i.currentTNode=n,i.isParent=o}function Tu(){return z.lFrame.isParent}function $s(){return z.isInCheckNoChangesMode}function qs(n){z.isInCheckNoChangesMode=n}function II(n,o){const i=z.lFrame;i.bindingIndex=i.bindingRootIndex=n,Cu(o)}function Cu(n){z.lFrame.currentDirectiveIndex=n}function Su(n){z.lFrame.currentQueryIndex=n}function RI(n){const o=n[1];return 2===o.type?o.declTNode:1===o.type?n[6]:null}function _g(n,o,i){if(i&W.SkipSelf){let l=o,u=n;for(;!(l=l.parent,null!==l||i&W.Host||(l=RI(u),null===l||(u=u[15],10&l.type))););if(null===l)return!1;o=l,n=u}const s=z.lFrame=mg();return s.currentTNode=o,s.lView=n,!0}function Zs(n){const o=mg(),i=n[1];z.lFrame=o,o.currentTNode=i.firstChild,o.lView=n,o.tView=i,o.contextLView=n,o.bindingIndex=i.bindingStartIndex,o.inI18n=!1}function mg(){const n=z.lFrame,o=null===n?null:n.child;return null===o?Eg(n):o}function Eg(n){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=o),o}function Tg(){const n=z.lFrame;return z.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const vg=Tg;function Qs(){const n=Tg();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ft(){return z.lFrame.selectedIndex}function so(n){z.lFrame.selectedIndex=n}function ea(n,o){for(let i=o.directiveStart,s=o.directiveEnd;i<s;i++){const u=n.data[i].type.prototype,{ngAfterContentInit:h,ngAfterContentChecked:d,ngAfterViewInit:g,ngAfterViewChecked:_,ngOnDestroy:m}=u;h&&(n.contentHooks||(n.contentHooks=[])).push(-i,h),d&&((n.contentHooks||(n.contentHooks=[])).push(i,d),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(i,d)),g&&(n.viewHooks||(n.viewHooks=[])).push(-i,g),_&&((n.viewHooks||(n.viewHooks=[])).push(i,_),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(i,_)),null!=m&&(n.destroyHooks||(n.destroyHooks=[])).push(i,m)}}function ta(n,o,i){Cg(n,o,3,i)}function na(n,o,i,s){(3&n[2])===i&&Cg(n,o,i,s)}function Iu(n,o){let i=n[2];(3&i)===o&&(i&=2047,i+=1,n[2]=i)}function Cg(n,o,i,s){const u=null!=s?s:-1,h=o.length-1;let d=0;for(let g=void 0!==s?65535&n[18]:0;g<h;g++)if("number"==typeof o[g+1]){if(d=o[g],null!=s&&d>=s)break}else o[g]<0&&(n[18]+=65536),(d<u||-1==u)&&(PI(n,i,o,g),n[18]=(4294901760&n[18])+g+2),g++}function PI(n,o,i,s){const l=i[s]<0,u=i[s+1],d=n[l?-i[s]:i[s]];if(l){if(n[2]>>11<n[18]>>16&&(3&n[2])===o){n[2]+=2048;try{u.call(d)}finally{}}}else try{u.call(d)}finally{}}class vr{constructor(o,i,s){this.factory=o,this.resolving=!1,this.canSeeViewProviders=i,this.injectImpl=s}}function oa(n,o,i){const s=Me(n);let l=0;for(;l<i.length;){const u=i[l];if("number"==typeof u){if(0!==u)break;l++;const h=i[l++],d=i[l++],g=i[l++];s?n.setAttribute(o,d,g,h):o.setAttributeNS(h,d,g)}else{const h=u,d=i[++l];Ru(h)?s&&n.setProperty(o,h,d):s?n.setAttribute(o,h,d):o.setAttribute(h,d),l++}}return l}function yg(n){return 3===n||4===n||6===n}function Ru(n){return 64===n.charCodeAt(0)}function ia(n,o){if(null!==o&&0!==o.length)if(null===n||0===n.length)n=o.slice();else{let i=-1;for(let s=0;s<o.length;s++){const l=o[s];"number"==typeof l?i=l:0===i||Sg(n,i,l,null,-1===i||2===i?o[++s]:null)}}return n}function Sg(n,o,i,s,l){let u=0,h=n.length;if(-1===o)h=-1;else for(;u<n.length;){const d=n[u++];if("number"==typeof d){if(d===o){h=-1;break}if(d>o){h=u-1;break}}}for(;u<n.length;){const d=n[u];if("number"==typeof d)break;if(d===i){if(null===s)return void(null!==l&&(n[u+1]=l));if(s===n[u+1])return void(n[u+2]=l)}u++,null!==s&&u++,null!==l&&u++}-1!==h&&(n.splice(h,0,o),u=h+1),n.splice(u++,0,i),null!==s&&n.splice(u++,0,s),null!==l&&n.splice(u++,0,l)}function Ig(n){return-1!==n}function ai(n){return 32767&n}function li(n,o){let i=function(n){return n>>16}(n),s=o;for(;i>0;)s=s[15],i--;return s}let Du=!0;function ra(n){const o=Du;return Du=n,o}let HI=0;function yr(n,o){const i=wu(n,o);if(-1!==i)return i;const s=o[1];s.firstCreatePass&&(n.injectorIndex=o.length,Au(s.data,n),Au(o,null),Au(s.blueprint,null));const l=sa(n,o),u=n.injectorIndex;if(Ig(l)){const h=ai(l),d=li(l,o),g=d[1].data;for(let _=0;_<8;_++)o[u+_]=d[h+_]|g[h+_]}return o[u+8]=l,u}function Au(n,o){n.push(0,0,0,0,0,0,0,0,o)}function wu(n,o){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===o[n.injectorIndex+8]?-1:n.injectorIndex}function sa(n,o){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let i=0,s=null,l=o;for(;null!==l;){const u=l[1],h=u.type;if(s=2===h?u.declTNode:1===h?l[6]:null,null===s)return-1;if(i++,l=l[15],-1!==s.injectorIndex)return s.injectorIndex|i<<16}return-1}function aa(n,o,i){!function(n,o,i){let s;"string"==typeof i?s=i.charCodeAt(0)||0:i.hasOwnProperty(gr)&&(s=i[gr]),null==s&&(s=i[gr]=HI++);const l=255&s;o.data[n+(l>>5)]|=1<<l}(n,o,i)}function Dg(n,o,i){if(i&W.Optional)return n;Hs(o,"NodeInjector")}function Ag(n,o,i,s){if(i&W.Optional&&void 0===s&&(s=null),0==(i&(W.Self|W.Host))){const l=n[9],u=no(void 0);try{return l?l.get(o,s,i&W.Optional):Jp(o,s,i&W.Optional)}finally{no(u)}}return Dg(s,o,i)}function wg(n,o,i,s=W.Default,l){if(null!==n){const u=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const o=n.hasOwnProperty(gr)?n[gr]:void 0;return"number"==typeof o?o>=0?255&o:jI:o}(i);if("function"==typeof u){if(!_g(o,n,s))return s&W.Host?Dg(l,i,s):Ag(o,i,s,l);try{const h=u(s);if(null!=h||s&W.Optional)return h;Hs(i)}finally{vg()}}else if("number"==typeof u){let h=null,d=wu(n,o),g=-1,_=s&W.Host?o[16][6]:null;for((-1===d||s&W.SkipSelf)&&(g=-1===d?sa(n,o):o[d+8],-1!==g&&Ng(s,!1)?(h=o[1],d=ai(g),o=li(g,o)):d=-1);-1!==d;){const m=o[1];if(Mg(u,d,m.data)){const E=XI(d,o,i,h,s,_);if(E!==Og)return E}g=o[d+8],-1!==g&&Ng(s,o[1].data[d+8]===_)&&Mg(u,d,o)?(h=m,d=ai(g),o=li(g,o)):d=-1}}}return Ag(o,i,s,l)}const Og={};function jI(){return new ui(He(),w())}function XI(n,o,i,s,l,u){const h=o[1],d=h.data[n+8],m=function(n,o,i,s,l){const u=n.providerIndexes,h=o.data,d=1048575&u,g=n.directiveStart,m=u>>20,v=l?d+m:n.directiveEnd;for(let C=s?d:d+m;C<v;C++){const S=h[C];if(C<g&&i===S||C>=g&&S.type===i)return C}if(l){const C=h[g];if(C&&en(C)&&C.type===i)return g}return null}(d,h,i,null==s?Ks(d)&&Du:s!=h&&0!=(3&d.type),l&W.Host&&u===d);return null!==m?Sr(o,h,m,d):Og}function Sr(n,o,i,s){let l=n[i];const u=o.data;if(function(n){return n instanceof vr}(l)){const h=l;h.resolving&&function(n,o){throw new Do("200",`Circular dependency in DI detected for ${n}`)}(pt(u[i]));const d=ra(h.canSeeViewProviders);h.resolving=!0;const g=h.injectImpl?no(h.injectImpl):null;_g(n,s,W.Default);try{l=n[i]=h.factory(void 0,u,n,s),o.firstCreatePass&&i>=s.directiveStart&&function(n,o,i){const{ngOnChanges:s,ngOnInit:l,ngDoCheck:u}=o.type.prototype;if(s){const h=og(o);(i.preOrderHooks||(i.preOrderHooks=[])).push(n,h),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(n,h)}l&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-n,l),u&&((i.preOrderHooks||(i.preOrderHooks=[])).push(n,u),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(n,u))}(i,u[i],o)}finally{null!==g&&no(g),ra(d),h.resolving=!1,vg()}}return l}function Mg(n,o,i){return!!(i[o+(n>>5)]&1<<n)}function Ng(n,o){return!(n&W.Self||n&W.Host&&o)}class ui{constructor(o,i){this._tNode=o,this._lView=i}get(o,i,s){return wg(this._tNode,this._lView,o,s,i)}}function Ou(n){return Xp(n)?()=>{const o=Ou(U(n));return o&&o()}:No(n)}const hi="__parameters__";function ko(n,o,i){return oo(()=>{const s=function(n){return function(...i){if(n){const s=n(...i);for(const l in s)this[l]=s[l]}}}(o);function l(...u){if(this instanceof l)return s.apply(this,u),this;const h=new l(...u);return d.annotation=h,d;function d(g,_,m){const E=g.hasOwnProperty(hi)?g[hi]:Object.defineProperty(g,hi,{value:[]})[hi];for(;E.length<=m;)E.push(null);return(E[m]=E[m]||[]).push(h),g}}return i&&(l.prototype=Object.create(i.prototype)),l.prototype.ngMetadataName=n,l.annotationCls=l,l})}class ae{constructor(o,i){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof i?this.__NG_ELEMENT_ID__=i:void 0!==i&&(this.\u0275prov=re({token:this,providedIn:i.providedIn||"root",factory:i.factory}))}toString(){return`InjectionToken ${this._desc}`}}const JI=new ae("AnalyzeForEntryComponents");function Cn(n,o){n.forEach(i=>Array.isArray(i)?Cn(i,o):o(i))}function ua(n,o,i){o>=n.length?n.push(i):n.splice(o,0,i)}function Lo(n,o){return o>=n.length-1?n.pop():n.splice(o,1)[0]}function Ot(n,o,i){let s=pi(n,o);return s>=0?n[1|s]=i:(s=~s,function(n,o,i,s){let l=n.length;if(l==o)n.push(i,s);else if(1===l)n.push(s,n[0]),n[0]=i;else{for(l--,n.push(n[l-1],n[l]);l>o;)n[l]=n[l-2],l--;n[o]=i,n[o+1]=s}}(n,s,o,i)),s}function ku(n,o){const i=pi(n,o);if(i>=0)return n[1|i]}function pi(n,o){return function(n,o,i){let s=0,l=n.length>>i;for(;l!==s;){const u=s+(l-s>>1),h=n[u<<i];if(o===h)return u<<i;h>o?l=u:s=u+1}return~(l<<i)}(n,o,1)}const wr={},Pu="__NG_DI_FLAG__",gi="ngTempTokenPath",rb=/\n/gm,xu="__source",Fu=ge({provide:String,useValue:ge});let Or;function fi(n){const o=Or;return Or=n,o}function ab(n,o=W.Default){if(void 0===Or)throw new Error("inject() must be called from an injection context");return null===Or?Jp(n,void 0,o):Or.get(n,o&W.Optional?null:void 0,o)}function B(n,o=W.Default){return(su||ab)(U(n),o)}function Po(n){const o=[];for(let i=0;i<n.length;i++){const s=U(n[i]);if(Array.isArray(s)){if(0===s.length)throw new Error("Arguments array must have arguments.");let l,u=W.Default;for(let h=0;h<s.length;h++){const d=s[h],g=lb(d);"number"==typeof g?-1===g?l=d.token:u|=g:l=d}o.push(B(l,u))}else o.push(B(s))}return o}function Mr(n,o){return n[Pu]=o,n.prototype[Pu]=o,n}function lb(n){return n[Pu]}function Fg(n,o,i,s){const l=n[gi];throw o[xu]&&l.unshift(o[xu]),n.message=function(n,o,i,s=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let l=oe(o);if(Array.isArray(o))l=o.map(oe).join(" -> ");else if("object"==typeof o){let u=[];for(let h in o)if(o.hasOwnProperty(h)){let d=o[h];u.push(h+":"+("string"==typeof d?JSON.stringify(d):oe(d)))}l=`{${u.join(", ")}}`}return`${i}${s?"("+s+")":""}[${l}]: ${n.replace(rb,"\n  ")}`}("\n"+n.message,l,i,s),n.ngTokenPath=l,n[gi]=null,n}const _i=Mr(ko("Inject",n=>({token:n})),-1),St=Mr(ko("Optional"),8),uo=Mr(ko("SkipSelf"),4);const nf="__ngContext__";function at(n,o){n[nf]=o}function Ku(n){const o=function(n){return n[nf]||null}(n);return o?Array.isArray(o)?o:o.lView:null}function _a(n){return n.ngOriginalError}function tR(n,...o){n.error(...o)}class Fo{constructor(){this._console=console}handleError(o){const i=this._findOriginalError(o),s=this._findContext(o),l=(n=o)&&n.ngErrorLogger||tR;var n;l(this._console,"ERROR",o),i&&l(this._console,"ORIGINAL ERROR",i),s&&l(this._console,"ERROR CONTEXT",s)}_findContext(o){return o?o.ngDebugContext||this._findContext(_a(o)):null}_findOriginalError(o){let i=o&&_a(o);for(;i&&_a(i);)i=_a(i);return i||null}}const df=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(de))();function In(n){return n instanceof Function?n():n}var Nt=(()=>((Nt=Nt||{})[Nt.Important=1]="Important",Nt[Nt.DashCase=2]="DashCase",Nt))();function $u(n,o){return undefined(n,o)}function Fr(n){const o=n[3];return Qt(o)?o[3]:o}function qu(n){return mf(n[13])}function Zu(n){return mf(n[4])}function mf(n){for(;null!==n&&!Qt(n);)n=n[4];return n}function vi(n,o,i,s,l){if(null!=s){let u,h=!1;Qt(s)?u=s:Tn(s)&&(h=!0,s=s[0]);const d=Fe(s);0===n&&null!==i?null==l?Sf(o,i,d):Vo(o,i,d,l||null,!0):1===n&&null!==i?Vo(o,i,d,l||null,!0):2===n?function(n,o,i){const s=Ea(n,o);s&&function(n,o,i,s){Me(n)?n.removeChild(o,i,s):o.removeChild(i)}(n,s,o,i)}(o,d,h):3===n&&o.destroyNode(d),null!=u&&function(n,o,i,s,l){const u=i[7];u!==Fe(i)&&vi(o,n,s,u,l);for(let d=10;d<i.length;d++){const g=i[d];Vr(g[1],g,n,o,s,u)}}(o,n,u,i,l)}}function ec(n,o,i){return Me(n)?n.createElement(o,i):null===i?n.createElement(o):n.createElementNS(i,o)}function Tf(n,o){const i=n[9],s=i.indexOf(o),l=o[3];1024&o[2]&&(o[2]&=-1025,Eu(l,-1)),i.splice(s,1)}function tc(n,o){if(n.length<=10)return;const i=10+o,s=n[i];if(s){const l=s[17];null!==l&&l!==n&&Tf(l,s),o>0&&(n[i-1][4]=s[4]);const u=Lo(n,10+o);!function(n,o){Vr(n,o,o[11],2,null,null),o[0]=null,o[6]=null}(s[1],s);const h=u[19];null!==h&&h.detachView(u[1]),s[3]=null,s[4]=null,s[2]&=-129}return s}function vf(n,o){if(!(256&o[2])){const i=o[11];Me(i)&&i.destroyNode&&Vr(n,o,i,3,null,null),function(n){let o=n[13];if(!o)return nc(n[1],n);for(;o;){let i=null;if(Tn(o))i=o[13];else{const s=o[10];s&&(i=s)}if(!i){for(;o&&!o[4]&&o!==n;)Tn(o)&&nc(o[1],o),o=o[3];null===o&&(o=n),Tn(o)&&nc(o[1],o),i=o&&o[4]}o=i}}(o)}}function nc(n,o){if(!(256&o[2])){o[2]&=-129,o[2]|=256,function(n,o){let i;if(null!=n&&null!=(i=n.destroyHooks))for(let s=0;s<i.length;s+=2){const l=o[i[s]];if(!(l instanceof vr)){const u=i[s+1];if(Array.isArray(u))for(let h=0;h<u.length;h+=2){const d=l[u[h]],g=u[h+1];try{g.call(d)}finally{}}else try{u.call(l)}finally{}}}}(n,o),function(n,o){const i=n.cleanup,s=o[7];let l=-1;if(null!==i)for(let u=0;u<i.length-1;u+=2)if("string"==typeof i[u]){const h=i[u+1],d="function"==typeof h?h(o):Fe(o[h]),g=s[l=i[u+2]],_=i[u+3];"boolean"==typeof _?d.removeEventListener(i[u],g,_):_>=0?s[l=_]():s[l=-_].unsubscribe(),u+=2}else{const h=s[l=i[u+1]];i[u].call(h)}if(null!==s){for(let u=l+1;u<s.length;u++)s[u]();o[7]=null}}(n,o),1===o[1].type&&Me(o[11])&&o[11].destroy();const i=o[17];if(null!==i&&Qt(o[3])){i!==o[3]&&Tf(i,o);const s=o[19];null!==s&&s.detachView(n)}}}function Cf(n,o,i){return function(n,o,i){let s=o;for(;null!==s&&40&s.type;)s=(o=s).parent;if(null===s)return i[0];if(2&s.flags){const l=n.data[s.directiveStart].encapsulation;if(l===Dt.None||l===Dt.Emulated)return null}return Ht(s,i)}(n,o.parent,i)}function Vo(n,o,i,s,l){Me(n)?n.insertBefore(o,i,s,l):o.insertBefore(i,s,l)}function Sf(n,o,i){Me(n)?n.appendChild(o,i):o.appendChild(i)}function If(n,o,i,s,l){null!==s?Vo(n,o,i,s,l):Sf(n,o,i)}function Ea(n,o){return Me(n)?n.parentNode(o):o.parentNode}let Df=function(n,o,i){return 40&n.type?Ht(n,i):null};function Ta(n,o,i,s){const l=Cf(n,s,o),u=o[11],d=function(n,o,i){return Df(n,o,i)}(s.parent||o[6],s,o);if(null!=l)if(Array.isArray(i))for(let g=0;g<i.length;g++)If(u,l,i[g],d,!1);else If(u,l,i,d,!1)}function va(n,o){if(null!==o){const i=o.type;if(3&i)return Ht(o,n);if(4&i)return ic(-1,n[o.index]);if(8&i){const s=o.child;if(null!==s)return va(n,s);{const l=n[o.index];return Qt(l)?ic(-1,l):Fe(l)}}if(32&i)return $u(o,n)()||Fe(n[o.index]);{const s=wf(n,o);return null!==s?Array.isArray(s)?s[0]:va(Fr(n[16]),s):va(n,o.next)}}return null}function wf(n,o){return null!==o?n[16][6].projection[o.projection]:null}function ic(n,o){const i=10+n+1;if(i<o.length){const s=o[i],l=s[1].firstChild;if(null!==l)return va(s,l)}return o[7]}function rc(n,o,i,s,l,u,h){for(;null!=i;){const d=s[i.index],g=i.type;if(h&&0===o&&(d&&at(Fe(d),s),i.flags|=4),64!=(64&i.flags))if(8&g)rc(n,o,i.child,s,l,u,!1),vi(o,n,l,d,u);else if(32&g){const _=$u(i,s);let m;for(;m=_();)vi(o,n,l,m,u);vi(o,n,l,d,u)}else 16&g?Mf(n,o,s,i,l,u):vi(o,n,l,d,u);i=h?i.projectionNext:i.next}}function Vr(n,o,i,s,l,u){rc(i,s,n.firstChild,o,l,u,!1)}function Mf(n,o,i,s,l,u){const h=i[16],g=h[6].projection[s.projection];if(Array.isArray(g))for(let _=0;_<g.length;_++)vi(o,n,l,g[_],u);else rc(n,o,g,h[3],l,u,!0)}function Nf(n,o,i){Me(n)?n.setAttribute(o,"style",i):o.style.cssText=i}function sc(n,o,i){Me(n)?""===i?n.removeAttribute(o,"class"):n.setAttribute(o,"class",i):o.className=i}function kf(n,o,i){let s=n.length;for(;;){const l=n.indexOf(o,i);if(-1===l)return l;if(0===l||n.charCodeAt(l-1)<=32){const u=o.length;if(l+u===s||n.charCodeAt(l+u)<=32)return l}i=l+1}}const Lf="ng-template";function DR(n,o,i){let s=0;for(;s<n.length;){let l=n[s++];if(i&&"class"===l){if(l=n[s],-1!==kf(l.toLowerCase(),o,0))return!0}else if(1===l){for(;s<n.length&&"string"==typeof(l=n[s++]);)if(l.toLowerCase()===o)return!0;return!1}}return!1}function Pf(n){return 4===n.type&&n.value!==Lf}function AR(n,o,i){return o===(4!==n.type||i?n.value:Lf)}function wR(n,o,i){let s=4;const l=n.attrs||[],u=function(n){for(let o=0;o<n.length;o++)if(yg(n[o]))return o;return n.length}(l);let h=!1;for(let d=0;d<o.length;d++){const g=o[d];if("number"!=typeof g){if(!h)if(4&s){if(s=2|1&s,""!==g&&!AR(n,g,i)||""===g&&1===o.length){if(nn(s))return!1;h=!0}}else{const _=8&s?g:o[++d];if(8&s&&null!==n.attrs){if(!DR(n.attrs,_,i)){if(nn(s))return!1;h=!0}continue}const E=OR(8&s?"class":g,l,Pf(n),i);if(-1===E){if(nn(s))return!1;h=!0;continue}if(""!==_){let v;v=E>u?"":l[E+1].toLowerCase();const C=8&s?v:null;if(C&&-1!==kf(C,_,0)||2&s&&_!==v){if(nn(s))return!1;h=!0}}}}else{if(!h&&!nn(s)&&!nn(g))return!1;if(h&&nn(g))continue;h=!1,s=g|1&s}}return nn(s)||h}function nn(n){return 0==(1&n)}function OR(n,o,i,s){if(null===o)return-1;let l=0;if(s||!i){let u=!1;for(;l<o.length;){const h=o[l];if(h===n)return l;if(3===h||6===h)u=!0;else{if(1===h||2===h){let d=o[++l];for(;"string"==typeof d;)d=o[++l];continue}if(4===h)break;if(0===h){l+=4;continue}}l+=u?1:2}return-1}return function(n,o){let i=n.indexOf(4);if(i>-1)for(i++;i<n.length;){const s=n[i];if("number"==typeof s)return-1;if(s===o)return i;i++}return-1}(o,n)}function xf(n,o,i=!1){for(let s=0;s<o.length;s++)if(wR(n,o[s],i))return!0;return!1}function Ff(n,o){return n?":not("+o.trim()+")":o}function PR(n){let o=n[0],i=1,s=2,l="",u=!1;for(;i<n.length;){let h=n[i];if("string"==typeof h)if(2&s){const d=n[++i];l+="["+h+(d.length>0?'="'+d+'"':"")+"]"}else 8&s?l+="."+h:4&s&&(l+=" "+h);else""!==l&&!nn(h)&&(o+=Ff(u,l),l=""),s=h,u=u||!nn(s);i++}return""!==l&&(o+=Ff(u,l)),o}const Z={};function ac(n){Vf(he(),w(),ft()+n,$s())}function Vf(n,o,i,s){if(!s)if(3==(3&o[2])){const u=n.preOrderCheckHooks;null!==u&&ta(o,u,i)}else{const u=n.preOrderHooks;null!==u&&na(o,u,0,i)}so(i)}function Ca(n,o){return n<<17|o<<2}function on(n){return n>>17&32767}function lc(n){return 2|n}function jn(n){return(131068&n)>>2}function uc(n,o){return-131069&n|o<<2}function cc(n){return 1|n}function zf(n,o){const i=n.contentQueries;if(null!==i)for(let s=0;s<i.length;s+=2){const l=i[s],u=i[s+1];if(-1!==u){const h=n.data[u];Su(l),h.contentQueries(2,o[u],u)}}}function Ur(n,o,i,s,l,u,h,d,g,_){const m=o.blueprint.slice();return m[0]=l,m[2]=140|s,cg(m),m[3]=m[15]=n,m[8]=i,m[10]=h||n&&n[10],m[11]=d||n&&n[11],m[12]=g||n&&n[12]||null,m[9]=_||n&&n[9]||null,m[6]=u,m[16]=2==o.type?n[16]:m,m}function Ci(n,o,i,s,l){let u=n.data[o];if(null===u)u=function(n,o,i,s,l){const u=dg(),h=Tu(),g=n.data[o]=function(n,o,i,s,l,u){return{type:i,index:s,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:l,attrs:u,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,h?u:u&&u.parent,i,o,s,l);return null===n.firstChild&&(n.firstChild=g),null!==u&&(h?null==u.child&&null!==g.parent&&(u.child=g):null===u.next&&(u.next=g)),g}(n,o,i,s,l),z.lFrame.inI18n&&(u.flags|=64);else if(64&u.type){u.type=i,u.value=s,u.attrs=l;const h=function(){const n=z.lFrame,o=n.currentTNode;return n.isParent?o:o.parent}();u.injectorIndex=null===h?-1:h.injectorIndex}return vn(u,!0),u}function yi(n,o,i,s){if(0===i)return-1;const l=o.length;for(let u=0;u<i;u++)o.push(s),n.blueprint.push(s),n.data.push(null);return l}function Br(n,o,i){Zs(o);try{const s=n.viewQuery;null!==s&&Rc(1,s,i);const l=n.template;null!==l&&Jf(n,o,l,1,i),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&zf(n,o),n.staticViewQueries&&Rc(2,n.viewQuery,i);const u=n.components;null!==u&&function(n,o){for(let i=0;i<o.length;i++)gD(n,o[i])}(o,u)}catch(s){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),s}finally{o[2]&=-5,Qs()}}function Si(n,o,i,s){const l=o[2];if(256==(256&l))return;Zs(o);const u=$s();try{cg(o),function(n){z.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==i&&Jf(n,o,i,2,s);const h=3==(3&l);if(!u)if(h){const _=n.preOrderCheckHooks;null!==_&&ta(o,_,null)}else{const _=n.preOrderHooks;null!==_&&na(o,_,0,null),Iu(o,0)}if(function(n){for(let o=qu(n);null!==o;o=Zu(o)){if(!o[2])continue;const i=o[9];for(let s=0;s<i.length;s++){const l=i[s],u=l[3];0==(1024&l[2])&&Eu(u,1),l[2]|=1024}}}(o),function(n){for(let o=qu(n);null!==o;o=Zu(o))for(let i=10;i<o.length;i++){const s=o[i],l=s[1];mu(s)&&Si(l,s,l.template,s[8])}}(o),null!==n.contentQueries&&zf(n,o),!u)if(h){const _=n.contentCheckHooks;null!==_&&ta(o,_)}else{const _=n.contentHooks;null!==_&&na(o,_,1),Iu(o,1)}!function(n,o){const i=n.hostBindingOpCodes;if(null!==i)try{for(let s=0;s<i.length;s++){const l=i[s];if(l<0)so(~l);else{const u=l,h=i[++s],d=i[++s];II(h,u),d(2,o[u])}}}finally{so(-1)}}(n,o);const d=n.components;null!==d&&function(n,o){for(let i=0;i<o.length;i++)pD(n,o[i])}(o,d);const g=n.viewQuery;if(null!==g&&Rc(2,g,s),!u)if(h){const _=n.viewCheckHooks;null!==_&&ta(o,_)}else{const _=n.viewHooks;null!==_&&na(o,_,2),Iu(o,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),u||(o[2]&=-73),1024&o[2]&&(o[2]&=-1025,Eu(o[3],-1))}finally{Qs()}}function zR(n,o,i,s){const l=o[10],u=!$s(),h=function(n){return 4==(4&n[2])}(o);try{u&&!h&&l.begin&&l.begin(),h&&Br(n,o,s),Si(n,o,i,s)}finally{u&&!h&&l.end&&l.end()}}function Jf(n,o,i,s,l){const u=ft(),h=2&s;try{so(-1),h&&o.length>20&&Vf(n,o,20,$s()),i(s,l)}finally{so(u)}}function Ec(n,o,i){!hg()||(function(n,o,i,s){const l=i.directiveStart,u=i.directiveEnd;n.firstCreatePass||yr(i,o),at(s,o);const h=i.initialInputs;for(let d=l;d<u;d++){const g=n.data[d],_=en(g);_&&lD(o,i,g);const m=Sr(o,n,d,i);at(m,o),null!==h&&uD(0,d-l,m,g,0,h),_&&(wt(i.index,o)[8]=m)}}(n,o,i,Ht(i,o)),128==(128&i.flags)&&function(n,o,i){const s=i.directiveStart,l=i.directiveEnd,h=i.index,d=z.lFrame.currentDirectiveIndex;try{so(h);for(let g=s;g<l;g++){const _=n.data[g],m=o[g];Cu(g),(null!==_.hostBindings||0!==_.hostVars||null!==_.hostAttrs)&&i_(_,m)}}finally{so(-1),Cu(d)}}(n,o,i))}function Tc(n,o,i=Ht){const s=o.localNames;if(null!==s){let l=o.index+1;for(let u=0;u<s.length;u+=2){const h=s[u+1],d=-1===h?i(o,n):n[h];n[l++]=d}}}function qf(n){const o=n.tView;return null===o||o.incompleteFirstPass?n.tView=Ia(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):o}function Ia(n,o,i,s,l,u,h,d,g,_){const m=20+s,E=m+l,v=function(n,o){const i=[];for(let s=0;s<o;s++)i.push(s<n?null:Z);return i}(m,E),C="function"==typeof _?_():_;return v[1]={type:n,blueprint:v,template:i,queries:null,viewQuery:d,declTNode:o,data:v.slice().fill(null,m),bindingStartIndex:m,expandoStartIndex:E,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof u?u():u,pipeRegistry:"function"==typeof h?h():h,firstChild:null,schemas:g,consts:C,incompleteFirstPass:!1}}function t_(n,o,i){for(let s in n)if(n.hasOwnProperty(s)){const l=n[s];(i=null===i?{}:i).hasOwnProperty(s)?i[s].push(o,l):i[s]=[o,l]}return i}function vc(n,o,i,s){let l=!1;if(hg()){const u=function(n,o,i){const s=n.directiveRegistry;let l=null;if(s)for(let u=0;u<s.length;u++){const h=s[u];xf(i,h.selectors,!1)&&(l||(l=[]),aa(yr(i,o),n,h.type),en(h)?(r_(n,i),l.unshift(h)):l.push(h))}return l}(n,o,i),h=null===s?null:{"":-1};if(null!==u){l=!0,s_(i,n.data.length,u.length);for(let m=0;m<u.length;m++){const E=u[m];E.providersResolver&&E.providersResolver(E)}let d=!1,g=!1,_=yi(n,o,u.length,null);for(let m=0;m<u.length;m++){const E=u[m];i.mergedAttrs=ia(i.mergedAttrs,E.hostAttrs),a_(n,i,o,_,E),aD(_,E,h),null!==E.contentQueries&&(i.flags|=8),(null!==E.hostBindings||null!==E.hostAttrs||0!==E.hostVars)&&(i.flags|=128);const v=E.type.prototype;!d&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(i.index),d=!0),!g&&(v.ngOnChanges||v.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(i.index),g=!0),_++}!function(n,o){const s=o.directiveEnd,l=n.data,u=o.attrs,h=[];let d=null,g=null;for(let _=o.directiveStart;_<s;_++){const m=l[_],E=m.inputs,v=null===u||Pf(o)?null:cD(E,u);h.push(v),d=t_(E,_,d),g=t_(m.outputs,_,g)}null!==d&&(d.hasOwnProperty("class")&&(o.flags|=16),d.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=h,o.inputs=d,o.outputs=g}(n,i)}h&&function(n,o,i){if(o){const s=n.localNames=[];for(let l=0;l<o.length;l+=2){const u=i[o[l+1]];if(null==u)throw new Do("301",`Export of name '${o[l+1]}' not found!`);s.push(o[l],u)}}}(i,s,h)}return i.mergedAttrs=ia(i.mergedAttrs,i.attrs),l}function o_(n,o,i,s,l,u){const h=u.hostBindings;if(h){let d=n.hostBindingOpCodes;null===d&&(d=n.hostBindingOpCodes=[]);const g=~o.index;(function(n){let o=n.length;for(;o>0;){const i=n[--o];if("number"==typeof i&&i<0)return i}return 0})(d)!=g&&d.push(g),d.push(s,l,h)}}function i_(n,o){null!==n.hostBindings&&n.hostBindings(1,o)}function r_(n,o){o.flags|=2,(n.components||(n.components=[])).push(o.index)}function aD(n,o,i){if(i){if(o.exportAs)for(let s=0;s<o.exportAs.length;s++)i[o.exportAs[s]]=n;en(o)&&(i[""]=n)}}function s_(n,o,i){n.flags|=1,n.directiveStart=o,n.directiveEnd=o+i,n.providerIndexes=o}function a_(n,o,i,s,l){n.data[s]=l;const u=l.factory||(l.factory=No(l.type)),h=new vr(u,en(l),null);n.blueprint[s]=h,i[s]=h,o_(n,o,0,s,yi(n,i,l.hostVars,Z),l)}function lD(n,o,i){const s=Ht(o,n),l=qf(i),u=n[10],h=ba(n,Ur(n,l,null,i.onPush?64:16,s,o,u,u.createRenderer(s,i),null,null));n[o.index]=h}function uD(n,o,i,s,l,u){const h=u[o];if(null!==h){const d=s.setInput;for(let g=0;g<h.length;){const _=h[g++],m=h[g++],E=h[g++];null!==d?s.setInput(i,E,_,m):i[m]=E}}}function cD(n,o){let i=null,s=0;for(;s<o.length;){const l=o[s];if(0!==l)if(5!==l){if("number"==typeof l)break;n.hasOwnProperty(l)&&(null===i&&(i=[]),i.push(l,n[l],o[s+1])),s+=2}else s+=2;else s+=4}return i}function l_(n,o,i,s){return new Array(n,!0,!1,o,null,0,s,i,null,null)}function pD(n,o){const i=wt(o,n);if(mu(i)){const s=i[1];80&i[2]?Si(s,i,s.template,i[8]):i[5]>0&&yc(i)}}function yc(n){for(let s=qu(n);null!==s;s=Zu(s))for(let l=10;l<s.length;l++){const u=s[l];if(1024&u[2]){const h=u[1];Si(h,u,h.template,u[8])}else u[5]>0&&yc(u)}const i=n[1].components;if(null!==i)for(let s=0;s<i.length;s++){const l=wt(i[s],n);mu(l)&&l[5]>0&&yc(l)}}function gD(n,o){const i=wt(o,n),s=i[1];(function(n,o){for(let i=o.length;i<n.blueprint.length;i++)o.push(n.blueprint[i])})(s,i),Br(s,i,i[8])}function ba(n,o){return n[13]?n[14][4]=o:n[13]=o,n[14]=o,o}function Sc(n){for(;n;){n[2]|=64;const o=Fr(n);if(iI(n)&&!o)return n;n=o}return null}function bc(n,o,i){const s=o[10];s.begin&&s.begin();try{Si(n,o,n.template,i)}catch(l){throw p_(o,l),l}finally{s.end&&s.end()}}function u_(n){!function(n){for(let o=0;o<n.components.length;o++){const i=n.components[o],s=Ku(i),l=s[1];zR(l,s,l.template,i)}}(n[8])}function Rc(n,o,i){Su(0),o(n,i)}const TD=(()=>Promise.resolve(null))();function c_(n){return n[7]||(n[7]=[])}function h_(n){return n.cleanup||(n.cleanup=[])}function p_(n,o){const i=n[9],s=i?i.get(Fo,null):null;s&&s.handleError(o)}function g_(n,o,i,s,l){for(let u=0;u<i.length;){const h=i[u++],d=i[u++],g=o[h],_=n.data[h];null!==_.setInput?_.setInput(g,l,s,d):g[d]=l}}function Ra(n,o,i){let s=i?n.styles:null,l=i?n.classes:null,u=0;if(null!==o)for(let h=0;h<o.length;h++){const d=o[h];"number"==typeof d?u=d:1==u?l=ou(l,d):2==u&&(s=ou(s,d+": "+o[++h]+";"))}i?n.styles=s:n.stylesWithoutHost=s,i?n.classes=l:n.classesWithoutHost=l}const Hr=new ae("INJECTOR",-1);class f_{get(o,i=wr){if(i===wr){const s=new Error(`NullInjectorError: No provider for ${oe(o)}!`);throw s.name="NullInjectorError",s}return i}}const Gr=new ae("Set Injector scope."),Wr={},yD={};let Dc;function __(){return void 0===Dc&&(Dc=new f_),Dc}function m_(n,o=null,i=null,s){return new ID(n,i,o||__(),s)}class ID{constructor(o,i,s,l=null){this.parent=s,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const u=[];i&&Cn(i,d=>this.processProvider(d,o,i)),Cn([o],d=>this.processInjectorType(d,[],u)),this.records.set(Hr,Ii(void 0,this));const h=this.records.get(Gr);this.scope=null!=h?h.value:null,this.source=l||("object"==typeof o?null:oe(o))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(o=>o.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(o,i=wr,s=W.Default){this.assertNotDestroyed();const l=fi(this),u=no(void 0);try{if(!(s&W.SkipSelf)){let d=this.records.get(o);if(void 0===d){const g=("function"==typeof(n=o)||"object"==typeof n&&n instanceof ae)&&Bn(o);d=g&&this.injectableDefInScope(g)?Ii(Ac(o),Wr):null,this.records.set(o,d)}if(null!=d)return this.hydrate(o,d)}return(s&W.Self?__():this.parent).get(o,i=s&W.Optional&&i===wr?null:i)}catch(h){if("NullInjectorError"===h.name){if((h[gi]=h[gi]||[]).unshift(oe(o)),l)throw h;return Fg(h,o,"R3InjectorError",this.source)}throw h}finally{no(u),fi(l)}var n}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(o=>this.get(o))}toString(){const o=[];return this.records.forEach((s,l)=>o.push(oe(l))),`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(o,i,s){if(!(o=U(o)))return!1;let l=Kp(o);const u=null==l&&o.ngModule||void 0,h=void 0===u?o:u,d=-1!==s.indexOf(h);if(void 0!==u&&(l=Kp(u)),null==l)return!1;if(null!=l.imports&&!d){let m;s.push(h);try{Cn(l.imports,E=>{this.processInjectorType(E,i,s)&&(void 0===m&&(m=[]),m.push(E))})}finally{}if(void 0!==m)for(let E=0;E<m.length;E++){const{ngModule:v,providers:C}=m[E];Cn(C,S=>this.processProvider(S,v,C||_e))}}this.injectorDefTypes.add(h);const g=No(h)||(()=>new h);this.records.set(h,Ii(g,Wr));const _=l.providers;if(null!=_&&!d){const m=o;Cn(_,E=>this.processProvider(E,m,_))}return void 0!==u&&void 0!==o.providers}processProvider(o,i,s){let l=bi(o=U(o))?o:U(o&&o.provide);const u=(n=o,T_(n)?Ii(void 0,n.useValue):Ii(E_(n),Wr));var n;if(bi(o)||!0!==o.multi)this.records.get(l);else{let h=this.records.get(l);h||(h=Ii(void 0,Wr,!0),h.factory=()=>Po(h.multi),this.records.set(l,h)),l=o,h.multi.push(o)}this.records.set(l,u)}hydrate(o,i){return i.value===Wr&&(i.value=yD,i.value=i.factory()),"object"==typeof i.value&&i.value&&null!==(n=i.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(i.value),i.value;var n}injectableDefInScope(o){if(!o.providedIn)return!1;const i=U(o.providedIn);return"string"==typeof i?"any"===i||i===this.scope:this.injectorDefTypes.has(i)}}function Ac(n){const o=Bn(n),i=null!==o?o.factory:No(n);if(null!==i)return i;if(n instanceof ae)throw new Error(`Token ${oe(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const o=n.length;if(o>0){const s=function(n,o){const i=[];for(let s=0;s<n;s++)i.push(o);return i}(o,"?");throw new Error(`Can't resolve all parameters for ${oe(n)}: (${s.join(", ")}).`)}const i=function(n){const o=n&&(n[Gs]||n[zp]);if(o){const i=function(n){if(n.hasOwnProperty("name"))return n.name;const o=(""+n).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),o}return null}(n);return null!==i?()=>i.factory(n):()=>new n}(n);throw new Error("unreachable")}function E_(n,o,i){let s;if(bi(n)){const l=U(n);return No(l)||Ac(l)}if(T_(n))s=()=>U(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))s=()=>n.useFactory(...Po(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))s=()=>B(U(n.useExisting));else{const l=U(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return No(l)||Ac(l);s=()=>new l(...Po(n.deps))}return s}function Ii(n,o,i=!1){return{factory:n,value:o,multi:i?[]:void 0}}function T_(n){return null!==n&&"object"==typeof n&&Fu in n}function bi(n){return"function"==typeof n}const v_=function(n,o,i){return function(n,o=null,i=null,s){const l=m_(n,o,i,s);return l._resolveInjectorDefTypes(),l}({name:i},o,n,i)};let fe=(()=>{class n{static create(i,s){return Array.isArray(i)?v_(i,s,""):v_(i.providers,i.parent,i.name||"")}}return n.THROW_IF_NOT_FOUND=wr,n.NULL=new f_,n.\u0275prov=re({token:n,providedIn:"any",factory:()=>B(Hr)}),n.__NG_ELEMENT_ID__=-1,n})();function XD(n,o){ea(Ku(n)[1],He())}function be(n){let o=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),i=!0;const s=[n];for(;o;){let l;if(en(n))l=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new Error("Directives cannot inherit Components");l=o.\u0275dir}if(l){if(i){s.push(l);const h=n;h.inputs=Lc(n.inputs),h.declaredInputs=Lc(n.declaredInputs),h.outputs=Lc(n.outputs);const d=l.hostBindings;d&&JD(n,d);const g=l.viewQuery,_=l.contentQueries;if(g&&KD(n,g),_&&zD(n,_),nu(n.inputs,l.inputs),nu(n.declaredInputs,l.declaredInputs),nu(n.outputs,l.outputs),en(l)&&l.data.animation){const m=n.data;m.animation=(m.animation||[]).concat(l.data.animation)}}const u=l.features;if(u)for(let h=0;h<u.length;h++){const d=u[h];d&&d.ngInherit&&d(n),d===be&&(i=!1)}}o=Object.getPrototypeOf(o)}!function(n){let o=0,i=null;for(let s=n.length-1;s>=0;s--){const l=n[s];l.hostVars=o+=l.hostVars,l.hostAttrs=ia(l.hostAttrs,i=ia(i,l.hostAttrs))}}(s)}function Lc(n){return n===ei?{}:n===_e?[]:n}function KD(n,o){const i=n.viewQuery;n.viewQuery=i?(s,l)=>{o(s,l),i(s,l)}:o}function zD(n,o){const i=n.contentQueries;n.contentQueries=i?(s,l,u)=>{o(s,l,u),i(s,l,u)}:o}function JD(n,o){const i=n.hostBindings;n.hostBindings=i?(s,l)=>{o(s,l),i(s,l)}:o}let Da=null;function Ri(){if(!Da){const n=de.Symbol;if(n&&n.iterator)Da=n.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let i=0;i<o.length;++i){const s=o[i];"entries"!==s&&"size"!==s&&Map.prototype[s]===Map.prototype.entries&&(Da=s)}}}return Da}function Xr(n){return!!Pc(n)&&(Array.isArray(n)||!(n instanceof Map)&&Ri()in n)}function Pc(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function lt(n,o,i){return!Object.is(n[o],i)&&(n[o]=i,!0)}function O(n,o=W.Default){const i=w();return null===i?B(n,o):wg(He(),i,U(n),o)}function Bc(){throw new Error("invalid")}function Oa(n,o,i){const s=w();return lt(s,z.lFrame.bindingIndex++,o)&&function(n,o,i,s,l,u,h,d){const g=Ht(o,i);let m,_=o.inputs;!d&&null!=_&&(m=_[s])?(g_(n,i,m,s,l),Ks(o)&&function(n,o){const i=wt(o,n);16&i[2]||(i[2]|=64)}(i,o.index)):3&o.type&&(s=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(s),l=null!=h?h(l,o.value||"",s):l,Me(u)?u.setProperty(g,s,l):Ru(s)||(g.setProperty?g.setProperty(s,l):g[s]=l))}(he(),function(){const n=z.lFrame;return _u(n.tView,n.selectedIndex)}(),s,n,o,s[11],i,!1),Oa}function Hc(n,o,i,s,l){const h=l?"class":"style";g_(n,i,o.inputs[h],h,s)}function po(n,o,i,s){const l=w(),u=he(),h=20+n,d=l[11],g=l[h]=ec(d,o,z.lFrame.currentNamespace),_=u.firstCreatePass?function(n,o,i,s,l,u,h){const d=o.consts,_=Ci(o,n,2,l,ro(d,u));return vc(o,i,_,ro(d,h)),null!==_.attrs&&Ra(_,_.attrs,!1),null!==_.mergedAttrs&&Ra(_,_.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,_),_}(h,u,l,0,o,i,s):u.data[h];vn(_,!0);const m=_.mergedAttrs;null!==m&&oa(d,g,m);const E=_.classes;null!==E&&sc(d,g,E);const v=_.styles;null!==v&&Nf(d,g,v),64!=(64&_.flags)&&Ta(u,l,g,_),0===z.lFrame.elementDepthCount&&at(g,l),z.lFrame.elementDepthCount++,zs(_)&&(Ec(u,l,_),function(n,o,i){if(hu(o)){const l=o.directiveEnd;for(let u=o.directiveStart;u<l;u++){const h=n.data[u];h.contentQueries&&h.contentQueries(1,i[u],u)}}}(u,_,l)),null!==s&&Tc(l,_)}function go(){let n=He();Tu()?z.lFrame.isParent=!1:(n=n.parent,vn(n,!1));const o=n;z.lFrame.elementDepthCount--;const i=he();i.firstCreatePass&&(ea(i,n),hu(n)&&i.queries.elementEnd(n)),null!=o.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(o)&&Hc(i,o,w(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(o)&&Hc(i,o,w(),o.stylesWithoutHost,!1)}function Ma(n,o,i,s){po(n,o,i,s),go()}function Kr(n){return!!n&&"function"==typeof n.then}const Na=function(n){return!!n&&"function"==typeof n.subscribe};function tt(n,o,i,s){const l=w(),u=he(),h=He();return function(n,o,i,s,l,u,h,d){const g=zs(s),m=n.firstCreatePass&&h_(n),E=o[8],v=c_(o);let C=!0;if(3&s.type||d){const I=Ht(s,o),A=d?d(I):I,R=v.length,x=d?V=>d(Fe(V[s.index])):s.index;if(Me(i)){let V=null;if(!d&&g&&(V=function(n,o,i,s){const l=n.cleanup;if(null!=l)for(let u=0;u<l.length-1;u+=2){const h=l[u];if(h===i&&l[u+1]===s){const d=o[7],g=l[u+2];return d.length>g?d[g]:null}"string"==typeof h&&(u+=2)}return null}(n,o,l,s.index)),null!==V)(V.__ngLastListenerFn__||V).__ngNextListenerFn__=u,V.__ngLastListenerFn__=u,C=!1;else{u=Gc(s,o,E,u,!1);const Q=i.listen(A,l,u);v.push(u,Q),m&&m.push(l,x,R,R+1)}}else u=Gc(s,o,E,u,!0),A.addEventListener(l,u,h),v.push(u),m&&m.push(l,x,R,h)}else u=Gc(s,o,E,u,!1);const S=s.outputs;let b;if(C&&null!==S&&(b=S[l])){const I=b.length;if(I)for(let A=0;A<I;A+=2){const Xe=o[b[A]][b[A+1]].subscribe(u),$t=v.length;v.push(u,Xe),m&&m.push(l,s.index,$t,-($t+1))}}}(u,l,l[11],h,n,o,!!i,s),tt}function cm(n,o,i,s){try{return!1!==i(s)}catch(l){return p_(n,l),!1}}function Gc(n,o,i,s,l){return function u(h){if(h===Function)return s;const d=2&n.flags?wt(n.index,o):o;0==(32&o[2])&&Sc(d);let g=cm(o,0,s,h),_=u.__ngNextListenerFn__;for(;_;)g=cm(o,0,_,h)&&g,_=_.__ngNextListenerFn__;return l&&!1===g&&(h.preventDefault(),h.returnValue=!1),g}}function vm(n,o,i,s,l){const u=n[i+1],h=null===o;let d=s?on(u):jn(u),g=!1;for(;0!==d&&(!1===g||h);){const m=n[d+1];FA(n[d],o)&&(g=!0,n[d+1]=s?cc(m):lc(m)),d=s?on(m):jn(m)}g&&(n[i+1]=s?lc(u):cc(u))}function FA(n,o){return null===n||null==o||(Array.isArray(n)?n[1]:n)===o||!(!Array.isArray(n)||"string"!=typeof o)&&pi(n,o)>=0}function ka(n,o){return function(n,o,i,s){const l=w(),u=he(),h=function(n){const o=z.lFrame,i=o.bindingIndex;return o.bindingIndex=o.bindingIndex+n,i}(2);u.firstUpdatePass&&function(n,o,i,s){const l=n.data;if(null===l[i+1]){const u=l[ft()],h=function(n,o){return o>=n.expandoStartIndex}(n,i);(function(n,o){return 0!=(n.flags&(o?16:32))})(u,s)&&null===o&&!h&&(o=!1),o=function(n,o,i,s){const l=function(n){const o=z.lFrame.currentDirectiveIndex;return-1===o?null:n[o]}(n);let u=s?o.residualClasses:o.residualStyles;if(null===l)0===(s?o.classBindings:o.styleBindings)&&(i=zr(i=jc(null,n,o,i,s),o.attrs,s),u=null);else{const h=o.directiveStylingLast;if(-1===h||n[h]!==l)if(i=jc(l,n,o,i,s),null===u){let g=function(n,o,i){const s=i?o.classBindings:o.styleBindings;if(0!==jn(s))return n[on(s)]}(n,o,s);void 0!==g&&Array.isArray(g)&&(g=jc(null,n,o,g[1],s),g=zr(g,o.attrs,s),function(n,o,i,s){n[on(i?o.classBindings:o.styleBindings)]=s}(n,o,s,g))}else u=function(n,o,i){let s;const l=o.directiveEnd;for(let u=1+o.directiveStylingLast;u<l;u++)s=zr(s,n[u].hostAttrs,i);return zr(s,o.attrs,i)}(n,o,s)}return void 0!==u&&(s?o.residualClasses=u:o.residualStyles=u),i}(l,u,o,s),function(n,o,i,s,l,u){let h=u?o.classBindings:o.styleBindings,d=on(h),g=jn(h);n[s]=i;let m,_=!1;if(Array.isArray(i)){const E=i;m=E[1],(null===m||pi(E,m)>0)&&(_=!0)}else m=i;if(l)if(0!==g){const v=on(n[d+1]);n[s+1]=Ca(v,d),0!==v&&(n[v+1]=uc(n[v+1],s)),n[d+1]=function(n,o){return 131071&n|o<<17}(n[d+1],s)}else n[s+1]=Ca(d,0),0!==d&&(n[d+1]=uc(n[d+1],s)),d=s;else n[s+1]=Ca(g,0),0===d?d=s:n[g+1]=uc(n[g+1],s),g=s;_&&(n[s+1]=lc(n[s+1])),vm(n,m,s,!0),vm(n,m,s,!1),function(n,o,i,s,l){const u=l?n.residualClasses:n.residualStyles;null!=u&&"string"==typeof o&&pi(u,o)>=0&&(i[s+1]=cc(i[s+1]))}(o,m,n,s,u),h=Ca(d,g),u?o.classBindings=h:o.styleBindings=h}(l,u,o,i,h,s)}}(u,n,h,s),o!==Z&&lt(l,h,o)&&function(n,o,i,s,l,u,h,d){if(!(3&o.type))return;const g=n.data,_=g[d+1];La(function(n){return 1==(1&n)}(_)?Nm(g,o,i,l,jn(_),h):void 0)||(La(u)||function(n){return 2==(2&n)}(_)&&(u=Nm(g,null,i,l,d,h)),function(n,o,i,s,l){const u=Me(n);if(o)l?u?n.addClass(i,s):i.classList.add(s):u?n.removeClass(i,s):i.classList.remove(s);else{let h=-1===s.indexOf("-")?void 0:Nt.DashCase;if(null==l)u?n.removeStyle(i,s,h):i.style.removeProperty(s);else{const d="string"==typeof l&&l.endsWith("!important");d&&(l=l.slice(0,-10),h|=Nt.Important),u?n.setStyle(i,s,l,h):i.style.setProperty(s,l,d?"important":"")}}}(s,h,function(n,o){return Fe(o[n])}(ft(),i),l,u))}(u,u.data[ft()],l,l[11],n,l[h+1]=function(n,o){return null==n||("string"==typeof o?n+=o:"object"==typeof n&&(n=oe(function(n){return n instanceof class{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}(n)))),n}(o,i),s,h)}(n,o,null,!0),ka}function jc(n,o,i,s,l){let u=null;const h=i.directiveEnd;let d=i.directiveStylingLast;for(-1===d?d=i.directiveStart:d++;d<h&&(u=o[d],s=zr(s,u.hostAttrs,l),u!==n);)d++;return null!==n&&(i.directiveStylingLast=d),s}function zr(n,o,i){const s=i?1:2;let l=-1;if(null!==o)for(let u=0;u<o.length;u++){const h=o[u];"number"==typeof h?l=h:l===s&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Ot(n,h,!!i||o[++u]))}return void 0===n?null:n}function Nm(n,o,i,s,l,u){const h=null===o;let d;for(;l>0;){const g=n[l],_=Array.isArray(g),m=_?g[1]:g,E=null===m;let v=i[l+1];v===Z&&(v=E?_e:void 0);let C=E?ku(v,s):m===s?v:void 0;if(_&&!La(C)&&(C=ku(g,s)),La(C)&&(d=C,h))return d;const S=n[l+1];l=h?on(S):jn(S)}if(null!==o){let g=u?o.residualClasses:o.residualStyles;null!=g&&(d=ku(g,s))}return d}function La(n){return void 0!==n}function fo(n,o=""){const i=w(),s=he(),l=n+20,u=s.firstCreatePass?Ci(s,l,1,o,null):s.data[l],h=i[l]=function(n,o){return Me(n)?n.createText(o):n.createTextNode(o)}(i[11],o);Ta(s,i,h,u),vn(u,!1)}const Bo=void 0;var Ew=["en",[["a","p"],["AM","PM"],Bo],[["AM","PM"],Bo,Bo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Bo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Bo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Bo,"{1} 'at' {0}",Bo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const i=Math.floor(Math.abs(n)),s=n.toString().replace(/^[^.]*\.?/,"").length;return 1===i&&0===s?1:5}];let Vi={};function tE(n){return n in Vi||(Vi[n]=de.ng&&de.ng.common&&de.ng.common.locales&&de.ng.common.locales[n]),Vi[n]}var P=(()=>((P=P||{})[P.LocaleId=0]="LocaleId",P[P.DayPeriodsFormat=1]="DayPeriodsFormat",P[P.DayPeriodsStandalone=2]="DayPeriodsStandalone",P[P.DaysFormat=3]="DaysFormat",P[P.DaysStandalone=4]="DaysStandalone",P[P.MonthsFormat=5]="MonthsFormat",P[P.MonthsStandalone=6]="MonthsStandalone",P[P.Eras=7]="Eras",P[P.FirstDayOfWeek=8]="FirstDayOfWeek",P[P.WeekendRange=9]="WeekendRange",P[P.DateFormat=10]="DateFormat",P[P.TimeFormat=11]="TimeFormat",P[P.DateTimeFormat=12]="DateTimeFormat",P[P.NumberSymbols=13]="NumberSymbols",P[P.NumberFormats=14]="NumberFormats",P[P.CurrencyCode=15]="CurrencyCode",P[P.CurrencySymbol=16]="CurrencySymbol",P[P.CurrencyName=17]="CurrencyName",P[P.Currencies=18]="Currencies",P[P.Directionality=19]="Directionality",P[P.PluralCase=20]="PluralCase",P[P.ExtraData=21]="ExtraData",P))();const Pa="en-US";let nE=Pa;function zc(n,o,i,s,l){if(n=U(n),Array.isArray(n))for(let u=0;u<n.length;u++)zc(n[u],o,i,s,l);else{const u=he(),h=w();let d=bi(n)?n:U(n.provide),g=E_(n);const _=He(),m=1048575&_.providerIndexes,E=_.directiveStart,v=_.providerIndexes>>20;if(bi(n)||!n.multi){const C=new vr(g,l,O),S=$c(d,o,l?m:m+v,E);-1===S?(aa(yr(_,h),u,d),Jc(u,n,o.length),o.push(d),_.directiveStart++,_.directiveEnd++,l&&(_.providerIndexes+=1048576),i.push(C),h.push(C)):(i[S]=C,h[S]=C)}else{const C=$c(d,o,m+v,E),S=$c(d,o,m,m+v),b=C>=0&&i[C],I=S>=0&&i[S];if(l&&!I||!l&&!b){aa(yr(_,h),u,d);const A=function(n,o,i,s,l){const u=new vr(n,i,O);return u.multi=[],u.index=o,u.componentProviders=0,RE(u,l,s&&!i),u}(l?_O:fO,i.length,l,s,g);!l&&I&&(i[S].providerFactory=A),Jc(u,n,o.length,0),o.push(d),_.directiveStart++,_.directiveEnd++,l&&(_.providerIndexes+=1048576),i.push(A),h.push(A)}else Jc(u,n,C>-1?C:S,RE(i[l?S:C],g,!l&&s));!l&&s&&I&&i[S].componentProviders++}}}function Jc(n,o,i,s){const l=bi(o);if(l||function(n){return!!n.useClass}(o)){const h=(o.useClass||o).prototype.ngOnDestroy;if(h){const d=n.destroyHooks||(n.destroyHooks=[]);if(!l&&o.multi){const g=d.indexOf(i);-1===g?d.push(i,[s,h]):d[g+1].push(s,h)}else d.push(i,h)}}}function RE(n,o,i){return i&&n.componentProviders++,n.multi.push(o)-1}function $c(n,o,i,s){for(let l=i;l<s;l++)if(o[l]===n)return l;return-1}function fO(n,o,i,s){return qc(this.multi,[])}function _O(n,o,i,s){const l=this.multi;let u;if(this.providerFactory){const h=this.providerFactory.componentProviders,d=Sr(i,i[1],this.providerFactory.index,s);u=d.slice(0,h),qc(l,u);for(let g=h;g<d.length;g++)u.push(d[g])}else u=[],qc(l,u);return u}function qc(n,o){for(let i=0;i<n.length;i++)o.push((0,n[i])());return o}function Re(n,o=[]){return i=>{i.providersResolver=(s,l)=>function(n,o,i){const s=he();if(s.firstCreatePass){const l=en(n);zc(i,s.data,s.blueprint,l,!0),zc(o,s.data,s.blueprint,l,!1)}}(s,l?l(n):n,o)}}class DE{}const wE="ngComponent";class TO{resolveComponentFactory(o){throw function(n){const o=Error(`No component factory found for ${oe(n)}. Did you add it to @NgModule.entryComponents?`);return o[wE]=n,o}(o)}}let Ho=(()=>{class n{}return n.NULL=new TO,n})();function Ba(...n){}function Bi(n,o){return new $e(Ht(n,o))}const yO=function(){return Bi(He(),w())};let $e=(()=>{class n{constructor(i){this.nativeElement=i}}return n.__NG_ELEMENT_ID__=yO,n})();class Ha{}let zn=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>IO(),n})();const IO=function(){const n=w(),i=wt(He().index,n);return function(n){return n[11]}(Tn(i)?i:n)};let Qc=(()=>{class n{}return n.\u0275prov=re({token:n,providedIn:"root",factory:()=>null}),n})();class Qr{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const ME=new Qr("13.0.0"),Hi={};function Ga(n,o,i,s,l=!1){for(;null!==i;){const u=o[i.index];if(null!==u&&s.push(Fe(u)),Qt(u))for(let d=10;d<u.length;d++){const g=u[d],_=g[1].firstChild;null!==_&&Ga(g[1],g,_,s)}const h=i.type;if(8&h)Ga(n,o,i.child,s);else if(32&h){const d=$u(i,o);let g;for(;g=d();)s.push(g)}else if(16&h){const d=wf(o,i);if(Array.isArray(d))s.push(...d);else{const g=Fr(o[16]);Ga(g[1],g,d,s,!0)}}i=l?i.projectionNext:i.next}return s}class es{constructor(o,i){this._lView=o,this._cdRefInjectingView=i,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,i=o[1];return Ga(i,o,i.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(Qt(o)){const i=o[8],s=i?i.indexOf(this):-1;s>-1&&(tc(o,s),Lo(i,s))}this._attachedToViewContainer=!1}vf(this._lView[1],this._lView)}onDestroy(o){!function(n,o,i,s){const l=c_(o);null===i?l.push(s):(l.push(i),n.firstCreatePass&&h_(n).push(s,l.length-1))}(this._lView[1],this._lView,null,o)}markForCheck(){Sc(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){bc(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,o,i){qs(!0);try{bc(n,o,i)}finally{qs(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var o;this._appRef=null,Vr(this._lView[1],o=this._lView,o[11],2,null,null)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=o}}class DO extends es{constructor(o){super(o),this._view=o}detectChanges(){u_(this._view)}checkNoChanges(){!function(n){qs(!0);try{u_(n)}finally{qs(!1)}}(this._view)}get context(){return null}}class NE extends Ho{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const i=it(o);return new eh(i,this.ngModule)}}function kE(n){const o=[];for(let i in n)n.hasOwnProperty(i)&&o.push({propName:n[i],templateName:i});return o}const wO=new ae("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>df});class eh extends DE{constructor(o,i){super(),this.componentDef=o,this.ngModule=i,this.componentType=o.type,this.selector=o.selectors.map(PR).join(","),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!i}get inputs(){return kE(this.componentDef.inputs)}get outputs(){return kE(this.componentDef.outputs)}create(o,i,s,l){const u=(l=l||this.ngModule)?function(n,o){return{get:(i,s,l)=>{const u=n.get(i,Hi,l);return u!==Hi||s===Hi?u:o.get(i,s,l)}}}(o,l.injector):o,h=u.get(Ha,lg),d=u.get(Qc,null),g=h.createRenderer(null,this.componentDef),_=this.componentDef.selectors[0][0]||"div",m=s?function(n,o,i){if(Me(n))return n.selectRootElement(o,i===Dt.ShadowDom);let s="string"==typeof o?n.querySelector(o):o;return s.textContent="",s}(g,s,this.componentDef.encapsulation):ec(h.createRenderer(null,this.componentDef),_,function(n){const o=n.toLowerCase();return"svg"===o?"http://www.w3.org/2000/svg":"math"===o?"http://www.w3.org/1998/MathML/":null}(_)),E=this.componentDef.onPush?576:528,v=function(n,o){return{components:[],scheduler:n||df,clean:TD,playerHandler:o||null,flags:0}}(),C=Ia(0,null,null,1,0,null,null,null,null,null),S=Ur(null,C,v,E,null,null,h,g,d,u);let b,I;Zs(S);try{const A=function(n,o,i,s,l,u){const h=i[1];i[20]=n;const g=Ci(h,20,2,"#host",null),_=g.mergedAttrs=o.hostAttrs;null!==_&&(Ra(g,_,!0),null!==n&&(oa(l,n,_),null!==g.classes&&sc(l,n,g.classes),null!==g.styles&&Nf(l,n,g.styles)));const m=s.createRenderer(n,o),E=Ur(i,qf(o),null,o.onPush?64:16,i[20],g,s,m,u||null,null);return h.firstCreatePass&&(aa(yr(g,i),h,o.type),r_(h,g),s_(g,i.length,1)),ba(i,E),i[20]=E}(m,this.componentDef,S,h,g);if(m)if(s)oa(g,m,["ng-version",ME.full]);else{const{attrs:R,classes:x}=function(n){const o=[],i=[];let s=1,l=2;for(;s<n.length;){let u=n[s];if("string"==typeof u)2===l?""!==u&&o.push(u,n[++s]):8===l&&i.push(u);else{if(!nn(l))break;l=u}s++}return{attrs:o,classes:i}}(this.componentDef.selectors[0]);R&&oa(g,m,R),x&&x.length>0&&sc(g,m,x.join(" "))}if(I=_u(C,20),void 0!==i){const R=I.projection=[];for(let x=0;x<this.ngContentSelectors.length;x++){const V=i[x];R.push(null!=V?Array.from(V):null)}}b=function(n,o,i,s,l){const u=i[1],h=function(n,o,i){const s=He();n.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),a_(n,s,o,yi(n,o,1,null),i));const l=Sr(o,n,s.directiveStart,s);at(l,o);const u=Ht(s,o);return u&&at(u,o),l}(u,i,o);if(s.components.push(h),n[8]=h,l&&l.forEach(g=>g(h,o)),o.contentQueries){const g=He();o.contentQueries(1,h,g.directiveStart)}const d=He();return!u.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(so(d.index),o_(i[1],d,0,d.directiveStart,d.directiveEnd,o),i_(o,h)),h}(A,this.componentDef,S,v,[XD]),Br(C,S,null)}finally{Qs()}return new NO(this.componentType,b,Bi(I,S),S,I)}}class NO extends class{}{constructor(o,i,s,l,u){super(),this.location=s,this._rootLView=l,this._tNode=u,this.instance=i,this.hostView=this.changeDetectorRef=new DO(l),this.componentType=o}get injector(){return new ui(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}class On{}class LE{}const Gi=new Map;class xE extends On{constructor(o,i){super(),this._parent=i,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new NE(this);const s=Vt(o);this._bootstrapComponents=In(s.bootstrap),this._r3Injector=m_(o,i,[{provide:On,useValue:this},{provide:Ho,useValue:this.componentFactoryResolver}],oe(o)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(o)}get(o,i=fe.THROW_IF_NOT_FOUND,s=W.Default){return o===fe||o===On||o===Hr?this:this._r3Injector.get(o,i,s)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(i=>i()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class nh extends LE{constructor(o){super(),this.moduleType=o,null!==Vt(o)&&function(n){const o=new Set;!function i(s){const l=Vt(s,!0),u=l.id;null!==u&&(function(n,o,i){if(o&&o!==i)throw new Error(`Duplicate module registered for ${n} - ${oe(o)} vs ${oe(o.name)}`)}(u,Gi.get(u),s),Gi.set(u,s));const h=In(l.imports);for(const d of h)o.has(d)||(o.add(d),i(d))}(n)}(o)}create(o){return new xE(this.moduleType,o)}}function oh(n){return o=>{setTimeout(n,void 0,o)}}const Le=class extends xn{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,i,s){var g,_,m;let l=o,u=i||(()=>null),h=s;if(o&&"object"==typeof o){const E=o;l=null==(g=E.next)?void 0:g.bind(E),u=null==(_=E.error)?void 0:_.bind(E),h=null==(m=E.complete)?void 0:m.bind(E)}this.__isAsync&&(u=oh(u),l&&(l=oh(l)),h&&(h=oh(h)));const d=super.subscribe({next:l,error:u,complete:h});return o instanceof r&&o.add(d),d}};Symbol;const tM=function(){return n=He(),o=w(),4&n.type?new oM(o,n,Bi(n,o)):null;var n,o};let Jn=(()=>{class n{}return n.__NG_ELEMENT_ID__=tM,n})();const nM=Jn,oM=class extends nM{constructor(o,i,s){super(),this._declarationLView=o,this._declarationTContainer=i,this.elementRef=s}createEmbeddedView(o){const i=this._declarationTContainer.tViews,s=Ur(this._declarationLView,i,o,16,null,i.declTNode,null,null,null,null);s[17]=this._declarationLView[this._declarationTContainer.index];const u=this._declarationLView[19];return null!==u&&(s[19]=u.createEmbeddedView(i)),Br(i,s,o),new es(s)}};const sM=function(){return function(n,o){let i;const s=o[n.index];if(Qt(s))i=s;else{let l;if(8&n.type)l=Fe(s);else{const u=o[11];l=u.createComment("");const h=Ht(n,o);Vo(u,Ea(u,h),l,function(n,o){return Me(n)?n.nextSibling(o):o.nextSibling}(u,h),!1)}o[n.index]=i=l_(s,o,l,n),ba(o,i)}return new GE(i,n,o)}(He(),w())};let ln=(()=>{class n{}return n.__NG_ELEMENT_ID__=sM,n})();const lM=ln,GE=class extends lM{constructor(o,i,s){super(),this._lContainer=o,this._hostTNode=i,this._hostLView=s}get element(){return Bi(this._hostTNode,this._hostLView)}get injector(){return new ui(this._hostTNode,this._hostLView)}get parentInjector(){const o=sa(this._hostTNode,this._hostLView);if(Ig(o)){const i=li(o,this._hostLView),s=ai(o);return new ui(i[1].data[s+8],i)}return new ui(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const i=WE(this._lContainer);return null!==i&&i[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,i,s){const l=o.createEmbeddedView(i||{});return this.insert(l,s),l}createComponent(o,i,s,l,u){const h=o&&!("function"==typeof o);let d;if(h)d=i;else{const E=i||{};d=E.index,s=E.injector,l=E.projectableNodes,u=E.ngModuleRef}const g=h?o:new eh(it(o)),_=s||this.parentInjector;if(!u&&null==g.ngModule&&_){const E=_.get(On,null);E&&(u=E)}const m=g.create(_,l,void 0,u);return this.insert(m.hostView,d),m}insert(o,i){const s=o._lView,l=s[1];if(Qt(s[3])){const m=this.indexOf(o);if(-1!==m)this.detach(m);else{const E=s[3],v=new GE(E,E[6],E[3]);v.detach(v.indexOf(o))}}const u=this._adjustIndex(i),h=this._lContainer;!function(n,o,i,s){const l=10+s,u=i.length;s>0&&(i[l-1][4]=o),s<u-10?(o[4]=i[l],ua(i,10+s,o)):(i.push(o),o[4]=null),o[3]=i;const h=o[17];null!==h&&i!==h&&function(n,o){const i=n[9];o[16]!==o[3][3][16]&&(n[2]=!0),null===i?n[9]=[o]:i.push(o)}(h,o);const d=o[19];null!==d&&d.insertView(n),o[2]|=128}(l,s,h,u);const d=ic(u,h),g=s[11],_=Ea(g,h[7]);return null!==_&&function(n,o,i,s,l,u){s[0]=l,s[6]=o,Vr(n,s,i,1,l,u)}(l,h[6],g,s,_,d),o.attachToViewContainerRef(),ua(ih(h),u,o),o}move(o,i){return this.insert(o,i)}indexOf(o){const i=WE(this._lContainer);return null!==i?i.indexOf(o):-1}remove(o){const i=this._adjustIndex(o,-1),s=tc(this._lContainer,i);s&&(Lo(ih(this._lContainer),i),vf(s[1],s))}detach(o){const i=this._adjustIndex(o,-1),s=tc(this._lContainer,i);return s&&null!=Lo(ih(this._lContainer),i)?new es(s):null}_adjustIndex(o,i=0){return null==o?this.length+i:o}};function WE(n){return n[8]}function ih(n){return n[8]||(n[8]=[])}const is=new ae("Application Initializer");let ji=(()=>{class n{constructor(i){this.appInits=i,this.resolve=Ba,this.reject=Ba,this.initialized=!1,this.done=!1,this.donePromise=new Promise((s,l)=>{this.resolve=s,this.reject=l})}runInitializers(){if(this.initialized)return;const i=[],s=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let l=0;l<this.appInits.length;l++){const u=this.appInits[l]();if(Kr(u))i.push(u);else if(Na(u)){const h=new Promise((d,g)=>{u.subscribe({complete:d,error:g})});i.push(h)}}Promise.all(i).then(()=>{s()}).catch(l=>{this.reject(l)}),0===i.length&&s(),this.initialized=!0}}return n.\u0275fac=function(i){return new(i||n)(B(is,8))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();const rs=new ae("AppId"),XM={provide:rs,useFactory:function(){return`${Eh()}${Eh()}${Eh()}`},deps:[]};function Eh(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const pT=new ae("Platform Initializer"),Th=new ae("Platform ID"),gT=new ae("appBootstrapListener");let Ka=(()=>{class n{log(i){console.log(i)}warn(i){console.warn(i)}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();const _o=new ae("LocaleId"),fT=new ae("DefaultCurrencyCode");class KM{constructor(o,i){this.ngModuleFactory=o,this.componentFactories=i}}const vh=function(n){return new nh(n)},zM=vh,JM=function(n){return Promise.resolve(vh(n))},mT=function(n){const o=vh(n),s=In(Vt(n).declarations).reduce((l,u)=>{const h=it(u);return h&&l.push(new eh(h)),l},[]);return new KM(o,s)},$M=mT,qM=function(n){return Promise.resolve(mT(n))};let za=(()=>{class n{constructor(){this.compileModuleSync=zM,this.compileModuleAsync=JM,this.compileModuleAndAllComponentsSync=$M,this.compileModuleAndAllComponentsAsync=qM}clearCache(){}clearCacheFor(i){}getModuleId(i){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();const eN=(()=>Promise.resolve(0))();function Ch(n){"undefined"==typeof Zone?eN.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Ve{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:s=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Le(!1),this.onMicrotaskEmpty=new Le(!1),this.onStable=new Le(!1),this.onError=new Le(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const l=this;l._nesting=0,l._outer=l._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(l._inner=l._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(l._inner=l._inner.fork(Zone.longStackTraceZoneSpec)),l.shouldCoalesceEventChangeDetection=!s&&i,l.shouldCoalesceRunChangeDetection=s,l.lastRequestAnimationFrameId=-1,l.nativeRequestAnimationFrame=function(){let n=de.requestAnimationFrame,o=de.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&o){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const s=o[Zone.__symbol__("OriginalDelegate")];s&&(o=s)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function(n){const o=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(de,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Sh(n),n.isCheckStableRunning=!0,yh(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Sh(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(i,s,l,u,h,d)=>{try{return ET(n),i.invokeTask(l,u,h,d)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===u.type||n.shouldCoalesceRunChangeDetection)&&o(),TT(n)}},onInvoke:(i,s,l,u,h,d,g)=>{try{return ET(n),i.invoke(l,u,h,d,g)}finally{n.shouldCoalesceRunChangeDetection&&o(),TT(n)}},onHasTask:(i,s,l,u)=>{i.hasTask(l,u),s===l&&("microTask"==u.change?(n._hasPendingMicrotasks=u.microTask,Sh(n),yh(n)):"macroTask"==u.change&&(n.hasPendingMacrotasks=u.macroTask))},onHandleError:(i,s,l,u)=>(i.handleError(l,u),n.runOutsideAngular(()=>n.onError.emit(u)),!1)})}(l)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ve.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Ve.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(o,i,s){return this._inner.run(o,i,s)}runTask(o,i,s,l){const u=this._inner,h=u.scheduleEventTask("NgZoneEvent: "+l,o,nN,Ba,Ba);try{return u.runTask(h,i,s)}finally{u.cancelTask(h)}}runGuarded(o,i,s){return this._inner.runGuarded(o,i,s)}runOutsideAngular(o){return this._outer.run(o)}}const nN={};function yh(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Sh(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function ET(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function TT(n){n._nesting--,yh(n)}class rN{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Le,this.onMicrotaskEmpty=new Le,this.onStable=new Le,this.onError=new Le}run(o,i,s){return o.apply(i,s)}runGuarded(o,i,s){return o.apply(i,s)}runOutsideAngular(o){return o()}runTask(o,i,s,l){return o.apply(i,s)}}let Ih=(()=>{class n{constructor(i){this._ngZone=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),i.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ve.assertNotInAngularZone(),Ch(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Ch(()=>{for(;0!==this._callbacks.length;){let i=this._callbacks.pop();clearTimeout(i.timeoutId),i.doneCb(this._didWork)}this._didWork=!1});else{let i=this.getPendingTasks();this._callbacks=this._callbacks.filter(s=>!s.updateCb||!s.updateCb(i)||(clearTimeout(s.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(i=>({source:i.source,creationLocation:i.creationLocation,data:i.data})):[]}addCallback(i,s,l){let u=-1;s&&s>0&&(u=setTimeout(()=>{this._callbacks=this._callbacks.filter(h=>h.timeoutId!==u),i(this._didWork,this.getPendingTasks())},s)),this._callbacks.push({doneCb:i,timeoutId:u,updateCb:l})}whenStable(i,s,l){if(l&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(i,s,l),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(i,s,l){return[]}}return n.\u0275fac=function(i){return new(i||n)(B(Ve))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})(),vT=(()=>{class n{constructor(){this._applications=new Map,bh.addToWindow(this)}registerApplication(i,s){this._applications.set(i,s)}unregisterApplication(i){this._applications.delete(i)}unregisterAllApplications(){this._applications.clear()}getTestability(i){return this._applications.get(i)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(i,s=!0){return bh.findTestabilityInTree(this,i,s)}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();class sN{addToWindow(o){}findTestabilityInTree(o,i,s){return null}}let bh=new sN,CT=!0,yT=!1;let un;const IT=new ae("AllowMultipleToken");class Rh{constructor(o,i){this.name=o,this.token=i}}function bT(n,o,i=[]){const s=`Platform: ${o}`,l=new ae(s);return(u=[])=>{let h=RT();if(!h||h.injector.get(IT,!1))if(n)n(i.concat(u).concat({provide:l,useValue:!0}));else{const d=i.concat(u).concat({provide:l,useValue:!0},{provide:Gr,useValue:"platform"});!function(n){if(un&&!un.destroyed&&!un.injector.get(IT,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");un=n.get(DT);const o=n.get(pT,null);o&&o.forEach(i=>i())}(fe.create({providers:d,name:s}))}return function(n){const o=RT();if(!o)throw new Error("No platform exists!");if(!o.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return o}(l)}}function RT(){return un&&!un.destroyed?un:null}let DT=(()=>{class n{constructor(i){this._injector=i,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(i,s){const d=function(n,o){let i;return i="noop"===n?new rN:("zone.js"===n?void 0:n)||new Ve({enableLongStackTrace:(yT=!0,CT),shouldCoalesceEventChangeDetection:!!(null==o?void 0:o.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==o?void 0:o.ngZoneRunCoalescing)}),i}(s?s.ngZone:void 0,{ngZoneEventCoalescing:s&&s.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:s&&s.ngZoneRunCoalescing||!1}),g=[{provide:Ve,useValue:d}];return d.run(()=>{const _=fe.create({providers:g,parent:this.injector,name:i.moduleType.name}),m=i.create(_),E=m.injector.get(Fo,null);if(!E)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return d.runOutsideAngular(()=>{const v=d.onError.subscribe({next:C=>{E.handleError(C)}});m.onDestroy(()=>{Dh(this._modules,m),v.unsubscribe()})}),function(n,o,i){try{const s=i();return Kr(s)?s.catch(l=>{throw o.runOutsideAngular(()=>n.handleError(l)),l}):s}catch(s){throw o.runOutsideAngular(()=>n.handleError(s)),s}}(E,d,()=>{const v=m.injector.get(ji);return v.runInitializers(),v.donePromise.then(()=>(function(n){Rt(n,"Expected localeId to be defined"),"string"==typeof n&&(nE=n.toLowerCase().replace(/_/g,"-"))}(m.injector.get(_o,Pa)||Pa),this._moduleDoBootstrap(m),m))})})}bootstrapModule(i,s=[]){const l=AT({},s);return function(n,o,i){const s=new nh(i);return Promise.resolve(s)}(0,0,i).then(u=>this.bootstrapModuleFactory(u,l))}_moduleDoBootstrap(i){const s=i.injector.get(Xi);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(l=>s.bootstrap(l));else{if(!i.instance.ngDoBootstrap)throw new Error(`The module ${oe(i.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);i.instance.ngDoBootstrap(s)}this._modules.push(i)}onDestroy(i){this._destroyListeners.push(i)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(i){return new(i||n)(B(fe))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();function AT(n,o){return Array.isArray(o)?o.reduce(AT,n):H(H({},n),o)}let Xi=(()=>{class n{constructor(i,s,l,u,h){this._zone=i,this._injector=s,this._exceptionHandler=l,this._componentFactoryResolver=u,this._initStatus=h,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const d=new Ae(_=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{_.next(this._stable),_.complete()})}),g=new Ae(_=>{let m;this._zone.runOutsideAngular(()=>{m=this._zone.onStable.subscribe(()=>{Ve.assertNotInAngularZone(),Ch(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,_.next(!0))})})});const E=this._zone.onUnstable.subscribe(()=>{Ve.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{_.next(!1)}))});return()=>{m.unsubscribe(),E.unsubscribe()}});this.isStable=function(...n){const o=pr(n),i=function(n,o){return"number"==typeof eu(n)?n.pop():1/0}(n),s=n;return s.length?1===s.length?mn(s[0]):dr(i)(ze(s,o)):Vn}(d,g.pipe(function(n={}){const{connector:o=(()=>new xn),resetOnError:i=!0,resetOnComplete:s=!0,resetOnRefCountZero:l=!0}=n;return u=>{let h=null,d=null,g=null,_=0,m=!1,E=!1;const v=()=>{null==d||d.unsubscribe(),d=null},C=()=>{v(),h=g=null,m=E=!1},S=()=>{const b=h;C(),null==b||b.unsubscribe()};return et((b,I)=>{_++,!E&&!m&&v();const A=g=null!=g?g:o();I.add(()=>{_--,0===_&&!E&&!m&&(d=tu(S,l))}),A.subscribe(I),h||(h=new hr({next:R=>A.next(R),error:R=>{E=!0,v(),d=tu(C,i,R),A.error(R)},complete:()=>{m=!0,v(),d=tu(C,s),A.complete()}}),ze(b).subscribe(h))})(u)}}()))}bootstrap(i,s){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let l;l=i instanceof DE?i:this._componentFactoryResolver.resolveComponentFactory(i),this.componentTypes.push(l.componentType);const u=function(n){return n.isBoundToModule}(l)?void 0:this._injector.get(On),d=l.create(fe.NULL,[],s||l.selector,u),g=d.location.nativeElement,_=d.injector.get(Ih,null),m=_&&d.injector.get(vT);return _&&m&&m.registerApplication(g,_),d.onDestroy(()=>{this.detachView(d.hostView),Dh(this.components,d),m&&m.unregisterApplication(g)}),this._loadComponent(d),d}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(i))}finally{this._runningTick=!1}}attachView(i){const s=i;this._views.push(s),s.attachToAppRef(this)}detachView(i){const s=i;Dh(this._views,s),s.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i),this._injector.get(gT,[]).concat(this._bootstrapListeners).forEach(l=>l(i))}ngOnDestroy(){this._views.slice().forEach(i=>i.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(i){return new(i||n)(B(Ve),B(fe),B(Fo),B(Ho),B(ji))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();function Dh(n,o){const i=n.indexOf(o);i>-1&&n.splice(i,1)}const CN=function(n){return function(n,o,i){if(Ks(n)&&!i){const s=wt(n.index,o);return new es(s,s)}return 47&n.type?new es(o[16],o):null}(He(),w(),16==(16&n))};let wh=(()=>{class n{}return n.__NG_ELEMENT_ID__=CN,n})();class PT{constructor(){}supports(o){return Xr(o)}create(o){return new LN(o)}}const kN=(n,o)=>o;class LN{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||kN}forEachItem(o){let i;for(i=this._itHead;null!==i;i=i._next)o(i)}forEachOperation(o){let i=this._itHead,s=this._removalsHead,l=0,u=null;for(;i||s;){const h=!s||i&&i.currentIndex<FT(s,l,u)?i:s,d=FT(h,l,u),g=h.currentIndex;if(h===s)l--,s=s._nextRemoved;else if(i=i._next,null==h.previousIndex)l++;else{u||(u=[]);const _=d-l,m=g-l;if(_!=m){for(let v=0;v<_;v++){const C=v<u.length?u[v]:u[v]=0,S=C+v;m<=S&&S<_&&(u[v]=C+1)}u[h.previousIndex]=m-_}}d!==g&&o(h,d,g)}}forEachPreviousItem(o){let i;for(i=this._previousItHead;null!==i;i=i._nextPrevious)o(i)}forEachAddedItem(o){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)o(i)}forEachMovedItem(o){let i;for(i=this._movesHead;null!==i;i=i._nextMoved)o(i)}forEachRemovedItem(o){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)o(i)}forEachIdentityChange(o){let i;for(i=this._identityChangesHead;null!==i;i=i._nextIdentityChange)o(i)}diff(o){if(null==o&&(o=[]),!Xr(o))throw new Error(`Error trying to diff '${oe(o)}'. Only arrays and iterables are allowed`);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let l,u,h,i=this._itHead,s=!1;if(Array.isArray(o)){this.length=o.length;for(let d=0;d<this.length;d++)u=o[d],h=this._trackByFn(d,u),null!==i&&Object.is(i.trackById,h)?(s&&(i=this._verifyReinsertion(i,u,h,d)),Object.is(i.item,u)||this._addIdentityChange(i,u)):(i=this._mismatch(i,u,h,d),s=!0),i=i._next}else l=0,function(n,o){if(Array.isArray(n))for(let i=0;i<n.length;i++)o(n[i]);else{const i=n[Ri()]();let s;for(;!(s=i.next()).done;)o(s.value)}}(o,d=>{h=this._trackByFn(l,d),null!==i&&Object.is(i.trackById,h)?(s&&(i=this._verifyReinsertion(i,d,h,l)),Object.is(i.item,d)||this._addIdentityChange(i,d)):(i=this._mismatch(i,d,h,l),s=!0),i=i._next,l++}),this.length=l;return this._truncate(i),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,i,s,l){let u;return null===o?u=this._itTail:(u=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(s,null))?(Object.is(o.item,i)||this._addIdentityChange(o,i),this._reinsertAfter(o,u,l)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(s,l))?(Object.is(o.item,i)||this._addIdentityChange(o,i),this._moveAfter(o,u,l)):o=this._addAfter(new PN(i,s),u,l),o}_verifyReinsertion(o,i,s,l){let u=null===this._unlinkedRecords?null:this._unlinkedRecords.get(s,null);return null!==u?o=this._reinsertAfter(u,o._prev,l):o.currentIndex!=l&&(o.currentIndex=l,this._addToMoves(o,l)),o}_truncate(o){for(;null!==o;){const i=o._next;this._addToRemovals(this._unlink(o)),o=i}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,i,s){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const l=o._prevRemoved,u=o._nextRemoved;return null===l?this._removalsHead=u:l._nextRemoved=u,null===u?this._removalsTail=l:u._prevRemoved=l,this._insertAfter(o,i,s),this._addToMoves(o,s),o}_moveAfter(o,i,s){return this._unlink(o),this._insertAfter(o,i,s),this._addToMoves(o,s),o}_addAfter(o,i,s){return this._insertAfter(o,i,s),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,i,s){const l=null===i?this._itHead:i._next;return o._next=l,o._prev=i,null===l?this._itTail=o:l._prev=o,null===i?this._itHead=o:i._next=o,null===this._linkedRecords&&(this._linkedRecords=new xT),this._linkedRecords.put(o),o.currentIndex=s,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const i=o._prev,s=o._next;return null===i?this._itHead=s:i._next=s,null===s?this._itTail=i:s._prev=i,o}_addToMoves(o,i){return o.previousIndex===i||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new xT),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,i){return o.item=i,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class PN{constructor(o,i){this.item=o,this.trackById=i,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class xN{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,i){let s;for(s=this._head;null!==s;s=s._nextDup)if((null===i||i<=s.currentIndex)&&Object.is(s.trackById,o))return s;return null}remove(o){const i=o._prevDup,s=o._nextDup;return null===i?this._head=s:i._nextDup=s,null===s?this._tail=i:s._prevDup=i,null===this._head}}class xT{constructor(){this.map=new Map}put(o){const i=o.trackById;let s=this.map.get(i);s||(s=new xN,this.map.set(i,s)),s.add(o)}get(o,i){const l=this.map.get(o);return l?l.get(o,i):null}remove(o){const i=o.trackById;return this.map.get(i).remove(o)&&this.map.delete(i),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function FT(n,o,i){const s=n.previousIndex;if(null===s)return s;let l=0;return i&&s<i.length&&(l=i[s]),s+o+l}class VT{constructor(){}supports(o){return o instanceof Map||Pc(o)}create(){return new FN}}class FN{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let i;for(i=this._mapHead;null!==i;i=i._next)o(i)}forEachPreviousItem(o){let i;for(i=this._previousMapHead;null!==i;i=i._nextPrevious)o(i)}forEachChangedItem(o){let i;for(i=this._changesHead;null!==i;i=i._nextChanged)o(i)}forEachAddedItem(o){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)o(i)}forEachRemovedItem(o){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)o(i)}diff(o){if(o){if(!(o instanceof Map||Pc(o)))throw new Error(`Error trying to diff '${oe(o)}'. Only maps and objects are allowed`)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let i=this._mapHead;if(this._appendAfter=null,this._forEach(o,(s,l)=>{if(i&&i.key===l)this._maybeAddToChanges(i,s),this._appendAfter=i,i=i._next;else{const u=this._getOrCreateRecordForKey(l,s);i=this._insertBeforeOrAppend(i,u)}}),i){i._prev&&(i._prev._next=null),this._removalsHead=i;for(let s=i;null!==s;s=s._nextRemoved)s===this._mapHead&&(this._mapHead=null),this._records.delete(s.key),s._nextRemoved=s._next,s.previousValue=s.currentValue,s.currentValue=null,s._prev=null,s._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,i){if(o){const s=o._prev;return i._next=o,i._prev=s,o._prev=i,s&&(s._next=i),o===this._mapHead&&(this._mapHead=i),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=i,i._prev=this._appendAfter):this._mapHead=i,this._appendAfter=i,null}_getOrCreateRecordForKey(o,i){if(this._records.has(o)){const l=this._records.get(o);this._maybeAddToChanges(l,i);const u=l._prev,h=l._next;return u&&(u._next=h),h&&(h._prev=u),l._next=null,l._prev=null,l}const s=new VN(o);return this._records.set(o,s),s.currentValue=i,this._addToAdditions(s),s}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,i){Object.is(i,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=i,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,i){o instanceof Map?o.forEach(i):Object.keys(o).forEach(s=>i(o[s],s))}}class VN{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function UT(){return new ss([new PT])}let ss=(()=>{class n{constructor(i){this.factories=i}static create(i,s){if(null!=s){const l=s.factories.slice();i=i.concat(l)}return new n(i)}static extend(i){return{provide:n,useFactory:s=>n.create(i,s||UT()),deps:[[n,new uo,new St]]}}find(i){const s=this.factories.find(l=>l.supports(i));if(null!=s)return s;throw new Error(`Cannot find a differ supporting object '${i}' of type '${function(n){return n.name||typeof n}(i)}'`)}}return n.\u0275prov=re({token:n,providedIn:"root",factory:UT}),n})();function BT(){return new Yi([new VT])}let Yi=(()=>{class n{constructor(i){this.factories=i}static create(i,s){if(s){const l=s.factories.slice();i=i.concat(l)}return new n(i)}static extend(i){return{provide:n,useFactory:s=>n.create(i,s||BT()),deps:[[n,new uo,new St]]}}find(i){const s=this.factories.find(l=>l.supports(i));if(s)return s;throw new Error(`Cannot find a differ supporting object '${i}'`)}}return n.\u0275prov=re({token:n,providedIn:"root",factory:BT}),n})();const BN=[new VT],GN=new ss([new PT]),WN=new Yi(BN),jN=bT(null,"core",[{provide:Th,useValue:"unknown"},{provide:DT,deps:[fe]},{provide:vT,deps:[]},{provide:Ka,deps:[]}]),JN=[{provide:Xi,useClass:Xi,deps:[Ve,fe,Fo,Ho,ji]},{provide:wO,deps:[Ve],useFactory:function(n){let o=[];return n.onStable.subscribe(()=>{for(;o.length;)o.pop()()}),function(i){o.push(i)}}},{provide:ji,useClass:ji,deps:[[new St,is]]},{provide:za,useClass:za,deps:[]},XM,{provide:ss,useFactory:function(){return GN},deps:[]},{provide:Yi,useFactory:function(){return WN},deps:[]},{provide:_o,useFactory:function(n){return n||"undefined"!=typeof $localize&&$localize.locale||Pa},deps:[[new _i(_o),new St,new uo]]},{provide:fT,useValue:"USD"}];let qN=(()=>{class n{constructor(i){}}return n.\u0275fac=function(i){return new(i||n)(B(Xi))},n.\u0275mod=En({type:n}),n.\u0275inj=xt({providers:JN}),n})(),ll=null;function Mn(){return ll}const nt=new ae("DocumentToken");let Yo=(()=>{class n{historyGo(i){throw new Error("Not implemented")}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=re({token:n,factory:function(){return B(Iv)},providedIn:"platform"}),n})();const XL=new ae("Location Initialized");let Iv=(()=>{class n extends Yo{constructor(i){super(),this._doc=i,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Mn().getBaseHref(this._doc)}onPopState(i){const s=Mn().getGlobalEventTarget(this._doc,"window");return s.addEventListener("popstate",i,!1),()=>s.removeEventListener("popstate",i)}onHashChange(i){const s=Mn().getGlobalEventTarget(this._doc,"window");return s.addEventListener("hashchange",i,!1),()=>s.removeEventListener("hashchange",i)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(i){this.location.pathname=i}pushState(i,s,l){bv()?this._history.pushState(i,s,l):this.location.hash=l}replaceState(i,s,l){bv()?this._history.replaceState(i,s,l):this.location.hash=l}forward(){this._history.forward()}back(){this._history.back()}historyGo(i=0){this._history.go(i)}getState(){return this._history.state}}return n.\u0275fac=function(i){return new(i||n)(B(nt))},n.\u0275prov=re({token:n,factory:function(){return new Iv(B(nt))},providedIn:"platform"}),n})();function bv(){return!!window.history.pushState}function nd(n,o){if(0==n.length)return o;if(0==o.length)return n;let i=0;return n.endsWith("/")&&i++,o.startsWith("/")&&i++,2==i?n+o.substring(1):1==i?n+o:n+"/"+o}function Rv(n){const o=n.match(/#|\?|$/),i=o&&o.index||n.length;return n.slice(0,i-("/"===n[i-1]?1:0))+n.slice(i)}function qn(n){return n&&"?"!==n[0]?"?"+n:n}let Zi=(()=>{class n{historyGo(i){throw new Error("Not implemented")}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=re({token:n,factory:function(){return function(n){const o=B(nt).location;return new Dv(B(Yo),o&&o.origin||"")}()},providedIn:"root"}),n})();const od=new ae("appBaseHref");let Dv=(()=>{class n extends Zi{constructor(i,s){if(super(),this._platformLocation=i,this._removeListenerFns=[],null==s&&(s=this._platformLocation.getBaseHrefFromDOM()),null==s)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=s}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}prepareExternalUrl(i){return nd(this._baseHref,i)}path(i=!1){const s=this._platformLocation.pathname+qn(this._platformLocation.search),l=this._platformLocation.hash;return l&&i?`${s}${l}`:s}pushState(i,s,l,u){const h=this.prepareExternalUrl(l+qn(u));this._platformLocation.pushState(i,s,h)}replaceState(i,s,l,u){const h=this.prepareExternalUrl(l+qn(u));this._platformLocation.replaceState(i,s,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(i=0){var s,l;null==(l=(s=this._platformLocation).historyGo)||l.call(s,i)}}return n.\u0275fac=function(i){return new(i||n)(B(Yo),B(od,8))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})(),zL=(()=>{class n extends Zi{constructor(i,s){super(),this._platformLocation=i,this._baseHref="",this._removeListenerFns=[],null!=s&&(this._baseHref=s)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}path(i=!1){let s=this._platformLocation.hash;return null==s&&(s="#"),s.length>0?s.substring(1):s}prepareExternalUrl(i){const s=nd(this._baseHref,i);return s.length>0?"#"+s:s}pushState(i,s,l,u){let h=this.prepareExternalUrl(l+qn(u));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.pushState(i,s,h)}replaceState(i,s,l,u){let h=this.prepareExternalUrl(l+qn(u));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.replaceState(i,s,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(i=0){var s,l;null==(l=(s=this._platformLocation).historyGo)||l.call(s,i)}}return n.\u0275fac=function(i){return new(i||n)(B(Yo),B(od,8))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})(),id=(()=>{class n{constructor(i,s){this._subject=new Le,this._urlChangeListeners=[],this._platformStrategy=i;const l=this._platformStrategy.getBaseHref();this._platformLocation=s,this._baseHref=Rv(Av(l)),this._platformStrategy.onPopState(u=>{this._subject.emit({url:this.path(!0),pop:!0,state:u.state,type:u.type})})}path(i=!1){return this.normalize(this._platformStrategy.path(i))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(i,s=""){return this.path()==this.normalize(i+qn(s))}normalize(i){return n.stripTrailingSlash(function(n,o){return n&&o.startsWith(n)?o.substring(n.length):o}(this._baseHref,Av(i)))}prepareExternalUrl(i){return i&&"/"!==i[0]&&(i="/"+i),this._platformStrategy.prepareExternalUrl(i)}go(i,s="",l=null){this._platformStrategy.pushState(l,"",i,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+qn(s)),l)}replaceState(i,s="",l=null){this._platformStrategy.replaceState(l,"",i,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+qn(s)),l)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(i=0){var s,l;null==(l=(s=this._platformStrategy).historyGo)||l.call(s,i)}onUrlChange(i){this._urlChangeListeners.push(i),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(s=>{this._notifyUrlChangeListeners(s.url,s.state)}))}_notifyUrlChangeListeners(i="",s){this._urlChangeListeners.forEach(l=>l(i,s))}subscribe(i,s,l){return this._subject.subscribe({next:i,error:s,complete:l})}}return n.normalizeQueryParams=qn,n.joinWithSlash=nd,n.stripTrailingSlash=Rv,n.\u0275fac=function(i){return new(i||n)(B(Zi),B(Yo))},n.\u0275prov=re({token:n,factory:function(){return new id(B(Zi),B(Yo))},providedIn:"root"}),n})();function Av(n){return n.replace(/\/index.html$/,"")}var Ue=(()=>((Ue=Ue||{})[Ue.Zero=0]="Zero",Ue[Ue.One=1]="One",Ue[Ue.Two=2]="Two",Ue[Ue.Few=3]="Few",Ue[Ue.Many=4]="Many",Ue[Ue.Other=5]="Other",Ue))();const o0=function(n){return function(n){const o=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let i=tE(o);if(i)return i;const s=o.split("-")[0];if(i=tE(s),i)return i;if("en"===s)return Ew;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[P.PluralCase]};class El{}let k0=(()=>{class n extends El{constructor(i){super(),this.locale=i}getPluralCategory(i,s){switch(o0(s||this.locale)(i)){case Ue.Zero:return"zero";case Ue.One:return"one";case Ue.Two:return"two";case Ue.Few:return"few";case Ue.Many:return"many";default:return"other"}}}return n.\u0275fac=function(i){return new(i||n)(B(_o))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})(),Vv=(()=>{class n{constructor(i,s){this._viewContainer=i,this._context=new B0,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=s}set ngIf(i){this._context.$implicit=this._context.ngIf=i,this._updateView()}set ngIfThen(i){Uv("ngIfThen",i),this._thenTemplateRef=i,this._thenViewRef=null,this._updateView()}set ngIfElse(i){Uv("ngIfElse",i),this._elseTemplateRef=i,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(i,s){return!0}}return n.\u0275fac=function(i){return new(i||n)(O(ln),O(Jn))},n.\u0275dir=Y({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class B0{constructor(){this.$implicit=null,this.ngIf=null}}function Uv(n,o){if(o&&!o.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${oe(o)}'.`)}let pP=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=En({type:n}),n.\u0275inj=xt({providers:[{provide:El,useClass:k0}]}),n})();let mP=(()=>{class n{}return n.\u0275prov=re({token:n,providedIn:"root",factory:()=>new EP(B(nt),window)}),n})();class EP{constructor(o,i){this.document=o,this.window=i,this.offset=()=>[0,0]}setOffset(o){this.offset=Array.isArray(o)?()=>o:o}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(o){this.supportsScrolling()&&this.window.scrollTo(o[0],o[1])}scrollToAnchor(o){if(!this.supportsScrolling())return;const i=function(n,o){const i=n.getElementById(o)||n.getElementsByName(o)[0];if(i)return i;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const s=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let l=s.currentNode;for(;l;){const u=l.shadowRoot;if(u){const h=u.getElementById(o)||u.querySelector(`[name="${o}"]`);if(h)return h}l=s.nextNode()}}return null}(this.document,o);i&&(this.scrollToElement(i),this.attemptFocus(i))}setHistoryScrollRestoration(o){if(this.supportScrollRestoration()){const i=this.window.history;i&&i.scrollRestoration&&(i.scrollRestoration=o)}}scrollToElement(o){const i=o.getBoundingClientRect(),s=i.left+this.window.pageXOffset,l=i.top+this.window.pageYOffset,u=this.offset();this.window.scrollTo(s-u[0],l-u[1])}attemptFocus(o){return o.focus(),this.document.activeElement===o}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const o=Wv(this.window.history)||Wv(Object.getPrototypeOf(this.window.history));return!(!o||!o.writable&&!o.set)}catch(o){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(o){return!1}}}function Wv(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class md extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var n;n=new md,ll||(ll=n)}onAndCancel(o,i,s){return o.addEventListener(i,s,!1),()=>{o.removeEventListener(i,s,!1)}}dispatchEvent(o,i){o.dispatchEvent(i)}remove(o){o.parentNode&&o.parentNode.removeChild(o)}createElement(o,i){return(i=i||this.getDefaultDocument()).createElement(o)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(o){return o.nodeType===Node.ELEMENT_NODE}isShadowRoot(o){return o instanceof DocumentFragment}getGlobalEventTarget(o,i){return"window"===i?window:"document"===i?o:"body"===i?o.body:null}getBaseHref(o){const i=(vs=vs||document.querySelector("base"),vs?vs.getAttribute("href"):null);return null==i?null:function(n){Tl=Tl||document.createElement("a"),Tl.setAttribute("href",n);const o=Tl.pathname;return"/"===o.charAt(0)?o:`/${o}`}(i)}resetBaseElement(){vs=null}getUserAgent(){return window.navigator.userAgent}getCookie(o){return function(n,o){o=encodeURIComponent(o);for(const i of n.split(";")){const s=i.indexOf("="),[l,u]=-1==s?[i,""]:[i.slice(0,s),i.slice(s+1)];if(l.trim()===o)return decodeURIComponent(u)}return null}(document.cookie,o)}}let Tl,vs=null;const jv=new ae("TRANSITION_ID"),bP=[{provide:is,useFactory:function(n,o,i){return()=>{i.get(ji).donePromise.then(()=>{const s=Mn(),l=o.querySelectorAll(`style[ng-transition="${n}"]`);for(let u=0;u<l.length;u++)s.remove(l[u])})}},deps:[jv,nt,fe],multi:!0}];class Ed{static init(){var n;n=new Ed,bh=n}addToWindow(o){de.getAngularTestability=(s,l=!0)=>{const u=o.findTestabilityInTree(s,l);if(null==u)throw new Error("Could not find testability for element.");return u},de.getAllAngularTestabilities=()=>o.getAllTestabilities(),de.getAllAngularRootElements=()=>o.getAllRootElements(),de.frameworkStabilizers||(de.frameworkStabilizers=[]),de.frameworkStabilizers.push(s=>{const l=de.getAllAngularTestabilities();let u=l.length,h=!1;const d=function(g){h=h||g,u--,0==u&&s(h)};l.forEach(function(g){g.whenStable(d)})})}findTestabilityInTree(o,i,s){if(null==i)return null;const l=o.getTestability(i);return null!=l?l:s?Mn().isShadowRoot(i)?this.findTestabilityInTree(o,i.host,!0):this.findTestabilityInTree(o,i.parentElement,!0):null}}let RP=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();const Cs=new ae("EventManagerPlugins");let Cl=(()=>{class n{constructor(i,s){this._zone=s,this._eventNameToPlugin=new Map,i.forEach(l=>l.manager=this),this._plugins=i.slice().reverse()}addEventListener(i,s,l){return this._findPluginFor(s).addEventListener(i,s,l)}addGlobalEventListener(i,s,l){return this._findPluginFor(s).addGlobalEventListener(i,s,l)}getZone(){return this._zone}_findPluginFor(i){const s=this._eventNameToPlugin.get(i);if(s)return s;const l=this._plugins;for(let u=0;u<l.length;u++){const h=l[u];if(h.supports(i))return this._eventNameToPlugin.set(i,h),h}throw new Error(`No event manager plugin found for event ${i}`)}}return n.\u0275fac=function(i){return new(i||n)(B(Cs),B(Ve))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();class Td{constructor(o){this._doc=o}addGlobalEventListener(o,i,s){const l=Mn().getGlobalEventTarget(this._doc,o);if(!l)throw new Error(`Unsupported event target ${l} for event ${i}`);return this.addEventListener(l,i,s)}}let Yv=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(i){const s=new Set;i.forEach(l=>{this._stylesSet.has(l)||(this._stylesSet.add(l),s.add(l))}),this.onStylesAdded(s)}onStylesAdded(i){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})(),ys=(()=>{class n extends Yv{constructor(i){super(),this._doc=i,this._hostNodes=new Map,this._hostNodes.set(i.head,[])}_addStylesToHost(i,s,l){i.forEach(u=>{const h=this._doc.createElement("style");h.textContent=u,l.push(s.appendChild(h))})}addHost(i){const s=[];this._addStylesToHost(this._stylesSet,i,s),this._hostNodes.set(i,s)}removeHost(i){const s=this._hostNodes.get(i);s&&s.forEach(Kv),this._hostNodes.delete(i)}onStylesAdded(i){this._hostNodes.forEach((s,l)=>{this._addStylesToHost(i,l,s)})}ngOnDestroy(){this._hostNodes.forEach(i=>i.forEach(Kv))}}return n.\u0275fac=function(i){return new(i||n)(B(nt))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();function Kv(n){Mn().remove(n)}const vd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Cd=/%COMP%/g;function yl(n,o,i){for(let s=0;s<o.length;s++){let l=o[s];Array.isArray(l)?yl(n,l,i):(l=l.replace(Cd,n),i.push(l))}return i}function $v(n){return o=>{if("__ngUnwrap__"===o)return n;!1===n(o)&&(o.preventDefault(),o.returnValue=!1)}}let yd=(()=>{class n{constructor(i,s,l){this.eventManager=i,this.sharedStylesHost=s,this.appId=l,this.rendererByCompId=new Map,this.defaultRenderer=new Sd(i)}createRenderer(i,s){if(!i||!s)return this.defaultRenderer;switch(s.encapsulation){case Dt.Emulated:{let l=this.rendererByCompId.get(s.id);return l||(l=new HP(this.eventManager,this.sharedStylesHost,s,this.appId),this.rendererByCompId.set(s.id,l)),l.applyToHost(i),l}case 1:case Dt.ShadowDom:return new GP(this.eventManager,this.sharedStylesHost,i,s);default:if(!this.rendererByCompId.has(s.id)){const l=yl(s.id,s.styles,[]);this.sharedStylesHost.addStyles(l),this.rendererByCompId.set(s.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(i){return new(i||n)(B(Cl),B(ys),B(rs))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();class Sd{constructor(o){this.eventManager=o,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(o,i){return i?document.createElementNS(vd[i]||i,o):document.createElement(o)}createComment(o){return document.createComment(o)}createText(o){return document.createTextNode(o)}appendChild(o,i){o.appendChild(i)}insertBefore(o,i,s){o&&o.insertBefore(i,s)}removeChild(o,i){o&&o.removeChild(i)}selectRootElement(o,i){let s="string"==typeof o?document.querySelector(o):o;if(!s)throw new Error(`The selector "${o}" did not match any elements`);return i||(s.textContent=""),s}parentNode(o){return o.parentNode}nextSibling(o){return o.nextSibling}setAttribute(o,i,s,l){if(l){i=l+":"+i;const u=vd[l];u?o.setAttributeNS(u,i,s):o.setAttribute(i,s)}else o.setAttribute(i,s)}removeAttribute(o,i,s){if(s){const l=vd[s];l?o.removeAttributeNS(l,i):o.removeAttribute(`${s}:${i}`)}else o.removeAttribute(i)}addClass(o,i){o.classList.add(i)}removeClass(o,i){o.classList.remove(i)}setStyle(o,i,s,l){l&(Nt.DashCase|Nt.Important)?o.style.setProperty(i,s,l&Nt.Important?"important":""):o.style[i]=s}removeStyle(o,i,s){s&Nt.DashCase?o.style.removeProperty(i):o.style[i]=""}setProperty(o,i,s){o[i]=s}setValue(o,i){o.nodeValue=i}listen(o,i,s){return"string"==typeof o?this.eventManager.addGlobalEventListener(o,i,$v(s)):this.eventManager.addEventListener(o,i,$v(s))}}class HP extends Sd{constructor(o,i,s,l){super(o),this.component=s;const u=yl(l+"-"+s.id,s.styles,[]);i.addStyles(u),this.contentAttr="_ngcontent-%COMP%".replace(Cd,l+"-"+s.id),this.hostAttr="_nghost-%COMP%".replace(Cd,l+"-"+s.id)}applyToHost(o){super.setAttribute(o,this.hostAttr,"")}createElement(o,i){const s=super.createElement(o,i);return super.setAttribute(s,this.contentAttr,""),s}}class GP extends Sd{constructor(o,i,s,l){super(o),this.sharedStylesHost=i,this.hostEl=s,this.shadowRoot=s.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=yl(l.id,l.styles,[]);for(let h=0;h<u.length;h++){const d=document.createElement("style");d.textContent=u[h],this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(o){return o===this.hostEl?this.shadowRoot:o}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(o,i){return super.appendChild(this.nodeOrShadowRoot(o),i)}insertBefore(o,i,s){return super.insertBefore(this.nodeOrShadowRoot(o),i,s)}removeChild(o,i){return super.removeChild(this.nodeOrShadowRoot(o),i)}parentNode(o){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(o)))}}let WP=(()=>{class n extends Td{constructor(i){super(i)}supports(i){return!0}addEventListener(i,s,l){return i.addEventListener(s,l,!1),()=>this.removeEventListener(i,s,l)}removeEventListener(i,s,l){return i.removeEventListener(s,l)}}return n.\u0275fac=function(i){return new(i||n)(B(nt))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();const Qv=["alt","control","meta","shift"],$P={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},eC={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},qP={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let ZP=(()=>{class n extends Td{constructor(i){super(i)}supports(i){return null!=n.parseEventName(i)}addEventListener(i,s,l){const u=n.parseEventName(s),h=n.eventCallback(u.fullKey,l,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Mn().onAndCancel(i,u.domEventName,h))}static parseEventName(i){const s=i.toLowerCase().split("."),l=s.shift();if(0===s.length||"keydown"!==l&&"keyup"!==l)return null;const u=n._normalizeKey(s.pop());let h="";if(Qv.forEach(g=>{const _=s.indexOf(g);_>-1&&(s.splice(_,1),h+=g+".")}),h+=u,0!=s.length||0===u.length)return null;const d={};return d.domEventName=l,d.fullKey=h,d}static getEventFullKey(i){let s="",l=function(n){let o=n.key;if(null==o){if(o=n.keyIdentifier,null==o)return"Unidentified";o.startsWith("U+")&&(o=String.fromCharCode(parseInt(o.substring(2),16)),3===n.location&&eC.hasOwnProperty(o)&&(o=eC[o]))}return $P[o]||o}(i);return l=l.toLowerCase()," "===l?l="space":"."===l&&(l="dot"),Qv.forEach(u=>{u!=l&&qP[u](i)&&(s+=u+".")}),s+=l,s}static eventCallback(i,s,l){return u=>{n.getEventFullKey(u)===i&&l.runGuarded(()=>s(u))}}static _normalizeKey(i){return"esc"===i?"escape":i}}return n.\u0275fac=function(i){return new(i||n)(B(nt))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();const sx=bT(jN,"browser",[{provide:Th,useValue:"browser"},{provide:pT,useValue:function(){md.makeCurrent(),Ed.init()},multi:!0},{provide:nt,useFactory:function(){return n=document,gu=n,document;var n},deps:[]}]),ax=[[],{provide:Gr,useValue:"root"},{provide:Fo,useFactory:function(){return new Fo},deps:[]},{provide:Cs,useClass:WP,multi:!0,deps:[nt,Ve,Th]},{provide:Cs,useClass:ZP,multi:!0,deps:[nt]},[],{provide:yd,useClass:yd,deps:[Cl,ys,rs]},{provide:Ha,useExisting:yd},{provide:Yv,useExisting:ys},{provide:ys,useClass:ys,deps:[nt]},{provide:Ih,useClass:Ih,deps:[Ve]},{provide:Cl,useClass:Cl,deps:[Cs,Ve]},{provide:class{},useClass:RP,deps:[]},[]];let lx=(()=>{class n{constructor(i){if(i)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(i){return{ngModule:n,providers:[{provide:rs,useValue:i.appId},{provide:jv,useExisting:rs},bP]}}}return n.\u0275fac=function(i){return new(i||n)(B(n,12))},n.\u0275mod=En({type:n}),n.\u0275inj=xt({providers:ax,imports:[pP,qN]}),n})();"undefined"!=typeof window&&window;const{isArray:_x}=Array,{getPrototypeOf:mx,prototype:Ex,keys:Tx}=Object;function nC(n){if(1===n.length){const o=n[0];if(_x(o))return{args:o,keys:null};if(function(n){return n&&"object"==typeof n&&mx(n)===Ex}(o)){const i=Tx(o);return{args:i.map(s=>o[s]),keys:i}}}return{args:n,keys:null}}const{isArray:Cx}=Array;function oC(n){return Ee(o=>function(n,o){return Cx(o)?n(...o):n(o)}(n,o))}function iC(n,o){return n.reduce((i,s,l)=>(i[s]=o[l],i),{})}let rC=(()=>{class n{constructor(i,s){this._renderer=i,this._elementRef=s,this.onChange=l=>{},this.onTouched=()=>{}}setProperty(i,s){this._renderer.setProperty(this._elementRef.nativeElement,i,s)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}}return n.\u0275fac=function(i){return new(i||n)(O(zn),O($e))},n.\u0275dir=Y({type:n}),n})(),Ko=(()=>{class n extends rC{}return n.\u0275fac=function(){let o;return function(s){return(o||(o=function(n){return oo(()=>{const o=n.prototype.constructor,i=o[Hn]||Ou(o),s=Object.prototype;let l=Object.getPrototypeOf(n.prototype).constructor;for(;l&&l!==s;){const u=l[Hn]||Ou(l);if(u&&u!==i)return u;l=Object.getPrototypeOf(l)}return u=>new u})}(n)))(s||n)}}(),n.\u0275dir=Y({type:n,features:[be]}),n})();const Nn=new ae("NgValueAccessor"),bx={provide:Nn,useExisting:Te(()=>Sl),multi:!0},Dx=new ae("CompositionEventMode");let Sl=(()=>{class n extends rC{constructor(i,s,l){super(i,s),this._compositionMode=l,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const n=Mn()?Mn().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(i){this.setProperty("value",null==i?"":i)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}}return n.\u0275fac=function(i){return new(i||n)(O(zn),O($e),O(Dx,8))},n.\u0275dir=Y({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){1&i&&tt("input",function(u){return s._handleInput(u.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(u){return s._compositionEnd(u.target.value)})},features:[Re([bx]),be]}),n})();const ht=new ae("NgValidators"),Co=new ae("NgAsyncValidators");function _C(n){return null!=n}function mC(n){const o=Kr(n)?ze(n):n;return Na(o),o}function EC(n){let o={};return n.forEach(i=>{o=null!=i?H(H({},o),i):o}),0===Object.keys(o).length?null:o}function TC(n,o){return o.map(i=>i(n))}function vC(n){return n.map(o=>function(n){return!n.validate}(o)?o:i=>o.validate(i))}function Ad(n){return null!=n?function(n){if(!n)return null;const o=n.filter(_C);return 0==o.length?null:function(i){return EC(TC(i,o))}}(vC(n)):null}function wd(n){return null!=n?function(n){if(!n)return null;const o=n.filter(_C);return 0==o.length?null:function(i){return function(...n){const o=Hp(n),{args:i,keys:s}=nC(n),l=new Ae(u=>{const{length:h}=i;if(!h)return void u.complete();const d=new Array(h);let g=h,_=h;for(let m=0;m<h;m++){let E=!1;mn(i[m]).subscribe(new Ye(u,v=>{E||(E=!0,_--),d[m]=v},()=>g--,void 0,()=>{(!g||!E)&&(_||u.next(s?iC(s,d):d),u.complete())}))}});return o?l.pipe(oC(o)):l}(TC(i,o).map(mC)).pipe(Ee(EC))}}(vC(n)):null}function SC(n,o){return null===n?[o]:Array.isArray(n)?[...n,o]:[n,o]}function Od(n){return n?Array.isArray(n)?n:[n]:[]}function Il(n,o){return Array.isArray(n)?n.includes(o):n===o}function RC(n,o){const i=Od(o);return Od(n).forEach(l=>{Il(i,l)||i.push(l)}),i}function DC(n,o){return Od(o).filter(i=>!Il(n,i))}class AC{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(o){this._rawValidators=o||[],this._composedValidatorFn=Ad(this._rawValidators)}_setAsyncValidators(o){this._rawAsyncValidators=o||[],this._composedAsyncValidatorFn=wd(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(o){this._onDestroyCallbacks.push(o)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(o=>o()),this._onDestroyCallbacks=[]}reset(o){this.control&&this.control.reset(o)}hasError(o,i){return!!this.control&&this.control.hasError(o,i)}getError(o,i){return this.control?this.control.getError(o,i):null}}class vt extends AC{get formDirective(){return null}get path(){return null}}class yo extends AC{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let OC=(()=>{class n extends class{constructor(o){this._cd=o}is(o){var i,s,l;return"submitted"===o?!!(null==(i=this._cd)?void 0:i.submitted):!!(null==(l=null==(s=this._cd)?void 0:s.control)?void 0:l[o])}}{constructor(i){super(i)}}return n.\u0275fac=function(i){return new(i||n)(O(yo,2))},n.\u0275dir=Y({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){2&i&&ka("ng-untouched",s.is("untouched"))("ng-touched",s.is("touched"))("ng-pristine",s.is("pristine"))("ng-dirty",s.is("dirty"))("ng-valid",s.is("valid"))("ng-invalid",s.is("invalid"))("ng-pending",s.is("pending"))},features:[be]}),n})();function Ss(n,o){(function(n,o){const i=function(n){return n._rawValidators}(n);null!==o.validator?n.setValidators(SC(i,o.validator)):"function"==typeof i&&n.setValidators([i]);const s=function(n){return n._rawAsyncValidators}(n);null!==o.asyncValidator?n.setAsyncValidators(SC(s,o.asyncValidator)):"function"==typeof s&&n.setAsyncValidators([s]);const l=()=>n.updateValueAndValidity();Al(o._rawValidators,l),Al(o._rawAsyncValidators,l)})(n,o),o.valueAccessor.writeValue(n.value),function(n,o){o.valueAccessor.registerOnChange(i=>{n._pendingValue=i,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&MC(n,o)})}(n,o),function(n,o){const i=(s,l)=>{o.valueAccessor.writeValue(s),l&&o.viewToModelUpdate(s)};n.registerOnChange(i),o._registerOnDestroy(()=>{n._unregisterOnChange(i)})}(n,o),function(n,o){o.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&MC(n,o),"submit"!==n.updateOn&&n.markAsTouched()})}(n,o),function(n,o){if(o.valueAccessor.setDisabledState){const i=s=>{o.valueAccessor.setDisabledState(s)};n.registerOnDisabledChange(i),o._registerOnDestroy(()=>{n._unregisterOnDisabledChange(i)})}}(n,o)}function Al(n,o){n.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(o)})}function MC(n,o){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),o.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Ol(n,o){const i=n.indexOf(o);i>-1&&n.splice(i,1)}const Is="VALID",Ml="INVALID",Qi="PENDING",bs="DISABLED";function xd(n){return(Vd(n)?n.validators:n)||null}function LC(n){return Array.isArray(n)?Ad(n):n||null}function Fd(n,o){return(Vd(o)?o.asyncValidators:n)||null}function PC(n){return Array.isArray(n)?wd(n):n||null}function Vd(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class Ud{constructor(o,i){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=o,this._rawAsyncValidators=i,this._composedValidatorFn=LC(this._rawValidators),this._composedAsyncValidatorFn=PC(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(o){this._rawValidators=this._composedValidatorFn=o}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(o){this._rawAsyncValidators=this._composedAsyncValidatorFn=o}get parent(){return this._parent}get valid(){return this.status===Is}get invalid(){return this.status===Ml}get pending(){return this.status==Qi}get disabled(){return this.status===bs}get enabled(){return this.status!==bs}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(o){this._rawValidators=o,this._composedValidatorFn=LC(o)}setAsyncValidators(o){this._rawAsyncValidators=o,this._composedAsyncValidatorFn=PC(o)}addValidators(o){this.setValidators(RC(o,this._rawValidators))}addAsyncValidators(o){this.setAsyncValidators(RC(o,this._rawAsyncValidators))}removeValidators(o){this.setValidators(DC(o,this._rawValidators))}removeAsyncValidators(o){this.setAsyncValidators(DC(o,this._rawAsyncValidators))}hasValidator(o){return Il(this._rawValidators,o)}hasAsyncValidator(o){return Il(this._rawAsyncValidators,o)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(o={}){this.touched=!0,this._parent&&!o.onlySelf&&this._parent.markAsTouched(o)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(o=>o.markAllAsTouched())}markAsUntouched(o={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0})}),this._parent&&!o.onlySelf&&this._parent._updateTouched(o)}markAsDirty(o={}){this.pristine=!1,this._parent&&!o.onlySelf&&this._parent.markAsDirty(o)}markAsPristine(o={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(i=>{i.markAsPristine({onlySelf:!0})}),this._parent&&!o.onlySelf&&this._parent._updatePristine(o)}markAsPending(o={}){this.status=Qi,!1!==o.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!o.onlySelf&&this._parent.markAsPending(o)}disable(o={}){const i=this._parentMarkedDirty(o.onlySelf);this.status=bs,this.errors=null,this._forEachChild(s=>{s.disable(Qe(H({},o),{onlySelf:!0}))}),this._updateValue(),!1!==o.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Qe(H({},o),{skipPristineCheck:i})),this._onDisabledChange.forEach(s=>s(!0))}enable(o={}){const i=this._parentMarkedDirty(o.onlySelf);this.status=Is,this._forEachChild(s=>{s.enable(Qe(H({},o),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:o.emitEvent}),this._updateAncestors(Qe(H({},o),{skipPristineCheck:i})),this._onDisabledChange.forEach(s=>s(!1))}_updateAncestors(o){this._parent&&!o.onlySelf&&(this._parent.updateValueAndValidity(o),o.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(o){this._parent=o}updateValueAndValidity(o={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Is||this.status===Qi)&&this._runAsyncValidator(o.emitEvent)),!1!==o.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!o.onlySelf&&this._parent.updateValueAndValidity(o)}_updateTreeValidity(o={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(o)),this.updateValueAndValidity({onlySelf:!0,emitEvent:o.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?bs:Is}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(o){if(this.asyncValidator){this.status=Qi,this._hasOwnPendingAsyncValidator=!0;const i=mC(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(s=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(s,{emitEvent:o})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(o,i={}){this.errors=o,this._updateControlsErrors(!1!==i.emitEvent)}get(o){return function(n,o,i){if(null==o||(Array.isArray(o)||(o=o.split(".")),Array.isArray(o)&&0===o.length))return null;let s=n;return o.forEach(l=>{s=s instanceof Bd?s.controls.hasOwnProperty(l)?s.controls[l]:null:s instanceof Gx&&s.at(l)||null}),s}(this,o)}getError(o,i){const s=i?this.get(i):this;return s&&s.errors?s.errors[o]:null}hasError(o,i){return!!this.getError(o,i)}get root(){let o=this;for(;o._parent;)o=o._parent;return o}_updateControlsErrors(o){this.status=this._calculateStatus(),o&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(o)}_initObservables(){this.valueChanges=new Le,this.statusChanges=new Le}_calculateStatus(){return this._allControlsDisabled()?bs:this.errors?Ml:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Qi)?Qi:this._anyControlsHaveStatus(Ml)?Ml:Is}_anyControlsHaveStatus(o){return this._anyControls(i=>i.status===o)}_anyControlsDirty(){return this._anyControls(o=>o.dirty)}_anyControlsTouched(){return this._anyControls(o=>o.touched)}_updatePristine(o={}){this.pristine=!this._anyControlsDirty(),this._parent&&!o.onlySelf&&this._parent._updatePristine(o)}_updateTouched(o={}){this.touched=this._anyControlsTouched(),this._parent&&!o.onlySelf&&this._parent._updateTouched(o)}_isBoxedValue(o){return"object"==typeof o&&null!==o&&2===Object.keys(o).length&&"value"in o&&"disabled"in o}_registerOnCollectionChange(o){this._onCollectionChange=o}_setUpdateStrategy(o){Vd(o)&&null!=o.updateOn&&(this._updateOn=o.updateOn)}_parentMarkedDirty(o){return!o&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class Nl extends Ud{constructor(o=null,i,s){super(xd(i),Fd(s,i)),this._onChange=[],this._applyFormState(o),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(o,i={}){this.value=this._pendingValue=o,this._onChange.length&&!1!==i.emitModelToViewChange&&this._onChange.forEach(s=>s(this.value,!1!==i.emitViewToModelChange)),this.updateValueAndValidity(i)}patchValue(o,i={}){this.setValue(o,i)}reset(o=null,i={}){this._applyFormState(o),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(o){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(o){this._onChange.push(o)}_unregisterOnChange(o){Ol(this._onChange,o)}registerOnDisabledChange(o){this._onDisabledChange.push(o)}_unregisterOnDisabledChange(o){Ol(this._onDisabledChange,o)}_forEachChild(o){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(o){this._isBoxedValue(o)?(this.value=this._pendingValue=o.value,o.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=o}}class Bd extends Ud{constructor(o,i,s){super(xd(i),Fd(s,i)),this.controls=o,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(o,i){return this.controls[o]?this.controls[o]:(this.controls[o]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(o,i,s={}){this.registerControl(o,i),this.updateValueAndValidity({emitEvent:s.emitEvent}),this._onCollectionChange()}removeControl(o,i={}){this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),delete this.controls[o],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(o,i,s={}){this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),delete this.controls[o],i&&this.registerControl(o,i),this.updateValueAndValidity({emitEvent:s.emitEvent}),this._onCollectionChange()}contains(o){return this.controls.hasOwnProperty(o)&&this.controls[o].enabled}setValue(o,i={}){this._checkAllValuesPresent(o),Object.keys(o).forEach(s=>{this._throwIfControlMissing(s),this.controls[s].setValue(o[s],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(o,i={}){null!=o&&(Object.keys(o).forEach(s=>{this.controls[s]&&this.controls[s].patchValue(o[s],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(o={},i={}){this._forEachChild((s,l)=>{s.reset(o[l],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(o,i,s)=>(o[s]=i instanceof Nl?i.value:i.getRawValue(),o))}_syncPendingControls(){let o=this._reduceChildren(!1,(i,s)=>!!s._syncPendingControls()||i);return o&&this.updateValueAndValidity({onlySelf:!0}),o}_throwIfControlMissing(o){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[o])throw new Error(`Cannot find form control with name: ${o}.`)}_forEachChild(o){Object.keys(this.controls).forEach(i=>{const s=this.controls[i];s&&o(s,i)})}_setUpControls(){this._forEachChild(o=>{o.setParent(this),o._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(o){for(const i of Object.keys(this.controls)){const s=this.controls[i];if(this.contains(i)&&o(s))return!0}return!1}_reduceValue(){return this._reduceChildren({},(o,i,s)=>((i.enabled||this.disabled)&&(o[s]=i.value),o))}_reduceChildren(o,i){let s=o;return this._forEachChild((l,u)=>{s=i(s,l,u)}),s}_allControlsDisabled(){for(const o of Object.keys(this.controls))if(this.controls[o].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(o){this._forEachChild((i,s)=>{if(void 0===o[s])throw new Error(`Must supply a value for form control with name: '${s}'.`)})}}class Gx extends Ud{constructor(o,i,s){super(xd(i),Fd(s,i)),this.controls=o,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(o){return this.controls[o]}push(o,i={}){this.controls.push(o),this._registerControl(o),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}insert(o,i,s={}){this.controls.splice(o,0,i),this._registerControl(i),this.updateValueAndValidity({emitEvent:s.emitEvent})}removeAt(o,i={}){this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),this.controls.splice(o,1),this.updateValueAndValidity({emitEvent:i.emitEvent})}setControl(o,i,s={}){this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),this.controls.splice(o,1),i&&(this.controls.splice(o,0,i),this._registerControl(i)),this.updateValueAndValidity({emitEvent:s.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(o,i={}){this._checkAllValuesPresent(o),o.forEach((s,l)=>{this._throwIfControlMissing(l),this.at(l).setValue(s,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(o,i={}){null!=o&&(o.forEach((s,l)=>{this.at(l)&&this.at(l).patchValue(s,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(o=[],i={}){this._forEachChild((s,l)=>{s.reset(o[l],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this.controls.map(o=>o instanceof Nl?o.value:o.getRawValue())}clear(o={}){this.controls.length<1||(this._forEachChild(i=>i._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:o.emitEvent}))}_syncPendingControls(){let o=this.controls.reduce((i,s)=>!!s._syncPendingControls()||i,!1);return o&&this.updateValueAndValidity({onlySelf:!0}),o}_throwIfControlMissing(o){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(o))throw new Error(`Cannot find form control at index ${o}`)}_forEachChild(o){this.controls.forEach((i,s)=>{o(i,s)})}_updateValue(){this.value=this.controls.filter(o=>o.enabled||this.disabled).map(o=>o.value)}_anyControls(o){return this.controls.some(i=>i.enabled&&o(i))}_setUpControls(){this._forEachChild(o=>this._registerControl(o))}_checkAllValuesPresent(o){this._forEachChild((i,s)=>{if(void 0===o[s])throw new Error(`Must supply a value for form control at index: ${s}.`)})}_allControlsDisabled(){for(const o of this.controls)if(o.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(o){o.setParent(this),o._registerOnCollectionChange(this._onCollectionChange)}}const Xx={provide:yo,useExisting:Te(()=>Gd)},VC=(()=>Promise.resolve(null))();let Gd=(()=>{class n extends yo{constructor(i,s,l,u){super(),this.control=new Nl,this._registered=!1,this.update=new Le,this._parent=i,this._setValidators(s),this._setAsyncValidators(l),this.valueAccessor=function(n,o){if(!o)return null;let i,s,l;return Array.isArray(o),o.forEach(u=>{u.constructor===Sl?i=u:function(n){return Object.getPrototypeOf(n.constructor)===Ko}(u)?s=u:l=u}),l||s||i||null}(0,u)}ngOnChanges(i){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in i&&this._updateDisabled(i),function(n,o){if(!n.hasOwnProperty("model"))return!1;const i=n.model;return!!i.isFirstChange()||!Object.is(o,i.currentValue)}(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(n,o){return[...o.path,n]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Ss(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(i){VC.then(()=>{this.control.setValue(i,{emitViewToModelChange:!1})})}_updateDisabled(i){const s=i.isDisabled.currentValue,l=""===s||s&&"false"!==s;VC.then(()=>{l&&!this.control.disabled?this.control.disable():!l&&this.control.disabled&&this.control.enable()})}}return n.\u0275fac=function(i){return new(i||n)(O(vt,9),O(ht,10),O(Co,10),O(Nn,10))},n.\u0275dir=Y({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Re([Xx]),be,st]}),n})(),BC=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=En({type:n}),n.\u0275inj=xt({}),n})(),_F=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=En({type:n}),n.\u0275inj=xt({imports:[[BC]]}),n})(),mF=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=En({type:n}),n.\u0275inj=xt({imports:[_F]}),n})();function ne(...n){return ze(n,pr(n))}class _n extends xn{constructor(o){super(),this._value=o}get value(){return this.getValue()}_subscribe(o){const i=super._subscribe(o);return!i.closed&&o.next(this._value),i}getValue(){const{hasError:o,thrownError:i,_value:s}=this;if(o)throw i;return this._throwIfClosed(),s}next(o){super.next(this._value=o)}}function ry(n,o,i){n?Fn(i,n,o):o()}const kl=N(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Jd(...n){return dr(1)(ze(n,pr(n)))}function sy(n){return new Ae(o=>{mn(n()).subscribe(o)})}function ay(){return et((n,o)=>{let i=null;n._refCount++;const s=new Ye(o,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(i=null);const l=n._connection,u=i;i=null,l&&(!u||l===u)&&l.unsubscribe(),o.unsubscribe()});n.subscribe(s),s.closed||(i=n.connect())})}class CF extends Ae{constructor(o,i){super(),this.source=o,this.subjectFactory=i,this._subject=null,this._refCount=0,this._connection=null,Dp(o)&&(this.lift=o.lift)}_subscribe(o){return this.getSubject().subscribe(o)}getSubject(){const o=this._subject;return(!o||o.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:o}=this;this._subject=this._connection=null,null==o||o.unsubscribe()}connect(){let o=this._connection;if(!o){o=this._connection=new r;const i=this.getSubject();o.add(this.source.subscribe(new Ye(i,void 0,()=>{this._teardown(),i.complete()},s=>{this._teardown(),i.error(s)},()=>this._teardown()))),o.closed&&(this._connection=null,o=r.EMPTY)}return o}refCount(){return ay()(this)}}function zo(n,o){return et((i,s)=>{let l=null,u=0,h=!1;const d=()=>h&&!l&&s.complete();i.subscribe(new Ye(s,g=>{null==l||l.unsubscribe();let _=0;const m=u++;mn(n(g,m)).subscribe(l=new Ye(s,E=>s.next(o?o(g,E,m,_++):E),()=>{l=null,d()}))},()=>{h=!0,d()}))})}function SF(n,o,i,s,l){return(u,h)=>{let d=i,g=o,_=0;u.subscribe(new Ye(h,m=>{const E=_++;g=d?n(g,m,E):(d=!0,m),s&&h.next(g)},l&&(()=>{d&&h.next(g),h.complete()})))}}function ly(n,o){return et(SF(n,o,arguments.length>=2,!0))}function er(n,o){return et((i,s)=>{let l=0;i.subscribe(new Ye(s,u=>n.call(o,u,l++)&&s.next(u)))})}function So(n){return et((o,i)=>{let u,s=null,l=!1;s=o.subscribe(new Ye(i,void 0,void 0,h=>{u=mn(n(h,So(n)(o))),s?(s.unsubscribe(),s=null,u.subscribe(i)):l=!0})),l&&(s.unsubscribe(),s=null,u.subscribe(i))})}function Ds(n,o){return M(o)?Ke(n,o,1):Ke(n,1)}function $d(n){return n<=0?()=>Vn:et((o,i)=>{let s=[];o.subscribe(new Ye(i,l=>{s.push(l),n<s.length&&s.shift()},()=>{for(const l of s)i.next(l);i.complete()},void 0,()=>{s=null}))})}function uy(n=IF){return et((o,i)=>{let s=!1;o.subscribe(new Ye(i,l=>{s=!0,i.next(l)},()=>s?i.complete():i.error(n())))})}function IF(){return new kl}function cy(n){return et((o,i)=>{let s=!1;o.subscribe(new Ye(i,l=>{s=!0,i.next(l)},()=>{s||i.next(n),i.complete()}))})}function tr(n,o){const i=arguments.length>=2;return s=>s.pipe(n?er((l,u)=>n(l,u,s)):bo,Bs(1),i?cy(o):uy(()=>new kl))}function Lt(n,o,i){const s=M(n)||o||i?{next:n,error:o,complete:i}:n;return s?et((l,u)=>{var h;null===(h=s.subscribe)||void 0===h||h.call(s);let d=!0;l.subscribe(new Ye(u,g=>{var _;null===(_=s.next)||void 0===_||_.call(s,g),u.next(g)},()=>{var g;d=!1,null===(g=s.complete)||void 0===g||g.call(s),u.complete()},g=>{var _;d=!1,null===(_=s.error)||void 0===_||_.call(s,g),u.error(g)},()=>{var g,_;d&&(null===(g=s.unsubscribe)||void 0===g||g.call(s)),null===(_=s.finalize)||void 0===_||_.call(s)}))}):bo}class eo{constructor(o,i){this.id=o,this.url=i}}class qd extends eo{constructor(o,i,s="imperative",l=null){super(o,i),this.navigationTrigger=s,this.restoredState=l}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class As extends eo{constructor(o,i,s){super(o,i),this.urlAfterRedirects=s}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class hy extends eo{constructor(o,i,s){super(o,i),this.reason=s}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class DF extends eo{constructor(o,i,s){super(o,i),this.error=s}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class AF extends eo{constructor(o,i,s,l){super(o,i),this.urlAfterRedirects=s,this.state=l}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class wF extends eo{constructor(o,i,s,l){super(o,i),this.urlAfterRedirects=s,this.state=l}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class OF extends eo{constructor(o,i,s,l,u){super(o,i),this.urlAfterRedirects=s,this.state=l,this.shouldActivate=u}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class MF extends eo{constructor(o,i,s,l){super(o,i),this.urlAfterRedirects=s,this.state=l}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class NF extends eo{constructor(o,i,s,l){super(o,i),this.urlAfterRedirects=s,this.state=l}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class dy{constructor(o){this.route=o}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class py{constructor(o){this.route=o}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class kF{constructor(o){this.snapshot=o}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class LF{constructor(o){this.snapshot=o}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class PF{constructor(o){this.snapshot=o}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xF{constructor(o){this.snapshot=o}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class gy{constructor(o,i,s){this.routerEvent=o,this.position=i,this.anchor=s}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const le="primary";class FF{constructor(o){this.params=o||{}}has(o){return Object.prototype.hasOwnProperty.call(this.params,o)}get(o){if(this.has(o)){const i=this.params[o];return Array.isArray(i)?i[0]:i}return null}getAll(o){if(this.has(o)){const i=this.params[o];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}}function nr(n){return new FF(n)}const fy="ngNavigationCancelingError";function Zd(n){const o=Error("NavigationCancelingError: "+n);return o[fy]=!0,o}function UF(n,o,i){const s=i.path.split("/");if(s.length>n.length||"full"===i.pathMatch&&(o.hasChildren()||s.length<n.length))return null;const l={};for(let u=0;u<s.length;u++){const h=s[u],d=n[u];if(h.startsWith(":"))l[h.substring(1)]=d;else if(h!==d.path)return null}return{consumed:n.slice(0,s.length),posParams:l}}function kn(n,o){const i=n?Object.keys(n):void 0,s=o?Object.keys(o):void 0;if(!i||!s||i.length!=s.length)return!1;let l;for(let u=0;u<i.length;u++)if(l=i[u],!_y(n[l],o[l]))return!1;return!0}function _y(n,o){if(Array.isArray(n)&&Array.isArray(o)){if(n.length!==o.length)return!1;const i=[...n].sort(),s=[...o].sort();return i.every((l,u)=>s[u]===l)}return n===o}function my(n){return Array.prototype.concat.apply([],n)}function Ey(n){return n.length>0?n[n.length-1]:null}function ot(n,o){for(const i in n)n.hasOwnProperty(i)&&o(n[i],i)}function Ln(n){return Na(n)?n:Kr(n)?ze(Promise.resolve(n)):ne(n)}const GF={exact:function Cy(n,o,i){if(!$o(n.segments,o.segments)||!Ll(n.segments,o.segments,i)||n.numberOfChildren!==o.numberOfChildren)return!1;for(const s in o.children)if(!n.children[s]||!Cy(n.children[s],o.children[s],i))return!1;return!0},subset:yy},Ty={exact:function(n,o){return kn(n,o)},subset:function(n,o){return Object.keys(o).length<=Object.keys(n).length&&Object.keys(o).every(i=>_y(n[i],o[i]))},ignored:()=>!0};function vy(n,o,i){return GF[i.paths](n.root,o.root,i.matrixParams)&&Ty[i.queryParams](n.queryParams,o.queryParams)&&!("exact"===i.fragment&&n.fragment!==o.fragment)}function yy(n,o,i){return Sy(n,o,o.segments,i)}function Sy(n,o,i,s){if(n.segments.length>i.length){const l=n.segments.slice(0,i.length);return!(!$o(l,i)||o.hasChildren()||!Ll(l,i,s))}if(n.segments.length===i.length){if(!$o(n.segments,i)||!Ll(n.segments,i,s))return!1;for(const l in o.children)if(!n.children[l]||!yy(n.children[l],o.children[l],s))return!1;return!0}{const l=i.slice(0,n.segments.length),u=i.slice(n.segments.length);return!!($o(n.segments,l)&&Ll(n.segments,l,s)&&n.children[le])&&Sy(n.children[le],o,u,s)}}function Ll(n,o,i){return o.every((s,l)=>Ty[i](n[l].parameters,s.parameters))}class Jo{constructor(o,i,s){this.root=o,this.queryParams=i,this.fragment=s}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=nr(this.queryParams)),this._queryParamMap}toString(){return KF.serialize(this)}}class ce{constructor(o,i){this.segments=o,this.children=i,this.parent=null,ot(i,(s,l)=>s.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Pl(this)}}class ws{constructor(o,i){this.path=o,this.parameters=i}get parameterMap(){return this._parameterMap||(this._parameterMap=nr(this.parameters)),this._parameterMap}toString(){return Ay(this)}}function $o(n,o){return n.length===o.length&&n.every((i,s)=>i.path===o[s].path)}class Iy{}class by{parse(o){const i=new n1(o);return new Jo(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(o){const i=`/${Os(o.root,!0)}`,s=function(n){const o=Object.keys(n).map(i=>{const s=n[i];return Array.isArray(s)?s.map(l=>`${xl(i)}=${xl(l)}`).join("&"):`${xl(i)}=${xl(s)}`}).filter(i=>!!i);return o.length?`?${o.join("&")}`:""}(o.queryParams);var n;return`${i}${s}${"string"==typeof o.fragment?`#${n=o.fragment,encodeURI(n)}`:""}`}}const KF=new by;function Pl(n){return n.segments.map(o=>Ay(o)).join("/")}function Os(n,o){if(!n.hasChildren())return Pl(n);if(o){const i=n.children[le]?Os(n.children[le],!1):"",s=[];return ot(n.children,(l,u)=>{u!==le&&s.push(`${u}:${Os(l,!1)}`)}),s.length>0?`${i}(${s.join("//")})`:i}{const i=function(n,o){let i=[];return ot(n.children,(s,l)=>{l===le&&(i=i.concat(o(s,l)))}),ot(n.children,(s,l)=>{l!==le&&(i=i.concat(o(s,l)))}),i}(n,(s,l)=>l===le?[Os(n.children[le],!1)]:[`${l}:${Os(s,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[le]?`${Pl(n)}/${i[0]}`:`${Pl(n)}/(${i.join("//")})`}}function Ry(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function xl(n){return Ry(n).replace(/%3B/gi,";")}function Qd(n){return Ry(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Fl(n){return decodeURIComponent(n)}function Dy(n){return Fl(n.replace(/\+/g,"%20"))}function Ay(n){return`${Qd(n.path)}${function(n){return Object.keys(n).map(o=>`;${Qd(o)}=${Qd(n[o])}`).join("")}(n.parameters)}`}const qF=/^[^\/()?;=#]+/;function Vl(n){const o=n.match(qF);return o?o[0]:""}const ZF=/^[^=?&#]+/,e1=/^[^&#]+/;class n1{constructor(o){this.url=o,this.remaining=o}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ce([],{}):new ce([],this.parseChildren())}parseQueryParams(){const o={};if(this.consumeOptional("?"))do{this.parseQueryParam(o)}while(this.consumeOptional("&"));return o}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const o=[];for(this.peekStartsWith("(")||o.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),o.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let s={};return this.peekStartsWith("(")&&(s=this.parseParens(!1)),(o.length>0||Object.keys(i).length>0)&&(s[le]=new ce(o,i)),s}parseSegment(){const o=Vl(this.remaining);if(""===o&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(o),new ws(Fl(o),this.parseMatrixParams())}parseMatrixParams(){const o={};for(;this.consumeOptional(";");)this.parseParam(o);return o}parseParam(o){const i=Vl(this.remaining);if(!i)return;this.capture(i);let s="";if(this.consumeOptional("=")){const l=Vl(this.remaining);l&&(s=l,this.capture(s))}o[Fl(i)]=Fl(s)}parseQueryParam(o){const i=function(n){const o=n.match(ZF);return o?o[0]:""}(this.remaining);if(!i)return;this.capture(i);let s="";if(this.consumeOptional("=")){const h=function(n){const o=n.match(e1);return o?o[0]:""}(this.remaining);h&&(s=h,this.capture(s))}const l=Dy(i),u=Dy(s);if(o.hasOwnProperty(l)){let h=o[l];Array.isArray(h)||(h=[h],o[l]=h),h.push(u)}else o[l]=u}parseParens(o){const i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const s=Vl(this.remaining),l=this.remaining[s.length];if("/"!==l&&")"!==l&&";"!==l)throw new Error(`Cannot parse url '${this.url}'`);let u;s.indexOf(":")>-1?(u=s.substr(0,s.indexOf(":")),this.capture(u),this.capture(":")):o&&(u=le);const h=this.parseChildren();i[u]=1===Object.keys(h).length?h[le]:new ce([],h),this.consumeOptional("//")}return i}peekStartsWith(o){return this.remaining.startsWith(o)}consumeOptional(o){return!!this.peekStartsWith(o)&&(this.remaining=this.remaining.substring(o.length),!0)}capture(o){if(!this.consumeOptional(o))throw new Error(`Expected "${o}".`)}}class wy{constructor(o){this._root=o}get root(){return this._root.value}parent(o){const i=this.pathFromRoot(o);return i.length>1?i[i.length-2]:null}children(o){const i=ep(o,this._root);return i?i.children.map(s=>s.value):[]}firstChild(o){const i=ep(o,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(o){const i=tp(o,this._root);return i.length<2?[]:i[i.length-2].children.map(l=>l.value).filter(l=>l!==o)}pathFromRoot(o){return tp(o,this._root).map(i=>i.value)}}function ep(n,o){if(n===o.value)return o;for(const i of o.children){const s=ep(n,i);if(s)return s}return null}function tp(n,o){if(n===o.value)return[o];for(const i of o.children){const s=tp(n,i);if(s.length)return s.unshift(o),s}return[]}class to{constructor(o,i){this.value=o,this.children=i}toString(){return`TreeNode(${this.value})`}}function or(n){const o={};return n&&n.children.forEach(i=>o[i.value.outlet]=i),o}class Oy extends wy{constructor(o,i){super(o),this.snapshot=i,np(this,o)}toString(){return this.snapshot.toString()}}function My(n,o){const i=function(n,o){const h=new Ul([],{},{},"",{},le,o,null,n.root,-1,{});return new ky("",new to(h,[]))}(n,o),s=new _n([new ws("",{})]),l=new _n({}),u=new _n({}),h=new _n({}),d=new _n(""),g=new ir(s,l,h,d,u,le,o,i.root);return g.snapshot=i.root,new Oy(new to(g,[]),i)}class ir{constructor(o,i,s,l,u,h,d,g){this.url=o,this.params=i,this.queryParams=s,this.fragment=l,this.data=u,this.outlet=h,this.component=d,this._futureSnapshot=g}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ee(o=>nr(o)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ee(o=>nr(o)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ny(n,o="emptyOnly"){const i=n.pathFromRoot;let s=0;if("always"!==o)for(s=i.length-1;s>=1;){const l=i[s],u=i[s-1];if(l.routeConfig&&""===l.routeConfig.path)s--;else{if(u.component)break;s--}}return function(n){return n.reduce((o,i)=>({params:H(H({},o.params),i.params),data:H(H({},o.data),i.data),resolve:H(H({},o.resolve),i._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(s))}class Ul{constructor(o,i,s,l,u,h,d,g,_,m,E){this.url=o,this.params=i,this.queryParams=s,this.fragment=l,this.data=u,this.outlet=h,this.component=d,this.routeConfig=g,this._urlSegment=_,this._lastPathIndex=m,this._resolve=E}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=nr(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=nr(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(s=>s.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ky extends wy{constructor(o,i){super(i),this.url=o,np(this,i)}toString(){return Ly(this._root)}}function np(n,o){o.value._routerState=n,o.children.forEach(i=>np(n,i))}function Ly(n){const o=n.children.length>0?` { ${n.children.map(Ly).join(", ")} } `:"";return`${n.value}${o}`}function op(n){if(n.snapshot){const o=n.snapshot,i=n._futureSnapshot;n.snapshot=i,kn(o.queryParams,i.queryParams)||n.queryParams.next(i.queryParams),o.fragment!==i.fragment&&n.fragment.next(i.fragment),kn(o.params,i.params)||n.params.next(i.params),function(n,o){if(n.length!==o.length)return!1;for(let i=0;i<n.length;++i)if(!kn(n[i],o[i]))return!1;return!0}(o.url,i.url)||n.url.next(i.url),kn(o.data,i.data)||n.data.next(i.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function ip(n,o){const i=kn(n.params,o.params)&&function(n,o){return $o(n,o)&&n.every((i,s)=>kn(i.parameters,o[s].parameters))}(n.url,o.url);return i&&!(!n.parent!=!o.parent)&&(!n.parent||ip(n.parent,o.parent))}function Ms(n,o,i){if(i&&n.shouldReuseRoute(o.value,i.value.snapshot)){const s=i.value;s._futureSnapshot=o.value;const l=function(n,o,i){return o.children.map(s=>{for(const l of i.children)if(n.shouldReuseRoute(s.value,l.value.snapshot))return Ms(n,s,l);return Ms(n,s)})}(n,o,i);return new to(s,l)}{if(n.shouldAttach(o.value)){const u=n.retrieve(o.value);if(null!==u){const h=u.route;return h.value._futureSnapshot=o.value,h.children=o.children.map(d=>Ms(n,d)),h}}const s=function(n){return new ir(new _n(n.url),new _n(n.params),new _n(n.queryParams),new _n(n.fragment),new _n(n.data),n.outlet,n.component,n)}(o.value),l=o.children.map(u=>Ms(n,u));return new to(s,l)}}function Bl(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Ns(n){return"object"==typeof n&&null!=n&&n.outlets}function rp(n,o,i,s,l){let u={};return s&&ot(s,(h,d)=>{u[d]=Array.isArray(h)?h.map(g=>`${g}`):`${h}`}),new Jo(i.root===n?o:Py(i.root,n,o),u,l)}function Py(n,o,i){const s={};return ot(n.children,(l,u)=>{s[u]=l===o?i:Py(l,o,i)}),new ce(n.segments,s)}class xy{constructor(o,i,s){if(this.isAbsolute=o,this.numberOfDoubleDots=i,this.commands=s,o&&s.length>0&&Bl(s[0]))throw new Error("Root segment cannot have matrix parameters");const l=s.find(Ns);if(l&&l!==Ey(s))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class sp{constructor(o,i,s){this.segmentGroup=o,this.processChildren=i,this.index=s}}function Fy(n,o,i){if(n||(n=new ce([],{})),0===n.segments.length&&n.hasChildren())return Hl(n,o,i);const s=function(n,o,i){let s=0,l=o;const u={match:!1,pathIndex:0,commandIndex:0};for(;l<n.segments.length;){if(s>=i.length)return u;const h=n.segments[l],d=i[s];if(Ns(d))break;const g=`${d}`,_=s<i.length-1?i[s+1]:null;if(l>0&&void 0===g)break;if(g&&_&&"object"==typeof _&&void 0===_.outlets){if(!Uy(g,_,h))return u;s+=2}else{if(!Uy(g,{},h))return u;s++}l++}return{match:!0,pathIndex:l,commandIndex:s}}(n,o,i),l=i.slice(s.commandIndex);if(s.match&&s.pathIndex<n.segments.length){const u=new ce(n.segments.slice(0,s.pathIndex),{});return u.children[le]=new ce(n.segments.slice(s.pathIndex),n.children),Hl(u,0,l)}return s.match&&0===l.length?new ce(n.segments,{}):s.match&&!n.hasChildren()?ap(n,o,i):s.match?Hl(n,0,l):ap(n,o,i)}function Hl(n,o,i){if(0===i.length)return new ce(n.segments,{});{const s=function(n){return Ns(n[0])?n[0].outlets:{[le]:n}}(i),l={};return ot(s,(u,h)=>{"string"==typeof u&&(u=[u]),null!==u&&(l[h]=Fy(n.children[h],o,u))}),ot(n.children,(u,h)=>{void 0===s[h]&&(l[h]=u)}),new ce(n.segments,l)}}function ap(n,o,i){const s=n.segments.slice(0,o);let l=0;for(;l<i.length;){const u=i[l];if(Ns(u)){const g=g1(u.outlets);return new ce(s,g)}if(0===l&&Bl(i[0])){s.push(new ws(n.segments[o].path,Vy(i[0]))),l++;continue}const h=Ns(u)?u.outlets[le]:`${u}`,d=l<i.length-1?i[l+1]:null;h&&d&&Bl(d)?(s.push(new ws(h,Vy(d))),l+=2):(s.push(new ws(h,{})),l++)}return new ce(s,{})}function g1(n){const o={};return ot(n,(i,s)=>{"string"==typeof i&&(i=[i]),null!==i&&(o[s]=ap(new ce([],{}),0,i))}),o}function Vy(n){const o={};return ot(n,(i,s)=>o[s]=`${i}`),o}function Uy(n,o,i){return n==i.path&&kn(o,i.parameters)}class _1{constructor(o,i,s,l){this.routeReuseStrategy=o,this.futureState=i,this.currState=s,this.forwardEvent=l}activate(o){const i=this.futureState._root,s=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,s,o),op(this.futureState.root),this.activateChildRoutes(i,s,o)}deactivateChildRoutes(o,i,s){const l=or(i);o.children.forEach(u=>{const h=u.value.outlet;this.deactivateRoutes(u,l[h],s),delete l[h]}),ot(l,(u,h)=>{this.deactivateRouteAndItsChildren(u,s)})}deactivateRoutes(o,i,s){const l=o.value,u=i?i.value:null;if(l===u)if(l.component){const h=s.getContext(l.outlet);h&&this.deactivateChildRoutes(o,i,h.children)}else this.deactivateChildRoutes(o,i,s);else u&&this.deactivateRouteAndItsChildren(i,s)}deactivateRouteAndItsChildren(o,i){this.routeReuseStrategy.shouldDetach(o.value.snapshot)?this.detachAndStoreRouteSubtree(o,i):this.deactivateRouteAndOutlet(o,i)}detachAndStoreRouteSubtree(o,i){const s=i.getContext(o.value.outlet),l=s&&o.value.component?s.children:i,u=or(o);for(const h of Object.keys(u))this.deactivateRouteAndItsChildren(u[h],l);if(s&&s.outlet){const h=s.outlet.detach(),d=s.children.onOutletDeactivated();this.routeReuseStrategy.store(o.value.snapshot,{componentRef:h,route:o,contexts:d})}}deactivateRouteAndOutlet(o,i){const s=i.getContext(o.value.outlet),l=s&&o.value.component?s.children:i,u=or(o);for(const h of Object.keys(u))this.deactivateRouteAndItsChildren(u[h],l);s&&s.outlet&&(s.outlet.deactivate(),s.children.onOutletDeactivated(),s.attachRef=null,s.resolver=null,s.route=null)}activateChildRoutes(o,i,s){const l=or(i);o.children.forEach(u=>{this.activateRoutes(u,l[u.value.outlet],s),this.forwardEvent(new xF(u.value.snapshot))}),o.children.length&&this.forwardEvent(new LF(o.value.snapshot))}activateRoutes(o,i,s){const l=o.value,u=i?i.value:null;if(op(l),l===u)if(l.component){const h=s.getOrCreateContext(l.outlet);this.activateChildRoutes(o,i,h.children)}else this.activateChildRoutes(o,i,s);else if(l.component){const h=s.getOrCreateContext(l.outlet);if(this.routeReuseStrategy.shouldAttach(l.snapshot)){const d=this.routeReuseStrategy.retrieve(l.snapshot);this.routeReuseStrategy.store(l.snapshot,null),h.children.onOutletReAttached(d.contexts),h.attachRef=d.componentRef,h.route=d.route.value,h.outlet&&h.outlet.attach(d.componentRef,d.route.value),op(d.route.value),this.activateChildRoutes(o,null,h.children)}else{const d=function(n){for(let o=n.parent;o;o=o.parent){const i=o.routeConfig;if(i&&i._loadedConfig)return i._loadedConfig;if(i&&i.component)return null}return null}(l.snapshot),g=d?d.module.componentFactoryResolver:null;h.attachRef=null,h.route=l,h.resolver=g,h.outlet&&h.outlet.activateWith(l,g),this.activateChildRoutes(o,null,h.children)}}else this.activateChildRoutes(o,null,s)}}class lp{constructor(o,i){this.routes=o,this.module=i}}function Io(n){return"function"==typeof n}function qo(n){return n instanceof Jo}const ks=Symbol("INITIAL_VALUE");function Ls(){return zo(n=>function(...n){const o=pr(n),i=Hp(n),{args:s,keys:l}=nC(n);if(0===s.length)return ze([],o);const u=new Ae(function(n,o,i=bo){return s=>{ry(o,()=>{const{length:l}=n,u=new Array(l);let h=l,d=l;for(let g=0;g<l;g++)ry(o,()=>{const _=ze(n[g],o);let m=!1;_.subscribe(new Ye(s,E=>{u[g]=E,m||(m=!0,d--),d||s.next(i(u.slice()))},()=>{--h||s.complete()}))},s)},s)}}(s,o,l?h=>iC(l,h):bo));return i?u.pipe(oC(i)):u}(n.map(o=>o.pipe(Bs(1),function(...n){const o=pr(n);return et((i,s)=>{(o?Jd(n,i,o):Jd(n,i)).subscribe(s)})}(ks)))).pipe(ly((o,i)=>{let s=!1;return i.reduce((l,u,h)=>l!==ks?l:(u===ks&&(s=!0),s||!1!==u&&h!==i.length-1&&!qo(u)?l:u),o)},ks),er(o=>o!==ks),Ee(o=>qo(o)?o:!0===o),Bs(1)))}class S1{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Ps,this.attachRef=null}}class Ps{constructor(){this.contexts=new Map}onChildOutletCreated(o,i){const s=this.getOrCreateContext(o);s.outlet=i,this.contexts.set(o,s)}onChildOutletDestroyed(o){const i=this.getContext(o);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const o=this.contexts;return this.contexts=new Map,o}onOutletReAttached(o){this.contexts=o}getOrCreateContext(o){let i=this.getContext(o);return i||(i=new S1,this.contexts.set(o,i)),i}getContext(o){return this.contexts.get(o)||null}}let up=(()=>{class n{constructor(i,s,l,u,h){this.parentContexts=i,this.location=s,this.resolver=l,this.changeDetector=h,this.activated=null,this._activatedRoute=null,this.activateEvents=new Le,this.deactivateEvents=new Le,this.attachEvents=new Le,this.detachEvents=new Le,this.name=u||le,i.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const i=this.parentContexts.getContext(this.name);i&&i.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,s){this.activated=i,this._activatedRoute=s,this.location.insert(i.hostView),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){const i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,s){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=i;const h=(s=s||this.resolver).resolveComponentFactory(i._futureSnapshot.routeConfig.component),d=this.parentContexts.getOrCreateContext(this.name).children,g=new I1(i,d,this.location.injector);this.activated=this.location.createComponent(h,this.location.length,g),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(i){return new(i||n)(O(Ps),O(ln),O(Ho),function(n){return function(n,o){if("class"===o)return n.classes;if("style"===o)return n.styles;const i=n.attrs;if(i){const s=i.length;let l=0;for(;l<s;){const u=i[l];if(yg(u))break;if(0===u)l+=2;else if("number"==typeof u)for(l++;l<s&&"string"==typeof i[l];)l++;else{if(u===o)return i[l+1];l+=2}}}return null}(He(),n)}("name"),O(wh))},n.\u0275dir=Y({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class I1{constructor(o,i,s){this.route=o,this.childContexts=i,this.parent=s}get(o,i){return o===ir?this.route:o===Ps?this.childContexts:this.parent.get(o,i)}}let By=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=fr({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(i,s){1&i&&Ma(0,"router-outlet")},directives:[up],encapsulation:2}),n})();function Hy(n,o=""){for(let i=0;i<n.length;i++){const s=n[i];b1(s,R1(o,s))}}function b1(n,o){n.children&&Hy(n.children,o)}function R1(n,o){return o?n||o.path?n&&!o.path?`${n}/`:!n&&o.path?o.path:`${n}/${o.path}`:"":n}function cp(n){const o=n.children&&n.children.map(cp),i=o?Qe(H({},n),{children:o}):H({},n);return!i.component&&(o||i.loadChildren)&&i.outlet&&i.outlet!==le&&(i.component=By),i}function Jt(n){return n.outlet||le}function Gy(n,o){const i=n.filter(s=>Jt(s)===o);return i.push(...n.filter(s=>Jt(s)!==o)),i}const Wy={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Gl(n,o,i){var d;if(""===o.path)return"full"===o.pathMatch&&(n.hasChildren()||i.length>0)?H({},Wy):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const l=(o.matcher||UF)(i,n,o);if(!l)return H({},Wy);const u={};ot(l.posParams,(g,_)=>{u[_]=g.path});const h=l.consumed.length>0?H(H({},u),l.consumed[l.consumed.length-1].parameters):u;return{matched:!0,consumedSegments:l.consumed,lastChild:l.consumed.length,parameters:h,positionalParamSegments:null!=(d=l.posParams)?d:{}}}function Wl(n,o,i,s,l="corrected"){if(i.length>0&&function(n,o,i){return i.some(s=>jl(n,o,s)&&Jt(s)!==le)}(n,i,s)){const h=new ce(o,function(n,o,i,s){const l={};l[le]=s,s._sourceSegment=n,s._segmentIndexShift=o.length;for(const u of i)if(""===u.path&&Jt(u)!==le){const h=new ce([],{});h._sourceSegment=n,h._segmentIndexShift=o.length,l[Jt(u)]=h}return l}(n,o,s,new ce(i,n.children)));return h._sourceSegment=n,h._segmentIndexShift=o.length,{segmentGroup:h,slicedSegments:[]}}if(0===i.length&&function(n,o,i){return i.some(s=>jl(n,o,s))}(n,i,s)){const h=new ce(n.segments,function(n,o,i,s,l,u){const h={};for(const d of s)if(jl(n,i,d)&&!l[Jt(d)]){const g=new ce([],{});g._sourceSegment=n,g._segmentIndexShift="legacy"===u?n.segments.length:o.length,h[Jt(d)]=g}return H(H({},l),h)}(n,o,i,s,n.children,l));return h._sourceSegment=n,h._segmentIndexShift=o.length,{segmentGroup:h,slicedSegments:i}}const u=new ce(n.segments,n.children);return u._sourceSegment=n,u._segmentIndexShift=o.length,{segmentGroup:u,slicedSegments:i}}function jl(n,o,i){return(!(n.hasChildren()||o.length>0)||"full"!==i.pathMatch)&&""===i.path}function jy(n,o,i,s){return!!(Jt(n)===s||s!==le&&jl(o,i,n))&&("**"===n.path||Gl(o,n,i).matched)}function Xy(n,o,i){return 0===o.length&&!n.children[i]}class xs{constructor(o){this.segmentGroup=o||null}}class Yy{constructor(o){this.urlTree=o}}function Xl(n){return new Ae(o=>o.error(new xs(n)))}function Ky(n){return new Ae(o=>o.error(new Yy(n)))}function M1(n){return new Ae(o=>o.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${n}'`)))}class L1{constructor(o,i,s,l,u){this.configLoader=i,this.urlSerializer=s,this.urlTree=l,this.config=u,this.allowRedirects=!0,this.ngModule=o.get(On)}apply(){const o=Wl(this.urlTree.root,[],[],this.config).segmentGroup,i=new ce(o.segments,o.children);return this.expandSegmentGroup(this.ngModule,this.config,i,le).pipe(Ee(u=>this.createUrlTree(hp(u),this.urlTree.queryParams,this.urlTree.fragment))).pipe(So(u=>{if(u instanceof Yy)return this.allowRedirects=!1,this.match(u.urlTree);throw u instanceof xs?this.noMatchError(u):u}))}match(o){return this.expandSegmentGroup(this.ngModule,this.config,o.root,le).pipe(Ee(l=>this.createUrlTree(hp(l),o.queryParams,o.fragment))).pipe(So(l=>{throw l instanceof xs?this.noMatchError(l):l}))}noMatchError(o){return new Error(`Cannot match any routes. URL Segment: '${o.segmentGroup}'`)}createUrlTree(o,i,s){const l=o.segments.length>0?new ce([],{[le]:o}):o;return new Jo(l,i,s)}expandSegmentGroup(o,i,s,l){return 0===s.segments.length&&s.hasChildren()?this.expandChildren(o,i,s).pipe(Ee(u=>new ce([],u))):this.expandSegment(o,s,i,s.segments,l,!0)}expandChildren(o,i,s){const l=[];for(const u of Object.keys(s.children))"primary"===u?l.unshift(u):l.push(u);return ze(l).pipe(Ds(u=>{const h=s.children[u],d=Gy(i,u);return this.expandSegmentGroup(o,d,h,u).pipe(Ee(g=>({segment:g,outlet:u})))}),ly((u,h)=>(u[h.outlet]=h.segment,u),{}),function(n,o){const i=arguments.length>=2;return s=>s.pipe(n?er((l,u)=>n(l,u,s)):bo,$d(1),i?cy(o):uy(()=>new kl))}())}expandSegment(o,i,s,l,u,h){return ze(s).pipe(Ds(d=>this.expandSegmentAgainstRoute(o,i,s,d,l,u,h).pipe(So(_=>{if(_ instanceof xs)return ne(null);throw _}))),tr(d=>!!d),So((d,g)=>{if(d instanceof kl||"EmptyError"===d.name){if(Xy(i,l,u))return ne(new ce([],{}));throw new xs(i)}throw d}))}expandSegmentAgainstRoute(o,i,s,l,u,h,d){return jy(l,i,u,h)?void 0===l.redirectTo?this.matchSegmentAgainstRoute(o,i,l,u,h):d&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(o,i,s,l,u,h):Xl(i):Xl(i)}expandSegmentAgainstRouteUsingRedirect(o,i,s,l,u,h){return"**"===l.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(o,s,l,h):this.expandRegularSegmentAgainstRouteUsingRedirect(o,i,s,l,u,h)}expandWildCardWithParamsAgainstRouteUsingRedirect(o,i,s,l){const u=this.applyRedirectCommands([],s.redirectTo,{});return s.redirectTo.startsWith("/")?Ky(u):this.lineralizeSegments(s,u).pipe(Ke(h=>{const d=new ce(h,{});return this.expandSegment(o,d,i,h,l,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(o,i,s,l,u,h){const{matched:d,consumedSegments:g,lastChild:_,positionalParamSegments:m}=Gl(i,l,u);if(!d)return Xl(i);const E=this.applyRedirectCommands(g,l.redirectTo,m);return l.redirectTo.startsWith("/")?Ky(E):this.lineralizeSegments(l,E).pipe(Ke(v=>this.expandSegment(o,i,s,v.concat(u.slice(_)),h,!1)))}matchSegmentAgainstRoute(o,i,s,l,u){if("**"===s.path)return s.loadChildren?(s._loadedConfig?ne(s._loadedConfig):this.configLoader.load(o.injector,s)).pipe(Ee(v=>(s._loadedConfig=v,new ce(l,{})))):ne(new ce(l,{}));const{matched:h,consumedSegments:d,lastChild:g}=Gl(i,s,l);if(!h)return Xl(i);const _=l.slice(g);return this.getChildConfig(o,s,l).pipe(Ke(E=>{const v=E.module,C=E.routes,{segmentGroup:S,slicedSegments:b}=Wl(i,d,_,C),I=new ce(S.segments,S.children);if(0===b.length&&I.hasChildren())return this.expandChildren(v,C,I).pipe(Ee(V=>new ce(d,V)));if(0===C.length&&0===b.length)return ne(new ce(d,{}));const A=Jt(s)===u;return this.expandSegment(v,I,C,b,A?le:u,!0).pipe(Ee(x=>new ce(d.concat(x.segments),x.children)))}))}getChildConfig(o,i,s){return i.children?ne(new lp(i.children,o)):i.loadChildren?void 0!==i._loadedConfig?ne(i._loadedConfig):this.runCanLoadGuards(o.injector,i,s).pipe(Ke(l=>{return l?this.configLoader.load(o.injector,i).pipe(Ee(u=>(i._loadedConfig=u,u))):(n=i,new Ae(o=>o.error(Zd(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`))));var n})):ne(new lp([],o))}runCanLoadGuards(o,i,s){const l=i.canLoad;return l&&0!==l.length?ne(l.map(h=>{const d=o.get(h);let g;if((n=d)&&Io(n.canLoad))g=d.canLoad(i,s);else{if(!Io(d))throw new Error("Invalid CanLoad guard");g=d(i,s)}var n;return Ln(g)})).pipe(Ls(),Lt(h=>{if(!qo(h))return;const d=Zd(`Redirecting to "${this.urlSerializer.serialize(h)}"`);throw d.url=h,d}),Ee(h=>!0===h)):ne(!0)}lineralizeSegments(o,i){let s=[],l=i.root;for(;;){if(s=s.concat(l.segments),0===l.numberOfChildren)return ne(s);if(l.numberOfChildren>1||!l.children[le])return M1(o.redirectTo);l=l.children[le]}}applyRedirectCommands(o,i,s){return this.applyRedirectCreatreUrlTree(i,this.urlSerializer.parse(i),o,s)}applyRedirectCreatreUrlTree(o,i,s,l){const u=this.createSegmentGroup(o,i.root,s,l);return new Jo(u,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(o,i){const s={};return ot(o,(l,u)=>{if("string"==typeof l&&l.startsWith(":")){const d=l.substring(1);s[u]=i[d]}else s[u]=l}),s}createSegmentGroup(o,i,s,l){const u=this.createSegments(o,i.segments,s,l);let h={};return ot(i.children,(d,g)=>{h[g]=this.createSegmentGroup(o,d,s,l)}),new ce(u,h)}createSegments(o,i,s,l){return i.map(u=>u.path.startsWith(":")?this.findPosParam(o,u,l):this.findOrReturn(u,s))}findPosParam(o,i,s){const l=s[i.path.substring(1)];if(!l)throw new Error(`Cannot redirect to '${o}'. Cannot find '${i.path}'.`);return l}findOrReturn(o,i){let s=0;for(const l of i){if(l.path===o.path)return i.splice(s),l;s++}return o}}function hp(n){const o={};for(const s of Object.keys(n.children)){const u=hp(n.children[s]);(u.segments.length>0||u.hasChildren())&&(o[s]=u)}return function(n){if(1===n.numberOfChildren&&n.children[le]){const o=n.children[le];return new ce(n.segments.concat(o.segments),o.children)}return n}(new ce(n.segments,o))}class zy{constructor(o){this.path=o,this.route=this.path[this.path.length-1]}}class Yl{constructor(o,i){this.component=o,this.route=i}}function F1(n,o,i){const s=n._root;return Fs(s,o?o._root:null,i,[s.value])}function Kl(n,o,i){const s=function(n){if(!n)return null;for(let o=n.parent;o;o=o.parent){const i=o.routeConfig;if(i&&i._loadedConfig)return i._loadedConfig}return null}(o);return(s?s.module.injector:i).get(n)}function Fs(n,o,i,s,l={canDeactivateChecks:[],canActivateChecks:[]}){const u=or(o);return n.children.forEach(h=>{(function(n,o,i,s,l={canDeactivateChecks:[],canActivateChecks:[]}){const u=n.value,h=o?o.value:null,d=i?i.getContext(n.value.outlet):null;if(h&&u.routeConfig===h.routeConfig){const g=function(n,o,i){if("function"==typeof i)return i(n,o);switch(i){case"pathParamsChange":return!$o(n.url,o.url);case"pathParamsOrQueryParamsChange":return!$o(n.url,o.url)||!kn(n.queryParams,o.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ip(n,o)||!kn(n.queryParams,o.queryParams);default:return!ip(n,o)}}(h,u,u.routeConfig.runGuardsAndResolvers);g?l.canActivateChecks.push(new zy(s)):(u.data=h.data,u._resolvedData=h._resolvedData),Fs(n,o,u.component?d?d.children:null:i,s,l),g&&d&&d.outlet&&d.outlet.isActivated&&l.canDeactivateChecks.push(new Yl(d.outlet.component,h))}else h&&Vs(o,d,l),l.canActivateChecks.push(new zy(s)),Fs(n,null,u.component?d?d.children:null:i,s,l)})(h,u[h.value.outlet],i,s.concat([h.value]),l),delete u[h.value.outlet]}),ot(u,(h,d)=>Vs(h,i.getContext(d),l)),l}function Vs(n,o,i){const s=or(n),l=n.value;ot(s,(u,h)=>{Vs(u,l.component?o?o.children.getContext(h):null:o,i)}),i.canDeactivateChecks.push(new Yl(l.component&&o&&o.outlet&&o.outlet.isActivated?o.outlet.component:null,l))}class $1{}function Jy(n){return new Ae(o=>o.error(n))}class Z1{constructor(o,i,s,l,u,h){this.rootComponentType=o,this.config=i,this.urlTree=s,this.url=l,this.paramsInheritanceStrategy=u,this.relativeLinkResolution=h}recognize(){const o=Wl(this.urlTree.root,[],[],this.config.filter(h=>void 0===h.redirectTo),this.relativeLinkResolution).segmentGroup,i=this.processSegmentGroup(this.config,o,le);if(null===i)return null;const s=new Ul([],Object.freeze({}),Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,{},le,this.rootComponentType,null,this.urlTree.root,-1,{}),l=new to(s,i),u=new ky(this.url,l);return this.inheritParamsAndData(u._root),u}inheritParamsAndData(o){const i=o.value,s=Ny(i,this.paramsInheritanceStrategy);i.params=Object.freeze(s.params),i.data=Object.freeze(s.data),o.children.forEach(l=>this.inheritParamsAndData(l))}processSegmentGroup(o,i,s){return 0===i.segments.length&&i.hasChildren()?this.processChildren(o,i):this.processSegment(o,i,i.segments,s)}processChildren(o,i){const s=[];for(const u of Object.keys(i.children)){const h=i.children[u],d=Gy(o,u),g=this.processSegmentGroup(d,h,u);if(null===g)return null;s.push(...g)}const l=$y(s);return l.sort((o,i)=>o.value.outlet===le?-1:i.value.outlet===le?1:o.value.outlet.localeCompare(i.value.outlet)),l}processSegment(o,i,s,l){for(const u of o){const h=this.processSegmentAgainstRoute(u,i,s,l);if(null!==h)return h}return Xy(i,s,l)?[]:null}processSegmentAgainstRoute(o,i,s,l){if(o.redirectTo||!jy(o,i,s,l))return null;let u,h=[],d=[];if("**"===o.path){const C=s.length>0?Ey(s).parameters:{};u=new Ul(s,C,Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,Qy(o),Jt(o),o.component,o,qy(i),Zy(i)+s.length,eS(o))}else{const C=Gl(i,o,s);if(!C.matched)return null;h=C.consumedSegments,d=s.slice(C.lastChild),u=new Ul(h,C.parameters,Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,Qy(o),Jt(o),o.component,o,qy(i),Zy(i)+h.length,eS(o))}const g=(n=o).children?n.children:n.loadChildren?n._loadedConfig.routes:[],{segmentGroup:_,slicedSegments:m}=Wl(i,h,d,g.filter(C=>void 0===C.redirectTo),this.relativeLinkResolution);var n;if(0===m.length&&_.hasChildren()){const C=this.processChildren(g,_);return null===C?null:[new to(u,C)]}if(0===g.length&&0===m.length)return[new to(u,[])];const E=Jt(o)===l,v=this.processSegment(g,_,m,E?le:l);return null===v?null:[new to(u,v)]}}function tV(n){const o=n.value.routeConfig;return o&&""===o.path&&void 0===o.redirectTo}function $y(n){const o=[],i=new Set;for(const s of n){if(!tV(s)){o.push(s);continue}const l=o.find(u=>s.value.routeConfig===u.value.routeConfig);void 0!==l?(l.children.push(...s.children),i.add(l)):o.push(s)}for(const s of i){const l=$y(s.children);o.push(new to(s.value,l))}return o.filter(s=>!i.has(s))}function qy(n){let o=n;for(;o._sourceSegment;)o=o._sourceSegment;return o}function Zy(n){let o=n,i=o._segmentIndexShift?o._segmentIndexShift:0;for(;o._sourceSegment;)o=o._sourceSegment,i+=o._segmentIndexShift?o._segmentIndexShift:0;return i-1}function Qy(n){return n.data||{}}function eS(n){return n.resolve||{}}function dp(n){return zo(o=>{const i=n(o);return i?ze(i).pipe(Ee(()=>o)):ne(o)})}class uV extends class{shouldDetach(o){return!1}store(o,i){}shouldAttach(o){return!1}retrieve(o){return null}shouldReuseRoute(o,i){return o.routeConfig===i.routeConfig}}{}const pp=new ae("ROUTES");class tS{constructor(o,i,s,l){this.injector=o,this.compiler=i,this.onLoadStartListener=s,this.onLoadEndListener=l}load(o,i){if(i._loader$)return i._loader$;this.onLoadStartListener&&this.onLoadStartListener(i);const l=this.loadModuleFactory(i.loadChildren).pipe(Ee(u=>{this.onLoadEndListener&&this.onLoadEndListener(i);const h=u.create(o);return new lp(my(h.injector.get(pp,void 0,W.Self|W.Optional)).map(cp),h)}),So(u=>{throw i._loader$=void 0,u}));return i._loader$=new CF(l,()=>new xn).pipe(ay()),i._loader$}loadModuleFactory(o){return Ln(o()).pipe(Ke(i=>i instanceof LE?ne(i):ze(this.compiler.compileModuleAsync(i))))}}class hV{shouldProcessUrl(o){return!0}extract(o){return o}merge(o,i){return o}}function dV(n){throw n}function pV(n,o,i){return o.parse("/")}function nS(n,o){return ne(null)}const gV={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},fV={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Pt=(()=>{class n{constructor(i,s,l,u,h,d,g){this.rootComponentType=i,this.urlSerializer=s,this.rootContexts=l,this.location=u,this.config=g,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new xn,this.errorHandler=dV,this.malformedUriErrorHandler=pV,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:nS,afterPreactivation:nS},this.urlHandlingStrategy=new hV,this.routeReuseStrategy=new uV,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=h.get(On),this.console=h.get(Ka);const E=h.get(Ve);this.isNgZoneEnabled=E instanceof Ve&&Ve.isInAngularZone(),this.resetConfig(g),this.currentUrlTree=new Jo(new ce([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new tS(h,d,v=>this.triggerEvent(new dy(v)),v=>this.triggerEvent(new py(v))),this.routerState=My(this.currentUrlTree,this.rootComponentType),this.transitions=new _n({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var i;return null==(i=this.location.getState())?void 0:i.\u0275routerPageId}setupNavigations(i){const s=this.events;return i.pipe(er(l=>0!==l.id),Ee(l=>Qe(H({},l),{extractedUrl:this.urlHandlingStrategy.extract(l.rawUrl)})),zo(l=>{let u=!1,h=!1;return ne(l).pipe(Lt(d=>{this.currentNavigation={id:d.id,initialUrl:d.currentRawUrl,extractedUrl:d.extractedUrl,trigger:d.source,extras:d.extras,previousNavigation:this.lastSuccessfulNavigation?Qe(H({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),zo(d=>{const g=this.browserUrlTree.toString(),_=!this.navigated||d.extractedUrl.toString()!==g||g!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||_)&&this.urlHandlingStrategy.shouldProcessUrl(d.rawUrl))return zl(d.source)&&(this.browserUrlTree=d.extractedUrl),ne(d).pipe(zo(E=>{const v=this.transitions.getValue();return s.next(new qd(E.id,this.serializeUrl(E.extractedUrl),E.source,E.restoredState)),v!==this.transitions.getValue()?Vn:Promise.resolve(E)}),function(n,o,i,s){return zo(l=>function(n,o,i,s,l){return new L1(n,o,i,s,l).apply()}(n,o,i,l.extractedUrl,s).pipe(Ee(u=>Qe(H({},l),{urlAfterRedirects:u}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Lt(E=>{this.currentNavigation=Qe(H({},this.currentNavigation),{finalUrl:E.urlAfterRedirects})}),function(n,o,i,s,l){return Ke(u=>function(n,o,i,s,l="emptyOnly",u="legacy"){try{const h=new Z1(n,o,i,s,l,u).recognize();return null===h?Jy(new $1):ne(h)}catch(h){return Jy(h)}}(n,o,u.urlAfterRedirects,i(u.urlAfterRedirects),s,l).pipe(Ee(h=>Qe(H({},u),{targetSnapshot:h}))))}(this.rootComponentType,this.config,E=>this.serializeUrl(E),this.paramsInheritanceStrategy,this.relativeLinkResolution),Lt(E=>{if("eager"===this.urlUpdateStrategy){if(!E.extras.skipLocationChange){const C=this.urlHandlingStrategy.merge(E.urlAfterRedirects,E.rawUrl);this.setBrowserUrl(C,E)}this.browserUrlTree=E.urlAfterRedirects}const v=new AF(E.id,this.serializeUrl(E.extractedUrl),this.serializeUrl(E.urlAfterRedirects),E.targetSnapshot);s.next(v)}));if(_&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:v,extractedUrl:C,source:S,restoredState:b,extras:I}=d,A=new qd(v,this.serializeUrl(C),S,b);s.next(A);const R=My(C,this.rootComponentType).snapshot;return ne(Qe(H({},d),{targetSnapshot:R,urlAfterRedirects:C,extras:Qe(H({},I),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=d.rawUrl,d.resolve(null),Vn}),dp(d=>{const{targetSnapshot:g,id:_,extractedUrl:m,rawUrl:E,extras:{skipLocationChange:v,replaceUrl:C}}=d;return this.hooks.beforePreactivation(g,{navigationId:_,appliedUrlTree:m,rawUrlTree:E,skipLocationChange:!!v,replaceUrl:!!C})}),Lt(d=>{const g=new wF(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);this.triggerEvent(g)}),Ee(d=>Qe(H({},d),{guards:F1(d.targetSnapshot,d.currentSnapshot,this.rootContexts)})),function(n,o){return Ke(i=>{const{targetSnapshot:s,currentSnapshot:l,guards:{canActivateChecks:u,canDeactivateChecks:h}}=i;return 0===h.length&&0===u.length?ne(Qe(H({},i),{guardsResult:!0})):function(n,o,i,s){return ze(n).pipe(Ke(l=>function(n,o,i,s,l){const u=o&&o.routeConfig?o.routeConfig.canDeactivate:null;return u&&0!==u.length?ne(u.map(d=>{const g=Kl(d,o,l);let _;if(function(n){return n&&Io(n.canDeactivate)}(g))_=Ln(g.canDeactivate(n,o,i,s));else{if(!Io(g))throw new Error("Invalid CanDeactivate guard");_=Ln(g(n,o,i,s))}return _.pipe(tr())})).pipe(Ls()):ne(!0)}(l.component,l.route,i,o,s)),tr(l=>!0!==l,!0))}(h,s,l,n).pipe(Ke(d=>d&&function(n){return"boolean"==typeof n}(d)?function(n,o,i,s){return ze(o).pipe(Ds(l=>Jd(function(n,o){return null!==n&&o&&o(new kF(n)),ne(!0)}(l.route.parent,s),function(n,o){return null!==n&&o&&o(new PF(n)),ne(!0)}(l.route,s),function(n,o,i){const s=o[o.length-1],u=o.slice(0,o.length-1).reverse().map(h=>function(n){const o=n.routeConfig?n.routeConfig.canActivateChild:null;return o&&0!==o.length?{node:n,guards:o}:null}(h)).filter(h=>null!==h).map(h=>sy(()=>ne(h.guards.map(g=>{const _=Kl(g,h.node,i);let m;if(function(n){return n&&Io(n.canActivateChild)}(_))m=Ln(_.canActivateChild(s,n));else{if(!Io(_))throw new Error("Invalid CanActivateChild guard");m=Ln(_(s,n))}return m.pipe(tr())})).pipe(Ls())));return ne(u).pipe(Ls())}(n,l.path,i),function(n,o,i){const s=o.routeConfig?o.routeConfig.canActivate:null;if(!s||0===s.length)return ne(!0);const l=s.map(u=>sy(()=>{const h=Kl(u,o,i);let d;if(function(n){return n&&Io(n.canActivate)}(h))d=Ln(h.canActivate(o,n));else{if(!Io(h))throw new Error("Invalid CanActivate guard");d=Ln(h(o,n))}return d.pipe(tr())}));return ne(l).pipe(Ls())}(n,l.route,i))),tr(l=>!0!==l,!0))}(s,u,n,o):ne(d)),Ee(d=>Qe(H({},i),{guardsResult:d})))})}(this.ngModule.injector,d=>this.triggerEvent(d)),Lt(d=>{if(qo(d.guardsResult)){const _=Zd(`Redirecting to "${this.serializeUrl(d.guardsResult)}"`);throw _.url=d.guardsResult,_}const g=new OF(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot,!!d.guardsResult);this.triggerEvent(g)}),er(d=>!!d.guardsResult||(this.restoreHistory(d),this.cancelNavigationTransition(d,""),!1)),dp(d=>{if(d.guards.canActivateChecks.length)return ne(d).pipe(Lt(g=>{const _=new MF(g.id,this.serializeUrl(g.extractedUrl),this.serializeUrl(g.urlAfterRedirects),g.targetSnapshot);this.triggerEvent(_)}),zo(g=>{let _=!1;return ne(g).pipe(function(n,o){return Ke(i=>{const{targetSnapshot:s,guards:{canActivateChecks:l}}=i;if(!l.length)return ne(i);let u=0;return ze(l).pipe(Ds(h=>function(n,o,i,s){return function(n,o,i,s){const l=Object.keys(n);if(0===l.length)return ne({});const u={};return ze(l).pipe(Ke(h=>function(n,o,i,s){const l=Kl(n,o,s);return Ln(l.resolve?l.resolve(o,i):l(o,i))}(n[h],o,i,s).pipe(Lt(d=>{u[h]=d}))),$d(1),Ke(()=>Object.keys(u).length===l.length?ne(u):Vn))}(n._resolve,n,o,s).pipe(Ee(u=>(n._resolvedData=u,n.data=H(H({},n.data),Ny(n,i).resolve),null)))}(h.route,s,n,o)),Lt(()=>u++),$d(1),Ke(h=>u===l.length?ne(i):Vn))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Lt({next:()=>_=!0,complete:()=>{_||(this.restoreHistory(g),this.cancelNavigationTransition(g,"At least one route resolver didn't emit any value."))}}))}),Lt(g=>{const _=new NF(g.id,this.serializeUrl(g.extractedUrl),this.serializeUrl(g.urlAfterRedirects),g.targetSnapshot);this.triggerEvent(_)}))}),dp(d=>{const{targetSnapshot:g,id:_,extractedUrl:m,rawUrl:E,extras:{skipLocationChange:v,replaceUrl:C}}=d;return this.hooks.afterPreactivation(g,{navigationId:_,appliedUrlTree:m,rawUrlTree:E,skipLocationChange:!!v,replaceUrl:!!C})}),Ee(d=>{const g=function(n,o,i){const s=Ms(n,o._root,i?i._root:void 0);return new Oy(s,o)}(this.routeReuseStrategy,d.targetSnapshot,d.currentRouterState);return Qe(H({},d),{targetRouterState:g})}),Lt(d=>{this.currentUrlTree=d.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl),this.routerState=d.targetRouterState,"deferred"===this.urlUpdateStrategy&&(d.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,d),this.browserUrlTree=d.urlAfterRedirects)}),((n,o,i)=>Ee(s=>(new _1(o,s.targetRouterState,s.currentRouterState,i).activate(n),s)))(this.rootContexts,this.routeReuseStrategy,d=>this.triggerEvent(d)),Lt({next(){u=!0},complete(){u=!0}}),function(n){return et((o,i)=>{try{o.subscribe(i)}finally{i.add(n)}})}(()=>{var d;u||h||this.cancelNavigationTransition(l,`Navigation ID ${l.id} is not equal to the current navigation id ${this.navigationId}`),(null==(d=this.currentNavigation)?void 0:d.id)===l.id&&(this.currentNavigation=null)}),So(d=>{if(h=!0,function(n){return n&&n[fy]}(d)){const g=qo(d.url);g||(this.navigated=!0,this.restoreHistory(l,!0));const _=new hy(l.id,this.serializeUrl(l.extractedUrl),d.message);s.next(_),g?setTimeout(()=>{const m=this.urlHandlingStrategy.merge(d.url,this.rawUrlTree),E={skipLocationChange:l.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||zl(l.source)};this.scheduleNavigation(m,"imperative",null,E,{resolve:l.resolve,reject:l.reject,promise:l.promise})},0):l.resolve(!1)}else{this.restoreHistory(l,!0);const g=new DF(l.id,this.serializeUrl(l.extractedUrl),d);s.next(g);try{l.resolve(this.errorHandler(d))}catch(_){l.reject(_)}}return Vn}))}))}resetRootComponentType(i){this.rootComponentType=i,this.routerState.root.component=this.rootComponentType}setTransition(i){this.transitions.next(H(H({},this.transitions.value),i))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(i=>{const s="popstate"===i.type?"popstate":"hashchange";"popstate"===s&&setTimeout(()=>{var d;const l={replaceUrl:!0},u=(null==(d=i.state)?void 0:d.navigationId)?i.state:null;if(u){const g=H({},u);delete g.navigationId,delete g.\u0275routerPageId,0!==Object.keys(g).length&&(l.state=g)}const h=this.parseUrl(i.url);this.scheduleNavigation(h,s,u,l)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(i){this.events.next(i)}resetConfig(i){Hy(i),this.config=i.map(cp),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(i,s={}){const{relativeTo:l,queryParams:u,fragment:h,queryParamsHandling:d,preserveFragment:g}=s,_=l||this.routerState.root,m=g?this.currentUrlTree.fragment:h;let E=null;switch(d){case"merge":E=H(H({},this.currentUrlTree.queryParams),u);break;case"preserve":E=this.currentUrlTree.queryParams;break;default:E=u||null}return null!==E&&(E=this.removeEmptyProps(E)),function(n,o,i,s,l){if(0===i.length)return rp(o.root,o.root,o,s,l);const u=function(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new xy(!0,0,n);let o=0,i=!1;const s=n.reduce((l,u,h)=>{if("object"==typeof u&&null!=u){if(u.outlets){const d={};return ot(u.outlets,(g,_)=>{d[_]="string"==typeof g?g.split("/"):g}),[...l,{outlets:d}]}if(u.segmentPath)return[...l,u.segmentPath]}return"string"!=typeof u?[...l,u]:0===h?(u.split("/").forEach((d,g)=>{0==g&&"."===d||(0==g&&""===d?i=!0:".."===d?o++:""!=d&&l.push(d))}),l):[...l,u]},[]);return new xy(i,o,s)}(i);if(u.toRoot())return rp(o.root,new ce([],{}),o,s,l);const h=function(n,o,i){if(n.isAbsolute)return new sp(o.root,!0,0);if(-1===i.snapshot._lastPathIndex){const u=i.snapshot._urlSegment;return new sp(u,u===o.root,0)}const s=Bl(n.commands[0])?0:1;return function(n,o,i){let s=n,l=o,u=i;for(;u>l;){if(u-=l,s=s.parent,!s)throw new Error("Invalid number of '../'");l=s.segments.length}return new sp(s,!1,l-u)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+s,n.numberOfDoubleDots)}(u,o,n),d=h.processChildren?Hl(h.segmentGroup,h.index,u.commands):Fy(h.segmentGroup,h.index,u.commands);return rp(h.segmentGroup,d,o,s,l)}(_,this.currentUrlTree,i,E,null!=m?m:null)}navigateByUrl(i,s={skipLocationChange:!1}){const l=qo(i)?i:this.parseUrl(i),u=this.urlHandlingStrategy.merge(l,this.rawUrlTree);return this.scheduleNavigation(u,"imperative",null,s)}navigate(i,s={skipLocationChange:!1}){return function(n){for(let o=0;o<n.length;o++){const i=n[o];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${o}`)}}(i),this.navigateByUrl(this.createUrlTree(i,s),s)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){let s;try{s=this.urlSerializer.parse(i)}catch(l){s=this.malformedUriErrorHandler(l,this.urlSerializer,i)}return s}isActive(i,s){let l;if(l=!0===s?H({},gV):!1===s?H({},fV):s,qo(i))return vy(this.currentUrlTree,i,l);const u=this.parseUrl(i);return vy(this.currentUrlTree,u,l)}removeEmptyProps(i){return Object.keys(i).reduce((s,l)=>{const u=i[l];return null!=u&&(s[l]=u),s},{})}processNavigations(){this.navigations.subscribe(i=>{this.navigated=!0,this.lastSuccessfulId=i.id,this.currentPageId=i.targetPageId,this.events.next(new As(i.id,this.serializeUrl(i.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,i.resolve(!0)},i=>{this.console.warn(`Unhandled Navigation Error: ${i}`)})}scheduleNavigation(i,s,l,u,h){var A,R,x;if(this.disposed)return Promise.resolve(!1);const d=this.transitions.value,g=zl(s)&&d&&!zl(d.source),_=d.rawUrl.toString()===i.toString(),m=d.id===(null==(A=this.currentNavigation)?void 0:A.id);if(g&&_&&m)return Promise.resolve(!0);let v,C,S;h?(v=h.resolve,C=h.reject,S=h.promise):S=new Promise((V,Q)=>{v=V,C=Q});const b=++this.navigationId;let I;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(l=this.location.getState()),I=l&&l.\u0275routerPageId?l.\u0275routerPageId:u.replaceUrl||u.skipLocationChange?null!=(R=this.browserPageId)?R:0:(null!=(x=this.browserPageId)?x:0)+1):I=0,this.setTransition({id:b,targetPageId:I,source:s,restoredState:l,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:i,extras:u,resolve:v,reject:C,promise:S,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),S.catch(V=>Promise.reject(V))}setBrowserUrl(i,s){const l=this.urlSerializer.serialize(i),u=H(H({},s.extras.state),this.generateNgRouterState(s.id,s.targetPageId));this.location.isCurrentPathEqualTo(l)||s.extras.replaceUrl?this.location.replaceState(l,"",u):this.location.go(l,"",u)}restoreHistory(i,s=!1){var l,u;if("computed"===this.canceledNavigationResolution){const h=this.currentPageId-i.targetPageId;"popstate"!==i.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null==(l=this.currentNavigation)?void 0:l.finalUrl)||0===h?this.currentUrlTree===(null==(u=this.currentNavigation)?void 0:u.finalUrl)&&0===h&&(this.resetState(i),this.browserUrlTree=i.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(h)}else"replace"===this.canceledNavigationResolution&&(s&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=i.currentRouterState,this.currentUrlTree=i.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(i,s){const l=new hy(i.id,this.serializeUrl(i.extractedUrl),s);this.triggerEvent(l),i.resolve(!1)}generateNgRouterState(i,s){return"computed"===this.canceledNavigationResolution?{navigationId:i,\u0275routerPageId:s}:{navigationId:i}}}return n.\u0275fac=function(i){Bc()},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();function zl(n){return"imperative"!==n}class oS{}class iS{preload(o,i){return ne(null)}}let rS=(()=>{class n{constructor(i,s,l,u){this.router=i,this.injector=l,this.preloadingStrategy=u,this.loader=new tS(l,s,g=>i.triggerEvent(new dy(g)),g=>i.triggerEvent(new py(g)))}setUpPreloading(){this.subscription=this.router.events.pipe(er(i=>i instanceof As),Ds(()=>this.preload())).subscribe(()=>{})}preload(){const i=this.injector.get(On);return this.processRoutes(i,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,s){const l=[];for(const u of s)if(u.loadChildren&&!u.canLoad&&u._loadedConfig){const h=u._loadedConfig;l.push(this.processRoutes(h.module,h.routes))}else u.loadChildren&&!u.canLoad?l.push(this.preloadConfig(i,u)):u.children&&l.push(this.processRoutes(i,u.children));return ze(l).pipe(dr(),Ee(u=>{}))}preloadConfig(i,s){return this.preloadingStrategy.preload(s,()=>(s._loadedConfig?ne(s._loadedConfig):this.loader.load(i.injector,s)).pipe(Ke(u=>(s._loadedConfig=u,this.processRoutes(u.module,u.routes)))))}}return n.\u0275fac=function(i){return new(i||n)(B(Pt),B(za),B(fe),B(oS))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})(),_p=(()=>{class n{constructor(i,s,l={}){this.router=i,this.viewportScroller=s,this.options=l,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},l.scrollPositionRestoration=l.scrollPositionRestoration||"disabled",l.anchorScrolling=l.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(i=>{i instanceof qd?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof As&&(this.lastId=i.id,this.scheduleScrollEvent(i,this.router.parseUrl(i.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(i=>{i instanceof gy&&(i.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(i.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,s){this.router.triggerEvent(new gy(i,"popstate"===this.lastSource?this.store[this.restoredId]:null,s))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(i){Bc()},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();const Zo=new ae("ROUTER_CONFIGURATION"),sS=new ae("ROUTER_FORROOT_GUARD"),vV=[id,{provide:Iy,useClass:by},{provide:Pt,useFactory:function(n,o,i,s,l,u,h={},d,g){const _=new Pt(null,n,o,i,s,l,my(u));return d&&(_.urlHandlingStrategy=d),g&&(_.routeReuseStrategy=g),function(n,o){n.errorHandler&&(o.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(o.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(o.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(o.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(o.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(o.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(o.canceledNavigationResolution=n.canceledNavigationResolution)}(h,_),h.enableTracing&&_.events.subscribe(m=>{var E,v;null==(E=console.group)||E.call(console,`Router Event: ${m.constructor.name}`),console.log(m.toString()),console.log(m),null==(v=console.groupEnd)||v.call(console)}),_},deps:[Iy,Ps,id,fe,za,pp,Zo,[class{},new St],[class{},new St]]},Ps,{provide:ir,useFactory:function(n){return n.routerState.root},deps:[Pt]},rS,iS,class{preload(o,i){return i().pipe(So(()=>ne(null)))}},{provide:Zo,useValue:{enableTracing:!1}}];function CV(){return new Rh("Router",Pt)}let aS=(()=>{class n{constructor(i,s){}static forRoot(i,s){return{ngModule:n,providers:[vV,lS(i),{provide:sS,useFactory:IV,deps:[[Pt,new St,new uo]]},{provide:Zo,useValue:s||{}},{provide:Zi,useFactory:SV,deps:[Yo,[new _i(od),new St],Zo]},{provide:_p,useFactory:yV,deps:[Pt,mP,Zo]},{provide:oS,useExisting:s&&s.preloadingStrategy?s.preloadingStrategy:iS},{provide:Rh,multi:!0,useFactory:CV},[mp,{provide:is,multi:!0,useFactory:AV,deps:[mp]},{provide:uS,useFactory:wV,deps:[mp]},{provide:gT,multi:!0,useExisting:uS}]]}}static forChild(i){return{ngModule:n,providers:[lS(i)]}}}return n.\u0275fac=function(i){return new(i||n)(B(sS,8),B(Pt,8))},n.\u0275mod=En({type:n}),n.\u0275inj=xt({}),n})();function yV(n,o,i){return i.scrollOffset&&o.setOffset(i.scrollOffset),new _p(n,o,i)}function SV(n,o,i={}){return i.useHash?new zL(n,o):new Dv(n,o)}function IV(n){return"guarded"}function lS(n){return[{provide:JI,multi:!0,useValue:n},{provide:pp,multi:!0,useValue:n}]}let mp=(()=>{class n{constructor(i){this.injector=i,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new xn}appInitializer(){return this.injector.get(XL,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let s=null;const l=new Promise(d=>s=d),u=this.injector.get(Pt),h=this.injector.get(Zo);return"disabled"===h.initialNavigation?(u.setUpLocationChangeListener(),s(!0)):"enabled"===h.initialNavigation||"enabledBlocking"===h.initialNavigation?(u.hooks.afterPreactivation=()=>this.initNavigation?ne(null):(this.initNavigation=!0,s(!0),this.resultOfPreactivationDone),u.initialNavigation()):s(!0),l})}bootstrapListener(i){const s=this.injector.get(Zo),l=this.injector.get(rS),u=this.injector.get(_p),h=this.injector.get(Pt),d=this.injector.get(Xi);i===d.components[0]&&(("enabledNonBlocking"===s.initialNavigation||void 0===s.initialNavigation)&&h.initialNavigation(),l.setUpPreloading(),u.init(),h.resetRootComponentType(d.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(i){return new(i||n)(B(fe))},n.\u0275prov=re({token:n,factory:n.\u0275fac}),n})();function AV(n){return n.appInitializer.bind(n)}function wV(n){return n.bootstrapListener.bind(n)}const uS=new ae("Router Initializer");var sr=F(447),Jl=F(298),Qo=F(402);function MV(n,o){1&n&&(po(0,"span"),fo(1,"Loading"),go())}const NV=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:(()=>{class n{constructor(){this.demoWorkspace=null,this.showInner=""}RunCode(){this.run=Qo.interpreterHelper.createInterpreter(this.demoWorkspace,Jl),this.run.runCode((s,l)=>new Interpreter(this.run.latestCode,l))}ngOnInit(){Qo.filterBlocks.definitionBlocks(sr.Blocks,Jl);var i=[Qo.defaultBlocks.generalBlocks(),Qo.filterBlocks.filterXML()];this.initialize(i),Qo.saveBlocksUrl.restoreState(sr.Xml,this.demoWorkspace)}SaveBlocks(){Qo.saveBlocksUrl.saveState(sr.Xml,this.demoWorkspace)}ShowInnerWorkings(){if(null!=document.getElementById("output"))if(null!=this.demoWorkspace){var s=sr.Xml.workspaceToDom(this.demoWorkspace,!0),l=sr.Xml.domToPrettyText(s);this.showInner=`\n            ========\n            ${l}\n            ========\n            ${this.run.latestCode}\n            `}else window.alert("demoWorkspace is null");else window.alert("outputArea is null")}initialize(i){const s=document.getElementById("blocklyDiv");if(null!=s){var u=`<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox-simple" style="display: none">\n    ${i.map(g=>`<sep></sep>${g}`)}\n    </xml>`;document.getElementById("toolbox"),this.demoWorkspace=sr.inject(s,{readOnly:!1,media:"media/",trashcan:!0,move:{scrollbars:!0,drag:!0,wheel:!0},toolbox:u}),console.log(Jl),this.run=Qo.interpreterHelper.createInterpreter(this.demoWorkspace,Jl);var d=this;this.demoWorkspace.addChangeListener(function(g){g.isUiEvent||(d.run.resetInterpreter(),d.run.generateCodeAndLoadIntoInterpreter(),d.ShowInnerWorkings())})}else window.alert("blocklyDiv is null")}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=fr({type:n,selectors:[["app-display-blockly"]],decls:12,vars:2,consts:[[3,"click"],[4,"ngIf"],[2,"width","100%"],["id","blocklyDiv",2,"display","inline-block","height","480px","width","58%"],["id","output","disabled","disabled",2,"display","inline-block","height","480px","width","38%",3,"ngModel","ngModelChange"]],template:function(i,s){1&i&&(po(0,"a",0),tt("click",function(){return s.ShowInnerWorkings()}),fo(1,"Show blocks"),go(),fo(2," \xa0 "),po(3,"a",0),tt("click",function(){return s.SaveBlocks()}),fo(4,"Save Blocks"),go(),po(5,"a",0),tt("click",function(){return s.RunCode()}),fo(6,"Run Code"),go(),function(n,o,i,s,l,u,h,d){const g=w(),_=he(),m=n+20,E=_.firstCreatePass?function(n,o,i,s,l,u,h,d,g){const _=o.consts,m=Ci(o,n,4,h||null,ro(_,d));vc(o,i,m,ro(_,g)),ea(o,m);const E=m.tViews=Ia(2,m,s,l,u,o.directiveRegistry,o.pipeRegistry,null,o.schemas,_);return null!==o.queries&&(o.queries.template(o,m),E.queries=o.queries.embeddedTView(m)),m}(m,_,g,o,i,s,l,u,h):_.data[m];vn(E,!1);const v=g[11].createComment("");Ta(_,g,v,E),at(v,g),ba(g,g[m]=l_(v,g,v,E)),zs(E)&&Ec(_,g,E),null!=h&&Tc(g,E,d)}(7,MV,2,0,"span",1),po(8,"div",2),Ma(9,"div",3),po(10,"textarea",4),tt("ngModelChange",function(u){return s.showInner=u}),fo(11,"    "),go(),go()),2&i&&(ac(7),Oa("ngIf",null==s.demoWorkspace),ac(3),Oa("ngModel",s.showInner))},directives:[Vv,Sl,OC,Gd],styles:[""]}),n})()}];let kV=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=En({type:n}),n.\u0275inj=xt({imports:[[aS.forRoot(NV)],aS]}),n})(),LV=(()=>{class n{constructor(){this.title="AutoBlocklyApp"}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=fr({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(i,s){1&i&&(fo(0,"Here will be "),Ma(1,"router-outlet"))},directives:[up],styles:[""]}),n})(),PV=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=En({type:n,bootstrap:[LV]}),n.\u0275inj=xt({providers:[],imports:[[lx,kV,mF]]}),n})();(function(){if(yT)throw new Error("Cannot enable prod mode after platform setup.");CT=!1})(),sx().bootstrapModule(PV).catch(n=>console.error(n))},183:(ie,K)=>{K.generalBlocks=function(){return'\n    \n    <category name="BlocklyCore=>">\n\n    <category id="catLogic" colour="210" name="Logic">\n        <block type="controls_if"></block>\n        <block type="logic_compare"></block>\n        <block type="logic_operation"></block>\n        <block type="logic_negate"></block>\n        <block type="logic_boolean"></block>\n        <block type="logic_null"></block>\n        <block type="logic_ternary"></block>\n    </category>\n    <category id="catLoops" colour="120" name="Loops">\n        <block type="controls_repeat_ext">\n            <value name="TIMES">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_whileUntil"></block>\n        <block type="controls_for">\n            <value name="FROM">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n            <value name="BY">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_forEach"></block>\n        <block type="controls_flow_statements"></block>\n    </category>\n    <category id="catMath" colour="230" name="Math">\n        <block type="math_number"></block>\n        <block type="math_arithmetic">\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_single">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">9</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_trig">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">45</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_constant"></block>\n        <block type="math_number_property">\n            <value name="NUMBER_TO_CHECK">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_change">\n            <value name="DELTA">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_round">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">3.1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_on_list"></block>\n        <block type="math_modulo">\n            <value name="DIVIDEND">\n                <shadow type="math_number">\n                    <field name="NUM">64</field>\n                </shadow>\n            </value>\n            <value name="DIVISOR">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_constrain">\n            <value name="VALUE">\n                <shadow type="math_number">\n                    <field name="NUM">50</field>\n                </shadow>\n            </value>\n            <value name="LOW">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="HIGH">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_random_int">\n            <value name="FROM">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_random_float"></block>\n    </category>\n    <category id="catText" colour="160" name="Text">\n        <block type="text"></block>\n        <block type="text_join"></block>\n        <block type="text_append">\n            <value name="TEXT">\n                <shadow type="text"></shadow>\n            </value>\n        </block>\n        <block type="text_length">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_isEmpty">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT"></field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_indexOf">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n            <value name="FIND">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_charAt">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n        </block>\n        <block type="text_getSubstring">\n            <value name="STRING">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n        </block>\n        <block type="text_changeCase">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_trim">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_print">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_prompt_ext">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category id="catLists" colour="260" name="Lists">\n        <block type="lists_create_with">\n            <mutation items="0"></mutation>\n        </block>\n        <block type="lists_create_with"></block>\n        <block type="lists_repeat">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">5</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_length"></block>\n        <block type="lists_isEmpty"></block>\n        <block type="lists_indexOf">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getIndex">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_setIndex">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getSublist">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_split">\n            <value name="DELIM">\n                <shadow type="text">\n                    <field name="TEXT">,</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_sort"></block>\n    </category>\n    <category id="catColour" colour="20" name="Color">\n        <block type="colour_picker"></block>\n        <block type="colour_random"></block>\n        <block type="colour_rgb">\n            <value name="RED">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n            <value name="GREEN">\n                <shadow type="math_number">\n                    <field name="NUM">50</field>\n                </shadow>\n            </value>\n            <value name="BLUE">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="colour_blend">\n            <value name="COLOUR1">\n                <shadow type="colour_picker">\n                    <field name="COLOUR">#ff0000</field>\n                </shadow>\n            </value>\n            <value name="COLOUR2">\n                <shadow type="colour_picker">\n                    <field name="COLOUR">#3333ff</field>\n                </shadow>\n            </value>\n            <value name="RATIO">\n                <shadow type="math_number">\n                    <field name="NUM">0.5</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category id="catVariables" colour="330" custom="VARIABLE" name="Variables"></category>\n    <category id="catFunctions" colour="290" custom="PROCEDURE" name="Functions"></category>\n</category>\n\n      '}},988:(ie,K)=>{K.definitionBlocks=function(F,M){F.filterList={init:function(){this.appendDummyInput().appendField("filterList"),this.appendValueInput("LIST").setCheck("Array"),this.appendValueInput("Logic").setCheck("String").appendField("item=>"),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},M.filterList=function(N){var t=M.valueToCode(N,"LIST",M.ORDER_MEMBER)||"[]",e=M.valueToCode(N,"Logic",M.ORDER_ATOMIC);"string"==typeof e&&(e=e.substr(1,e.length-2));var r="";return r+='(function(t){ if (typeof t === "string") return JSON.parse(t);  return t;}('+t+")).filter(function (item){ return "+e+";})",[r+="",M.ORDER_FUNCTION_CALL]},F.mapList={init:function(){this.appendDummyInput().appendField("mapList"),this.appendValueInput("LIST").setCheck("Array"),this.appendValueInput("Logic").setCheck("String").appendField("item=>"),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},M.mapList=function(N){var t=M.valueToCode(N,"LIST",M.ORDER_MEMBER)||"[]",e=M.valueToCode(N,"Logic",M.ORDER_ATOMIC);"string"==typeof e&&(e=e.substr(1,e.length-2));var r="";return r+='(function(t){ if (typeof t === "string") return JSON.parse(t);  return t;}('+t+")).map(function (item){ return "+e+";})",[r+="",M.ORDER_FUNCTION_CALL]}},K.filterXML=function(){return'\n    <category name="Advanced=>">\n        <category id="catArray" name="Array">\n            <block type="filterList">\n                <value name="LIST">\n                    <block type="variables_get">\n                        <field name="VAR">list</field>\n                    </block>\n                </value>\n                <value name="Logic">\n                    <shadow type="text">\n                        <field name="TEXT">item.property == "value"</field>\n                    </shadow>\n                </value>\n            </block>\n            <block type="mapList">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n            <value name="Logic">\n                <shadow type="text">\n                    <field name="TEXT">item.property</field>\n                </shadow>\n            </value>\n        </block>\n\n        </category>\n    </category>\n\n'}},402:(ie,K,F)=>{ie.exports={defaultBlocks:F(183),filterBlocks:F(988),interpreterHelper:F(694),saveBlocksUrl:F(123)}},694:(ie,K)=>{K.createInterpreter=function(F,M){return{latestCode:"",workspace:F,BlocklyJavaScript:M,step:0,highlightPause:!1,myInterpreter:null,runner:null,generateCodeAndLoadIntoInterpreter:function(){this.BlocklyJavaScript.STATEMENT_PREFIX="highlightBlock(%1);\n",this.BlocklyJavaScript.addReservedWords("highlightBlock"),this.latestCode=this.BlocklyJavaScript.workspaceToCode(F),this.resetStepUi(!0)},resetStepUi:function(N){this.step=0,this.workspace.highlightBlock(null),this.highlightPause=!1},resetInterpreter:function(){this.myInterpreter=null,this.runner&&(window.clearTimeout(this.runner),this.runner=null)},runnerThis:function(){this.myInterpreter&&(this.myInterpreter.run()?setTimeout(this.runner,10):(console.log("\n\n<< Program complete >>"),this.resetInterpreter(),this.resetStepUi(!1)))},highlightBlock:function(N){this.workspace.highlightBlock(N),highlightPause=!0},runCode:function(N){this.myInterpreter||this.resetStepUi(!0),this.generateCodeAndLoadIntoInterpreter();var t=this;setTimeout(function(){this.highlightPause=!1,t.myInterpreter=N(t.latestCode,(e,r)=>t.initApiJS(e,r,t)),t.runner=function(){t.myInterpreter&&(t.myInterpreter.run()?setTimeout(runner,10):(console.log("\n\n<< Program complete >>"),t.resetInterpreter(),t.resetStepUi(!1)))},t.runner()},100)},initInterpreterWaitForSeconds:function(N,t){this.BlocklyJavaScript.addReservedWords("waitForSeconds");var e=N.createAsyncFunction(function(r,a){setTimeout(a,1e3*r)});N.setProperty(t,"waitForSeconds",e)},initApiJS:function(N,t,e){N.setProperty(t,"alert",N.createNativeFunction(r=function(a){a=a?a.toString():"",console.log(a)}));var r=function(a){return a=a?a.toString():"",N.createPrimitive(prompt(a))};N.setProperty(t,"prompt",N.createNativeFunction(r)),e.BlocklyJavaScript.addReservedWords("waitForSeconds"),r=N.createAsyncFunction(function(a,c){setTimeout(c,1e3*a)}),N.setProperty(t,"waitForSeconds",r),r=function(a){return a=a?a.toString():"",N.createPrimitive(e.highlightBlock(a))},N.setProperty(t,"highlightBlock",N.createNativeFunction(r))}}}},123:(ie,K)=>{K.saveState=function(N,t){var r=N.workspaceToDom(t,!0),a=N.domToPrettyText(r);window.localStorage.setItem("BlocklyState",a)},K.restoreState=function(N,t){var r=window.localStorage.getItem("BlocklyState");if(r){var a=N.textToDom(r);N.clearWorkspaceAndLoadFromXml(a,t)}return""}},818:function(ie,K,F){var N,t;N=[F(794)],void 0!==(t=function(e){"use strict";return e}.apply(K,N))&&(ie.exports=t)},794:function(ie,K){var N;void 0!==(N=function(){"use strict";var t={connectionTypes:{INPUT_VALUE:1,OUTPUT_VALUE:2,NEXT_STATEMENT:3,PREVIOUS_STATEMENT:4},constants:{},LINE_MODE_MULTIPLIER:40,PAGE_MODE_MULTIPLIER:125,DRAG_RADIUS:5,FLYOUT_DRAG_RADIUS:10,SNAP_RADIUS:28};return t.CONNECTING_SNAP_RADIUS=t.SNAP_RADIUS,t.CURRENT_CONNECTION_PREFERENCE=8,t.BUMP_DELAY=250,t.BUMP_RANDOMNESS=10,t.COLLAPSE_CHARS=30,t.LONGPRESS=750,t.SOUND_LIMIT=100,t.DRAG_STACK=!0,t.HSV_SATURATION=.45,t.HSV_VALUE=.65,t.SPRITE={width:96,height:124,url:"sprites.png"},t.constants.ALIGN={LEFT:-1,CENTRE:0,RIGHT:1},t.DRAG_NONE=0,t.DRAG_STICKY=1,t.DRAG_BEGIN=1,t.DRAG_FREE=2,t.OPPOSITE_TYPE=[],t.OPPOSITE_TYPE[t.connectionTypes.INPUT_VALUE]=t.connectionTypes.OUTPUT_VALUE,t.OPPOSITE_TYPE[t.connectionTypes.OUTPUT_VALUE]=t.connectionTypes.INPUT_VALUE,t.OPPOSITE_TYPE[t.connectionTypes.NEXT_STATEMENT]=t.connectionTypes.PREVIOUS_STATEMENT,t.OPPOSITE_TYPE[t.connectionTypes.PREVIOUS_STATEMENT]=t.connectionTypes.NEXT_STATEMENT,t.VARIABLE_CATEGORY_NAME="VARIABLE",t.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",t.PROCEDURE_CATEGORY_NAME="PROCEDURE",t.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",t.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",t.constants.COLLAPSED_INPUT_NAME="_TEMP_COLLAPSED_INPUT",t.constants.COLLAPSED_FIELD_NAME="_TEMP_COLLAPSED_FIELD",t.utils={},t.utils.global=function(){return"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:this}(),t.Msg={},t.utils.global.Blockly||(t.utils.global.Blockly={}),t.utils.global.Blockly.Msg||(t.utils.global.Blockly.Msg=t.Msg),t.utils.colour={},t.utils.colour.parse=function(e){e=String(e).toLowerCase().trim();var r=t.utils.colour.names[e];if(r||(r="0x"==e.substring(0,2)?"#"+e.substring(2):e,/^#[0-9a-f]{6}$/.test(r="#"==r[0]?r:"#"+r)))return r;if(/^#[0-9a-f]{3}$/.test(r))return["#",r[1],r[1],r[2],r[2],r[3],r[3]].join("");var a=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return a&&(e=Number(a[1]),r=Number(a[2]),a=Number(a[3]),0<=e&&256>e&&0<=r&&256>r&&0<=a&&256>a)?t.utils.colour.rgbToHex(e,r,a):null},t.utils.colour.rgbToHex=function(e,r,a){return r=e<<16|r<<8|a,16>e?"#"+(16777216|r).toString(16).substr(1):"#"+r.toString(16)},t.utils.colour.hexToRgb=function(e){return(e=t.utils.colour.parse(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},t.utils.colour.hsvToHex=function(e,r,a){var c=0,p=0,f=0;if(0==r)f=p=c=a;else{var T=Math.floor(e/60),y=e/60-T;e=a*(1-r);var D=a*(1-r*y);switch(r=a*(1-r*(1-y)),T){case 1:c=D,p=a,f=e;break;case 2:c=e,p=a,f=r;break;case 3:c=e,p=D,f=a;break;case 4:c=r,p=e,f=a;break;case 5:c=a,p=e,f=D;break;case 6:case 0:c=a,p=r,f=e}}return t.utils.colour.rgbToHex(Math.floor(c),Math.floor(p),Math.floor(f))},t.utils.colour.blend=function(e,r,a){return(e=t.utils.colour.parse(e))&&(r=t.utils.colour.parse(r))?(e=t.utils.colour.hexToRgb(e),r=t.utils.colour.hexToRgb(r),t.utils.colour.rgbToHex(Math.round(r[0]+a*(e[0]-r[0])),Math.round(r[1]+a*(e[1]-r[1])),Math.round(r[2]+a*(e[2]-r[2])))):null},t.utils.colour.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},t.utils.Coordinate=function(e,r){this.x=e,this.y=r},t.utils.Coordinate.equals=function(e,r){return e==r||!(!e||!r)&&e.x==r.x&&e.y==r.y},t.utils.Coordinate.distance=function(e,r){var a=e.x-r.x;return e=e.y-r.y,Math.sqrt(a*a+e*e)},t.utils.Coordinate.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},t.utils.Coordinate.difference=function(e,r){return new t.utils.Coordinate(e.x-r.x,e.y-r.y)},t.utils.Coordinate.sum=function(e,r){return new t.utils.Coordinate(e.x+r.x,e.y+r.y)},t.utils.Coordinate.prototype.clone=function(){return new t.utils.Coordinate(this.x,this.y)},t.utils.Coordinate.prototype.scale=function(e){return this.x*=e,this.y*=e,this},t.utils.Coordinate.prototype.translate=function(e,r){return this.x+=e,this.y+=r,this},t.utils.Rect=function(e,r,a,c){this.top=e,this.bottom=r,this.left=a,this.right=c},t.utils.Rect.prototype.contains=function(e,r){return e>=this.left&&e<=this.right&&r>=this.top&&r<=this.bottom},t.utils.Rect.prototype.intersects=function(e){return!(this.left>e.right||this.right<e.left||this.top>e.bottom||this.bottom<e.top)},t.utils.string={},t.utils.string.startsWith=function(e,r){return 0==e.lastIndexOf(r,0)},t.utils.string.shortestStringLength=function(e){return e.length?e.reduce(function(r,a){return r.length<a.length?r:a}).length:0},t.utils.string.commonWordPrefix=function(e,r){if(!e.length)return 0;if(1==e.length)return e[0].length;var a=0;r=r||t.utils.string.shortestStringLength(e);for(var c=0;c<r;c++){for(var p=e[0][c],f=1;f<e.length;f++)if(p!=e[f][c])return a;" "==p&&(a=c+1)}for(f=1;f<e.length;f++)if((p=e[f][c])&&" "!=p)return a;return r},t.utils.string.commonWordSuffix=function(e,r){if(!e.length)return 0;if(1==e.length)return e[0].length;var a=0;r=r||t.utils.string.shortestStringLength(e);for(var c=0;c<r;c++){for(var p=e[0].substr(-c-1,1),f=1;f<e.length;f++)if(p!=e[f].substr(-c-1,1))return a;" "==p&&(a=c+1)}for(f=1;f<e.length;f++)if((p=e[f].charAt(e[f].length-c-1))&&" "!=p)return a;return r},t.utils.string.wrap=function(e,r){e=e.split("\n");for(var a=0;a<e.length;a++)e[a]=t.utils.string.wrapLine_(e[a],r);return e.join("\n")},t.utils.string.wrapLine_=function(e,r){if(e.length<=r)return e;for(var a=e.trim().split(/\s+/),c=0;c<a.length;c++)a[c].length>r&&(r=a[c].length);c=-1/0;var p=1;do{var f=c,T=e;e=[];var y=a.length/p,D=1;for(c=0;c<a.length-1;c++)D<(c+1.5)/y?(D++,e[c]=!0):e[c]=!1;e=t.utils.string.wrapMutate_(a,e,r),c=t.utils.string.wrapScore_(a,e,r),e=t.utils.string.wrapToText_(a,e),p++}while(c>f);return T},t.utils.string.wrapScore_=function(e,r,a){for(var c=[0],p=[],f=0;f<e.length;f++)c[c.length-1]+=e[f].length,!0===r[f]?(c.push(0),p.push(e[f].charAt(e[f].length-1))):!1===r[f]&&c[c.length-1]++;for(e=Math.max.apply(Math,c),f=r=0;f<c.length;f++)r-=2*Math.pow(Math.abs(a-c[f]),1.5),r-=Math.pow(e-c[f],1.5),-1!=".?!".indexOf(p[f])?r+=a/3:-1!=",;)]}".indexOf(p[f])&&(r+=a/4);return 1<c.length&&c[c.length-1]<=c[c.length-2]&&(r+=.5),r},t.utils.string.wrapMutate_=function(e,r,a){for(var p,c=t.utils.string.wrapScore_(e,r,a),f=0;f<r.length-1;f++)if(r[f]!=r[f+1]){var T=[].concat(r);T[f]=!T[f],T[f+1]=!T[f+1];var y=t.utils.string.wrapScore_(e,T,a);y>c&&(c=y,p=T)}return p?t.utils.string.wrapMutate_(e,p,a):r},t.utils.string.wrapToText_=function(e,r){for(var a=[],c=0;c<e.length;c++)a.push(e[c]),void 0!==r[c]&&a.push(r[c]?"\n":" ");return a.join("")},t.utils.Size=function(e,r){this.width=e,this.height=r},t.utils.Size.equals=function(e,r){return e==r||!(!e||!r)&&e.width==r.width&&e.height==r.height},t.utils.style={},t.utils.style.getSize=function(e){if("none"!=t.utils.style.getStyle_(e,"display"))return t.utils.style.getSizeWithDisplay_(e);var r=e.style,a=r.display,c=r.visibility,p=r.position;r.visibility="hidden",r.position="absolute",r.display="inline";var f=e.offsetWidth;return e=e.offsetHeight,r.display=a,r.position=p,r.visibility=c,new t.utils.Size(f,e)},t.utils.style.getSizeWithDisplay_=function(e){return new t.utils.Size(e.offsetWidth,e.offsetHeight)},t.utils.style.getStyle_=function(e,r){return t.utils.style.getComputedStyle(e,r)||t.utils.style.getCascadedStyle(e,r)||e.style&&e.style[r]},t.utils.style.getComputedStyle=function(e,r){return document.defaultView&&document.defaultView.getComputedStyle&&(e=document.defaultView.getComputedStyle(e,null))&&(e[r]||e.getPropertyValue(r))||""},t.utils.style.getCascadedStyle=function(e,r){return e.currentStyle?e.currentStyle[r]:null},t.utils.style.getPageOffset=function(e){var r=new t.utils.Coordinate(0,0);e=e.getBoundingClientRect();var a=document.documentElement;return a=new t.utils.Coordinate(window.pageXOffset||a.scrollLeft,window.pageYOffset||a.scrollTop),r.x=e.left+a.x,r.y=e.top+a.y,r},t.utils.style.getViewportPageOffset=function(){var e=document.body,r=document.documentElement;return new t.utils.Coordinate(e.scrollLeft||r.scrollLeft,e.scrollTop||r.scrollTop)},t.utils.style.setElementShown=function(e,r){e.style.display=r?"":"none"},t.utils.style.isRightToLeft=function(e){return"rtl"==t.utils.style.getStyle_(e,"direction")},t.utils.style.getBorderBox=function(e){var r=t.utils.style.getComputedStyle(e,"borderLeftWidth"),a=t.utils.style.getComputedStyle(e,"borderRightWidth"),c=t.utils.style.getComputedStyle(e,"borderTopWidth");return e=t.utils.style.getComputedStyle(e,"borderBottomWidth"),{top:parseFloat(c),right:parseFloat(a),bottom:parseFloat(e),left:parseFloat(r)}},t.utils.style.scrollIntoContainerView=function(e,r,a){e=t.utils.style.getContainerOffsetToScrollInto(e,r,a),r.scrollLeft=e.x,r.scrollTop=e.y},t.utils.style.getContainerOffsetToScrollInto=function(e,r,a){var c=t.utils.style.getPageOffset(e),p=t.utils.style.getPageOffset(r),f=t.utils.style.getBorderBox(r),T=c.x-p.x-f.left;return c=c.y-p.y-f.top,p=t.utils.style.getSizeWithDisplay_(e),e=r.clientWidth-p.width,p=r.clientHeight-p.height,f=r.scrollLeft,r=r.scrollTop,a?(f+=T-e/2,r+=c-p/2):(f+=Math.min(T,Math.max(T-e,0)),r+=Math.min(c,Math.max(c-p,0))),new t.utils.Coordinate(f,r)},t.utils.userAgent={},function(e){function r(c){return-1!=a.indexOf(c.toUpperCase())}t.utils.userAgent.raw=e;var a=t.utils.userAgent.raw.toUpperCase();t.utils.userAgent.IE=r("Trident")||r("MSIE"),t.utils.userAgent.EDGE=r("Edge"),t.utils.userAgent.JAVA_FX=r("JavaFX"),t.utils.userAgent.CHROME=(r("Chrome")||r("CriOS"))&&!t.utils.userAgent.EDGE,t.utils.userAgent.WEBKIT=r("WebKit")&&!t.utils.userAgent.EDGE,t.utils.userAgent.GECKO=r("Gecko")&&!t.utils.userAgent.WEBKIT&&!t.utils.userAgent.IE&&!t.utils.userAgent.EDGE,t.utils.userAgent.ANDROID=r("Android"),e=t.utils.global.navigator&&t.utils.global.navigator.maxTouchPoints,t.utils.userAgent.IPAD=r("iPad")||r("Macintosh")&&0<e,t.utils.userAgent.IPOD=r("iPod"),t.utils.userAgent.IPHONE=r("iPhone")&&!t.utils.userAgent.IPAD&&!t.utils.userAgent.IPOD,t.utils.userAgent.MAC=r("Macintosh"),t.utils.userAgent.TABLET=t.utils.userAgent.IPAD||t.utils.userAgent.ANDROID&&!r("Mobile")||r("Silk"),t.utils.userAgent.MOBILE=!t.utils.userAgent.TABLET&&(t.utils.userAgent.IPOD||t.utils.userAgent.IPHONE||t.utils.userAgent.ANDROID||r("IEMobile"))}(t.utils.global.navigator&&t.utils.global.navigator.userAgent||""),t.utils.noEvent=function(e){e.preventDefault(),e.stopPropagation()},t.utils.isTargetInput=function(e){return"textarea"==e.target.type||"text"==e.target.type||"number"==e.target.type||"email"==e.target.type||"password"==e.target.type||"search"==e.target.type||"tel"==e.target.type||"url"==e.target.type||e.target.isContentEditable||e.target.dataset&&"true"==e.target.dataset.isTextInput},t.utils.getRelativeXY=function(e){var r=new t.utils.Coordinate(0,0),a=e.getAttribute("x");return a&&(r.x=parseInt(a,10)),(a=e.getAttribute("y"))&&(r.y=parseInt(a,10)),(a=(a=e.getAttribute("transform"))&&a.match(t.utils.getRelativeXY.XY_REGEX_))&&(r.x+=Number(a[1]),a[3]&&(r.y+=Number(a[3]))),(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&(e=e.match(t.utils.getRelativeXY.XY_STYLE_REGEX_))&&(r.x+=Number(e[1]),e[3]&&(r.y+=Number(e[3]))),r},t.utils.getInjectionDivXY_=function(e){for(var r=0,a=0;e;){var c=t.utils.getRelativeXY(e);if(r+=c.x,a+=c.y,-1!=(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;e=e.parentNode}return new t.utils.Coordinate(r,a)},t.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,t.utils.getRelativeXY.XY_STYLE_REGEX_=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,t.utils.isRightButton=function(e){return!(!e.ctrlKey||!t.utils.userAgent.MAC)||2==e.button},t.utils.mouseToSvg=function(e,r,a){var c=r.createSVGPoint();return c.x=e.clientX,c.y=e.clientY,a||(a=r.getScreenCTM().inverse()),c.matrixTransform(a)},t.utils.getScrollDeltaPixels=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*t.LINE_MODE_MULTIPLIER,y:e.deltaY*t.LINE_MODE_MULTIPLIER};case 2:return{x:e.deltaX*t.PAGE_MODE_MULTIPLIER,y:e.deltaY*t.PAGE_MODE_MULTIPLIER}}},t.utils.tokenizeInterpolation=function(e){return t.utils.tokenizeInterpolation_(e,!0)},t.utils.replaceMessageReferences=function(e){return"string"!=typeof e?e:(e=t.utils.tokenizeInterpolation_(e,!1)).length?String(e[0]):""},t.utils.checkMessageReferences=function(e){for(var r=!0,a=t.Msg,c=e.match(/%{BKY_[A-Z]\w*}/gi),p=0;p<c.length;p++)null==a[c[p].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+c[p]+" in "+e),r=!1);return r},t.utils.tokenizeInterpolation_=function(e,r){var a=[],c=e.split("");c.push("");var p=0;e=[];for(var f=null,T=0;T<c.length;T++){var y=c[T];0==p?"%"==y?((y=e.join(""))&&a.push(y),e.length=0,p=1):e.push(y):1==p?"%"==y?(e.push(y),p=0):r&&"0"<=y&&"9">=y?(p=2,f=y,(y=e.join(""))&&a.push(y),e.length=0):"{"==y?p=3:(e.push("%",y),p=0):2==p?"0"<=y&&"9">=y?f+=y:(a.push(parseInt(f,10)),T--,p=0):3==p&&(""==y?(e.splice(0,0,"%{"),T--,p=0):"}"!=y?e.push(y):(p=e.join(""),/[A-Z]\w*/i.test(p)?(y=p.toUpperCase(),(y=t.utils.string.startsWith(y,"BKY_")?y.substring(4):null)&&y in t.Msg?"string"==typeof(p=t.Msg[y])?Array.prototype.push.apply(a,t.utils.tokenizeInterpolation_(p,r)):a.push(r?String(p):p):a.push("%{"+p+"}")):a.push("%{"+p+"}"),p=e.length=0))}for((y=e.join(""))&&a.push(y),r=[],T=e.length=0;T<a.length;++T)"string"==typeof a[T]?e.push(a[T]):((y=e.join(""))&&r.push(y),e.length=0,r.push(a[T]));return(y=e.join(""))&&r.push(y),e.length=0,r},t.utils.genUid=function(){for(var e=t.utils.genUid.soup_.length,r=[],a=0;20>a;a++)r[a]=t.utils.genUid.soup_.charAt(Math.random()*e);return r.join("")},t.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t.utils.is3dSupported=function(){if(void 0!==t.utils.is3dSupported.cached_)return t.utils.is3dSupported.cached_;if(!t.utils.global.getComputedStyle)return!1;var e=document.createElement("p"),r="none",a={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var c in document.body.insertBefore(e,null),a)if(void 0!==e.style[c]){if(e.style[c]="translate3d(1px,1px,1px)",!(r=t.utils.global.getComputedStyle(e)))return document.body.removeChild(e),!1;r=r.getPropertyValue(a[c])}return document.body.removeChild(e),t.utils.is3dSupported.cached_="none"!==r,t.utils.is3dSupported.cached_},t.utils.runAfterPageLoad=function(e){if("object"!=typeof document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"==document.readyState)e();else var r=setInterval(function(){"complete"==document.readyState&&(clearInterval(r),e())},10)},t.utils.getViewportBBox=function(){var e=t.utils.style.getViewportPageOffset();return new t.utils.Rect(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},t.utils.arrayRemove=function(e,r){return-1!=(r=e.indexOf(r))&&(e.splice(r,1),!0)},t.utils.getDocumentScroll=function(){var e=document.documentElement,r=window;return t.utils.userAgent.IE&&r.pageYOffset!=e.scrollTop?new t.utils.Coordinate(e.scrollLeft,e.scrollTop):new t.utils.Coordinate(r.pageXOffset||e.scrollLeft,r.pageYOffset||e.scrollTop)},t.utils.getBlockTypeCounts=function(e,r){var a=Object.create(null),c=e.getDescendants(!0);for(r&&(e=e.getNextBlock())&&(e=c.indexOf(e),c.splice(e,c.length-e)),e=0;r=c[e];e++)a[r.type]?a[r.type]++:a[r.type]=1;return a},t.utils.screenToWsCoordinates=function(e,r){var a=r.x;r=r.y;var c=e.getInjectionDiv().getBoundingClientRect();return a=new t.utils.Coordinate(a-c.left,r-c.top),r=e.getOriginOffsetInPixels(),t.utils.Coordinate.difference(a,r).scale(1/e.scale)},t.utils.parseBlockColour=function(e){var r="string"==typeof e?t.utils.replaceMessageReferences(e):e,a=Number(r);if(!isNaN(a)&&0<=a&&360>=a)return{hue:a,hex:t.utils.colour.hsvToHex(a,t.HSV_SATURATION,255*t.HSV_VALUE)};if(a=t.utils.colour.parse(r))return{hue:null,hex:a};throw a='Invalid colour: "'+r+'"',e!=r&&(a+=' (from "'+e+'")'),Error(a)},t.Touch={},t.Touch.TOUCH_ENABLED="ontouchstart"in t.utils.global||!!(t.utils.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!t.utils.global.navigator||!t.utils.global.navigator.maxTouchPoints&&!t.utils.global.navigator.msMaxTouchPoints),t.Touch.touchIdentifier_=null,t.Touch.TOUCH_MAP={},t.utils.global.PointerEvent?t.Touch.TOUCH_MAP={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:t.Touch.TOUCH_ENABLED&&(t.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),t.longPid_=0,t.longStart=function(e,r){t.longStop_(),e.changedTouches&&1!=e.changedTouches.length||(t.longPid_=setTimeout(function(){e.changedTouches&&(e.button=2,e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),r&&r.handleRightClick(e)},t.LONGPRESS))},t.longStop_=function(){t.longPid_&&(clearTimeout(t.longPid_),t.longPid_=0)},t.Touch.clearTouchIdentifier=function(){t.Touch.touchIdentifier_=null},t.Touch.shouldHandleEvent=function(e){return!t.Touch.isMouseOrTouchEvent(e)||t.Touch.checkTouchIdentifier(e)},t.Touch.getTouchIdentifierFromEvent=function(e){return null!=e.pointerId?e.pointerId:e.changedTouches&&e.changedTouches[0]&&null!=e.changedTouches[0].identifier?e.changedTouches[0].identifier:"mouse"},t.Touch.checkTouchIdentifier=function(e){var r=t.Touch.getTouchIdentifierFromEvent(e);return null!=t.Touch.touchIdentifier_?t.Touch.touchIdentifier_==r:("mousedown"==e.type||"touchstart"==e.type||"pointerdown"==e.type)&&(t.Touch.touchIdentifier_=r,!0)},t.Touch.setClientFromTouch=function(e){if(t.utils.string.startsWith(e.type,"touch")){var r=e.changedTouches[0];e.clientX=r.clientX,e.clientY=r.clientY}},t.Touch.isMouseOrTouchEvent=function(e){return t.utils.string.startsWith(e.type,"touch")||t.utils.string.startsWith(e.type,"mouse")||t.utils.string.startsWith(e.type,"pointer")},t.Touch.isTouchEvent=function(e){return t.utils.string.startsWith(e.type,"touch")||t.utils.string.startsWith(e.type,"pointer")},t.Touch.splitEventByTouches=function(e){var r=[];if(e.changedTouches)for(var a=0;a<e.changedTouches.length;a++)r[a]={type:e.type,changedTouches:[e.changedTouches[a]],target:e.target,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()}};else r.push(e);return r},t.browserEvents={},t.browserEvents.conditionalBind=function(e,r,a,c,p,f){var T=!1,y=function(De){var dt=!p;De=t.Touch.splitEventByTouches(De);for(var Pn,qt=0;Pn=De[qt];qt++)(!dt||t.Touch.shouldHandleEvent(Pn))&&(t.Touch.setClientFromTouch(Pn),a?c.call(a,Pn):c(Pn),T=!0)},D=[];if(t.utils.global.PointerEvent&&r in t.Touch.TOUCH_MAP)for(var G,k=0;G=t.Touch.TOUCH_MAP[r][k];k++)e.addEventListener(G,y,!1),D.push([e,G,y]);else if(e.addEventListener(r,y,!1),D.push([e,r,y]),r in t.Touch.TOUCH_MAP){var Se=function(De){y(De),T&&!f&&De.preventDefault()};for(k=0;G=t.Touch.TOUCH_MAP[r][k];k++)e.addEventListener(G,Se,!1),D.push([e,G,Se])}return D},t.browserEvents.bind=function(e,r,a,c){var p=function(k){a?c.call(a,k):c(k)},f=[];if(t.utils.global.PointerEvent&&r in t.Touch.TOUCH_MAP)for(var y,T=0;y=t.Touch.TOUCH_MAP[r][T];T++)e.addEventListener(y,p,!1),f.push([e,y,p]);else if(e.addEventListener(r,p,!1),f.push([e,r,p]),r in t.Touch.TOUCH_MAP){var D=function(k){if(k.changedTouches&&1==k.changedTouches.length){var G=k.changedTouches[0];k.clientX=G.clientX,k.clientY=G.clientY}p(k),k.preventDefault()};for(T=0;y=t.Touch.TOUCH_MAP[r][T];T++)e.addEventListener(y,D,!1),f.push([e,y,D])}return f},t.browserEvents.unbind=function(e){for(;e.length;){var r=e.pop(),a=r[2];r[0].removeEventListener(r[1],a,!1)}return a},t.ComponentManager=function(){this.componentData_=Object.create(null),this.capabilityToComponentIds_=Object.create(null)},t.ComponentManager.prototype.addComponent=function(e,r){var a=e.component.id;if(!r&&this.componentData_[a])throw Error('Plugin "'+a+'" with capabilities "'+this.componentData_[a].capabilities+'" already added.');this.componentData_[a]=e,r=[];for(var c=0;c<e.capabilities.length;c++){var p=String(e.capabilities[c]).toLowerCase();r.push(p),void 0===this.capabilityToComponentIds_[p]?this.capabilityToComponentIds_[p]=[a]:this.capabilityToComponentIds_[p].push(a)}this.componentData_[a].capabilities=r},t.ComponentManager.prototype.removeComponent=function(e){var r=this.componentData_[e];if(r){for(var a=0;a<r.capabilities.length;a++){var c=String(r.capabilities[a]).toLowerCase();this.capabilityToComponentIds_[c].splice(this.capabilityToComponentIds_[c].indexOf(e),1)}delete this.componentData_[e]}},t.ComponentManager.prototype.addCapability=function(e,r){if(!this.getComponent(e))throw Error('Cannot add capability, "'+r+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,r)?console.warn('Plugin "'+e+'already has capability "'+r+'"'):(r=String(r).toLowerCase(),this.componentData_[e].capabilities.push(r),this.capabilityToComponentIds_[r].push(e))},t.ComponentManager.prototype.removeCapability=function(e,r){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+r+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,r)?(r=String(r).toLowerCase(),this.componentData_[e].capabilities.splice(this.componentData_[e].capabilities.indexOf(r),1),this.capabilityToComponentIds_[r].splice(this.capabilityToComponentIds_[r].indexOf(e),1)):console.warn('Plugin "'+e+"doesn't have capability \""+r+'" to remove')},t.ComponentManager.prototype.hasCapability=function(e,r){return r=String(r).toLowerCase(),-1!==this.componentData_[e].capabilities.indexOf(r)},t.ComponentManager.prototype.getComponent=function(e){return this.componentData_[e]&&this.componentData_[e].component},t.ComponentManager.prototype.getComponents=function(e,r){if(e=String(e).toLowerCase(),!(e=this.capabilityToComponentIds_[e]))return[];var a=[];if(r){var c=[],p=this.componentData_;e.forEach(function(f){c.push(p[f])}),c.sort(function(f,T){return f.weight-T.weight}),c.forEach(function(f){a.push(f.component)})}else p=this.componentData_,e.forEach(function(f){a.push(p[f].component)});return a},t.ComponentManager.Capability=function(e){this.name_=e},t.ComponentManager.Capability.prototype.toString=function(){return this.name_},t.ComponentManager.Capability.POSITIONABLE=new t.ComponentManager.Capability("positionable"),t.ComponentManager.Capability.DRAG_TARGET=new t.ComponentManager.Capability("drag_target"),t.ComponentManager.Capability.DELETE_AREA=new t.ComponentManager.Capability("delete_area"),t.ComponentManager.Capability.AUTOHIDEABLE=new t.ComponentManager.Capability("autohideable"),t.utils.Svg=function(e){this.tagName_=e},t.utils.Svg.prototype.toString=function(){return this.tagName_},t.utils.Svg.ANIMATE=new t.utils.Svg("animate"),t.utils.Svg.CIRCLE=new t.utils.Svg("circle"),t.utils.Svg.CLIPPATH=new t.utils.Svg("clipPath"),t.utils.Svg.DEFS=new t.utils.Svg("defs"),t.utils.Svg.FECOMPOSITE=new t.utils.Svg("feComposite"),t.utils.Svg.FECOMPONENTTRANSFER=new t.utils.Svg("feComponentTransfer"),t.utils.Svg.FEFLOOD=new t.utils.Svg("feFlood"),t.utils.Svg.FEFUNCA=new t.utils.Svg("feFuncA"),t.utils.Svg.FEGAUSSIANBLUR=new t.utils.Svg("feGaussianBlur"),t.utils.Svg.FEPOINTLIGHT=new t.utils.Svg("fePointLight"),t.utils.Svg.FESPECULARLIGHTING=new t.utils.Svg("feSpecularLighting"),t.utils.Svg.FILTER=new t.utils.Svg("filter"),t.utils.Svg.FOREIGNOBJECT=new t.utils.Svg("foreignObject"),t.utils.Svg.G=new t.utils.Svg("g"),t.utils.Svg.IMAGE=new t.utils.Svg("image"),t.utils.Svg.LINE=new t.utils.Svg("line"),t.utils.Svg.PATH=new t.utils.Svg("path"),t.utils.Svg.PATTERN=new t.utils.Svg("pattern"),t.utils.Svg.POLYGON=new t.utils.Svg("polygon"),t.utils.Svg.RECT=new t.utils.Svg("rect"),t.utils.Svg.SVG=new t.utils.Svg("svg"),t.utils.Svg.TEXT=new t.utils.Svg("text"),t.utils.Svg.TSPAN=new t.utils.Svg("tspan"),t.utils.dom={},t.utils.dom.SVG_NS="http://www.w3.org/2000/svg",t.utils.dom.HTML_NS="http://www.w3.org/1999/xhtml",t.utils.dom.XLINK_NS="http://www.w3.org/1999/xlink",t.utils.dom.NodeType={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_POSITION_CONTAINED_BY:16},t.utils.dom.cacheWidths_=null,t.utils.dom.cacheReference_=0,t.utils.dom.canvasContext_=null,t.utils.dom.createSvgElement=function(e,r,a){for(var c in e=document.createElementNS(t.utils.dom.SVG_NS,String(e)),r)e.setAttribute(c,r[c]);return document.body.runtimeStyle&&(e.runtimeStyle=e.currentStyle=e.style),a&&a.appendChild(e),e},t.utils.dom.addClass=function(e,r){var a=e.getAttribute("class")||"";return-1==(" "+a+" ").indexOf(" "+r+" ")&&(a&&(a+=" "),e.setAttribute("class",a+r),!0)},t.utils.dom.removeClasses=function(e,r){r=r.split(" ");for(var a=0;a<r.length;a++)t.utils.dom.removeClass(e,r[a])},t.utils.dom.removeClass=function(e,r){var a=e.getAttribute("class");if(-1==(" "+a+" ").indexOf(" "+r+" "))return!1;a=a.split(/\s+/);for(var c=0;c<a.length;c++)a[c]&&a[c]!=r||(a.splice(c,1),c--);return a.length?e.setAttribute("class",a.join(" ")):e.removeAttribute("class"),!0},t.utils.dom.hasClass=function(e,r){return-1!=(" "+e.getAttribute("class")+" ").indexOf(" "+r+" ")},t.utils.dom.removeNode=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},t.utils.dom.insertAfter=function(e,r){var a=r.nextSibling;if(!(r=r.parentNode))throw Error("Reference node has no parent.");a?r.insertBefore(e,a):r.appendChild(e)},t.utils.dom.containsNode=function(e,r){return!!(e.compareDocumentPosition(r)&t.utils.dom.NodeType.DOCUMENT_POSITION_CONTAINED_BY)},t.utils.dom.setCssTransform=function(e,r){e.style.transform=r,e.style["-webkit-transform"]=r},t.utils.dom.startTextWidthCache=function(){t.utils.dom.cacheReference_++,t.utils.dom.cacheWidths_||(t.utils.dom.cacheWidths_=Object.create(null))},t.utils.dom.stopTextWidthCache=function(){t.utils.dom.cacheReference_--,t.utils.dom.cacheReference_||(t.utils.dom.cacheWidths_=null)},t.utils.dom.getTextWidth=function(e){var a,r=e.textContent+"\n"+e.className.baseVal;if(t.utils.dom.cacheWidths_&&(a=t.utils.dom.cacheWidths_[r]))return a;try{a=t.utils.userAgent.IE||t.utils.userAgent.EDGE?e.getBBox().width:e.getComputedTextLength()}catch(c){return 8*e.textContent.length}return t.utils.dom.cacheWidths_&&(t.utils.dom.cacheWidths_[r]=a),a},t.utils.dom.getFastTextWidth=function(e,r,a,c){return t.utils.dom.getFastTextWidthWithSizeString(e,r+"pt",a,c)},t.utils.dom.getFastTextWidthWithSizeString=function(e,r,a,c){var f,p=e.textContent;return e=p+"\n"+e.className.baseVal,t.utils.dom.cacheWidths_&&(f=t.utils.dom.cacheWidths_[e])||(t.utils.dom.canvasContext_||((f=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(f),t.utils.dom.canvasContext_=f.getContext("2d")),t.utils.dom.canvasContext_.font=a+" "+r+" "+c,f=t.utils.dom.canvasContext_.measureText(p).width,t.utils.dom.cacheWidths_&&(t.utils.dom.cacheWidths_[e]=f)),f},t.utils.dom.measureFontMetrics=function(e,r,a,c){var p=document.createElement("span");p.style.font=a+" "+r+" "+c,p.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0px",(r=document.createElement("div")).setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),r.appendChild(p),r.appendChild(e),document.body.appendChild(r);try{a={},r.style.alignItems="baseline",a.baseline=e.offsetTop-p.offsetTop,r.style.alignItems="flex-end",a.height=e.offsetTop-p.offsetTop}finally{document.body.removeChild(r)}return a},t.utils.math={},t.utils.math.toRadians=function(e){return e*Math.PI/180},t.utils.math.toDegrees=function(e){return 180*e/Math.PI},t.utils.math.clamp=function(e,r,a){if(a<e){var c=a;a=e,e=c}return Math.max(e,Math.min(r,a))},t.DropDownDiv=function(){},t.DropDownDiv.boundsElement_=null,t.DropDownDiv.owner_=null,t.DropDownDiv.positionToField_=null,t.DropDownDiv.ARROW_SIZE=16,t.DropDownDiv.BORDER_SIZE=1,t.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,t.DropDownDiv.PADDING_Y=16,t.DropDownDiv.ANIMATION_TIME=.25,t.DropDownDiv.animateOutTimer_=null,t.DropDownDiv.onHide_=null,t.DropDownDiv.rendererClassName_="",t.DropDownDiv.themeClassName_="",t.DropDownDiv.createDom=function(){if(!t.DropDownDiv.DIV_){var e=document.createElement("div");e.className="blocklyDropDownDiv",(t.parentContainer||document.body).appendChild(e),t.DropDownDiv.DIV_=e;var r=document.createElement("div");r.className="blocklyDropDownContent",e.appendChild(r),t.DropDownDiv.content_=r,(r=document.createElement("div")).className="blocklyDropDownArrow",e.appendChild(r),t.DropDownDiv.arrow_=r,t.DropDownDiv.DIV_.style.opacity=0,t.DropDownDiv.DIV_.style.transition="transform "+t.DropDownDiv.ANIMATION_TIME+"s, opacity "+t.DropDownDiv.ANIMATION_TIME+"s",e.addEventListener("focusin",function(){t.utils.dom.addClass(e,"blocklyFocused")}),e.addEventListener("focusout",function(){t.utils.dom.removeClass(e,"blocklyFocused")})}},t.DropDownDiv.setBoundsElement=function(e){t.DropDownDiv.boundsElement_=e},t.DropDownDiv.getContentDiv=function(){return t.DropDownDiv.content_},t.DropDownDiv.clearContent=function(){t.DropDownDiv.content_.textContent="",t.DropDownDiv.content_.style.width=""},t.DropDownDiv.setColour=function(e,r){t.DropDownDiv.DIV_.style.backgroundColor=e,t.DropDownDiv.DIV_.style.borderColor=r},t.DropDownDiv.showPositionedByBlock=function(e,r,a,c){return t.DropDownDiv.showPositionedByRect_(t.DropDownDiv.getScaledBboxOfBlock_(r),e,a,c)},t.DropDownDiv.showPositionedByField=function(e,r,a){return t.DropDownDiv.positionToField_=!0,t.DropDownDiv.showPositionedByRect_(t.DropDownDiv.getScaledBboxOfField_(e),e,r,a)},t.DropDownDiv.getScaledBboxOfBlock_=function(e){var r=e.getSvgRoot(),a=r.getBBox(),c=e.workspace.scale;return e=a.height*c,a=a.width*c,r=t.utils.style.getPageOffset(r),new t.utils.Rect(r.y,r.y+e,r.x,r.x+a)},t.DropDownDiv.getScaledBboxOfField_=function(e){return e=e.getScaledBBox(),new t.utils.Rect(e.top,e.bottom,e.left,e.right)},t.DropDownDiv.showPositionedByRect_=function(e,r,a,c){var p=e.left+(e.right-e.left)/2,f=e.bottom;e=e.top,c&&(e+=c);for(var T=(c=r.getSourceBlock()).workspace;T.options.parentWorkspace;)T=T.options.parentWorkspace;return t.DropDownDiv.setBoundsElement(T.getParentSvg().parentNode),t.DropDownDiv.show(r,c.RTL,p,f,p,e,a)},t.DropDownDiv.show=function(e,r,a,c,p,f,T){return t.DropDownDiv.owner_=e,t.DropDownDiv.onHide_=T||null,(e=t.DropDownDiv.DIV_).style.direction=r?"rtl":"ltr",r=t.getMainWorkspace(),t.DropDownDiv.rendererClassName_=r.getRenderer().getClassName(),t.DropDownDiv.themeClassName_=r.getTheme().getClassName(),t.utils.dom.addClass(e,t.DropDownDiv.rendererClassName_),t.utils.dom.addClass(e,t.DropDownDiv.themeClassName_),t.DropDownDiv.positionInternal_(a,c,p,f)},t.DropDownDiv.getBoundsInfo_=function(){var e=t.utils.style.getPageOffset(t.DropDownDiv.boundsElement_),r=t.utils.style.getSize(t.DropDownDiv.boundsElement_);return{left:e.x,right:e.x+r.width,top:e.y,bottom:e.y+r.height,width:r.width,height:r.height}},t.DropDownDiv.getPositionMetrics_=function(e,r,a,c){var p=t.DropDownDiv.getBoundsInfo_(),f=t.utils.style.getSize(t.DropDownDiv.DIV_);return r+f.height<p.bottom?t.DropDownDiv.getPositionBelowMetrics_(e,r,p,f):c-f.height>p.top?t.DropDownDiv.getPositionAboveMetrics_(a,c,p,f):r+f.height<document.documentElement.clientHeight?t.DropDownDiv.getPositionBelowMetrics_(e,r,p,f):c-f.height>document.documentElement.clientTop?t.DropDownDiv.getPositionAboveMetrics_(a,c,p,f):t.DropDownDiv.getPositionTopOfPageMetrics_(e,p,f)},t.DropDownDiv.getPositionBelowMetrics_=function(e,r,a,c){return{initialX:(e=t.DropDownDiv.getPositionX(e,a.left,a.right,c.width)).divX,initialY:r,finalX:e.divX,finalY:r+t.DropDownDiv.PADDING_Y,arrowX:e.arrowX,arrowY:-(t.DropDownDiv.ARROW_SIZE/2+t.DropDownDiv.BORDER_SIZE),arrowAtTop:!0,arrowVisible:!0}},t.DropDownDiv.getPositionAboveMetrics_=function(e,r,a,c){return{initialX:(e=t.DropDownDiv.getPositionX(e,a.left,a.right,c.width)).divX,initialY:r-c.height,finalX:e.divX,finalY:r-c.height-t.DropDownDiv.PADDING_Y,arrowX:e.arrowX,arrowY:c.height-2*t.DropDownDiv.BORDER_SIZE-t.DropDownDiv.ARROW_SIZE/2,arrowAtTop:!1,arrowVisible:!0}},t.DropDownDiv.getPositionTopOfPageMetrics_=function(e,r,a){return{initialX:(e=t.DropDownDiv.getPositionX(e,r.left,r.right,a.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},t.DropDownDiv.getPositionX=function(e,r,a,c){var p=e;return e=t.utils.math.clamp(r,e-c/2,a-c),{arrowX:c=t.utils.math.clamp(r=t.DropDownDiv.ARROW_HORIZONTAL_PADDING,(p-=t.DropDownDiv.ARROW_SIZE/2)-e,c-r-t.DropDownDiv.ARROW_SIZE),divX:e}},t.DropDownDiv.isVisible=function(){return!!t.DropDownDiv.owner_},t.DropDownDiv.hideIfOwner=function(e,r){return t.DropDownDiv.owner_===e&&(r?t.DropDownDiv.hideWithoutAnimation():t.DropDownDiv.hide(),!0)},t.DropDownDiv.hide=function(){var e=t.DropDownDiv.DIV_;e.style.transform="translate(0, 0)",e.style.opacity=0,t.DropDownDiv.animateOutTimer_=setTimeout(function(){t.DropDownDiv.hideWithoutAnimation()},1e3*t.DropDownDiv.ANIMATION_TIME),t.DropDownDiv.onHide_&&(t.DropDownDiv.onHide_(),t.DropDownDiv.onHide_=null)},t.DropDownDiv.hideWithoutAnimation=function(){if(t.DropDownDiv.isVisible()){t.DropDownDiv.animateOutTimer_&&clearTimeout(t.DropDownDiv.animateOutTimer_);var e=t.DropDownDiv.DIV_;e.style.transform="",e.style.left="",e.style.top="",e.style.opacity=0,e.style.display="none",e.style.backgroundColor="",e.style.borderColor="",t.DropDownDiv.onHide_&&(t.DropDownDiv.onHide_(),t.DropDownDiv.onHide_=null),t.DropDownDiv.clearContent(),t.DropDownDiv.owner_=null,t.DropDownDiv.rendererClassName_&&(t.utils.dom.removeClass(e,t.DropDownDiv.rendererClassName_),t.DropDownDiv.rendererClassName_=""),t.DropDownDiv.themeClassName_&&(t.utils.dom.removeClass(e,t.DropDownDiv.themeClassName_),t.DropDownDiv.themeClassName_=""),t.getMainWorkspace().markFocused()}},t.DropDownDiv.positionInternal_=function(e,r,a,c){(e=t.DropDownDiv.getPositionMetrics_(e,r,a,c)).arrowVisible?(t.DropDownDiv.arrow_.style.display="",t.DropDownDiv.arrow_.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",t.DropDownDiv.arrow_.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):t.DropDownDiv.arrow_.style.display="none",r=Math.floor(e.initialX),a=Math.floor(e.initialY),c=Math.floor(e.finalX);var p=Math.floor(e.finalY),f=t.DropDownDiv.DIV_;return f.style.left=r+"px",f.style.top=a+"px",f.style.display="block",f.style.opacity=1,f.style.transform="translate("+(c-r)+"px,"+(p-a)+"px)",!!e.arrowAtTop},t.DropDownDiv.repositionForWindowResize=function(){if(t.DropDownDiv.owner_){var e=t.DropDownDiv.owner_,r=e.getSourceBlock();e=t.DropDownDiv.positionToField_?t.DropDownDiv.getScaledBboxOfField_(e):t.DropDownDiv.getScaledBboxOfBlock_(r),t.DropDownDiv.positionInternal_(r=e.left+(e.right-e.left)/2,e.bottom,r,e.top)}else t.DropDownDiv.hide()},t.registry={},t.registry.typeMap_=Object.create(null),t.registry.DEFAULT="default",t.registry.Type=function(e){this.name_=e},t.registry.Type.prototype.toString=function(){return this.name_},t.registry.Type.CONNECTION_CHECKER=new t.registry.Type("connectionChecker"),t.registry.Type.CURSOR=new t.registry.Type("cursor"),t.registry.Type.EVENT=new t.registry.Type("event"),t.registry.Type.FIELD=new t.registry.Type("field"),t.registry.Type.RENDERER=new t.registry.Type("renderer"),t.registry.Type.TOOLBOX=new t.registry.Type("toolbox"),t.registry.Type.THEME=new t.registry.Type("theme"),t.registry.Type.TOOLBOX_ITEM=new t.registry.Type("toolboxItem"),t.registry.Type.FLYOUTS_VERTICAL_TOOLBOX=new t.registry.Type("flyoutsVerticalToolbox"),t.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX=new t.registry.Type("flyoutsHorizontalToolbox"),t.registry.Type.METRICS_MANAGER=new t.registry.Type("metricsManager"),t.registry.Type.BLOCK_DRAGGER=new t.registry.Type("blockDragger"),t.registry.register=function(e,r,a,c){if(!(e instanceof t.registry.Type)&&"string"!=typeof e||""==String(e).trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=String(e).toLowerCase(),"string"!=typeof r||""==r.trim())throw Error('Invalid name "'+r+'". The name must be a non-empty string.');if(r=r.toLowerCase(),!a)throw Error("Can not register a null value");var p=t.registry.typeMap_[e];if(p||(p=t.registry.typeMap_[e]=Object.create(null)),t.registry.validate_(e,a),!c&&p[r])throw Error('Name "'+r+'" with type "'+e+'" already registered.');p[r]=a},t.registry.validate_=function(e,r){if(e===String(t.registry.Type.FIELD)&&"function"!=typeof r.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},t.registry.unregister=function(e,r){e=String(e).toLowerCase(),r=r.toLowerCase();var a=t.registry.typeMap_[e];a&&a[r]?delete t.registry.typeMap_[e][r]:console.warn("Unable to unregister ["+r+"]["+e+"] from the registry.")},t.registry.getItem_=function(e,r,a){e=String(e).toLowerCase(),r=r.toLowerCase();var c=t.registry.typeMap_[e];if(!c||!c[r]){if(r="Unable to find ["+r+"]["+e+"] in the registry.",a)throw Error(r+" You must require or register a "+e+" plugin.");return console.warn(r),null}return c[r]},t.registry.hasItem=function(e,r){return e=String(e).toLowerCase(),r=r.toLowerCase(),!!(e=t.registry.typeMap_[e])&&!!e[r]},t.registry.getClass=function(e,r,a){return t.registry.getItem_(e,r,a)},t.registry.getObject=function(e,r,a){return t.registry.getItem_(e,r,a)},t.registry.getClassFromOptions=function(e,r,a){return"function"==typeof(r=r.plugins[e.toString()]||t.registry.DEFAULT)?r:t.registry.getClass(e,r,a)},t.Events={},t.Events.group_="",t.Events.recordUndo=!0,t.Events.disabled_=0,t.Events.CREATE="create",t.Events.BLOCK_CREATE=t.Events.CREATE,t.Events.DELETE="delete",t.Events.BLOCK_DELETE=t.Events.DELETE,t.Events.CHANGE="change",t.Events.BLOCK_CHANGE=t.Events.CHANGE,t.Events.MOVE="move",t.Events.BLOCK_MOVE=t.Events.MOVE,t.Events.VAR_CREATE="var_create",t.Events.VAR_DELETE="var_delete",t.Events.VAR_RENAME="var_rename",t.Events.UI="ui",t.Events.BLOCK_DRAG="drag",t.Events.SELECTED="selected",t.Events.CLICK="click",t.Events.MARKER_MOVE="marker_move",t.Events.BUBBLE_OPEN="bubble_open",t.Events.TRASHCAN_OPEN="trashcan_open",t.Events.TOOLBOX_ITEM_SELECT="toolbox_item_select",t.Events.THEME_CHANGE="theme_change",t.Events.VIEWPORT_CHANGE="viewport_change",t.Events.COMMENT_CREATE="comment_create",t.Events.COMMENT_DELETE="comment_delete",t.Events.COMMENT_CHANGE="comment_change",t.Events.COMMENT_MOVE="comment_move",t.Events.FINISHED_LOADING="finished_loading",t.Events.BUMP_EVENTS=[t.Events.BLOCK_CREATE,t.Events.BLOCK_MOVE,t.Events.COMMENT_CREATE,t.Events.COMMENT_MOVE],t.Events.FIRE_QUEUE_=[],t.Events.fire=function(e){t.Events.isEnabled()&&(t.Events.FIRE_QUEUE_.length||setTimeout(t.Events.fireNow_,0),t.Events.FIRE_QUEUE_.push(e))},t.Events.fireNow_=function(){for(var a,e=t.Events.filter(t.Events.FIRE_QUEUE_,!0),r=t.Events.FIRE_QUEUE_.length=0;a=e[r];r++)if(a.workspaceId){var c=t.Workspace.getById(a.workspaceId);c&&c.fireChangeListener(a)}},t.Events.filter=function(e,r){e=e.slice(),r||e.reverse();for(var f,a=[],c=Object.create(null),p=0;f=e[p];p++)if(!f.isNull()){var T=[f.isUiEvent?t.Events.UI:f.type,f.blockId,f.workspaceId].join(" "),y=c[T],D=y?y.event:null;y?f.type==t.Events.MOVE&&y.index==p-1?(D.newParentId=f.newParentId,D.newInputName=f.newInputName,D.newCoordinate=f.newCoordinate,y.index=p):f.type==t.Events.CHANGE&&f.element==D.element&&f.name==D.name?D.newValue=f.newValue:f.type==t.Events.VIEWPORT_CHANGE?(D.viewTop=f.viewTop,D.viewLeft=f.viewLeft,D.scale=f.scale,D.oldScale=f.oldScale):(f.type!=t.Events.CLICK||D.type!=t.Events.BUBBLE_OPEN)&&(c[T]={event:f,index:p},a.push(f)):(c[T]={event:f,index:p},a.push(f))}for(e=a.filter(function(k){return!k.isNull()}),r||e.reverse(),p=1;f=e[p];p++)f.type==t.Events.CHANGE&&"mutation"==f.element&&e.unshift(e.splice(p,1)[0]);return e},t.Events.clearPendingUndo=function(){for(var r,e=0;r=t.Events.FIRE_QUEUE_[e];e++)r.recordUndo=!1},t.Events.disable=function(){t.Events.disabled_++},t.Events.enable=function(){t.Events.disabled_--},t.Events.isEnabled=function(){return 0==t.Events.disabled_},t.Events.getGroup=function(){return t.Events.group_},t.Events.setGroup=function(e){t.Events.group_="boolean"==typeof e?e?t.utils.genUid():"":e},t.Events.getDescendantIds=function(e){var r=[];e=e.getDescendants(!1);for(var c,a=0;c=e[a];a++)r[a]=c.id;return r},t.Events.fromJson=function(e,r){var a=t.Events.get(e.type);if(!a)throw Error("Unknown event type.");return(a=new a).fromJson(e),a.workspaceId=r.id,a},t.Events.get=function(e){return t.registry.getClass(t.registry.Type.EVENT,e)},t.Events.disableOrphans=function(e){if((e.type==t.Events.MOVE||e.type==t.Events.CREATE)&&e.workspaceId){var r=t.Workspace.getById(e.workspaceId),a=r.getBlockById(e.blockId);if(a){e=t.Events.recordUndo;try{t.Events.recordUndo=!1;var c=a.getParent();if(c&&c.isEnabled()){var f,p=a.getDescendants(!1);for(r=0;f=p[r];r++)f.setEnabled(!0)}else if((a.outputConnection||a.previousConnection)&&!r.isDragging())do{a.setEnabled(!1),a=a.getNextBlock()}while(a)}finally{t.Events.recordUndo=e}}}},t.Events.Abstract=function(){this.isBlank=null,this.workspaceId=void 0,this.group=t.Events.getGroup(),this.recordUndo=t.Events.recordUndo},t.Events.Abstract.prototype.isUiEvent=!1,t.Events.Abstract.prototype.toJson=function(){var e={type:this.type};return this.group&&(e.group=this.group),e},t.Events.Abstract.prototype.fromJson=function(e){this.isBlank=!1,this.group=e.group},t.Events.Abstract.prototype.isNull=function(){return!1},t.Events.Abstract.prototype.run=function(e){},t.Events.Abstract.prototype.getEventWorkspace_=function(){if(this.workspaceId)var e=t.Workspace.getById(this.workspaceId);if(!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e},t.utils.object={},t.utils.object.inherits=function(e,r){e.superClass_=r.prototype,e.prototype=Object.create(r.prototype),e.prototype.constructor=e},t.utils.object.mixin=function(e,r){for(var a in r)e[a]=r[a]},t.utils.object.deepMerge=function(e,r){for(var a in r)e[a]=null!=r[a]&&"object"==typeof r[a]?t.utils.object.deepMerge(e[a]||Object.create(null),r[a]):r[a];return e},t.utils.object.values=function(e){return Object.values?Object.values(e):Object.keys(e).map(function(r){return e[r]})},t.utils.xml={},t.utils.xml.NAME_SPACE="https://developers.google.com/blockly/xml",t.utils.xml.document=function(){return document},t.utils.xml.createElement=function(e){return t.utils.xml.document().createElementNS(t.utils.xml.NAME_SPACE,e)},t.utils.xml.createTextNode=function(e){return t.utils.xml.document().createTextNode(e)},t.utils.xml.textToDomDocument=function(e){return(new DOMParser).parseFromString(e,"text/xml")},t.utils.xml.domToText=function(e){return(new XMLSerializer).serializeToString(e)},t.inputTypes={VALUE:t.connectionTypes.INPUT_VALUE,STATEMENT:t.connectionTypes.NEXT_STATEMENT,DUMMY:5},t.Xml={},t.Xml.workspaceToDom=function(e,r){var a=t.utils.xml.createElement("xml"),c=t.Xml.variablesToDom(t.Variables.allUsedVarModels(e));c.hasChildNodes()&&a.appendChild(c);var f,p=e.getTopComments(!0);for(c=0;f=p[c];c++)a.appendChild(f.toXmlWithXY(r));for(e=e.getTopBlocks(!0),c=0;p=e[c];c++)a.appendChild(t.Xml.blockToDomWithXY(p,r));return a},t.Xml.variablesToDom=function(e){for(var c,r=t.utils.xml.createElement("variables"),a=0;c=e[a];a++){var p=t.utils.xml.createElement("variable");p.appendChild(t.utils.xml.createTextNode(c.name)),c.type&&p.setAttribute("type",c.type),p.id=c.getId(),r.appendChild(p)}return r},t.Xml.blockToDomWithXY=function(e,r){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;var a;e.workspace.RTL&&(a=e.workspace.getWidth()),r=t.Xml.blockToDom(e,r);var c=e.getRelativeToSurfaceXY();return r.setAttribute("x",Math.round(e.workspace.RTL?a-c.x:c.x)),r.setAttribute("y",Math.round(c.y)),r},t.Xml.fieldToDom_=function(e){if(e.isSerializable()){var r=t.utils.xml.createElement("field");return r.setAttribute("name",e.name||""),e.toXml(r)}return null},t.Xml.allFieldsToDom_=function(e,r){for(var c,a=0;c=e.inputList[a];a++)for(var f,p=0;f=c.fieldRow[p];p++)(f=t.Xml.fieldToDom_(f))&&r.appendChild(f)},t.Xml.blockToDom=function(e,r){if(e.isInsertionMarker())return(e=e.getChildren(!1)[0])?t.Xml.blockToDom(e):new DocumentFragment;var a=t.utils.xml.createElement(e.isShadow()?"shadow":"block");if(a.setAttribute("type",e.type),r||a.setAttribute("id",e.id),e.mutationToDom){var c=e.mutationToDom();c&&(c.hasChildNodes()||c.hasAttributes())&&a.appendChild(c)}if(t.Xml.allFieldsToDom_(e,a),c=e.getCommentText()){var p=e.commentModel.size,f=e.commentModel.pinned,T=t.utils.xml.createElement("comment");T.appendChild(t.utils.xml.createTextNode(c)),T.setAttribute("pinned",f),T.setAttribute("h",p.height),T.setAttribute("w",p.width),a.appendChild(T)}for(e.data&&((c=t.utils.xml.createElement("data")).appendChild(t.utils.xml.createTextNode(e.data)),a.appendChild(c)),c=0;p=e.inputList[c];c++){var y;if(f=!0,p.type!=t.inputTypes.DUMMY){var D=p.connection.targetBlock();p.type==t.inputTypes.VALUE?y=t.utils.xml.createElement("value"):p.type==t.inputTypes.STATEMENT&&(y=t.utils.xml.createElement("statement")),!(T=p.connection.getShadowDom())||D&&D.isShadow()||y.appendChild(t.Xml.cloneShadow_(T,r)),D&&(T=t.Xml.blockToDom(D,r)).nodeType==t.utils.dom.NodeType.ELEMENT_NODE&&(y.appendChild(T),f=!1),y.setAttribute("name",p.name),f||a.appendChild(y)}}return null!=e.inputsInline&&e.inputsInline!=e.inputsInlineDefault&&a.setAttribute("inline",e.inputsInline),e.isCollapsed()&&a.setAttribute("collapsed",!0),e.isEnabled()||a.setAttribute("disabled",!0),e.isDeletable()||e.isShadow()||a.setAttribute("deletable",!1),e.isMovable()||e.isShadow()||a.setAttribute("movable",!1),e.isEditable()||a.setAttribute("editable",!1),(c=e.getNextBlock())&&(T=t.Xml.blockToDom(c,r)).nodeType==t.utils.dom.NodeType.ELEMENT_NODE&&((y=t.utils.xml.createElement("next")).appendChild(T),a.appendChild(y)),!(T=e.nextConnection&&e.nextConnection.getShadowDom())||c&&c.isShadow()||y.appendChild(t.Xml.cloneShadow_(T,r)),a},t.Xml.cloneShadow_=function(e,r){for(var c,a=e=e.cloneNode(!0);a;)if(r&&"shadow"==a.nodeName&&a.removeAttribute("id"),a.firstChild)a=a.firstChild;else{for(;a&&!a.nextSibling;)c=a,a=a.parentNode,c.nodeType==t.utils.dom.NodeType.TEXT_NODE&&""==c.data.trim()&&a.firstChild!=c&&t.utils.dom.removeNode(c);a&&(c=a,a=a.nextSibling,c.nodeType==t.utils.dom.NodeType.TEXT_NODE&&""==c.data.trim()&&t.utils.dom.removeNode(c))}return e},t.Xml.domToText=function(e){return t.utils.xml.domToText(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},t.Xml.domToPrettyText=function(e){e=t.Xml.domToText(e).split("<");for(var r="",a=1;a<e.length;a++){var c=e[a];"/"==c[0]&&(r=r.substring(2)),e[a]=r+"<"+c,"/"!=c[0]&&"/>"!=c.slice(-2)&&(r+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},t.Xml.textToDom=function(e){var r=t.utils.xml.textToDomDocument(e);if(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+e);return r.documentElement},t.Xml.clearWorkspaceAndLoadFromXml=function(e,r){return r.setResizesEnabled(!1),r.clear(),e=t.Xml.domToWorkspace(e,r),r.setResizesEnabled(!0),e},t.Xml.domToWorkspace=function(e,r){if(e instanceof t.Workspace){var a=e;e=r,r=a,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var c;r.RTL&&(c=r.getWidth()),a=[],t.utils.dom.startTextWidthCache();var p=t.Events.getGroup();p||t.Events.setGroup(!0),r.setResizesEnabled&&r.setResizesEnabled(!1);var f=!0;try{for(var y,T=0;y=e.childNodes[T];T++){var D=y.nodeName.toLowerCase(),k=y;if("block"==D||"shadow"==D&&!t.Events.recordUndo){var G=t.Xml.domToBlock(k,r);a.push(G.id);var Se=k.hasAttribute("x")?parseInt(k.getAttribute("x"),10):10,De=k.hasAttribute("y")?parseInt(k.getAttribute("y"),10):10;isNaN(Se)||isNaN(De)||G.moveBy(r.RTL?c-Se:Se,De),f=!1}else{if("shadow"==D)throw TypeError("Shadow block cannot be a top-level block.");if("comment"==D)r.rendered?t.WorkspaceCommentSvg?t.WorkspaceCommentSvg.fromXml(k,r,c):console.warn("Missing require for Blockly.WorkspaceCommentSvg, ignoring workspace comment."):t.WorkspaceComment?t.WorkspaceComment.fromXml(k,r):console.warn("Missing require for Blockly.WorkspaceComment, ignoring workspace comment.");else if("variables"==D){if(!f)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");t.Xml.domToVariables(k,r),f=!1}}}}finally{p||t.Events.setGroup(!1),t.utils.dom.stopTextWidthCache()}return r.setResizesEnabled&&r.setResizesEnabled(!0),t.Events.fire(new(t.Events.get(t.Events.FINISHED_LOADING))(r)),a},t.Xml.appendDomToWorkspace=function(e,r){var a;if(Object.prototype.hasOwnProperty.call(r,"scale")&&(a=r.getBlocksBoundingBox()),e=t.Xml.domToWorkspace(e,r),a&&a.top!=a.bottom){var c=a.bottom,p=r.RTL?a.right:a.left,f=1/0,T=-1/0,y=1/0;for(a=0;a<e.length;a++){var D=r.getBlockById(e[a]).getRelativeToSurfaceXY();D.y<y&&(y=D.y),D.x<f&&(f=D.x),D.x>T&&(T=D.x)}for(c=c-y+10,p=r.RTL?p-T:p-f,a=0;a<e.length;a++)r.getBlockById(e[a]).moveBy(p,c)}return e},t.Xml.domToBlock=function(e,r){if(e instanceof t.Workspace){var a=e;e=r,r=a,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}t.Events.disable(),a=r.getAllVariables();try{var c=t.Xml.domToBlockHeadless_(e,r),p=c.getDescendants(!1);if(r.rendered){c.setConnectionTracking(!1);for(var f=p.length-1;0<=f;f--)p[f].initSvg();for(f=p.length-1;0<=f;f--)p[f].render(!1);setTimeout(function(){c.disposed||c.setConnectionTracking(!0)},1),c.updateDisabled(),r.resizeContents()}else for(f=p.length-1;0<=f;f--)p[f].initModel()}finally{t.Events.enable()}if(t.Events.isEnabled()){for(e=t.Variables.getAddedVariables(r,a),f=0;f<e.length;f++)r=e[f],t.Events.fire(new(t.Events.get(t.Events.VAR_CREATE))(r));t.Events.fire(new(t.Events.get(t.Events.CREATE))(c))}return c},t.Xml.domToVariables=function(e,r){for(var c,a=0;c=e.childNodes[a];a++)if(c.nodeType==t.utils.dom.NodeType.ELEMENT_NODE){var p=c.getAttribute("type"),f=c.getAttribute("id");r.createVariable(c.textContent,p,f)}},t.Xml.mapSupportedXmlTags_=function(e){for(var c,r={mutation:[],comment:[],data:[],field:[],input:[],next:[]},a=0;c=e.childNodes[a];a++)if(c.nodeType!=t.utils.dom.NodeType.TEXT_NODE)switch(c.nodeName.toLowerCase()){case"mutation":r.mutation.push(c);break;case"comment":if(!t.Comment){console.warn("Missing require for Blockly.Comment, ignoring block comment.");break}r.comment.push(c);break;case"data":r.data.push(c);break;case"title":case"field":r.field.push(c);break;case"value":case"statement":r.input.push(c);break;case"next":r.next.push(c);break;default:console.warn("Ignoring unknown tag: "+c.nodeName)}return r},t.Xml.applyMutationTagNodes_=function(e,r){for(var p,a=!1,c=0;p=e[c];c++)r.domToMutation&&(r.domToMutation(p),r.initSvg&&(a=!0));return a},t.Xml.applyCommentTagNodes_=function(e,r){for(var c,a=0;c=e[a];a++){var p=c.textContent,f="true"==c.getAttribute("pinned"),T=parseInt(c.getAttribute("w"),10);c=parseInt(c.getAttribute("h"),10),r.setCommentText(p),r.commentModel.pinned=f,isNaN(T)||isNaN(c)||(r.commentModel.size=new t.utils.Size(T,c)),f&&r.getCommentIcon&&!r.isInFlyout&&setTimeout(function(){r.getCommentIcon().setVisible(!0)},1)}},t.Xml.applyDataTagNodes_=function(e,r){for(var c,a=0;c=e[a];a++)r.data=c.textContent},t.Xml.applyFieldTagNodes_=function(e,r){for(var c,a=0;c=e[a];a++){var p=c.getAttribute("name");t.Xml.domToField_(r,p,c)}},t.Xml.findChildBlocks_=function(e){for(var c,r={childBlockElement:null,childShadowElement:null},a=0;c=e.childNodes[a];a++)c.nodeType==t.utils.dom.NodeType.ELEMENT_NODE&&("block"==c.nodeName.toLowerCase()?r.childBlockElement=c:"shadow"==c.nodeName.toLowerCase()&&(r.childShadowElement=c));return r},t.Xml.applyInputTagNodes_=function(e,r,a,c){for(var f,p=0;f=e[p];p++){var T=f.getAttribute("name"),y=a.getInput(T);if(!y){console.warn("Ignoring non-existent input "+T+" in block "+c);break}if((f=t.Xml.findChildBlocks_(f)).childBlockElement){if(!y.connection)throw TypeError("Input connection does not exist.");t.Xml.domToBlockHeadless_(f.childBlockElement,r,y.connection,!1)}f.childShadowElement&&y.connection.setShadowDom(f.childShadowElement)}},t.Xml.applyNextTagNodes_=function(e,r,a){for(var p,c=0;p=e[c];c++){if((p=t.Xml.findChildBlocks_(p)).childBlockElement){if(!a.nextConnection)throw TypeError("Next statement does not exist.");if(a.nextConnection.isConnected())throw TypeError("Next statement is already connected.");t.Xml.domToBlockHeadless_(p.childBlockElement,r,a.nextConnection,!0)}p.childShadowElement&&a.nextConnection&&a.nextConnection.setShadowDom(p.childShadowElement)}},t.Xml.domToBlockHeadless_=function(e,r,a,c){var p=e.getAttribute("type");if(!p)throw TypeError("Block type unspecified: "+e.outerHTML);var f=e.getAttribute("id");f=r.newBlock(p,f);var T=t.Xml.mapSupportedXmlTags_(e),y=t.Xml.applyMutationTagNodes_(T.mutation,f);if(t.Xml.applyCommentTagNodes_(T.comment,f),t.Xml.applyDataTagNodes_(T.data,f),a)if(c){if(!f.previousConnection)throw TypeError("Next block does not have previous statement.");a.connect(f.previousConnection)}else if(f.outputConnection)a.connect(f.outputConnection);else{if(!f.previousConnection)throw TypeError("Child block does not have output or previous statement.");a.connect(f.previousConnection)}if(t.Xml.applyFieldTagNodes_(T.field,f),t.Xml.applyInputTagNodes_(T.input,r,f,p),t.Xml.applyNextTagNodes_(T.next,r,f),y&&f.initSvg(),(r=e.getAttribute("inline"))&&f.setInputsInline("true"==r),(r=e.getAttribute("disabled"))&&f.setEnabled("true"!=r&&"disabled"!=r),(r=e.getAttribute("deletable"))&&f.setDeletable("true"==r),(r=e.getAttribute("movable"))&&f.setMovable("true"==r),(r=e.getAttribute("editable"))&&f.setEditable("true"==r),(r=e.getAttribute("collapsed"))&&f.setCollapsed("true"==r),"shadow"==e.nodeName.toLowerCase()){for(e=f.getChildren(!1),r=0;a=e[r];r++)if(!a.isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(f.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");f.setShadow(!0)}return f},t.Xml.domToField_=function(e,r,a){var c=e.getField(r);c?c.fromXml(a):console.warn("Ignoring non-existent field "+r+" in block "+e.type)},t.Xml.deleteNext=function(e){for(var a,r=0;a=e.childNodes[r];r++)if("next"==a.nodeName.toLowerCase()){e.removeChild(a);break}},t.Events.BlockBase=function(e){t.Events.BlockBase.superClass_.constructor.call(this),this.blockId=(this.isBlank=void 0===e)?"":e.id,this.workspaceId=this.isBlank?"":e.workspace.id},t.utils.object.inherits(t.Events.BlockBase,t.Events.Abstract),t.Events.BlockBase.prototype.toJson=function(){var e=t.Events.BlockBase.superClass_.toJson.call(this);return e.blockId=this.blockId,e},t.Events.BlockBase.prototype.fromJson=function(e){t.Events.BlockBase.superClass_.fromJson.call(this,e),this.blockId=e.blockId},t.Events.BlockChange=function(e,r,a,c,p){t.Events.Change.superClass_.constructor.call(this,e),e&&(this.element=void 0===r?"":r,this.name=void 0===a?"":a,this.oldValue=void 0===c?"":c,this.newValue=void 0===p?"":p)},t.utils.object.inherits(t.Events.BlockChange,t.Events.BlockBase),t.Events.Change=t.Events.BlockChange,t.Events.BlockChange.prototype.type=t.Events.CHANGE,t.Events.BlockChange.prototype.toJson=function(){var e=t.Events.BlockChange.superClass_.toJson.call(this);return e.element=this.element,this.name&&(e.name=this.name),e.oldValue=this.oldValue,e.newValue=this.newValue,e},t.Events.BlockChange.prototype.fromJson=function(e){t.Events.BlockChange.superClass_.fromJson.call(this,e),this.element=e.element,this.name=e.name,this.oldValue=e.oldValue,this.newValue=e.newValue},t.Events.BlockChange.prototype.isNull=function(){return this.oldValue==this.newValue},t.Events.BlockChange.prototype.run=function(e){var r=this.getEventWorkspace_().getBlockById(this.blockId);if(r)switch(r.mutator&&r.mutator.setVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(r=r.getField(this.name))?r.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":r.setCommentText(e||null);break;case"collapsed":r.setCollapsed(!!e);break;case"disabled":r.setEnabled(!e);break;case"inline":r.setInputsInline(!!e);break;case"mutation":var a="";if(r.mutationToDom&&(a=(a=r.mutationToDom())&&t.Xml.domToText(a)),r.domToMutation){var c=t.Xml.textToDom(e||"<mutation/>");r.domToMutation(c)}t.Events.fire(new t.Events.BlockChange(r,"mutation",null,a,e));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},t.Events.Create=function(e){t.Events.Create.superClass_.constructor.call(this,e),e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=e.workspace.rendered?t.Xml.blockToDomWithXY(e):t.Xml.blockToDom(e),this.ids=t.Events.getDescendantIds(e))},t.utils.object.inherits(t.Events.Create,t.Events.BlockBase),t.Events.BlockCreate=t.Events.Create,t.Events.Create.prototype.type=t.Events.CREATE,t.Events.Create.prototype.toJson=function(){var e=t.Events.Create.superClass_.toJson.call(this);return e.xml=t.Xml.domToText(this.xml),e.ids=this.ids,this.recordUndo||(e.recordUndo=this.recordUndo),e},t.Events.Create.prototype.fromJson=function(e){t.Events.Create.superClass_.fromJson.call(this,e),this.xml=t.Xml.textToDom(e.xml),this.ids=e.ids,void 0!==e.recordUndo&&(this.recordUndo=e.recordUndo)},t.Events.Create.prototype.run=function(e){var r=this.getEventWorkspace_();if(e)(e=t.utils.xml.createElement("xml")).appendChild(this.xml),t.Xml.domToWorkspace(e,r);else{e=0;for(var a;a=this.ids[e];e++){var c=r.getBlockById(a);c?c.dispose(!1):a==this.blockId&&console.warn("Can't uncreate non-existent block: "+a)}}},t.Events.Delete=function(e){if(t.Events.Delete.superClass_.constructor.call(this,e),e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=e.workspace.rendered?t.Xml.blockToDomWithXY(e):t.Xml.blockToDom(e),this.ids=t.Events.getDescendantIds(e)}},t.utils.object.inherits(t.Events.Delete,t.Events.BlockBase),t.Events.BlockDelete=t.Events.Delete,t.Events.Delete.prototype.type=t.Events.DELETE,t.Events.Delete.prototype.toJson=function(){var e=t.Events.Delete.superClass_.toJson.call(this);return e.oldXml=t.Xml.domToText(this.oldXml),e.ids=this.ids,this.recordUndo||(e.recordUndo=this.recordUndo),e},t.Events.Delete.prototype.fromJson=function(e){t.Events.Delete.superClass_.fromJson.call(this,e),this.oldXml=t.Xml.textToDom(e.oldXml),this.ids=e.ids,void 0!==e.recordUndo&&(this.recordUndo=e.recordUndo)},t.Events.Delete.prototype.run=function(e){var r=this.getEventWorkspace_();if(e){e=0;for(var a;a=this.ids[e];e++){var c=r.getBlockById(a);c?c.dispose(!1):a==this.blockId&&console.warn("Can't delete non-existent block: "+a)}}else(e=t.utils.xml.createElement("xml")).appendChild(this.oldXml),t.Xml.domToWorkspace(e,r)},t.Events.Move=function(e){t.Events.Move.superClass_.constructor.call(this,e),e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation_(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)},t.utils.object.inherits(t.Events.Move,t.Events.BlockBase),t.Events.BlockMove=t.Events.Move,t.Events.Move.prototype.type=t.Events.MOVE,t.Events.Move.prototype.toJson=function(){var e=t.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(e.newParentId=this.newParentId),this.newInputName&&(e.newInputName=this.newInputName),this.newCoordinate&&(e.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),this.recordUndo||(e.recordUndo=this.recordUndo),e},t.Events.Move.prototype.fromJson=function(e){if(t.Events.Move.superClass_.fromJson.call(this,e),this.newParentId=e.newParentId,this.newInputName=e.newInputName,e.newCoordinate){var r=e.newCoordinate.split(",");this.newCoordinate=new t.utils.Coordinate(Number(r[0]),Number(r[1]))}void 0!==e.recordUndo&&(this.recordUndo=e.recordUndo)},t.Events.Move.prototype.recordNew=function(){var e=this.currentLocation_();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate},t.Events.Move.prototype.currentLocation_=function(){var e=this.getEventWorkspace_().getBlockById(this.blockId),r={},a=e.getParent();return a?(r.parentId=a.id,(e=a.getInputWithBlock(e))&&(r.inputName=e.name)):r.coordinate=e.getRelativeToSurfaceXY(),r},t.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&t.utils.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},t.Events.Move.prototype.run=function(e){var r=this.getEventWorkspace_(),a=r.getBlockById(this.blockId);if(a){var c=e?this.newParentId:this.oldParentId,p=e?this.newInputName:this.oldInputName,f=e?this.newCoordinate:this.oldCoordinate;if(e=null,c&&!(e=r.getBlockById(c)))return void console.warn("Can't connect to non-existent block: "+c);if(a.getParent()&&a.unplug(),f)p=a.getRelativeToSurfaceXY(),a.moveBy(f.x-p.x,f.y-p.y);else{if(r=(a=a.outputConnection||a.previousConnection).type,p){if(e=e.getInput(p))var T=e.connection}else r==t.connectionTypes.PREVIOUS_STATEMENT&&(T=e.nextConnection);T?a.connect(T):console.warn("Can't connect to non-existent input: "+p)}}else console.warn("Can't move non-existent block: "+this.blockId)},t.registry.register(t.registry.Type.EVENT,t.Events.CREATE,t.Events.Create),t.registry.register(t.registry.Type.EVENT,t.Events.DELETE,t.Events.Delete),t.registry.register(t.registry.Type.EVENT,t.Events.CHANGE,t.Events.BlockChange),t.registry.register(t.registry.Type.EVENT,t.Events.MOVE,t.Events.Move),t.Events.FinishedLoading=function(e){this.isBlank=void 0===e,this.workspaceId=e?e.id:"",this.group=t.Events.getGroup(),this.recordUndo=!1},t.utils.object.inherits(t.Events.FinishedLoading,t.Events.Abstract),t.Events.FinishedLoading.prototype.type=t.Events.FINISHED_LOADING,t.Events.FinishedLoading.prototype.toJson=function(){var e={type:this.type};return this.group&&(e.group=this.group),this.workspaceId&&(e.workspaceId=this.workspaceId),e},t.Events.FinishedLoading.prototype.fromJson=function(e){this.isBlank=!1,this.workspaceId=e.workspaceId,this.group=e.group},t.registry.register(t.registry.Type.EVENT,t.Events.FINISHED_LOADING,t.Events.FinishedLoading),t.Events.UiBase=function(e){t.Events.UiBase.superClass_.constructor.call(this),this.isBlank=void 0===e,this.workspaceId=e||"",this.recordUndo=!1},t.utils.object.inherits(t.Events.UiBase,t.Events.Abstract),t.Events.UiBase.prototype.isUiEvent=!0,t.Events.Ui=function(e,r,a,c){t.Events.Ui.superClass_.constructor.call(this,e?e.workspace.id:void 0),this.blockId=e?e.id:null,this.element=void 0===r?"":r,this.oldValue=void 0===a?"":a,this.newValue=void 0===c?"":c},t.utils.object.inherits(t.Events.Ui,t.Events.UiBase),t.Events.Ui.prototype.type=t.Events.UI,t.Events.Ui.prototype.toJson=function(){var e=t.Events.Ui.superClass_.toJson.call(this);return e.element=this.element,void 0!==this.newValue&&(e.newValue=this.newValue),this.blockId&&(e.blockId=this.blockId),e},t.Events.Ui.prototype.fromJson=function(e){t.Events.Ui.superClass_.fromJson.call(this,e),this.element=e.element,this.newValue=e.newValue,this.blockId=e.blockId},t.registry.register(t.registry.Type.EVENT,t.Events.UI,t.Events.Ui),t.Events.VarBase=function(e){t.Events.VarBase.superClass_.constructor.call(this),this.varId=(this.isBlank=void 0===e)?"":e.getId(),this.workspaceId=this.isBlank?"":e.workspace.id},t.utils.object.inherits(t.Events.VarBase,t.Events.Abstract),t.Events.VarBase.prototype.toJson=function(){var e=t.Events.VarBase.superClass_.toJson.call(this);return e.varId=this.varId,e},t.Events.VarBase.prototype.fromJson=function(e){t.Events.VarBase.superClass_.toJson.call(this),this.varId=e.varId},t.Events.VarCreate=function(e){t.Events.VarCreate.superClass_.constructor.call(this,e),e&&(this.varType=e.type,this.varName=e.name)},t.utils.object.inherits(t.Events.VarCreate,t.Events.VarBase),t.Events.VarCreate.prototype.type=t.Events.VAR_CREATE,t.Events.VarCreate.prototype.toJson=function(){var e=t.Events.VarCreate.superClass_.toJson.call(this);return e.varType=this.varType,e.varName=this.varName,e},t.Events.VarCreate.prototype.fromJson=function(e){t.Events.VarCreate.superClass_.fromJson.call(this,e),this.varType=e.varType,this.varName=e.varName},t.Events.VarCreate.prototype.run=function(e){var r=this.getEventWorkspace_();e?r.createVariable(this.varName,this.varType,this.varId):r.deleteVariableById(this.varId)},t.Events.VarDelete=function(e){t.Events.VarDelete.superClass_.constructor.call(this,e),e&&(this.varType=e.type,this.varName=e.name)},t.utils.object.inherits(t.Events.VarDelete,t.Events.VarBase),t.Events.VarDelete.prototype.type=t.Events.VAR_DELETE,t.Events.VarDelete.prototype.toJson=function(){var e=t.Events.VarDelete.superClass_.toJson.call(this);return e.varType=this.varType,e.varName=this.varName,e},t.Events.VarDelete.prototype.fromJson=function(e){t.Events.VarDelete.superClass_.fromJson.call(this,e),this.varType=e.varType,this.varName=e.varName},t.Events.VarDelete.prototype.run=function(e){var r=this.getEventWorkspace_();e?r.deleteVariableById(this.varId):r.createVariable(this.varName,this.varType,this.varId)},t.Events.VarRename=function(e,r){t.Events.VarRename.superClass_.constructor.call(this,e),e&&(this.oldName=e.name,this.newName=void 0===r?"":r)},t.utils.object.inherits(t.Events.VarRename,t.Events.VarBase),t.Events.VarRename.prototype.type=t.Events.VAR_RENAME,t.Events.VarRename.prototype.toJson=function(){var e=t.Events.VarRename.superClass_.toJson.call(this);return e.oldName=this.oldName,e.newName=this.newName,e},t.Events.VarRename.prototype.fromJson=function(e){t.Events.VarRename.superClass_.fromJson.call(this,e),this.oldName=e.oldName,this.newName=e.newName},t.Events.VarRename.prototype.run=function(e){this.getEventWorkspace_().renameVariableById(this.varId,e?this.newName:this.oldName)},t.registry.register(t.registry.Type.EVENT,t.Events.VAR_CREATE,t.Events.VarCreate),t.registry.register(t.registry.Type.EVENT,t.Events.VAR_DELETE,t.Events.VarDelete),t.registry.register(t.registry.Type.EVENT,t.Events.VAR_RENAME,t.Events.VarRename),t.BlockDragSurfaceSvg=function(e){this.container_=e,this.createDom()},t.BlockDragSurfaceSvg.prototype.SVG_=null,t.BlockDragSurfaceSvg.prototype.dragGroup_=null,t.BlockDragSurfaceSvg.prototype.container_=null,t.BlockDragSurfaceSvg.prototype.scale_=1,t.BlockDragSurfaceSvg.prototype.surfaceXY_=null,t.BlockDragSurfaceSvg.prototype.childSurfaceXY_=new t.utils.Coordinate(0,0),t.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=t.utils.dom.createSvgElement(t.utils.Svg.SVG,{xmlns:t.utils.dom.SVG_NS,"xmlns:html":t.utils.dom.HTML_NS,"xmlns:xlink":t.utils.dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{},this.SVG_))},t.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(e){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(e),this.SVG_.style.display="block",this.surfaceXY_=new t.utils.Coordinate(0,0)},t.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(e,r,a){this.scale_=a,e=e.toFixed(0),r=r.toFixed(0),this.childSurfaceXY_.x=parseInt(e,10),this.childSurfaceXY_.y=parseInt(r,10),this.dragGroup_.setAttribute("transform","translate("+e+","+r+") scale("+a+")")},t.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var e=this.surfaceXY_.x,r=this.surfaceXY_.y;e=e.toFixed(0),r=r.toFixed(0),this.SVG_.style.display="block",t.utils.dom.setCssTransform(this.SVG_,"translate3d("+e+"px, "+r+"px, 0px)")},t.BlockDragSurfaceSvg.prototype.translateBy=function(e,r){this.surfaceXY_=new t.utils.Coordinate(this.surfaceXY_.x+e,this.surfaceXY_.y+r),this.translateSurfaceInternal_()},t.BlockDragSurfaceSvg.prototype.translateSurface=function(e,r){this.surfaceXY_=new t.utils.Coordinate(e*this.scale_,r*this.scale_),this.translateSurfaceInternal_()},t.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var e=t.utils.getRelativeXY(this.SVG_);return new t.utils.Coordinate(e.x/this.scale_,e.y/this.scale_)},t.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},t.BlockDragSurfaceSvg.prototype.getSvgRoot=function(){return this.SVG_},t.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},t.BlockDragSurfaceSvg.prototype.getWsTranslation=function(){return this.childSurfaceXY_.clone()},t.BlockDragSurfaceSvg.prototype.clearAndHide=function(e){if(e?e.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null},t.Css={},t.Css.injected_=!1,t.Css.register=function(e){if(t.Css.injected_)throw Error("CSS already injected");Array.prototype.push.apply(t.Css.CONTENT,e),e.length=0},t.Css.inject=function(e,r){if(!t.Css.injected_){t.Css.injected_=!0;var a=t.Css.CONTENT.join("\n");t.Css.CONTENT.length=0,e&&(e=r.replace(/[\\/]$/,""),a=a.replace(/<<<PATH>>>/g,e),(e=document.createElement("style")).id="blockly-common-style",a=document.createTextNode(a),e.appendChild(a),document.head.insertBefore(e,document.head.firstChild))}},t.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none;","}",".blocklyNonSelectable {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyBlockCanvas.blocklyCanvasTransitioning,",".blocklyBubbleCanvas.blocklyCanvasTransitioning {","transition: transform .5s;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font: 9pt sans-serif;","opacity: .9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: absolute;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-color: #dadce0;","background-color: #fff;","border-radius: 2px;","padding: 4px;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","overflow-x: hidden;","position: relative;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyArrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".blocklyArrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #515A5A;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyInsertionMarker>.blocklyPath,",".blocklyInsertionMarker>.blocklyPathLight,",".blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: .2;","stroke: none;","}",".blocklyMultilineText {","font-family: monospace;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyText text {","cursor: default;","}",".blocklySvg text,",".blocklyBlockDragSurface text {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","height: 100%;","margin: 0;","outline: none;","padding: 0;","width: 100%;","text-align: center;","display: block;","box-sizing: border-box;","}",".blocklyHtmlInput::-ms-clear {","display: none;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal,",".blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyVerticalMarker {","stroke-width: 3px;","fill: rgba(255,255,255,.5);","pointer-events: none;","}",".blocklyComputeCanvas {","position: absolute;","width: 0;","height: 0;","}",".blocklyNoPointerEvents {","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","border-radius: 2px;","padding: 0 !important;","}",".blocklyDropdownMenu .blocklyMenuItem {","padding-left: 28px;","}",".blocklyDropdownMenu .blocklyMenuItemRtl {","padding-left: 5px;","padding-right: 28px;","}",".blocklyWidgetDiv .blocklyMenu {","background: #fff;","border: 1px solid transparent;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","}",".blocklyWidgetDiv .blocklyMenu.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv .blocklyMenu {","background: inherit;","border: inherit;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","position: relative;","z-index: 20000;","}",".blocklyMenuItem {","border: none;","color: #000;","cursor: pointer;","list-style: none;","margin: 0;","min-width: 7em;","padding: 6px 15px;","white-space: nowrap;","}",".blocklyMenuItemDisabled {","color: #ccc;","cursor: inherit;","}",".blocklyMenuItemHighlight {","background-color: rgba(0,0,0,.1);","}",".blocklyMenuItemCheckbox {","height: 16px;","position: absolute;","width: 16px;","}",".blocklyMenuItemSelected .blocklyMenuItemCheckbox {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;","float: left;","margin-left: -24px;","position: static;","}",".blocklyMenuItemRtl .blocklyMenuItemCheckbox {","float: right;","margin-right: -24px;","}"],t.Grid=function(e,r){this.gridPattern_=e,this.spacing_=r.spacing,this.length_=r.length,this.line2_=(this.line1_=e.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=r.snap},t.Grid.prototype.scale_=1,t.Grid.prototype.dispose=function(){this.gridPattern_=null},t.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},t.Grid.prototype.getSpacing=function(){return this.spacing_},t.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},t.Grid.prototype.update=function(e){this.scale_=e;var r=this.spacing_*e||100;this.gridPattern_.setAttribute("width",r),this.gridPattern_.setAttribute("height",r);var a=(r=Math.floor(this.spacing_/2)+.5)-this.length_/2,c=r+this.length_/2;this.setLineAttributes_(this.line1_,e,a*=e,c*=e,r*=e,r),this.setLineAttributes_(this.line2_,e,r,r,a,c)},t.Grid.prototype.setLineAttributes_=function(e,r,a,c,p,f){e&&(e.setAttribute("stroke-width",r),e.setAttribute("x1",a),e.setAttribute("y1",p),e.setAttribute("x2",c),e.setAttribute("y2",f))},t.Grid.prototype.moveTo=function(e,r){this.gridPattern_.setAttribute("x",e),this.gridPattern_.setAttribute("y",r),(t.utils.userAgent.IE||t.utils.userAgent.EDGE)&&this.update(this.scale_)},t.Grid.createDom=function(e,r,a){return e=t.utils.dom.createSvgElement(t.utils.Svg.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},a),0<r.length&&0<r.spacing?(t.utils.dom.createSvgElement(t.utils.Svg.LINE,{stroke:r.colour},e),1<r.length&&t.utils.dom.createSvgElement(t.utils.Svg.LINE,{stroke:r.colour},e)):t.utils.dom.createSvgElement(t.utils.Svg.LINE,{},e),e},t.Theme=function(e,r,a,c){this.name=e,this.blockStyles=r||Object.create(null),this.categoryStyles=a||Object.create(null),this.componentStyles=c||Object.create(null),this.fontStyle=Object.create(null),this.startHats=null,t.registry.register(t.registry.Type.THEME,e,this)},t.Theme.prototype.getClassName=function(){return this.name+"-theme"},t.Theme.prototype.setBlockStyle=function(e,r){this.blockStyles[e]=r},t.Theme.prototype.setCategoryStyle=function(e,r){this.categoryStyles[e]=r},t.Theme.prototype.getComponentStyle=function(e){return(e=this.componentStyles[e])&&"string"==typeof e&&this.getComponentStyle(e)?this.getComponentStyle(e):e?String(e):null},t.Theme.prototype.setComponentStyle=function(e,r){this.componentStyles[e]=r},t.Theme.prototype.setFontStyle=function(e){this.fontStyle=e},t.Theme.prototype.setStartHats=function(e){this.startHats=e},t.Theme.defineTheme=function(e,r){var a=new t.Theme(e),c=r.base;return c&&("string"==typeof c&&(c=t.registry.getObject(t.registry.Type.THEME,c)),c instanceof t.Theme&&(t.utils.object.deepMerge(a,c),a.name=e)),t.utils.object.deepMerge(a.blockStyles,r.blockStyles),t.utils.object.deepMerge(a.categoryStyles,r.categoryStyles),t.utils.object.deepMerge(a.componentStyles,r.componentStyles),t.utils.object.deepMerge(a.fontStyle,r.fontStyle),null!=r.startHats&&(a.startHats=r.startHats),a},t.Themes={},t.Themes.Classic={},t.Themes.Classic.defaultBlockStyles={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},t.Themes.Classic.categoryStyles={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},t.Themes.Classic=new t.Theme("classic",t.Themes.Classic.defaultBlockStyles,t.Themes.Classic.categoryStyles),t.utils.IdGenerator={},t.utils.IdGenerator.nextId_=0,t.utils.IdGenerator.getNextUniqueId=function(){return"blockly-"+(t.utils.IdGenerator.nextId_++).toString(36)},t.utils.Metrics=function(){},t.utils.toolbox={},t.utils.toolbox.CATEGORY_TOOLBOX_KIND="categoryToolbox",t.utils.toolbox.FLYOUT_TOOLBOX_KIND="flyoutToolbox",t.utils.toolbox.Position={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3},t.utils.toolbox.convertToolboxDefToJson=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=t.utils.toolbox.parseToolboxTree(e),e=t.utils.toolbox.convertToToolboxJson_(e)),t.utils.toolbox.validateToolbox_(e),e):null},t.utils.toolbox.validateToolbox_=function(e){var r=e.kind;if(e=e.contents,r&&r!=t.utils.toolbox.FLYOUT_TOOLBOX_KIND&&r!=t.utils.toolbox.CATEGORY_TOOLBOX_KIND)throw Error("Invalid toolbox kind "+r+". Please supply either "+t.utils.toolbox.FLYOUT_TOOLBOX_KIND+" or "+t.utils.toolbox.CATEGORY_TOOLBOX_KIND);if(!e)throw Error("Toolbox must have a contents attribute.")},t.utils.toolbox.convertFlyoutDefToJsonArray=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:t.utils.toolbox.xmlToJsonArray_(e):[]},t.utils.toolbox.hasCategories=function(e){if(!e)return!1;var r=e.kind;return r?r==t.utils.toolbox.CATEGORY_TOOLBOX_KIND:!!e.contents.filter(function(a){return"CATEGORY"==a.kind.toUpperCase()}).length},t.utils.toolbox.isCategoryCollapsible=function(e){return!(!e||!e.contents||!e.contents.filter(function(r){return"CATEGORY"==r.kind.toUpperCase()}).length)},t.utils.toolbox.convertToToolboxJson_=function(e){var r={contents:t.utils.toolbox.xmlToJsonArray_(e)};return e instanceof Node&&t.utils.toolbox.addAttributes_(e,r),r},t.utils.toolbox.xmlToJsonArray_=function(e){var c,r=[],a=e.childNodes;for(a||(a=e),e=0;c=a[e];e++)if(c.tagName){var p={},f=c.tagName.toUpperCase();p.kind=f,"BLOCK"==f?p.blockxml=c:c.childNodes&&0<c.childNodes.length&&(p.contents=t.utils.toolbox.xmlToJsonArray_(c)),t.utils.toolbox.addAttributes_(c,p),r.push(p)}return r},t.utils.toolbox.addAttributes_=function(e,r){for(var a=0;a<e.attributes.length;a++){var c=e.attributes[a];-1<c.nodeName.indexOf("css-")?(r.cssconfig=r.cssconfig||{},r.cssconfig[c.nodeName.replace("css-","")]=c.value):r[c.nodeName]=c.value}},t.utils.toolbox.parseToolboxTree=function(e){if(e){if("string"!=typeof e&&(t.utils.userAgent.IE&&e.outerHTML?e=e.outerHTML:e instanceof Element||(e=null)),"string"==typeof e&&"xml"!=(e=t.Xml.textToDom(e)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e=null;return e},t.Options=function(e){var r=!!e.readOnly;if(r)var a=null,c=!1,p=!1,f=!1,T=!1,y=!1,D=!1;else{a=t.utils.toolbox.convertToolboxDefToJson(e.toolbox),c=t.utils.toolbox.hasCategories(a),void 0===(p=e.trashcan)&&(p=c);var k=e.maxTrashcanContents;p?void 0===k&&(k=32):k=0,void 0===(f=e.collapse)&&(f=c),void 0===(T=e.comments)&&(T=c),void 0===(y=e.disable)&&(y=c),void 0===(D=e.sounds)&&(D=!0)}var G=!!e.rtl,Se=e.horizontalLayout;void 0===Se&&(Se=!1);var De=e.toolboxPosition;De="end"!==De,De=Se?De?t.utils.toolbox.Position.TOP:t.utils.toolbox.Position.BOTTOM:De==G?t.utils.toolbox.Position.RIGHT:t.utils.toolbox.Position.LEFT;var dt=e.css;void 0===dt&&(dt=!0);var qt="https://blockly-demo.appspot.com/static/media/";e.media?qt=e.media:e.path&&(qt=e.path+"media/");var Pn=void 0===e.oneBasedIndex||!!e.oneBasedIndex,cr=e.renderer||"geras",hr=e.plugins||{};this.RTL=G,this.oneBasedIndex=Pn,this.collapse=f,this.comments=T,this.disable=y,this.readOnly=r,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=e.maxInstances,this.pathToMedia=qt,this.hasCategories=c,this.moveOptions=t.Options.parseMoveOptions_(e,c),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=p,this.maxTrashcanContents=k,this.hasSounds=D,this.hasCss=dt,this.horizontalLayout=Se,this.languageTree=a,this.gridOptions=t.Options.parseGridOptions_(e),this.zoomOptions=t.Options.parseZoomOptions_(e),this.toolboxPosition=De,this.theme=t.Options.parseThemeOptions_(e),this.renderer=cr,this.rendererOverrides=e.rendererOverrides,this.gridPattern=null,this.parentWorkspace=e.parentWorkspace,this.plugins=hr},t.BlocklyOptions=function(){},t.Options.parseMoveOptions_=function(e,r){var a=e.move||{},c={};return void 0===a.scrollbars&&void 0===e.scrollbars?c.scrollbars=r:"object"==typeof a.scrollbars?(c.scrollbars={},c.scrollbars.horizontal=!!a.scrollbars.horizontal,c.scrollbars.vertical=!!a.scrollbars.vertical,c.scrollbars.horizontal&&c.scrollbars.vertical?c.scrollbars=!0:c.scrollbars.horizontal||c.scrollbars.vertical||(c.scrollbars=!1)):c.scrollbars=!!a.scrollbars||!!e.scrollbars,c.wheel=c.scrollbars&&void 0!==a.wheel?!!a.wheel:"object"==typeof c.scrollbars,c.drag=!(!c.scrollbars||void 0!==a.drag&&!a.drag),c},t.Options.parseZoomOptions_=function(e){var r={};return r.controls=void 0!==(e=e.zoom||{}).controls&&!!e.controls,r.wheel=void 0!==e.wheel&&!!e.wheel,r.startScale=void 0===e.startScale?1:Number(e.startScale),r.maxScale=void 0===e.maxScale?3:Number(e.maxScale),r.minScale=void 0===e.minScale?.3:Number(e.minScale),r.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),r.pinch=void 0===e.pinch?r.wheel||r.controls:!!e.pinch,r},t.Options.parseGridOptions_=function(e){e=e.grid||{};var r={};return r.spacing=Number(e.spacing)||0,r.colour=e.colour||"#888",r.length=void 0===e.length?1:Number(e.length),r.snap=0<r.spacing&&!!e.snap,r},t.Options.parseThemeOptions_=function(e){return"string"==typeof(e=e.theme||t.Themes.Classic)?t.registry.getObject(t.registry.Type.THEME,e):e instanceof t.Theme?e:t.Theme.defineTheme(e.name||"builtin"+t.utils.IdGenerator.getNextUniqueId(),e)},t.Options.parseToolboxTree=function(e){return t.utils.deprecation.warn("Blockly.Options.parseToolboxTree","September 2020","September 2021","Blockly.utils.toolbox.parseToolboxTree"),t.utils.toolbox.parseToolboxTree(e)},t.ScrollbarPair=function(e,r,a,c,p){this.workspace_=e,a=void 0===a||a;var f=(r=void 0===r||r)&&a;r&&(this.hScroll=new t.Scrollbar(e,!0,f,c,p)),a&&(this.vScroll=new t.Scrollbar(e,!1,f,c,p)),f&&(this.corner_=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{height:t.Scrollbar.scrollbarThickness,width:t.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),t.utils.dom.insertAfter(this.corner_,e.getBubbleCanvas())),this.oldHostMetrics_=null},t.ScrollbarPair.prototype.dispose=function(){t.utils.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)},t.ScrollbarPair.prototype.resize=function(){var e=this.workspace_.getMetrics();if(e){var r=!1,a=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==e.viewWidth&&this.oldHostMetrics_.viewHeight==e.viewHeight&&this.oldHostMetrics_.absoluteTop==e.absoluteTop&&this.oldHostMetrics_.absoluteLeft==e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth==e.scrollWidth&&this.oldHostMetrics_.viewLeft==e.viewLeft&&this.oldHostMetrics_.scrollLeft==e.scrollLeft||(r=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight==e.scrollHeight&&this.oldHostMetrics_.viewTop==e.viewTop&&this.oldHostMetrics_.scrollTop==e.scrollTop||(a=!0)):a=r=!0,r||a){try{t.Events.disable(),this.hScroll&&r&&this.hScroll.resize(e),this.vScroll&&a&&this.vScroll.resize(e)}finally{t.Events.enable()}this.workspace_.maybeFireViewportChangeEvent()}this.hScroll&&this.vScroll&&(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==e.viewWidth&&this.oldHostMetrics_.absoluteLeft==e.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==e.viewHeight&&this.oldHostMetrics_.absoluteTop==e.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position.y)),this.oldHostMetrics_=e}},t.ScrollbarPair.prototype.canScrollHorizontally=function(){return!!this.hScroll},t.ScrollbarPair.prototype.canScrollVertically=function(){return!!this.vScroll},t.ScrollbarPair.prototype.setOrigin=function(e,r){this.hScroll&&this.hScroll.setOrigin(e,r),this.vScroll&&this.vScroll.setOrigin(e,r)},t.ScrollbarPair.prototype.set=function(e,r,a){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(r,!1),(a||void 0===a)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace_.setMetrics(e))},t.ScrollbarPair.prototype.setX=function(e){this.hScroll&&this.hScroll.set(e,!0)},t.ScrollbarPair.prototype.setY=function(e){this.vScroll&&this.vScroll.set(e,!0)},t.ScrollbarPair.prototype.setContainerVisible=function(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)},t.ScrollbarPair.prototype.isVisible=function(){var e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e},t.ScrollbarPair.prototype.resizeContent=function(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)},t.ScrollbarPair.prototype.resizeView=function(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)},t.Scrollbar=function(e,r,a,c,p){this.workspace_=e,this.pair_=a||!1,this.horizontal_=r,this.margin_=void 0!==p?p:t.Scrollbar.DEFAULT_SCROLLBAR_MARGIN,this.ratio=this.oldHostMetrics_=null,this.createDom_(c),this.position=new t.utils.Coordinate(0,0),e=t.Scrollbar.scrollbarThickness,r?(this.svgBackground_.setAttribute("height",e),this.outerSvg_.setAttribute("height",e),this.svgHandle_.setAttribute("height",e-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",e),this.outerSvg_.setAttribute("width",e),this.svgHandle_.setAttribute("width",e-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=t.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=t.browserEvents.conditionalBind(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},t.Scrollbar.prototype.origin_=new t.utils.Coordinate(0,0),t.Scrollbar.prototype.startDragMouse_=0,t.Scrollbar.prototype.scrollbarLength_=0,t.Scrollbar.prototype.handleLength_=0,t.Scrollbar.prototype.handlePosition_=0,t.Scrollbar.prototype.isVisible_=!0,t.Scrollbar.prototype.containerVisible_=!0,t.Scrollbar.scrollbarThickness=15,t.Touch.TOUCH_ENABLED&&(t.Scrollbar.scrollbarThickness=25),t.Scrollbar.DEFAULT_SCROLLBAR_MARGIN=.5,t.Scrollbar.metricsAreEquivalent_=function(e,r){return e.viewWidth==r.viewWidth&&e.viewHeight==r.viewHeight&&e.viewLeft==r.viewLeft&&e.viewTop==r.viewTop&&e.absoluteTop==r.absoluteTop&&e.absoluteLeft==r.absoluteLeft&&e.scrollWidth==r.scrollWidth&&e.scrollHeight==r.scrollHeight&&e.scrollLeft==r.scrollLeft&&e.scrollTop==r.scrollTop},t.Scrollbar.prototype.dispose=function(){this.cleanUp_(),t.browserEvents.unbind(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,t.browserEvents.unbind(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,t.utils.dom.removeNode(this.outerSvg_),this.svgBackground_=this.svgGroup_=this.outerSvg_=null,this.svgHandle_&&(this.workspace_.getThemeManager().unsubscribe(this.svgHandle_),this.svgHandle_=null),this.workspace_=null},t.Scrollbar.prototype.constrainHandleLength_=function(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength_)},t.Scrollbar.prototype.setHandleLength_=function(e){this.handleLength_=e,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},t.Scrollbar.prototype.constrainHandlePosition_=function(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength_-this.handleLength_)},t.Scrollbar.prototype.setHandlePosition=function(e){this.handlePosition_=e,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},t.Scrollbar.prototype.setScrollbarLength_=function(e){this.scrollbarLength_=e,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollbarLength_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollbarLength_)},t.Scrollbar.prototype.setPosition=function(e,r){this.position.x=e,this.position.y=r,t.utils.dom.setCssTransform(this.outerSvg_,"translate("+(this.position.x+this.origin_.x)+"px,"+(this.position.y+this.origin_.y)+"px)")},t.Scrollbar.prototype.resize=function(e){!e&&!(e=this.workspace_.getMetrics())||this.oldHostMetrics_&&t.Scrollbar.metricsAreEquivalent_(e,this.oldHostMetrics_)||(this.horizontal_?this.resizeHorizontal_(e):this.resizeVertical_(e),this.oldHostMetrics_=e,this.updateMetrics_())},t.Scrollbar.prototype.requiresViewResize_=function(e){return!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==e.viewWidth||this.oldHostMetrics_.viewHeight!==e.viewHeight||this.oldHostMetrics_.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics_.absoluteTop!==e.absoluteTop},t.Scrollbar.prototype.resizeHorizontal_=function(e){this.requiresViewResize_(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)},t.Scrollbar.prototype.resizeViewHorizontal=function(e){var r=e.viewWidth-2*this.margin_;this.pair_&&(r-=t.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,r)),r=e.absoluteLeft+this.margin_,this.pair_&&this.workspace_.RTL&&(r+=t.Scrollbar.scrollbarThickness),this.setPosition(r,e.absoluteTop+e.viewHeight-t.Scrollbar.scrollbarThickness-this.margin_),this.resizeContentHorizontal(e)},t.Scrollbar.prototype.resizeContentHorizontal=function(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var r=this.scrollbarLength_*e.viewWidth/e.scrollWidth;r=this.constrainHandleLength_(r),this.setHandleLength_(r);var a=this.scrollbarLength_-this.handleLength_;e=this.constrainHandlePosition_(e=(e.viewLeft-e.scrollLeft)/(r=e.scrollWidth-e.viewWidth)*a),this.setHandlePosition(e),this.ratio=a/r}},t.Scrollbar.prototype.resizeVertical_=function(e){this.requiresViewResize_(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)},t.Scrollbar.prototype.resizeViewVertical=function(e){var r=e.viewHeight-2*this.margin_;this.pair_&&(r-=t.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,r)),this.setPosition(this.workspace_.RTL?e.absoluteLeft+this.margin_:e.absoluteLeft+e.viewWidth-t.Scrollbar.scrollbarThickness-this.margin_,e.absoluteTop+this.margin_),this.resizeContentVertical(e)},t.Scrollbar.prototype.resizeContentVertical=function(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var r=this.scrollbarLength_*e.viewHeight/e.scrollHeight;r=this.constrainHandleLength_(r),this.setHandleLength_(r);var a=this.scrollbarLength_-this.handleLength_;e=this.constrainHandlePosition_(e=(e.viewTop-e.scrollTop)/(r=e.scrollHeight-e.viewHeight)*a),this.setHandlePosition(e),this.ratio=a/r}},t.Scrollbar.prototype.createDom_=function(e){var r="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");e&&(r+=" "+e),this.outerSvg_=t.utils.dom.createSvgElement(t.utils.Svg.SVG,{class:r},null),this.svgGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{},this.outerSvg_),this.svgBackground_=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blocklyScrollbarBackground"},this.svgGroup_),e=Math.floor((t.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},this.svgGroup_),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarOpacity","fill-opacity"),t.utils.dom.insertAfter(this.outerSvg_,this.workspace_.getParentSvg())},t.Scrollbar.prototype.isVisible=function(){return this.isVisible_},t.Scrollbar.prototype.setContainerVisible=function(e){var r=e!=this.containerVisible_;this.containerVisible_=e,r&&this.updateDisplay_()},t.Scrollbar.prototype.setVisible=function(e){var r=e!=this.isVisible();if(this.pair_)throw Error("Unable to toggle visibility of paired scrollbars.");this.isVisible_=e,r&&this.updateDisplay_()},t.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},t.Scrollbar.prototype.onMouseDownBar_=function(e){if(this.workspace_.markFocused(),t.Touch.clearTouchIdentifier(),this.cleanUp_(),t.utils.isRightButton(e))e.stopPropagation();else{var r=t.utils.mouseToSvg(e,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());r=this.horizontal_?r.x:r.y;var a=t.utils.getInjectionDivXY_(this.svgHandle_),c=this.handlePosition_,p=.95*this.handleLength_;r<=(a=this.horizontal_?a.x:a.y)?c-=p:r>=a+this.handleLength_&&(c+=p),this.setHandlePosition(this.constrainHandlePosition_(c)),this.updateMetrics_(),e.stopPropagation(),e.preventDefault()}},t.Scrollbar.prototype.onMouseDownHandle_=function(e){this.workspace_.markFocused(),this.cleanUp_(),t.utils.isRightButton(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?e.clientX:e.clientY,t.Scrollbar.onMouseUpWrapper_=t.browserEvents.conditionalBind(document,"mouseup",this,this.onMouseUpHandle_),t.Scrollbar.onMouseMoveWrapper_=t.browserEvents.conditionalBind(document,"mousemove",this,this.onMouseMoveHandle_),e.stopPropagation(),e.preventDefault())},t.Scrollbar.prototype.onMouseMoveHandle_=function(e){this.setHandlePosition(this.constrainHandlePosition_(this.startDragHandle+((this.horizontal_?e.clientX:e.clientY)-this.startDragMouse_))),this.updateMetrics_()},t.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),t.Touch.clearTouchIdentifier(),this.cleanUp_()},t.Scrollbar.prototype.cleanUp_=function(){t.hideChaff(!0),t.Scrollbar.onMouseUpWrapper_&&(t.browserEvents.unbind(t.Scrollbar.onMouseUpWrapper_),t.Scrollbar.onMouseUpWrapper_=null),t.Scrollbar.onMouseMoveWrapper_&&(t.browserEvents.unbind(t.Scrollbar.onMouseMoveWrapper_),t.Scrollbar.onMouseMoveWrapper_=null)},t.Scrollbar.prototype.getRatio_=function(){var e=this.handlePosition_/(this.scrollbarLength_-this.handleLength_);return isNaN(e)&&(e=0),e},t.Scrollbar.prototype.updateMetrics_=function(){var e=this.getRatio_(),r={};this.horizontal_?r.x=e:r.y=e,this.workspace_.setMetrics(r)},t.Scrollbar.prototype.set=function(e,r){this.setHandlePosition(this.constrainHandlePosition_(e*this.ratio)),(r||void 0===r)&&this.updateMetrics_()},t.Scrollbar.prototype.setOrigin=function(e,r){this.origin_=new t.utils.Coordinate(e,r)},t.Tooltip={},t.Tooltip.visible=!1,t.Tooltip.blocked_=!1,t.Tooltip.LIMIT=50,t.Tooltip.mouseOutPid_=0,t.Tooltip.showPid_=0,t.Tooltip.lastX_=0,t.Tooltip.lastY_=0,t.Tooltip.element_=null,t.Tooltip.poisonedElement_=null,t.Tooltip.OFFSET_X=0,t.Tooltip.OFFSET_Y=10,t.Tooltip.RADIUS_OK=10,t.Tooltip.HOVER_MS=750,t.Tooltip.MARGINS=5,t.Tooltip.DIV=null,t.Tooltip.getTooltipOfObject=function(e){if(e=t.Tooltip.getTargetObject_(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},t.Tooltip.getTargetObject_=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},t.Tooltip.createDom=function(){t.Tooltip.DIV||(t.Tooltip.DIV=document.createElement("div"),t.Tooltip.DIV.className="blocklyTooltipDiv",(t.parentContainer||document.body).appendChild(t.Tooltip.DIV))},t.Tooltip.bindMouseEvents=function(e){e.mouseOverWrapper_=t.browserEvents.bind(e,"mouseover",null,t.Tooltip.onMouseOver_),e.mouseOutWrapper_=t.browserEvents.bind(e,"mouseout",null,t.Tooltip.onMouseOut_),e.addEventListener("mousemove",t.Tooltip.onMouseMove_,!1)},t.Tooltip.unbindMouseEvents=function(e){e&&(t.browserEvents.unbind(e.mouseOverWrapper_),t.browserEvents.unbind(e.mouseOutWrapper_),e.removeEventListener("mousemove",t.Tooltip.onMouseMove_))},t.Tooltip.onMouseOver_=function(e){t.Tooltip.blocked_||(e=t.Tooltip.getTargetObject_(e.currentTarget),t.Tooltip.element_!=e&&(t.Tooltip.hide(),t.Tooltip.poisonedElement_=null,t.Tooltip.element_=e),clearTimeout(t.Tooltip.mouseOutPid_))},t.Tooltip.onMouseOut_=function(e){t.Tooltip.blocked_||(t.Tooltip.mouseOutPid_=setTimeout(function(){t.Tooltip.element_=null,t.Tooltip.poisonedElement_=null,t.Tooltip.hide()},1),clearTimeout(t.Tooltip.showPid_))},t.Tooltip.onMouseMove_=function(e){if(t.Tooltip.element_&&t.Tooltip.element_.tooltip&&!t.Tooltip.blocked_)if(t.Tooltip.visible){var r=t.Tooltip.lastX_-e.pageX;e=t.Tooltip.lastY_-e.pageY,Math.sqrt(r*r+e*e)>t.Tooltip.RADIUS_OK&&t.Tooltip.hide()}else t.Tooltip.poisonedElement_!=t.Tooltip.element_&&(clearTimeout(t.Tooltip.showPid_),t.Tooltip.lastX_=e.pageX,t.Tooltip.lastY_=e.pageY,t.Tooltip.showPid_=setTimeout(t.Tooltip.show_,t.Tooltip.HOVER_MS))},t.Tooltip.dispose=function(){t.Tooltip.element_=null,t.Tooltip.poisonedElement_=null,t.Tooltip.hide()},t.Tooltip.hide=function(){t.Tooltip.visible&&(t.Tooltip.visible=!1,t.Tooltip.DIV&&(t.Tooltip.DIV.style.display="none")),t.Tooltip.showPid_&&clearTimeout(t.Tooltip.showPid_)},t.Tooltip.block=function(){t.Tooltip.hide(),t.Tooltip.blocked_=!0},t.Tooltip.unblock=function(){t.Tooltip.blocked_=!1},t.Tooltip.show_=function(){if(!t.Tooltip.blocked_&&(t.Tooltip.poisonedElement_=t.Tooltip.element_,t.Tooltip.DIV)){t.Tooltip.DIV.textContent="";var e=t.Tooltip.getTooltipOfObject(t.Tooltip.element_);e=(e=t.utils.string.wrap(e,t.Tooltip.LIMIT)).split("\n");for(var r=0;r<e.length;r++){var a=document.createElement("div");a.appendChild(document.createTextNode(e[r])),t.Tooltip.DIV.appendChild(a)}e=t.Tooltip.element_.RTL,r=document.documentElement.clientWidth,a=document.documentElement.clientHeight,t.Tooltip.DIV.style.direction=e?"rtl":"ltr",t.Tooltip.DIV.style.display="block",t.Tooltip.visible=!0;var c=t.Tooltip.lastX_;c=e?c-(t.Tooltip.OFFSET_X+t.Tooltip.DIV.offsetWidth):c+t.Tooltip.OFFSET_X;var p=t.Tooltip.lastY_+t.Tooltip.OFFSET_Y;p+t.Tooltip.DIV.offsetHeight>a+window.scrollY&&(p-=t.Tooltip.DIV.offsetHeight+2*t.Tooltip.OFFSET_Y),e?c=Math.max(t.Tooltip.MARGINS-window.scrollX,c):c+t.Tooltip.DIV.offsetWidth>r+window.scrollX-2*t.Tooltip.MARGINS&&(c=r-t.Tooltip.DIV.offsetWidth-2*t.Tooltip.MARGINS),t.Tooltip.DIV.style.top=p+"px",t.Tooltip.DIV.style.left=c+"px"}},t.utils.aria={},t.utils.aria.ARIA_PREFIX_="aria-",t.utils.aria.ROLE_ATTRIBUTE_="role",t.utils.aria.Role={GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",LISTBOX:"listbox",MENU:"menu",MENUITEM:"menuitem",MENUITEMCHECKBOX:"menuitemcheckbox",OPTION:"option",PRESENTATION:"presentation",ROW:"row",TREE:"tree",TREEITEM:"treeitem"},t.utils.aria.State={ACTIVEDESCENDANT:"activedescendant",COLCOUNT:"colcount",DISABLED:"disabled",EXPANDED:"expanded",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",ORIENTATION:"orientation",POSINSET:"posinset",ROWCOUNT:"rowcount",SELECTED:"selected",SETSIZE:"setsize",VALUEMAX:"valuemax",VALUEMIN:"valuemin"},t.utils.aria.setRole=function(e,r){e.setAttribute(t.utils.aria.ROLE_ATTRIBUTE_,r)},t.utils.aria.setState=function(e,r,a){Array.isArray(a)&&(a=a.join(" ")),e.setAttribute(t.utils.aria.ARIA_PREFIX_+r,a)},t.IASTNodeLocation=function(){},t.IASTNodeLocationSvg=function(){},t.IASTNodeLocationWithBlock=function(){},t.IKeyboardAccessible=function(){},t.utils.deprecation={},t.utils.deprecation.warn=function(e,r,a,c){e=e+" was deprecated on "+r+" and will be deleted on "+a+".",c&&(e+="\nUse "+c+" instead."),console.warn(e)},t.Connection=function(e,r){this.sourceBlock_=e,this.type=r},t.Connection.CAN_CONNECT=0,t.Connection.REASON_SELF_CONNECTION=1,t.Connection.REASON_WRONG_TYPE=2,t.Connection.REASON_TARGET_NULL=3,t.Connection.REASON_CHECKS_FAILED=4,t.Connection.REASON_DIFFERENT_WORKSPACES=5,t.Connection.REASON_SHADOW_PARENT=6,t.Connection.REASON_DRAG_CHECKS_FAILED=7,t.Connection.prototype.targetConnection=null,t.Connection.prototype.disposed=!1,t.Connection.prototype.check_=null,t.Connection.prototype.shadowDom_=null,t.Connection.prototype.x=0,t.Connection.prototype.y=0,t.Connection.prototype.connect_=function(e){var y,r=t.connectionTypes.INPUT_VALUE,a=this.getSourceBlock(),c=e.getSourceBlock();if(e.isConnected()&&e.disconnect(),this.isConnected()){var p=this.getShadowDom(!0);this.shadowDom_=null;var f=this.targetBlock();if(f.isShadow())f.dispose(!1);else{this.disconnect();var T=f}this.shadowDom_=p}t.Events.isEnabled()&&(y=new(t.Events.get(t.Events.BLOCK_MOVE))(c)),t.Connection.connectReciprocally_(this,e),c.setParent(a),y&&(y.recordNew(),t.Events.fire(y)),T&&((c=t.Connection.getConnectionForOrphanedConnection(c,e=this.type===r?T.outputConnection:T.previousConnection))?e.connect(c):e.onFailedConnect(this))},t.Connection.prototype.dispose=function(){if(this.isConnected()){this.setShadowDom(null);var e=this.targetBlock();e&&e.unplug()}this.disposed=!0},t.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},t.Connection.prototype.isSuperior=function(){return this.type==t.connectionTypes.INPUT_VALUE||this.type==t.connectionTypes.NEXT_STATEMENT},t.Connection.prototype.isConnected=function(){return!!this.targetConnection},t.Connection.prototype.canConnectWithReason=function(e){return t.utils.deprecation.warn("Connection.prototype.canConnectWithReason","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnectWithReason(this,e,!1)},t.Connection.prototype.checkConnection=function(e){t.utils.deprecation.warn("Connection.prototype.checkConnection","July 2020","July 2021","the workspace's connection checker");var r=this.getConnectionChecker(),a=r.canConnectWithReason(this,e,!1);if(a!=t.Connection.CAN_CONNECT)throw Error(r.getErrorMessage(a,this,e))},t.Connection.prototype.getConnectionChecker=function(){return this.sourceBlock_.workspace.connectionChecker},t.Connection.prototype.isConnectionAllowed=function(e){return t.utils.deprecation.warn("Connection.prototype.isConnectionAllowed","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,e,!0)},t.Connection.prototype.onFailedConnect=function(e){},t.Connection.prototype.connect=function(e){if(this.targetConnection!=e&&this.getConnectionChecker().canConnect(this,e,!1)){var r=t.Events.getGroup();r||t.Events.setGroup(!0),this.isSuperior()?this.connect_(e):e.connect_(this),r||t.Events.setGroup(!1)}},t.Connection.connectReciprocally_=function(e,r){if(!e||!r)throw Error("Cannot connect null connections.");e.targetConnection=r,r.targetConnection=e},t.Connection.getSingleConnection_=function(e,r){for(var f,a=null,c=(r=r.outputConnection).getConnectionChecker(),p=0;f=e.inputList[p];p++)if((f=f.connection)&&c.canConnect(r,f,!1)){if(a)return null;a=f}return a},t.Connection.getConnectionForOrphanedOutput_=function(e,r){for(var a;a=t.Connection.getSingleConnection_(e,r);)if(!(e=a.targetBlock())||e.isShadow())return a;return null},t.Connection.getConnectionForOrphanedConnection=function(e,r){if(r.type===t.connectionTypes.OUTPUT_VALUE)return t.Connection.getConnectionForOrphanedOutput_(e,r.getSourceBlock());e=e.lastConnectionInStack(!0);var a=r.getConnectionChecker();return e&&a.canConnect(r,e,!1)?e:null},t.Connection.prototype.disconnect=function(){var e=this.targetConnection;if(!e)throw Error("Source connection not connected.");if(e.targetConnection!=this)throw Error("Target connection not connected to source connection.");if(this.isSuperior()){var r=this.sourceBlock_,a=e.getSourceBlock();e=this}else r=e.getSourceBlock(),a=this.sourceBlock_;var c=t.Events.getGroup();c||t.Events.setGroup(!0),this.disconnectInternal_(r,a),a.isShadow()||e.respawnShadow_(),c||t.Events.setGroup(!1)},t.Connection.prototype.disconnectInternal_=function(e,r){var a;t.Events.isEnabled()&&(a=new(t.Events.get(t.Events.BLOCK_MOVE))(r)),this.targetConnection=this.targetConnection.targetConnection=null,r.setParent(null),a&&(a.recordNew(),t.Events.fire(a))},t.Connection.prototype.respawnShadow_=function(){var e=this.getSourceBlock(),r=this.getShadowDom();if(e.workspace&&r)if((e=t.Xml.domToBlock(r,e.workspace)).outputConnection)this.connect(e.outputConnection);else{if(!e.previousConnection)throw Error("Child block does not have output or previous statement.");this.connect(e.previousConnection)}},t.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},t.Connection.prototype.checkType=function(e){return t.utils.deprecation.warn("Connection.prototype.checkType","October 2019","January 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,e,!1)},t.Connection.prototype.checkType_=function(e){return t.utils.deprecation.warn("Connection.prototype.checkType_","October 2019","January 2021","the workspace's connection checker"),this.checkType(e)},t.Connection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},t.Connection.prototype.setCheck=function(e){return e?(Array.isArray(e)||(e=[e]),this.check_=e,this.onCheckChanged_()):this.check_=null,this},t.Connection.prototype.getCheck=function(){return this.check_},t.Connection.prototype.setShadowDom=function(e){this.shadowDom_=e,(e=this.targetBlock())?e.isShadow()&&(e.dispose(!1),this.respawnShadow_()):this.respawnShadow_()},t.Connection.prototype.getShadowDom=function(e){return e&&this.targetBlock().isShadow()?t.Xml.blockToDom(this.targetBlock()):this.shadowDom_},t.Connection.prototype.neighbours=function(e){return[]},t.Connection.prototype.getParentInput=function(){for(var e=null,r=this.sourceBlock_.inputList,a=0;a<r.length;a++)if(r[a].connection===this){e=r[a];break}return e},t.Connection.prototype.toString=function(){var e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection==this)var r="Output Connection of ";else if(e.previousConnection==this)r="Previous Connection of ";else if(e.nextConnection==this)r="Next Connection of ";else{r=null;for(var c,a=0;c=e.inputList[a];a++)if(c.connection==this){r=c;break}if(!r)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";r='Input "'+r.name+'" connection on '}return r+e.toDevString()},t.IConnectionChecker=function(){},t.ConnectionChecker=function(){},t.ConnectionChecker.prototype.canConnect=function(e,r,a,c){return this.canConnectWithReason(e,r,a,c)==t.Connection.CAN_CONNECT},t.ConnectionChecker.prototype.canConnectWithReason=function(e,r,a,c){var p=this.doSafetyChecks(e,r);return p!=t.Connection.CAN_CONNECT?p:this.doTypeChecks(e,r)?a&&!this.doDragChecks(e,r,c||0)?t.Connection.REASON_DRAG_CHECKS_FAILED:t.Connection.CAN_CONNECT:t.Connection.REASON_CHECKS_FAILED},t.ConnectionChecker.prototype.getErrorMessage=function(e,r,a){switch(e){case t.Connection.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case t.Connection.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case t.Connection.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case t.Connection.REASON_TARGET_NULL:return"Target connection is null.";case t.Connection.REASON_CHECKS_FAILED:return"Connection checks failed. "+r+" expected "+r.getCheck()+", found "+a.getCheck();case t.Connection.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case t.Connection.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";default:return"Unknown connection failure: this should never happen!"}},t.ConnectionChecker.prototype.doSafetyChecks=function(e,r){if(!e||!r)return t.Connection.REASON_TARGET_NULL;if(e.isSuperior())var a=e.getSourceBlock(),c=r.getSourceBlock();else c=e.getSourceBlock(),a=r.getSourceBlock();return a==c?t.Connection.REASON_SELF_CONNECTION:r.type!=t.OPPOSITE_TYPE[e.type]?t.Connection.REASON_WRONG_TYPE:a.workspace!==c.workspace?t.Connection.REASON_DIFFERENT_WORKSPACES:a.isShadow()&&!c.isShadow()?t.Connection.REASON_SHADOW_PARENT:t.Connection.CAN_CONNECT},t.ConnectionChecker.prototype.doTypeChecks=function(e,r){if(e=e.getCheck(),r=r.getCheck(),!e||!r)return!0;for(var a=0;a<e.length;a++)if(-1!=r.indexOf(e[a]))return!0;return!1},t.ConnectionChecker.prototype.doDragChecks=function(e,r,a){if(e.distanceFrom(r)>a||r.getSourceBlock().isInsertionMarker())return!1;switch(r.type){case t.connectionTypes.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,r);case t.connectionTypes.OUTPUT_VALUE:if(r.isConnected()&&!r.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case t.connectionTypes.INPUT_VALUE:if(r.isConnected()&&!r.targetBlock().isMovable()&&!r.targetBlock().isShadow())return!1;break;case t.connectionTypes.NEXT_STATEMENT:if(r.isConnected()&&!e.getSourceBlock().nextConnection&&!r.targetBlock().isShadow()&&r.targetBlock().nextConnection)return!1;break;default:return!1}return-1==t.draggingConnections.indexOf(r)},t.ConnectionChecker.prototype.canConnectToPrevious_=function(e,r){return!(e.targetConnection||-1!=t.draggingConnections.indexOf(r)||r.targetConnection&&(!(e=r.targetBlock()).isInsertionMarker()||e.getPreviousBlock()))},t.registry.register(t.registry.Type.CONNECTION_CHECKER,t.registry.DEFAULT,t.ConnectionChecker),t.VariableMap=function(e){this.variableMap_=Object.create(null),this.workspace=e},t.VariableMap.prototype.clear=function(){this.variableMap_=Object.create(null)},t.VariableMap.prototype.renameVariable=function(e,r){var a=this.getVariable(r,e.type),c=this.workspace.getAllBlocks(!1);t.Events.setGroup(!0);try{a&&a.getId()!=e.getId()?this.renameVariableWithConflict_(e,r,a,c):this.renameVariableAndUses_(e,r,c)}finally{t.Events.setGroup(!1)}},t.VariableMap.prototype.renameVariableById=function(e,r){var a=this.getVariableById(e);if(!a)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(a,r)},t.VariableMap.prototype.renameVariableAndUses_=function(e,r,a){for(t.Events.fire(new(t.Events.get(t.Events.VAR_RENAME))(e,r)),e.name=r,r=0;r<a.length;r++)a[r].updateVarName(e)},t.VariableMap.prototype.renameVariableWithConflict_=function(e,r,a,c){var p=e.type;for(r!=a.name&&this.renameVariableAndUses_(a,r,c),r=0;r<c.length;r++)c[r].renameVarById(e.getId(),a.getId());t.Events.fire(new(t.Events.get(t.Events.VAR_DELETE))(e)),e=this.getVariablesOfType(p).indexOf(e),this.variableMap_[p].splice(e,1)},t.VariableMap.prototype.createVariable=function(e,r,a){var c=this.getVariable(e,r);if(c){if(a&&c.getId()!=a)throw Error('Variable "'+e+'" is already in use and its id is "'+c.getId()+'" which conflicts with the passed in id, "'+a+'".');return c}if(a&&this.getVariableById(a))throw Error('Variable id, "'+a+'", is already in use.');return c=a||t.utils.genUid(),c=new t.VariableModel(this.workspace,e,r=r||"",c),(e=this.variableMap_[r]||[]).push(c),delete this.variableMap_[r],this.variableMap_[r]=e,c},t.VariableMap.prototype.deleteVariable=function(e){for(var c,r=this.variableMap_[e.type],a=0;c=r[a];a++)if(c.getId()==e.getId()){r.splice(a,1),t.Events.fire(new(t.Events.get(t.Events.VAR_DELETE))(e));break}},t.VariableMap.prototype.deleteVariableById=function(e){var r=this.getVariableById(e);if(r){var p,a=r.name,c=this.getVariableUsesById(e);for(e=0;p=c[e];e++)if("procedures_defnoreturn"==p.type||"procedures_defreturn"==p.type)return e=p.getFieldValue("NAME"),a=t.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",a).replace("%2",e),void t.alert(a);var f=this;1<c.length?(a=t.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(c.length)).replace("%2",a),t.confirm(a,function(T){T&&r&&f.deleteVariableInternal(r,c)})):f.deleteVariableInternal(r,c)}else console.warn("Can't delete non-existent variable: "+e)},t.VariableMap.prototype.deleteVariableInternal=function(e,r){var a=t.Events.getGroup();a||t.Events.setGroup(!0);try{for(var c=0;c<r.length;c++)r[c].dispose(!0);this.deleteVariable(e)}finally{a||t.Events.setGroup(!1)}},t.VariableMap.prototype.getVariable=function(e,r){if(r=this.variableMap_[r||""])for(var c,a=0;c=r[a];a++)if(t.Names.equals(c.name,e))return c;return null},t.VariableMap.prototype.getVariableById=function(e){for(var r=Object.keys(this.variableMap_),a=0;a<r.length;a++)for(var f,c=r[a],p=0;f=this.variableMap_[c][p];p++)if(f.getId()==e)return f;return null},t.VariableMap.prototype.getVariablesOfType=function(e){return(e=this.variableMap_[e||""])?e.slice():[]},t.VariableMap.prototype.getVariableTypes=function(e){var r={};t.utils.object.mixin(r,this.variableMap_),e&&e.getPotentialVariableMap()&&t.utils.object.mixin(r,e.getPotentialVariableMap().variableMap_),e=Object.keys(r),r=!1;for(var a=0;a<e.length;a++)""==e[a]&&(r=!0);return r||e.push(""),e},t.VariableMap.prototype.getAllVariables=function(){var r,e=[];for(r in this.variableMap_)e=e.concat(this.variableMap_[r]);return e},t.VariableMap.prototype.getAllVariableNames=function(){var r,e=[];for(r in this.variableMap_)for(var p,a=this.variableMap_[r],c=0;p=a[c];c++)e.push(p.name);return e},t.VariableMap.prototype.getVariableUsesById=function(e){for(var r=[],a=this.workspace.getAllBlocks(!1),c=0;c<a.length;c++){var p=a[c].getVarModels();if(p)for(var f=0;f<p.length;f++)p[f].getId()==e&&r.push(a[c])}return r},t.Workspace=function(e){this.id=t.utils.genUid(),t.Workspace.WorkspaceDB_[this.id]=this,this.options=e||new t.Options({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(t.registry.getClassFromOptions(t.registry.Type.CONNECTION_CHECKER,this.options,!0))(this),this.topBlocks_=[],this.topComments_=[],this.commentDB_=Object.create(null),this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.typedBlocksDB_=Object.create(null),this.variableMap_=new t.VariableMap(this),this.potentialVariableMap_=null},t.Workspace.prototype.rendered=!1,t.Workspace.prototype.isClearing=!1,t.Workspace.prototype.MAX_UNDO=1024,t.Workspace.prototype.connectionDBList=null,t.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete t.Workspace.WorkspaceDB_[this.id]},t.Workspace.SCAN_ANGLE=3,t.Workspace.prototype.sortObjects_=function(e,r){return e=e.getRelativeToSurfaceXY(),r=r.getRelativeToSurfaceXY(),e.y+t.Workspace.prototype.sortObjects_.offset*e.x-(r.y+t.Workspace.prototype.sortObjects_.offset*r.x)},t.Workspace.prototype.addTopBlock=function(e){this.topBlocks_.push(e)},t.Workspace.prototype.removeTopBlock=function(e){if(!t.utils.arrayRemove(this.topBlocks_,e))throw Error("Block not present in workspace's list of top-most blocks.")},t.Workspace.prototype.getTopBlocks=function(e){var r=[].concat(this.topBlocks_);return e&&1<r.length&&(this.sortObjects_.offset=Math.sin(t.utils.math.toRadians(t.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),r.sort(this.sortObjects_)),r},t.Workspace.prototype.addTypedBlock=function(e){this.typedBlocksDB_[e.type]||(this.typedBlocksDB_[e.type]=[]),this.typedBlocksDB_[e.type].push(e)},t.Workspace.prototype.removeTypedBlock=function(e){this.typedBlocksDB_[e.type].splice(this.typedBlocksDB_[e.type].indexOf(e),1),this.typedBlocksDB_[e.type].length||delete this.typedBlocksDB_[e.type]},t.Workspace.prototype.getBlocksByType=function(e,r){return this.typedBlocksDB_[e]?(e=this.typedBlocksDB_[e].slice(0),r&&1<e.length&&(this.sortObjects_.offset=Math.sin(t.utils.math.toRadians(t.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e):[]},t.Workspace.prototype.addTopComment=function(e){this.topComments_.push(e),this.commentDB_[e.id]&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB_[e.id]=e},t.Workspace.prototype.removeTopComment=function(e){if(!t.utils.arrayRemove(this.topComments_,e))throw Error("Comment not present in workspace's list of top-most comments.");delete this.commentDB_[e.id]},t.Workspace.prototype.getTopComments=function(e){var r=[].concat(this.topComments_);return e&&1<r.length&&(this.sortObjects_.offset=Math.sin(t.utils.math.toRadians(t.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),r.sort(this.sortObjects_)),r},t.Workspace.prototype.getAllBlocks=function(e){if(e){e=this.getTopBlocks(!0);for(var r=[],a=0;a<e.length;a++)r.push.apply(r,e[a].getDescendants(!0))}else for(r=this.getTopBlocks(!1),a=0;a<r.length;a++)r.push.apply(r,r[a].getChildren(!1));return r.filter(function(c){return!c.isInsertionMarker()})},t.Workspace.prototype.clear=function(){this.isClearing=!0;try{var e=t.Events.getGroup();for(e||t.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose(!1);for(;this.topComments_.length;)this.topComments_[this.topComments_.length-1].dispose(!1);e||t.Events.setGroup(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()}finally{this.isClearing=!1}},t.Workspace.prototype.renameVariableById=function(e,r){this.variableMap_.renameVariableById(e,r)},t.Workspace.prototype.createVariable=function(e,r,a){return this.variableMap_.createVariable(e,r,a)},t.Workspace.prototype.getVariableUsesById=function(e){return this.variableMap_.getVariableUsesById(e)},t.Workspace.prototype.deleteVariableById=function(e){this.variableMap_.deleteVariableById(e)},t.Workspace.prototype.getVariable=function(e,r){return this.variableMap_.getVariable(e,r)},t.Workspace.prototype.getVariableById=function(e){return this.variableMap_.getVariableById(e)},t.Workspace.prototype.getVariablesOfType=function(e){return this.variableMap_.getVariablesOfType(e)},t.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes(this)},t.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},t.Workspace.prototype.getAllVariableNames=function(){return this.variableMap_.getAllVariableNames()},t.Workspace.prototype.getWidth=function(){return 0},t.Workspace.prototype.newBlock=function(e,r){return new t.Block(this,e,r)},t.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length},t.Workspace.prototype.remainingCapacityOfType=function(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0},t.Workspace.prototype.isCapacityAvailable=function(e){if(!this.hasBlockLimits())return!0;var a,r=0;for(a in e){if(e[a]>this.remainingCapacityOfType(a))return!1;r+=e[a]}return!(r>this.remainingCapacity())},t.Workspace.prototype.hasBlockLimits=function(){return this.options.maxBlocks!=1/0||!!this.options.maxInstances},t.Workspace.prototype.getUndoStack=function(){return this.undoStack_},t.Workspace.prototype.getRedoStack=function(){return this.redoStack_},t.Workspace.prototype.undo=function(e){var r=e?this.redoStack_:this.undoStack_,a=e?this.undoStack_:this.redoStack_,c=r.pop();if(c){for(var p=[c];r.length&&c.group&&c.group==r[r.length-1].group;)p.push(r.pop());for(r=0;c=p[r];r++)a.push(c);p=t.Events.filter(p,e),t.Events.recordUndo=!1;try{for(r=0;c=p[r];r++)c.run(e)}finally{t.Events.recordUndo=!0}}},t.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,t.Events.clearPendingUndo()},t.Workspace.prototype.addChangeListener=function(e){return this.listeners_.push(e),e},t.Workspace.prototype.removeChangeListener=function(e){t.utils.arrayRemove(this.listeners_,e)},t.Workspace.prototype.fireChangeListener=function(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(var a,r=0;a=this.listeners_[r];r++)a(e)},t.Workspace.prototype.getBlockById=function(e){return this.blockDB_[e]||null},t.Workspace.prototype.setBlockById=function(e,r){this.blockDB_[e]=r},t.Workspace.prototype.removeBlockById=function(e){delete this.blockDB_[e]},t.Workspace.prototype.getCommentById=function(e){return this.commentDB_[e]||null},t.Workspace.prototype.allInputsFilled=function(e){for(var c,r=this.getTopBlocks(!1),a=0;c=r[a];a++)if(!c.allInputsFilled(e))return!1;return!0},t.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},t.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new t.VariableMap(this)},t.Workspace.prototype.getVariableMap=function(){return this.variableMap_},t.Workspace.prototype.setVariableMap=function(e){this.variableMap_=e},t.Workspace.WorkspaceDB_=Object.create(null),t.Workspace.getById=function(e){return t.Workspace.WorkspaceDB_[e]||null},t.Workspace.getAll=function(){var r,e=[];for(r in t.Workspace.WorkspaceDB_)e.push(t.Workspace.WorkspaceDB_[r]);return e},t.WorkspaceDragSurfaceSvg=function(e){this.container_=e,this.createDom()},t.WorkspaceDragSurfaceSvg.prototype.SVG_=null,t.WorkspaceDragSurfaceSvg.prototype.container_=null,t.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=t.utils.dom.createSvgElement(t.utils.Svg.SVG,{xmlns:t.utils.dom.SVG_NS,"xmlns:html":t.utils.dom.HTML_NS,"xmlns:xlink":t.utils.dom.XLINK_NS,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},t.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(e,r){e=e.toFixed(0),r=r.toFixed(0),this.SVG_.style.display="block",t.utils.dom.setCssTransform(this.SVG_,"translate3d("+e+"px, "+r+"px, 0px)")},t.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return t.utils.getRelativeXY(this.SVG_)},t.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(e){if(!e)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var r=this.SVG_.childNodes[0],a=this.SVG_.childNodes[1];if(!(r&&a&&t.utils.dom.hasClass(r,"blocklyBlockCanvas")&&t.utils.dom.hasClass(a,"blocklyBubbleCanvas")))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(null!=this.previousSibling_?t.utils.dom.insertAfter(r,this.previousSibling_):e.insertBefore(r,e.firstChild),t.utils.dom.insertAfter(a,r),this.SVG_.style.display="none",this.SVG_.childNodes.length)throw Error("Drag surface was not cleared.");t.utils.dom.setCssTransform(this.SVG_,""),this.previousSibling_=null},t.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(e,r,a,c,p,f){if(this.SVG_.childNodes.length)throw Error("Already dragging a block.");this.previousSibling_=a,e.setAttribute("transform","translate(0, 0) scale("+f+")"),r.setAttribute("transform","translate(0, 0) scale("+f+")"),this.SVG_.setAttribute("width",c),this.SVG_.setAttribute("height",p),this.SVG_.appendChild(e),this.SVG_.appendChild(r),this.SVG_.style.display="block"},t.blockRendering={},t.blockRendering.useDebugger=!1,t.blockRendering.register=function(e,r){t.registry.register(t.registry.Type.RENDERER,e,r)},t.blockRendering.unregister=function(e){t.registry.unregister(t.registry.Type.RENDERER,e)},t.blockRendering.startDebugger=function(){t.blockRendering.useDebugger=!0},t.blockRendering.stopDebugger=function(){t.blockRendering.useDebugger=!1},t.blockRendering.init=function(e,r,a){return(e=new(t.registry.getClass(t.registry.Type.RENDERER,e))(e)).init(r,a),e},t.ASTNode=function(e,r,a){if(!r)throw Error("Cannot create a node without a location.");this.type_=e,this.isConnection_=t.ASTNode.isConnectionType_(e),this.location_=r,this.wsCoordinate_=null,this.processParams_(a||null)},t.ASTNode.types={FIELD:"field",BLOCK:"block",INPUT:"input",OUTPUT:"output",NEXT:"next",PREVIOUS:"previous",STACK:"stack",WORKSPACE:"workspace"},t.ASTNode.NAVIGATE_ALL_FIELDS=!1,t.ASTNode.DEFAULT_OFFSET_Y=-20,t.ASTNode.isConnectionType_=function(e){switch(e){case t.ASTNode.types.PREVIOUS:case t.ASTNode.types.NEXT:case t.ASTNode.types.INPUT:case t.ASTNode.types.OUTPUT:return!0}return!1},t.ASTNode.createFieldNode=function(e){return e?new t.ASTNode(t.ASTNode.types.FIELD,e):null},t.ASTNode.createConnectionNode=function(e){if(!e)return null;var r=e.type;return r==t.connectionTypes.INPUT_VALUE||r==t.connectionTypes.NEXT_STATEMENT&&e.getParentInput()?t.ASTNode.createInputNode(e.getParentInput()):r==t.connectionTypes.NEXT_STATEMENT?new t.ASTNode(t.ASTNode.types.NEXT,e):r==t.connectionTypes.OUTPUT_VALUE?new t.ASTNode(t.ASTNode.types.OUTPUT,e):r==t.connectionTypes.PREVIOUS_STATEMENT?new t.ASTNode(t.ASTNode.types.PREVIOUS,e):null},t.ASTNode.createInputNode=function(e){return e&&e.connection?new t.ASTNode(t.ASTNode.types.INPUT,e.connection):null},t.ASTNode.createBlockNode=function(e){return e?new t.ASTNode(t.ASTNode.types.BLOCK,e):null},t.ASTNode.createStackNode=function(e){return e?new t.ASTNode(t.ASTNode.types.STACK,e):null},t.ASTNode.createWorkspaceNode=function(e,r){return r&&e?new t.ASTNode(t.ASTNode.types.WORKSPACE,e,{wsCoordinate:r}):null},t.ASTNode.createTopNode=function(e){var r=e.previousConnection||e.outputConnection;return r?t.ASTNode.createConnectionNode(r):t.ASTNode.createBlockNode(e)},t.ASTNode.prototype.processParams_=function(e){e&&e.wsCoordinate&&(this.wsCoordinate_=e.wsCoordinate)},t.ASTNode.prototype.getLocation=function(){return this.location_},t.ASTNode.prototype.getType=function(){return this.type_},t.ASTNode.prototype.getWsCoordinate=function(){return this.wsCoordinate_},t.ASTNode.prototype.isConnection=function(){return this.isConnection_},t.ASTNode.prototype.findNextForInput_=function(){var a,e=this.location_.getParentInput(),r=e.getSourceBlock();for(e=r.inputList.indexOf(e)+1;a=r.inputList[e];e++){for(var f,c=a.fieldRow,p=0;f=c[p];p++)if(f.isClickable()||t.ASTNode.NAVIGATE_ALL_FIELDS)return t.ASTNode.createFieldNode(f);if(a.connection)return t.ASTNode.createInputNode(a)}return null},t.ASTNode.prototype.findNextForField_=function(){var e=this.location_,r=e.getParentInput(),a=e.getSourceBlock(),c=a.inputList.indexOf(r);for(e=r.fieldRow.indexOf(e)+1;r=a.inputList[c];c++){for(var p=r.fieldRow;e<p.length;){if(p[e].isClickable()||t.ASTNode.NAVIGATE_ALL_FIELDS)return t.ASTNode.createFieldNode(p[e]);e++}if(e=0,r.connection)return t.ASTNode.createInputNode(r)}return null},t.ASTNode.prototype.findPrevForInput_=function(){for(var c,e=this.location_.getParentInput(),r=e.getSourceBlock(),a=r.inputList.indexOf(e);c=r.inputList[a];a--){if(c.connection&&c!==e)return t.ASTNode.createInputNode(c);for(var f,p=(c=c.fieldRow).length-1;f=c[p];p--)if(f.isClickable()||t.ASTNode.NAVIGATE_ALL_FIELDS)return t.ASTNode.createFieldNode(f)}return null},t.ASTNode.prototype.findPrevForField_=function(){var p,e=this.location_,r=e.getParentInput(),a=e.getSourceBlock(),c=a.inputList.indexOf(r);for(e=r.fieldRow.indexOf(e)-1;p=a.inputList[c];c--){if(p.connection&&p!==r)return t.ASTNode.createInputNode(p);for(p=p.fieldRow;-1<e;){if(p[e].isClickable()||t.ASTNode.NAVIGATE_ALL_FIELDS)return t.ASTNode.createFieldNode(p[e]);e--}0<=c-1&&(e=a.inputList[c-1].fieldRow.length-1)}return null},t.ASTNode.prototype.navigateBetweenStacks_=function(e){var r=this.getLocation();if(r instanceof t.Block||(r=r.getSourceBlock()),!r||!r.workspace)return null;var a=r.getRootBlock();r=a.workspace.getTopBlocks(!0);for(var p,c=0;p=r[c];c++)if(a.id==p.id)return-1==(e=c+(e?1:-1))||e==r.length?null:t.ASTNode.createStackNode(r[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")},t.ASTNode.prototype.findTopASTNodeForBlock_=function(e){var r=e.previousConnection||e.outputConnection;return r?t.ASTNode.createConnectionNode(r):t.ASTNode.createBlockNode(e)},t.ASTNode.prototype.getOutAstNodeForBlock_=function(e){if(!e)return null;var r=(e=e.getTopStackBlock()).previousConnection||e.outputConnection;return r&&r.targetConnection&&r.targetConnection.getParentInput()?t.ASTNode.createInputNode(r.targetConnection.getParentInput()):t.ASTNode.createStackNode(e)},t.ASTNode.prototype.findFirstFieldOrInput_=function(e){e=e.inputList;for(var a,r=0;a=e[r];r++){for(var f,c=a.fieldRow,p=0;f=c[p];p++)if(f.isClickable()||t.ASTNode.NAVIGATE_ALL_FIELDS)return t.ASTNode.createFieldNode(f);if(a.connection)return t.ASTNode.createInputNode(a)}return null},t.ASTNode.prototype.getSourceBlock=function(){return this.getType()===t.ASTNode.types.BLOCK||this.getType()===t.ASTNode.types.STACK?this.getLocation():this.getType()===t.ASTNode.types.WORKSPACE?null:this.getLocation().getSourceBlock()},t.ASTNode.prototype.next=function(){switch(this.type_){case t.ASTNode.types.STACK:return this.navigateBetweenStacks_(!0);case t.ASTNode.types.OUTPUT:var e=this.location_;return t.ASTNode.createBlockNode(e.getSourceBlock());case t.ASTNode.types.FIELD:return this.findNextForField_();case t.ASTNode.types.INPUT:return this.findNextForInput_();case t.ASTNode.types.BLOCK:return t.ASTNode.createConnectionNode(this.location_.nextConnection);case t.ASTNode.types.PREVIOUS:return t.ASTNode.createBlockNode((e=this.location_).getSourceBlock());case t.ASTNode.types.NEXT:return t.ASTNode.createConnectionNode((e=this.location_).targetConnection)}return null},t.ASTNode.prototype.in=function(){switch(this.type_){case t.ASTNode.types.WORKSPACE:var e=this.location_.getTopBlocks(!0);if(0<e.length)return t.ASTNode.createStackNode(e[0]);break;case t.ASTNode.types.STACK:return this.findTopASTNodeForBlock_(e=this.location_);case t.ASTNode.types.BLOCK:return this.findFirstFieldOrInput_(e=this.location_);case t.ASTNode.types.INPUT:return t.ASTNode.createConnectionNode(this.location_.targetConnection)}return null},t.ASTNode.prototype.prev=function(){switch(this.type_){case t.ASTNode.types.STACK:return this.navigateBetweenStacks_(!1);case t.ASTNode.types.FIELD:return this.findPrevForField_();case t.ASTNode.types.INPUT:return this.findPrevForInput_();case t.ASTNode.types.BLOCK:var e=this.location_;return t.ASTNode.createConnectionNode(e.previousConnection||e.outputConnection);case t.ASTNode.types.PREVIOUS:if((e=(e=this.location_).targetConnection)&&!e.getParentInput())return t.ASTNode.createConnectionNode(e);break;case t.ASTNode.types.NEXT:return t.ASTNode.createBlockNode((e=this.location_).getSourceBlock())}return null},t.ASTNode.prototype.out=function(){switch(this.type_){case t.ASTNode.types.STACK:var e=this.location_,r=e.getRelativeToSurfaceXY();return r=new t.utils.Coordinate(r.x,r.y+t.ASTNode.DEFAULT_OFFSET_Y),t.ASTNode.createWorkspaceNode(e.workspace,r);case t.ASTNode.types.OUTPUT:return(r=(e=this.location_).targetConnection)?t.ASTNode.createConnectionNode(r):t.ASTNode.createStackNode(e.getSourceBlock());case t.ASTNode.types.FIELD:return t.ASTNode.createBlockNode(this.location_.getSourceBlock());case t.ASTNode.types.INPUT:return t.ASTNode.createBlockNode((e=this.location_).getSourceBlock());case t.ASTNode.types.BLOCK:return this.getOutAstNodeForBlock_(e=this.location_);case t.ASTNode.types.PREVIOUS:case t.ASTNode.types.NEXT:return this.getOutAstNodeForBlock_((e=this.location_).getSourceBlock())}return null},t.Blocks=Object.create(null),t.Extensions={},t.Extensions.ALL_=Object.create(null),t.Extensions.register=function(e,r){if("string"!=typeof e||""==e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(t.Extensions.ALL_[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof r)throw Error('Error: Extension "'+e+'" must be a function');t.Extensions.ALL_[e]=r},t.Extensions.registerMixin=function(e,r){if(!r||"object"!=typeof r)throw Error('Error: Mixin "'+e+'" must be a object');t.Extensions.register(e,function(){this.mixin(r)})},t.Extensions.registerMutator=function(e,r,a,c){var p='Error when registering mutator "'+e+'": ';t.Extensions.checkHasFunction_(p,r.domToMutation,"domToMutation"),t.Extensions.checkHasFunction_(p,r.mutationToDom,"mutationToDom");var f=t.Extensions.checkMutatorDialog_(r,p);if(a&&"function"!=typeof a)throw Error('Extension "'+e+'" is not a function');t.Extensions.register(e,function(){if(f){if(!t.Mutator)throw Error(p+"Missing require for Blockly.Mutator");this.setMutator(new t.Mutator(c||[]))}this.mixin(r),a&&a.apply(this)})},t.Extensions.unregister=function(e){t.Extensions.ALL_[e]?delete t.Extensions.ALL_[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},t.Extensions.apply=function(e,r,a){var c=t.Extensions.ALL_[e];if("function"!=typeof c)throw Error('Error: Extension "'+e+'" not found.');if(a)t.Extensions.checkNoMutatorProperties_(e,r);else var p=t.Extensions.getMutatorProperties_(r);if(c.apply(r),a)t.Extensions.checkBlockHasMutatorProperties_('Error after applying mutator "'+e+'": ',r);else if(!t.Extensions.mutatorPropertiesMatch_(p,r))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},t.Extensions.checkHasFunction_=function(e,r,a){if(!r)throw Error(e+'missing required property "'+a+'"');if("function"!=typeof r)throw Error(e+'" required property "'+a+'" must be a function')},t.Extensions.checkNoMutatorProperties_=function(e,r){if(t.Extensions.getMutatorProperties_(r).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+r.id)},t.Extensions.checkMutatorDialog_=function(e,r){var a=void 0!==e.compose,c=void 0!==e.decompose;if(a&&c){if("function"!=typeof e.compose)throw Error(r+"compose must be a function.");if("function"!=typeof e.decompose)throw Error(r+"decompose must be a function.");return!0}if(!a&&!c)return!1;throw Error(r+'Must have both or neither of "compose" and "decompose"')},t.Extensions.checkBlockHasMutatorProperties_=function(e,r){if("function"!=typeof r.domToMutation)throw Error(e+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof r.mutationToDom)throw Error(e+'Applying a mutator didn\'t add "mutationToDom"');t.Extensions.checkMutatorDialog_(r,e)},t.Extensions.getMutatorProperties_=function(e){var r=[];return void 0!==e.domToMutation&&r.push(e.domToMutation),void 0!==e.mutationToDom&&r.push(e.mutationToDom),void 0!==e.compose&&r.push(e.compose),void 0!==e.decompose&&r.push(e.decompose),r},t.Extensions.mutatorPropertiesMatch_=function(e,r){if((r=t.Extensions.getMutatorProperties_(r)).length!=e.length)return!1;for(var a=0;a<r.length;a++)if(e[a]!=r[a])return!1;return!0},t.Extensions.buildTooltipForDropdown=function(e,r){var a=[];return"object"==typeof document&&t.utils.runAfterPageLoad(function(){for(var c in r)t.utils.checkMessageReferences(r[c])}),function(){this.type&&-1==a.indexOf(this.type)&&(t.Extensions.checkDropdownOptionsInTable_(this,e,r),a.push(this.type)),this.setTooltip(function(){var c=String(this.getFieldValue(e)),p=r[c];return null==p?-1==a.indexOf(this.type)&&(c="No tooltip mapping for value "+c+" of field "+e,null!=this.type&&(c+=" of block type "+this.type),console.warn(c+".")):p=t.utils.replaceMessageReferences(p),p}.bind(this))}},t.Extensions.checkDropdownOptionsInTable_=function(e,r,a){var c=e.getField(r);if(!c.isOptionListDynamic()){c=c.getOptions();for(var p=0;p<c.length;++p){var f=c[p][1];null==a[f]&&console.warn("No tooltip mapping for value "+f+" of field "+r+" of block type "+e.type)}}},t.Extensions.buildTooltipWithFieldText=function(e,r){return"object"==typeof document&&t.utils.runAfterPageLoad(function(){t.utils.checkMessageReferences(e)}),function(){this.setTooltip(function(){var a=this.getField(r);return t.utils.replaceMessageReferences(e).replace("%1",a?a.getText():"")}.bind(this))}},t.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip(function(){var e=this.getParent();return e&&e.getInputsInline()&&e.tooltip||this.tooltipWhenNotConnected_}.bind(this))},t.Extensions.register("parent_tooltip_when_inline",t.Extensions.extensionParentTooltip_),t.fieldRegistry={},t.fieldRegistry.register=function(e,r){t.registry.register(t.registry.Type.FIELD,e,r)},t.fieldRegistry.unregister=function(e){t.registry.unregister(t.registry.Type.FIELD,e)},t.fieldRegistry.fromJson=function(e){var r=t.registry.getObject(t.registry.Type.FIELD,e.type);return r?r.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},t.IDeletable=function(){},t.blockAnimations={},t.blockAnimations.disconnectPid_=0,t.blockAnimations.disconnectGroup_=null,t.blockAnimations.disposeUiEffect=function(e){var r=e.workspace,a=e.getSvgRoot();r.getAudioManager().play("delete"),e=r.getSvgXY(a),(a=a.cloneNode(!0)).translateX_=e.x,a.translateY_=e.y,a.setAttribute("transform","translate("+e.x+","+e.y+")"),r.getParentSvg().appendChild(a),a.bBox_=a.getBBox(),t.blockAnimations.disposeUiStep_(a,r.RTL,new Date,r.scale)},t.blockAnimations.disposeUiStep_=function(e,r,a,c){var p=(new Date-a)/150;1<p?t.utils.dom.removeNode(e):(e.setAttribute("transform","translate("+(e.translateX_+(r?-1:1)*e.bBox_.width*c/2*p)+","+(e.translateY_+e.bBox_.height*c*p)+") scale("+(1-p)*c+")"),setTimeout(t.blockAnimations.disposeUiStep_,10,e,r,a,c))},t.blockAnimations.connectionUiEffect=function(e){var r=e.workspace,a=r.scale;if(r.getAudioManager().play("click"),!(1>a)){var c=r.getSvgXY(e.getSvgRoot());e.outputConnection?(c.x+=(e.RTL?3:-3)*a,c.y+=13*a):e.previousConnection&&(c.x+=(e.RTL?-23:23)*a,c.y+=3*a),e=t.utils.dom.createSvgElement(t.utils.Svg.CIRCLE,{cx:c.x,cy:c.y,r:0,fill:"none",stroke:"#888","stroke-width":10},r.getParentSvg()),t.blockAnimations.connectionUiStep_(e,new Date,a)}},t.blockAnimations.connectionUiStep_=function(e,r,a){var c=(new Date-r)/150;1<c?t.utils.dom.removeNode(e):(e.setAttribute("r",25*c*a),e.style.opacity=1-c,t.blockAnimations.disconnectPid_=setTimeout(t.blockAnimations.connectionUiStep_,10,e,r,a))},t.blockAnimations.disconnectUiEffect=function(e){if(e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var r=e.getHeightWidth().height;r=Math.atan(10/r)/Math.PI*180,e.RTL||(r*=-1),t.blockAnimations.disconnectUiStep_(e.getSvgRoot(),r,new Date)}},t.blockAnimations.disconnectUiStep_=function(e,r,a){var c=(new Date-a)/200;1<c?e.skew_="":(e.skew_="skewX("+Math.round(Math.sin(c*Math.PI*3)*(1-c)*r)+")",t.blockAnimations.disconnectGroup_=e,t.blockAnimations.disconnectPid_=setTimeout(t.blockAnimations.disconnectUiStep_,10,e,r,a)),e.setAttribute("transform",e.translate_+e.skew_)},t.blockAnimations.disconnectUiStop=function(){if(t.blockAnimations.disconnectGroup_){clearTimeout(t.blockAnimations.disconnectPid_);var e=t.blockAnimations.disconnectGroup_;e.skew_="",e.setAttribute("transform",e.translate_),t.blockAnimations.disconnectGroup_=null}},t.Events.BlockDrag=function(e,r,a){t.Events.BlockDrag.superClass_.constructor.call(this,e?e.workspace.id:void 0),this.blockId=e?e.id:null,this.isStart=r,this.blocks=a},t.utils.object.inherits(t.Events.BlockDrag,t.Events.UiBase),t.Events.BlockDrag.prototype.type=t.Events.BLOCK_DRAG,t.Events.BlockDrag.prototype.toJson=function(){var e=t.Events.BlockDrag.superClass_.toJson.call(this);return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e},t.Events.BlockDrag.prototype.fromJson=function(e){t.Events.BlockDrag.superClass_.fromJson.call(this,e),this.isStart=e.isStart,this.blockId=e.blockId,this.blocks=e.blocks},t.registry.register(t.registry.Type.EVENT,t.Events.BLOCK_DRAG,t.Events.BlockDrag),t.IBlockDragger=function(){},t.InsertionMarkerManager=function(e){this.topBlock_=t.selected=e,this.workspace_=e.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.fadedBlock_=this.highlightedBlock_=this.markerConnection_=null,this.availableConnections_=this.initAvailableConnections_()},t.InsertionMarkerManager.PREVIEW_TYPE={INSERTION_MARKER:0,INPUT_OUTLINE:1,REPLACEMENT_FADE:2},t.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",t.InsertionMarkerManager.prototype.dispose=function(){this.availableConnections_.length=0,t.Events.disable();try{this.firstMarker_&&this.firstMarker_.dispose(),this.lastMarker_&&this.lastMarker_.dispose()}finally{t.Events.enable()}},t.InsertionMarkerManager.prototype.updateAvailableConnections=function(){this.availableConnections_=this.initAvailableConnections_()},t.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},t.InsertionMarkerManager.prototype.wouldConnectBlock=function(){return!!this.closestConnection_},t.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_&&(t.Events.disable(),this.hidePreview_(),t.Events.enable(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered)){var e=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;t.blockAnimations.connectionUiEffect(e.getSourceBlock()),this.topBlock_.getRootBlock().bringToFront()}},t.InsertionMarkerManager.prototype.update=function(e,r){var a=this.getCandidate_(e);((this.wouldDeleteBlock_=this.shouldDelete_(a,r))||this.shouldUpdatePreviews_(a,e))&&(t.Events.disable(),this.maybeHidePreview_(a),this.maybeShowPreview_(a),t.Events.enable())},t.InsertionMarkerManager.prototype.createMarkerBlock_=function(e){var r=e.type;t.Events.disable();try{var a=this.workspace_.newBlock(r);if(a.setInsertionMarker(!0),e.mutationToDom){var c=e.mutationToDom();c&&a.domToMutation(c)}for(r=0;r<e.inputList.length;r++){var p=e.inputList[r];if(p.name!=t.constants.COLLAPSED_INPUT_NAME){var f=a.inputList[r];if(!f)throw Error(t.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","an input"));for(c=0;c<p.fieldRow.length;c++){var T=p.fieldRow[c],y=f.fieldRow[c];if(!y)throw Error(t.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","a field"));y.setValue(T.getValue())}}}a.setCollapsed(e.isCollapsed()),a.setInputsInline(e.getInputsInline()),a.initSvg(),a.getSvgRoot().setAttribute("visibility","hidden")}finally{t.Events.enable()}return a},t.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var e=this.topBlock_.getConnections_(!1),r=this.topBlock_.lastConnectionInStack(!0);if(r&&r!=this.topBlock_.nextConnection){if(e.push(r),this.lastOnStack_=r,this.lastMarker_){t.Events.disable();try{this.lastMarker_.dispose()}finally{t.Events.enable()}}this.lastMarker_=this.createMarkerBlock_(r.getSourceBlock())}return e},t.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(e,r){var a=e.local,c=e.closest;return e=e.radius,a&&c?this.localConnection_&&this.closestConnection_?!(this.closestConnection_==c&&this.localConnection_==a||(a=this.localConnection_.x+r.x-this.closestConnection_.x,r=this.localConnection_.y+r.y-this.closestConnection_.y,r=Math.sqrt(a*a+r*r),c&&e>r-t.CURRENT_CONNECTION_PREFERENCE)):!this.localConnection_&&!this.closestConnection_||(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why."),!0):!(!this.localConnection_||!this.closestConnection_)},t.InsertionMarkerManager.prototype.getCandidate_=function(e){for(var r=this.getStartRadius_(),a=null,c=null,p=0;p<this.availableConnections_.length;p++){var f=this.availableConnections_[p],T=f.closest(r,e);T.connection&&(a=T.connection,c=f,r=T.radius)}return{closest:a,local:c,radius:r}},t.InsertionMarkerManager.prototype.getStartRadius_=function(){return this.closestConnection_&&this.localConnection_?t.CONNECTING_SNAP_RADIUS:t.SNAP_RADIUS},t.InsertionMarkerManager.prototype.shouldDelete_=function(e,r){return!(!r||!this.workspace_.getComponentManager().hasCapability(r.id,t.ComponentManager.Capability.DELETE_AREA))&&r.wouldDelete(this.topBlock_,e&&!!e.closest)},t.InsertionMarkerManager.prototype.maybeShowPreview_=function(e){if(!this.wouldDeleteBlock_){var r=e.closest;e=e.local,r&&(r==this.closestConnection_||r.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=r,this.localConnection_=e,this.showPreview_()))}},t.InsertionMarkerManager.prototype.showPreview_=function(){var e=this.closestConnection_,r=this.workspace_.getRenderer();switch(r.getConnectionPreviewMethod(e,this.localConnection_,this.topBlock_)){case t.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline_();break;case t.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker_();break;case t.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade_()}e&&r.shouldHighlightConnection(e)&&e.highlight()},t.InsertionMarkerManager.prototype.maybeHidePreview_=function(e){if(e.closest){var r=this.closestConnection_!=e.closest;e=this.localConnection_!=e.local,this.closestConnection_&&this.localConnection_&&(r||e||this.wouldDeleteBlock_)&&this.hidePreview_()}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null},t.InsertionMarkerManager.prototype.hidePreview_=function(){this.closestConnection_&&this.closestConnection_.targetBlock()&&this.workspace_.getRenderer().shouldHighlightConnection(this.closestConnection_)&&this.closestConnection_.unhighlight(),this.fadedBlock_?this.hideReplacementFade_():this.highlightedBlock_?this.hideInsertionInputOutline_():this.markerConnection_&&this.hideInsertionMarker_()},t.InsertionMarkerManager.prototype.showInsertionMarker_=function(){var e=this.localConnection_,r=this.closestConnection_,a=this.lastOnStack_&&e==this.lastOnStack_?this.lastMarker_:this.firstMarker_;if((e=a.getMatchingConnection(e.getSourceBlock(),e))==this.markerConnection_)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");a.render(),a.rendered=!0,a.getSvgRoot().setAttribute("visibility","visible"),e&&r&&a.positionNearConnection(e,r),r&&e.connect(r),this.markerConnection_=e},t.InsertionMarkerManager.prototype.hideInsertionMarker_=function(){if(this.markerConnection_){var e=this.markerConnection_,r=e.getSourceBlock(),a=r.nextConnection,c=r.previousConnection,p=r.outputConnection;if(p=e.type==t.connectionTypes.INPUT_VALUE&&!(p&&p.targetConnection),!(e!=a||c&&c.targetConnection)||p?e.targetBlock().unplug(!1):e.type==t.connectionTypes.NEXT_STATEMENT&&e!=a?((a=e.targetConnection).getSourceBlock().unplug(!1),c=c?c.targetConnection:null,r.unplug(!0),c&&c.connect(a)):r.unplug(!0),e.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null,(e=r.getSvgRoot())&&e.setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},t.InsertionMarkerManager.prototype.showInsertionInputOutline_=function(){var e=this.closestConnection_;this.highlightedBlock_=e.getSourceBlock(),this.highlightedBlock_.highlightShapeForInput(e,!0)},t.InsertionMarkerManager.prototype.hideInsertionInputOutline_=function(){this.highlightedBlock_.highlightShapeForInput(this.closestConnection_,!1),this.highlightedBlock_=null},t.InsertionMarkerManager.prototype.showReplacementFade_=function(){this.fadedBlock_=this.closestConnection_.targetBlock(),this.fadedBlock_.fadeForReplacement(!0)},t.InsertionMarkerManager.prototype.hideReplacementFade_=function(){this.fadedBlock_.fadeForReplacement(!1),this.fadedBlock_=null},t.InsertionMarkerManager.prototype.getInsertionMarkers=function(){var e=[];return this.firstMarker_&&e.push(this.firstMarker_),this.lastMarker_&&e.push(this.lastMarker_),e},t.BlockDragger=function(e,r){this.draggingBlock_=e,this.workspace_=r,this.draggedConnectionManager_=new t.InsertionMarkerManager(this.draggingBlock_),this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=t.BlockDragger.initIconData_(e)},t.BlockDragger.prototype.dispose=function(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()},t.BlockDragger.initIconData_=function(e){var r=[];e=e.getDescendants(!1);for(var c,a=0;c=e[a];a++){c=c.getIcons();for(var p=0;p<c.length;p++){var f={location:c[p].getIconLocation(),icon:c[p]};r.push(f)}}return r},t.BlockDragger.prototype.startDrag=function(e,r){t.Events.getGroup()||t.Events.setGroup(!0),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),t.utils.dom.startTextWidthCache(),this.workspace_.setResizesEnabled(!1),t.blockAnimations.disconnectUiStop(),this.shouldDisconnect_(r)&&this.disconnectBlock_(r,e),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface()},t.BlockDragger.prototype.shouldDisconnect_=function(e){return!!(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())},t.BlockDragger.prototype.disconnectBlock_=function(e,r){this.draggingBlock_.unplug(e),e=this.pixelsToWorkspaceUnits_(r),e=t.utils.Coordinate.sum(this.startXY_,e),this.draggingBlock_.translate(e.x,e.y),t.blockAnimations.disconnectUiEffect(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()},t.BlockDragger.prototype.fireDragStartEvent_=function(){var e=new(t.Events.get(t.Events.BLOCK_DRAG))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));t.Events.fire(e)},t.BlockDragger.prototype.drag=function(e,r){r=this.pixelsToWorkspaceUnits_(r);var a=t.utils.Coordinate.sum(this.startXY_,r);this.draggingBlock_.moveDuringDrag(a),this.dragIcons_(r),a=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(e),this.draggedConnectionManager_.update(r,this.dragTarget_),e=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock(),e!=this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==a&&(a&&a.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)},t.BlockDragger.prototype.endDrag=function(e,r){if(this.drag(e,r),this.dragIconData_=[],this.fireDragEndEvent_(),t.utils.dom.stopTextWidthCache(),t.blockAnimations.disconnectUiStop(),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_))e=this.startXY_;else{var a=(e=this.getNewLocationAfterDrag_(r)).delta;e=e.newLocation}this.draggingBlock_.moveOffDragSurface(e),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(!1),a?this.updateBlockAfterMove_(a):t.bumpObjectIntoBounds_(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)),this.workspace_.setResizesEnabled(!0),t.Events.setGroup(!1)},t.BlockDragger.prototype.getNewLocationAfterDrag_=function(e){var r={};return r.delta=this.pixelsToWorkspaceUnits_(e),r.newLocation=t.utils.Coordinate.sum(this.startXY_,r.delta),r},t.BlockDragger.prototype.maybeDeleteBlock_=function(){return!!this.wouldDeleteBlock_&&(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),t.draggingConnections=[],!0)},t.BlockDragger.prototype.updateBlockAfterMove_=function(e){this.draggingBlock_.moveConnections(e.x,e.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()},t.BlockDragger.prototype.fireDragEndEvent_=function(){var e=new(t.Events.get(t.Events.BLOCK_DRAG))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));t.Events.fire(e)},t.BlockDragger.prototype.updateToolboxStyle_=function(e){var r=this.workspace_.getToolbox();if(r){var a=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";e&&"function"==typeof r.removeStyle?r.removeStyle(a):e||"function"!=typeof r.addStyle||r.addStyle(a)}},t.BlockDragger.prototype.fireMoveEvent_=function(){var e=new(t.Events.get(t.Events.BLOCK_MOVE))(this.draggingBlock_);e.oldCoordinate=this.startXY_,e.recordNew(),t.Events.fire(e)},t.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)},t.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(e){return e=new t.utils.Coordinate(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e},t.BlockDragger.prototype.dragIcons_=function(e){for(var r=0;r<this.dragIconData_.length;r++){var a=this.dragIconData_[r];a.icon.setIconLocation(t.utils.Coordinate.sum(a.location,e))}},t.BlockDragger.prototype.getInsertionMarkers=function(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]},t.registry.register(t.registry.Type.BLOCK_DRAGGER,t.registry.DEFAULT,t.BlockDragger),t.IContextMenu=function(){},t.IDraggable=function(){},t.IBubble=function(){},t.Bubble=function(e,r,a,c,p,f){this.workspace_=e,this.content_=r,this.shape_=a,this.onMouseDownResizeWrapper_=this.onMouseDownBubbleWrapper_=this.moveCallback_=this.resizeCallback_=null,this.disposed=!1,a=t.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(a=-a),this.arrow_radians_=t.utils.math.toRadians(a),e.getBubbleCanvas().appendChild(this.createDom_(r,!(!p||!f))),this.setAnchorLocation(c),p&&f||(p=(e=this.content_.getBBox()).width+2*t.Bubble.BORDER_WIDTH,f=e.height+2*t.Bubble.BORDER_WIDTH),this.setBubbleSize(p,f),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0},t.Bubble.BORDER_WIDTH=6,t.Bubble.ARROW_THICKNESS=5,t.Bubble.ARROW_ANGLE=20,t.Bubble.ARROW_BEND=4,t.Bubble.ANCHOR_RADIUS=8,t.Bubble.onMouseUpWrapper_=null,t.Bubble.onMouseMoveWrapper_=null,t.Bubble.unbindDragEvents_=function(){t.Bubble.onMouseUpWrapper_&&(t.browserEvents.unbind(t.Bubble.onMouseUpWrapper_),t.Bubble.onMouseUpWrapper_=null),t.Bubble.onMouseMoveWrapper_&&(t.browserEvents.unbind(t.Bubble.onMouseMoveWrapper_),t.Bubble.onMouseMoveWrapper_=null)},t.Bubble.bubbleMouseUp_=function(e){t.Touch.clearTouchIdentifier(),t.Bubble.unbindDragEvents_()},t.Bubble.prototype.rendered_=!1,t.Bubble.prototype.anchorXY_=null,t.Bubble.prototype.relativeLeft_=0,t.Bubble.prototype.relativeTop_=0,t.Bubble.prototype.width_=0,t.Bubble.prototype.height_=0,t.Bubble.prototype.autoLayout_=!0,t.Bubble.prototype.createDom_=function(e,r){this.bubbleGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{},null);var a={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return t.utils.userAgent.JAVA_FX&&(a={}),a=t.utils.dom.createSvgElement(t.utils.Svg.G,a,this.bubbleGroup_),this.bubbleArrow_=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{},a),this.bubbleBack_=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blocklyDraggable",x:0,y:0,rx:t.Bubble.BORDER_WIDTH,ry:t.Bubble.BORDER_WIDTH},a),r?(this.resizeGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),t.utils.dom.createSvgElement(t.utils.Svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,(r=2*t.Bubble.BORDER_WIDTH).toString())},this.resizeGroup_),t.utils.dom.createSvgElement(t.utils.Svg.LINE,{class:"blocklyResizeLine",x1:r/3,y1:r-1,x2:r-1,y2:r/3},this.resizeGroup_),t.utils.dom.createSvgElement(t.utils.Svg.LINE,{class:"blocklyResizeLine",x1:2*r/3,y1:r-1,x2:r-1,y2:2*r/3},this.resizeGroup_)):this.resizeGroup_=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper_=t.browserEvents.conditionalBind(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&(this.onMouseDownResizeWrapper_=t.browserEvents.conditionalBind(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))),this.bubbleGroup_.appendChild(e),this.bubbleGroup_},t.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},t.Bubble.prototype.setSvgId=function(e){this.bubbleGroup_.dataset&&(this.bubbleGroup_.dataset.blockId=e)},t.Bubble.prototype.bubbleMouseDown_=function(e){var r=this.workspace_.getGesture(e);r&&r.handleBubbleStart(e,this)},t.Bubble.prototype.showContextMenu=function(e){},t.Bubble.prototype.isDeletable=function(){return!1},t.Bubble.prototype.setDeleteStyle=function(e){},t.Bubble.prototype.resizeMouseDown_=function(e){this.promote(),t.Bubble.unbindDragEvents_(),t.utils.isRightButton(e)||(this.workspace_.startDrag(e,new t.utils.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),t.Bubble.onMouseUpWrapper_=t.browserEvents.conditionalBind(document,"mouseup",this,t.Bubble.bubbleMouseUp_),t.Bubble.onMouseMoveWrapper_=t.browserEvents.conditionalBind(document,"mousemove",this,this.resizeMouseMove_),t.hideChaff()),e.stopPropagation()},t.Bubble.prototype.resizeMouseMove_=function(e){this.autoLayout_=!1,e=this.workspace_.moveDrag(e),this.setBubbleSize(this.workspace_.RTL?-e.x:e.x,e.y),this.workspace_.RTL&&this.positionBubble_()},t.Bubble.prototype.registerResizeEvent=function(e){this.resizeCallback_=e},t.Bubble.prototype.registerMoveEvent=function(e){this.moveCallback_=e},t.Bubble.prototype.promote=function(){var e=this.bubbleGroup_.parentNode;return e.lastChild!==this.bubbleGroup_&&(e.appendChild(this.bubbleGroup_),!0)},t.Bubble.prototype.setAnchorLocation=function(e){this.anchorXY_=e,this.rendered_&&this.positionBubble_()},t.Bubble.prototype.layoutBubble_=function(){var e=this.workspace_.getMetricsManager().getViewMetrics(!0),r=this.getOptimalRelativeLeft_(e),a=this.getOptimalRelativeTop_(e),c=this.shape_.getBBox(),p={x:r,y:-this.height_-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},f={x:-this.width_-30,y:a};a={x:c.width,y:a};var T={x:r,y:c.height};r=c.width<c.height?a:T,c=c.width<c.height?T:a,a=this.getOverlap_(p,e),T=this.getOverlap_(f,e);var y=this.getOverlap_(r,e);e=this.getOverlap_(c,e),a==(e=Math.max(a,T,y,e))?(this.relativeLeft_=p.x,this.relativeTop_=p.y):T==e?(this.relativeLeft_=f.x,this.relativeTop_=f.y):y==e?(this.relativeLeft_=r.x,this.relativeTop_=r.y):(this.relativeLeft_=c.x,this.relativeTop_=c.y)},t.Bubble.prototype.getOverlap_=function(e,r){var a=this.workspace_.RTL?this.anchorXY_.x-e.x-this.width_:e.x+this.anchorXY_.x;return e=e.y+this.anchorXY_.y,Math.max(0,Math.min(1,(Math.min(a+this.width_,r.left+r.width)-Math.max(a,r.left))*(Math.min(e+this.height_,r.top+r.height)-Math.max(e,r.top))/(this.width_*this.height_)))},t.Bubble.prototype.getOptimalRelativeLeft_=function(e){var r=-this.width_/4;if(this.width_>e.width)return r;if(this.workspace_.RTL)var a=this.anchorXY_.x-r,c=a-this.width_,p=e.left+e.width,f=e.left+t.Scrollbar.scrollbarThickness/this.workspace_.scale;else a=(c=r+this.anchorXY_.x)+this.width_,f=e.left,p=e.left+e.width-t.Scrollbar.scrollbarThickness/this.workspace_.scale;return this.workspace_.RTL?c<f?r=-(f-this.anchorXY_.x+this.width_):a>p&&(r=-(p-this.anchorXY_.x)):c<f?r=f-this.anchorXY_.x:a>p&&(r=p-this.anchorXY_.x-this.width_),r},t.Bubble.prototype.getOptimalRelativeTop_=function(e){var r=-this.height_/4;if(this.height_>e.height)return r;var a=this.anchorXY_.y+r,p=e.top;e=e.top+e.height-t.Scrollbar.scrollbarThickness/this.workspace_.scale;var f=this.anchorXY_.y;return a<p?r=p-f:a+this.height_>e&&(r=e-f-this.height_),r},t.Bubble.prototype.positionBubble_=function(){var e=this.anchorXY_.x;this.moveTo(e=this.workspace_.RTL?e-(this.relativeLeft_+this.width_):e+this.relativeLeft_,this.relativeTop_+this.anchorXY_.y)},t.Bubble.prototype.moveTo=function(e,r){this.bubbleGroup_.setAttribute("transform","translate("+e+","+r+")")},t.Bubble.prototype.setDragging=function(e){!e&&this.moveCallback_&&this.moveCallback_()},t.Bubble.prototype.getBubbleSize=function(){return new t.utils.Size(this.width_,this.height_)},t.Bubble.prototype.setBubbleSize=function(e,r){var a=2*t.Bubble.BORDER_WIDTH;e=Math.max(e,a+45),r=Math.max(r,a+20),this.width_=e,this.height_=r,this.bubbleBack_.setAttribute("width",e),this.bubbleBack_.setAttribute("height",r),this.resizeGroup_&&this.resizeGroup_.setAttribute("transform",this.workspace_.RTL?"translate("+2*t.Bubble.BORDER_WIDTH+","+(r-a)+") scale(-1 1)":"translate("+(e-a)+","+(r-a)+")"),this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_(),this.resizeCallback_&&this.resizeCallback_()},t.Bubble.prototype.renderArrow_=function(){var e=[],r=this.width_/2,a=this.height_/2,c=-this.relativeLeft_,p=-this.relativeTop_;if(r==c&&a==p)e.push("M "+r+","+a);else{p-=a,c-=r,this.workspace_.RTL&&(c*=-1);var f=Math.sqrt(p*p+c*c),T=Math.acos(c/f);0>p&&(T=2*Math.PI-T);var y=T+Math.PI/2;y>2*Math.PI&&(y-=2*Math.PI);var D=Math.sin(y),k=Math.cos(y),G=this.getBubbleSize();y=(G.width+G.height)/t.Bubble.ARROW_THICKNESS,y=Math.min(y,G.width,G.height)/4,c=r+(G=1-t.Bubble.ANCHOR_RADIUS/f)*c,p=a+G*p,G=r+y*k;var Se=a+y*D;r-=y*k,a-=y*D,(D=T+this.arrow_radians_)>2*Math.PI&&(D-=2*Math.PI),T=Math.sin(D)*f/t.Bubble.ARROW_BEND,f=Math.cos(D)*f/t.Bubble.ARROW_BEND,e.push("M"+G+","+Se),e.push("C"+(G+f)+","+(Se+T)+" "+c+","+p+" "+c+","+p),e.push("C"+c+","+p+" "+(r+f)+","+(a+T)+" "+r+","+a)}e.push("z"),this.bubbleArrow_.setAttribute("d",e.join(" "))},t.Bubble.prototype.setColour=function(e){this.bubbleBack_.setAttribute("fill",e),this.bubbleArrow_.setAttribute("fill",e)},t.Bubble.prototype.dispose=function(){this.onMouseDownBubbleWrapper_&&t.browserEvents.unbind(this.onMouseDownBubbleWrapper_),this.onMouseDownResizeWrapper_&&t.browserEvents.unbind(this.onMouseDownResizeWrapper_),t.Bubble.unbindDragEvents_(),t.utils.dom.removeNode(this.bubbleGroup_),this.disposed=!0},t.Bubble.prototype.moveDuringDrag=function(e,r){e?e.translateSurface(r.x,r.y):this.moveTo(r.x,r.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-r.x-this.width_:r.x-this.anchorXY_.x,this.relativeTop_=r.y-this.anchorXY_.y,this.renderArrow_()},t.Bubble.prototype.getRelativeToSurfaceXY=function(){return new t.utils.Coordinate(this.workspace_.RTL?-this.relativeLeft_+this.anchorXY_.x-this.width_:this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},t.Bubble.prototype.setAutoLayout=function(e){this.autoLayout_=e},t.Bubble.textToDom=function(e){var r=t.utils.dom.createSvgElement(t.utils.Svg.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:t.Bubble.BORDER_WIDTH},null);e=e.split("\n");for(var a=0;a<e.length;a++){var c=t.utils.dom.createSvgElement(t.utils.Svg.TSPAN,{dy:"1em",x:t.Bubble.BORDER_WIDTH},r),p=document.createTextNode(e[a]);c.appendChild(p)}return r},t.Bubble.createNonEditableBubble=function(e,r,a){if((a=new t.Bubble(r.workspace,e,r.pathObject.svgPath,a,null,null)).setSvgId(r.id),r.RTL){r=e.getBBox().width;for(var p,c=0;p=e.childNodes[c];c++)p.setAttribute("text-anchor","end"),p.setAttribute("x",r+t.Bubble.BORDER_WIDTH)}return a},t.Events.CommentBase=function(e){this.commentId=(this.isBlank=void 0===e)?"":e.id,this.workspaceId=this.isBlank?"":e.workspace.id,this.group=t.Events.getGroup(),this.recordUndo=t.Events.recordUndo},t.utils.object.inherits(t.Events.CommentBase,t.Events.Abstract),t.Events.CommentBase.prototype.toJson=function(){var e=t.Events.CommentBase.superClass_.toJson.call(this);return this.commentId&&(e.commentId=this.commentId),e},t.Events.CommentBase.prototype.fromJson=function(e){t.Events.CommentBase.superClass_.fromJson.call(this,e),this.commentId=e.commentId},t.Events.CommentChange=function(e,r,a){t.Events.CommentChange.superClass_.constructor.call(this,e),e&&(this.oldContents_=void 0===r?"":r,this.newContents_=void 0===a?"":a)},t.utils.object.inherits(t.Events.CommentChange,t.Events.CommentBase),t.Events.CommentChange.prototype.type=t.Events.COMMENT_CHANGE,t.Events.CommentChange.prototype.toJson=function(){var e=t.Events.CommentChange.superClass_.toJson.call(this);return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e},t.Events.CommentChange.prototype.fromJson=function(e){t.Events.CommentChange.superClass_.fromJson.call(this,e),this.oldContents_=e.oldContents,this.newContents_=e.newContents},t.Events.CommentChange.prototype.isNull=function(){return this.oldContents_==this.newContents_},t.Events.CommentChange.prototype.run=function(e){var r=this.getEventWorkspace_().getCommentById(this.commentId);r?r.setContent(e?this.newContents_:this.oldContents_):console.warn("Can't change non-existent comment: "+this.commentId)},t.Events.CommentCreate=function(e){t.Events.CommentCreate.superClass_.constructor.call(this,e),e&&(this.xml=e.toXmlWithXY())},t.utils.object.inherits(t.Events.CommentCreate,t.Events.CommentBase),t.Events.CommentCreate.prototype.type=t.Events.COMMENT_CREATE,t.Events.CommentCreate.prototype.toJson=function(){var e=t.Events.CommentCreate.superClass_.toJson.call(this);return e.xml=t.Xml.domToText(this.xml),e},t.Events.CommentCreate.prototype.fromJson=function(e){t.Events.CommentCreate.superClass_.fromJson.call(this,e),this.xml=t.Xml.textToDom(e.xml)},t.Events.CommentCreate.prototype.run=function(e){t.Events.CommentCreateDeleteHelper(this,e)},t.Events.CommentCreateDeleteHelper=function(e,r){var a=e.getEventWorkspace_();r?((r=t.utils.xml.createElement("xml")).appendChild(e.xml),t.Xml.domToWorkspace(r,a)):(a=a.getCommentById(e.commentId))?a.dispose(!1,!1):console.warn("Can't uncreate non-existent comment: "+e.commentId)},t.Events.CommentDelete=function(e){t.Events.CommentDelete.superClass_.constructor.call(this,e),e&&(this.xml=e.toXmlWithXY())},t.utils.object.inherits(t.Events.CommentDelete,t.Events.CommentBase),t.Events.CommentDelete.prototype.type=t.Events.COMMENT_DELETE,t.Events.CommentDelete.prototype.toJson=function(){return t.Events.CommentDelete.superClass_.toJson.call(this)},t.Events.CommentDelete.prototype.fromJson=function(e){t.Events.CommentDelete.superClass_.fromJson.call(this,e)},t.Events.CommentDelete.prototype.run=function(e){t.Events.CommentCreateDeleteHelper(this,!e)},t.Events.CommentMove=function(e){t.Events.CommentMove.superClass_.constructor.call(this,e),e&&(this.comment_=e,this.oldCoordinate_=e.getXY(),this.newCoordinate_=null)},t.utils.object.inherits(t.Events.CommentMove,t.Events.CommentBase),t.Events.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw Error("Tried to record the new position of a comment on the same event twice.");this.newCoordinate_=this.comment_.getXY(),this.comment_=null},t.Events.CommentMove.prototype.type=t.Events.COMMENT_MOVE,t.Events.CommentMove.prototype.setOldCoordinate=function(e){this.oldCoordinate_=e},t.Events.CommentMove.prototype.toJson=function(){var e=t.Events.CommentMove.superClass_.toJson.call(this);return this.oldCoordinate_&&(e.oldCoordinate=Math.round(this.oldCoordinate_.x)+","+Math.round(this.oldCoordinate_.y)),this.newCoordinate_&&(e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y)),e},t.Events.CommentMove.prototype.fromJson=function(e){if(t.Events.CommentMove.superClass_.fromJson.call(this,e),e.oldCoordinate){var r=e.oldCoordinate.split(",");this.oldCoordinate_=new t.utils.Coordinate(Number(r[0]),Number(r[1]))}e.newCoordinate&&(r=e.newCoordinate.split(","),this.newCoordinate_=new t.utils.Coordinate(Number(r[0]),Number(r[1])))},t.Events.CommentMove.prototype.isNull=function(){return t.utils.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)},t.Events.CommentMove.prototype.run=function(e){var r=this.getEventWorkspace_().getCommentById(this.commentId);if(r){e=e?this.newCoordinate_:this.oldCoordinate_;var a=r.getXY();r.moveBy(e.x-a.x,e.y-a.y)}else console.warn("Can't move non-existent comment: "+this.commentId)},t.registry.register(t.registry.Type.EVENT,t.Events.COMMENT_CREATE,t.Events.CommentCreate),t.registry.register(t.registry.Type.EVENT,t.Events.COMMENT_CHANGE,t.Events.CommentChange),t.registry.register(t.registry.Type.EVENT,t.Events.COMMENT_MOVE,t.Events.CommentMove),t.registry.register(t.registry.Type.EVENT,t.Events.COMMENT_DELETE,t.Events.CommentDelete),t.BubbleDragger=function(e,r){this.draggingBubble_=e,this.workspace_=r,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=t.utils.is3dSupported()&&r.getBlockDragSurface()?r.getBlockDragSurface():null},t.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},t.BubbleDragger.prototype.startBubbleDrag=function(){t.Events.getGroup()||t.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_(),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!0)},t.BubbleDragger.prototype.dragBubble=function(e,r){r=this.pixelsToWorkspaceUnits_(r),r=t.utils.Coordinate.sum(this.startXY_,r),this.draggingBubble_.moveDuringDrag(this.dragSurface_,r),r=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(e),e=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),e!=this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==r&&(r&&r.onDragExit(this.draggingBubble_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBubble_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBubble_)},t.BubbleDragger.prototype.shouldDelete_=function(e){return!(!e||!this.workspace_.getComponentManager().hasCapability(e.id,t.ComponentManager.Capability.DELETE_AREA))&&e.wouldDelete(this.draggingBubble_,!1)},t.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.draggingBubble_.setDeleteStyle(this.wouldDeleteBubble_)},t.BubbleDragger.prototype.endBubbleDrag=function(e,r){this.dragBubble(e,r),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBubble_)?e=this.startXY_:(e=this.pixelsToWorkspaceUnits_(r),e=t.utils.Coordinate.sum(this.startXY_,e)),this.draggingBubble_.moveTo(e.x,e.y),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBubble_),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.draggingBubble_.dispose(!1,!0)):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!1),this.fireMoveEvent_()),this.workspace_.setResizesEnabled(!0),t.Events.setGroup(!1)},t.BubbleDragger.prototype.fireMoveEvent_=function(){if(this.draggingBubble_.isComment){var e=new(t.Events.get(t.Events.COMMENT_MOVE))(this.draggingBubble_);e.setOldCoordinate(this.startXY_),e.recordNew(),t.Events.fire(e)}},t.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(e){return e=new t.utils.Coordinate(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e},t.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())},t.Events.Click=function(e,r,a){t.Events.Click.superClass_.constructor.call(this,e?e.workspace.id:r),this.blockId=e?e.id:null,this.targetType=a},t.utils.object.inherits(t.Events.Click,t.Events.UiBase),t.Events.Click.prototype.type=t.Events.CLICK,t.Events.Click.prototype.toJson=function(){var e=t.Events.Click.superClass_.toJson.call(this);return e.targetType=this.targetType,this.blockId&&(e.blockId=this.blockId),e},t.Events.Click.prototype.fromJson=function(e){t.Events.Click.superClass_.fromJson.call(this,e),this.targetType=e.targetType,this.blockId=e.blockId},t.registry.register(t.registry.Type.EVENT,t.Events.CLICK,t.Events.Click),t.WorkspaceDragger=function(e){this.workspace_=e,this.horizontalScrollEnabled_=this.workspace_.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace_.isMovableVertically(),this.startScrollXY_=new t.utils.Coordinate(e.scrollX,e.scrollY)},t.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},t.WorkspaceDragger.prototype.startDrag=function(){t.selected&&t.selected.unselect(),this.workspace_.setupDragSurface()},t.WorkspaceDragger.prototype.endDrag=function(e){this.drag(e),this.workspace_.resetDragSurface()},t.WorkspaceDragger.prototype.drag=function(e){if(e=t.utils.Coordinate.sum(this.startScrollXY_,e),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace_.scroll(e.x,e.y);else if(this.horizontalScrollEnabled_)this.workspace_.scroll(e.x,this.workspace_.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace_.scroll(this.workspace_.scrollX,e.y)}},t.Gesture=function(e,r){this.mouseDownXY_=null,this.currentDragDeltaXY_=new t.utils.Coordinate(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.creatorWorkspace_=r,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=e,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.healStack_=!t.DRAG_STACK},t.Gesture.prototype.dispose=function(){t.Touch.clearTouchIdentifier(),t.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&t.browserEvents.unbind(this.onMoveWrapper_),this.onUpWrapper_&&t.browserEvents.unbind(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.bubbleDragger_&&this.bubbleDragger_.dispose()},t.Gesture.prototype.updateFromEvent_=function(e){var r=new t.utils.Coordinate(e.clientX,e.clientY);this.updateDragDelta_(r)&&(this.updateIsDragging_(),t.longStop_()),this.mostRecentEvent_=e},t.Gesture.prototype.updateDragDelta_=function(e){return this.currentDragDeltaXY_=t.utils.Coordinate.difference(e,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=t.utils.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?t.FLYOUT_DRAG_RADIUS:t.DRAG_RADIUS))},t.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(!this.targetBlock_||!this.flyout_.isBlockCreatable_(this.targetBlock_)||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),t.Events.getGroup()||t.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),0))},t.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},t.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},t.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new t.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},t.Gesture.prototype.updateIsDragging_=function(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},t.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new(t.registry.getClassFromOptions(t.registry.Type.BLOCK_DRAGGER,this.creatorWorkspace_.options,!0))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)},t.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new t.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},t.Gesture.prototype.doStart=function(e){t.utils.isTargetInput(e)?this.cancel():(this.hasStarted_=!0,t.blockAnimations.disconnectUiStop(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),t.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=e,t.Tooltip.block(),this.targetBlock_&&this.targetBlock_.select(),t.utils.isRightButton(e)?this.handleRightClick(e):("touchstart"!=e.type.toLowerCase()&&"pointerdown"!=e.type.toLowerCase()||"mouse"==e.pointerType||t.longStart(e,this),this.mouseDownXY_=new t.utils.Coordinate(e.clientX,e.clientY),this.healStack_=e.altKey||e.ctrlKey||e.metaKey,this.bindMouseEvents(e)))},t.Gesture.prototype.bindMouseEvents=function(e){this.onMoveWrapper_=t.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=t.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this)),e.preventDefault(),e.stopPropagation()},t.Gesture.prototype.handleMove=function(e){this.updateFromEvent_(e),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),e.preventDefault(),e.stopPropagation()},t.Gesture.prototype.handleUp=function(e){this.updateFromEvent_(e),t.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(e,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(e,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(e),e.preventDefault(),e.stopPropagation(),this.dispose())},t.Gesture.prototype.cancel=function(){this.isEnding_||(t.longStop_(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},t.Gesture.prototype.handleRightClick=function(e){this.targetBlock_?(this.bringBlockToFront_(),t.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(e)):this.startBubble_?this.startBubble_.showContextMenu(e):this.startWorkspace_&&!this.flyout_&&(t.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()},t.Gesture.prototype.handleWsStart=function(e,r){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(r),this.mostRecentEvent_=e,this.doStart(e)},t.Gesture.prototype.fireWorkspaceClick_=function(e){t.Events.fire(new(t.Events.get(t.Events.CLICK))(null,e.id,"workspace"))},t.Gesture.prototype.handleFlyoutStart=function(e,r){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(r),this.handleWsStart(e,r.getWorkspace())},t.Gesture.prototype.handleBlockStart=function(e,r){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(r),this.mostRecentEvent_=e},t.Gesture.prototype.handleBubbleStart=function(e,r){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(r),this.mostRecentEvent_=e},t.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus(),this.startBubble_.select&&this.startBubble_.select()},t.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()},t.Gesture.prototype.doBlockClick_=function(){if(this.flyout_&&this.flyout_.autoClose)this.targetBlock_.isEnabled()&&(t.Events.getGroup()||t.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump());else{var e=new(t.Events.get(t.Events.CLICK))(this.startBlock_,this.startWorkspace_.id,"block");t.Events.fire(e)}this.bringBlockToFront_(),t.Events.setGroup(!1)},t.Gesture.prototype.doWorkspaceClick_=function(e){e=this.creatorWorkspace_,t.selected&&t.selected.unselect(),this.fireWorkspaceClick_(this.startWorkspace_||e)},t.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},t.Gesture.prototype.setStartField=function(e){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=e)},t.Gesture.prototype.setStartBubble=function(e){this.startBubble_||(this.startBubble_=e)},t.Gesture.prototype.setStartBlock=function(e){this.startBlock_||this.startBubble_||(this.startBlock_=e,e.isInFlyout&&e!=e.getRootBlock()?this.setTargetBlock_(e.getRootBlock()):this.setTargetBlock_(e))},t.Gesture.prototype.setTargetBlock_=function(e){e.isShadow()?this.setTargetBlock_(e.getParent()):this.targetBlock_=e},t.Gesture.prototype.setStartWorkspace_=function(e){this.startWorkspace_||(this.startWorkspace_=e)},t.Gesture.prototype.setStartFlyout_=function(e){this.flyout_||(this.flyout_=e)},t.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},t.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},t.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isClickable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},t.Gesture.prototype.isWorkspaceClick_=function(){return!(this.startBlock_||this.startBubble_||this.startField_||this.hasExceededDragRadius_)},t.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},t.Gesture.prototype.hasStarted=function(){return this.hasStarted_},t.Gesture.prototype.getInsertionMarkers=function(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]},t.Gesture.prototype.getCurrentDragger=function(){return this.isDraggingBlock_?this.blockDragger_:this.isDraggingWorkspace_?this.workspaceDragger_:this.isDraggingBubble_?this.bubbleDragger_:null},t.Gesture.inProgress=function(){for(var a,e=t.Workspace.getAll(),r=0;a=e[r];r++)if(a.currentGesture_)return!0;return!1},t.IRegistrable=function(){},t.Marker=function(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"},t.Marker.prototype.setDrawer=function(e){this.drawer_=e},t.Marker.prototype.getDrawer=function(){return this.drawer_},t.Marker.prototype.getCurNode=function(){return this.curNode_},t.Marker.prototype.setCurNode=function(e){var r=this.curNode_;this.curNode_=e,this.drawer_&&this.drawer_.draw(r,this.curNode_)},t.Marker.prototype.draw=function(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)},t.Marker.prototype.hide=function(){this.drawer_&&this.drawer_.hide()},t.Marker.prototype.dispose=function(){this.getDrawer()&&this.getDrawer().dispose()},t.Cursor=function(){t.Cursor.superClass_.constructor.call(this),this.type="cursor"},t.utils.object.inherits(t.Cursor,t.Marker),t.Cursor.prototype.next=function(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()==t.ASTNode.types.NEXT||e.getType()==t.ASTNode.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e},t.Cursor.prototype.in=function(){var e=this.getCurNode();return e?((e.getType()==t.ASTNode.types.PREVIOUS||e.getType()==t.ASTNode.types.OUTPUT)&&(e=e.next()),(e=e.in())&&this.setCurNode(e),e):null},t.Cursor.prototype.prev=function(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()==t.ASTNode.types.NEXT||e.getType()==t.ASTNode.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e},t.Cursor.prototype.out=function(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()==t.ASTNode.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null},t.registry.register(t.registry.Type.CURSOR,t.registry.DEFAULT,t.Cursor),t.MarkerManager=function(e){this.cursorSvg_=this.cursor_=null,this.markers_=Object.create(null),this.workspace_=e},t.MarkerManager.LOCAL_MARKER="local_marker_1",t.MarkerManager.prototype.registerMarker=function(e,r){this.markers_[e]&&this.unregisterMarker(e),r.setDrawer(this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,r)),this.setMarkerSvg(r.getDrawer().createDom()),this.markers_[e]=r},t.MarkerManager.prototype.unregisterMarker=function(e){var r=this.markers_[e];if(!r)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");r.dispose(),delete this.markers_[e]},t.MarkerManager.prototype.getCursor=function(){return this.cursor_},t.MarkerManager.prototype.getMarker=function(e){return this.markers_[e]||null},t.MarkerManager.prototype.setCursor=function(e){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=e)&&(e=this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,this.cursor_),this.cursor_.setDrawer(e),this.setCursorSvg(this.cursor_.getDrawer().createDom()))},t.MarkerManager.prototype.setCursorSvg=function(e){e?(this.workspace_.getBlockCanvas().appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null},t.MarkerManager.prototype.setMarkerSvg=function(e){e?this.workspace_.getBlockCanvas()&&(this.cursorSvg_?this.workspace_.getBlockCanvas().insertBefore(e,this.cursorSvg_):this.workspace_.getBlockCanvas().appendChild(e)):this.markerSvg_=null},t.MarkerManager.prototype.updateMarkers=function(){this.workspace_.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace_.getCursor().draw()},t.MarkerManager.prototype.dispose=function(){for(var a,e=Object.keys(this.markers_),r=0;a=e[r];r++)this.unregisterMarker(a);this.markers_=null,this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)},t.WidgetDiv={},t.WidgetDiv.owner_=null,t.WidgetDiv.dispose_=null,t.WidgetDiv.rendererClassName_="",t.WidgetDiv.themeClassName_="",t.WidgetDiv.createDom=function(){t.WidgetDiv.DIV||(t.WidgetDiv.DIV=document.createElement("div"),t.WidgetDiv.DIV.className="blocklyWidgetDiv",(t.parentContainer||document.body).appendChild(t.WidgetDiv.DIV))},t.WidgetDiv.show=function(e,r,a){t.WidgetDiv.hide(),t.WidgetDiv.owner_=e,t.WidgetDiv.dispose_=a,(e=t.WidgetDiv.DIV).style.direction=r?"rtl":"ltr",e.style.display="block",r=t.getMainWorkspace(),t.WidgetDiv.rendererClassName_=r.getRenderer().getClassName(),t.WidgetDiv.themeClassName_=r.getTheme().getClassName(),t.utils.dom.addClass(e,t.WidgetDiv.rendererClassName_),t.utils.dom.addClass(e,t.WidgetDiv.themeClassName_)},t.WidgetDiv.hide=function(){if(t.WidgetDiv.isVisible()){t.WidgetDiv.owner_=null;var e=t.WidgetDiv.DIV;e.style.display="none",e.style.left="",e.style.top="",t.WidgetDiv.dispose_&&t.WidgetDiv.dispose_(),t.WidgetDiv.dispose_=null,e.textContent="",t.WidgetDiv.rendererClassName_&&(t.utils.dom.removeClass(e,t.WidgetDiv.rendererClassName_),t.WidgetDiv.rendererClassName_=""),t.WidgetDiv.themeClassName_&&(t.utils.dom.removeClass(e,t.WidgetDiv.themeClassName_),t.WidgetDiv.themeClassName_=""),t.getMainWorkspace().markFocused()}},t.WidgetDiv.isVisible=function(){return!!t.WidgetDiv.owner_},t.WidgetDiv.hideIfOwner=function(e){t.WidgetDiv.owner_==e&&t.WidgetDiv.hide()},t.WidgetDiv.positionInternal_=function(e,r,a){t.WidgetDiv.DIV.style.left=e+"px",t.WidgetDiv.DIV.style.top=r+"px",t.WidgetDiv.DIV.style.height=a+"px"},t.WidgetDiv.positionWithAnchor=function(e,r,a,c){var p=t.WidgetDiv.calculateY_(e,r,a);e=t.WidgetDiv.calculateX_(e,r,a,c),0>p?t.WidgetDiv.positionInternal_(e,0,a.height+p):t.WidgetDiv.positionInternal_(e,p,a.height)},t.WidgetDiv.calculateX_=function(e,r,a,c){return c?(r=Math.max(r.right-a.width,e.left),Math.min(r,e.right-a.width)):(r=Math.min(r.left,e.right-a.width),Math.max(r,e.left))},t.WidgetDiv.calculateY_=function(e,r,a){return r.bottom+a.height>=e.bottom?r.top-a.height:r.bottom},t.Field=function(e,r,a){this.value_=this.DEFAULT_VALUE,this.tooltip_=this.validator_=null,this.size_=new t.utils.Size(0,0),this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=null,a&&this.configure_(a),this.setValue(e),r&&this.setValidator(r)},t.Field.prototype.DEFAULT_VALUE=null,t.Field.prototype.name=void 0,t.Field.prototype.disposed=!1,t.Field.prototype.maxDisplayLength=50,t.Field.prototype.sourceBlock_=null,t.Field.prototype.isDirty_=!0,t.Field.prototype.visible_=!0,t.Field.prototype.clickTarget_=null,t.Field.NBSP="\xa0",t.Field.prototype.EDITABLE=!0,t.Field.prototype.SERIALIZABLE=!1,t.Field.prototype.configure_=function(e){var r=e.tooltip;"string"==typeof r&&(r=t.utils.replaceMessageReferences(e.tooltip)),r&&this.setTooltip(r)},t.Field.prototype.setSourceBlock=function(e){if(this.sourceBlock_)throw Error("Field already bound to a block.");this.sourceBlock_=e},t.Field.prototype.getConstants=function(){return!this.constants_&&this.sourceBlock_&&this.sourceBlock_.workspace&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_},t.Field.prototype.getSourceBlock=function(){return this.sourceBlock_},t.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{},null),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())},t.Field.prototype.initView=function(){this.createBorderRect_(),this.createTextElement_()},t.Field.prototype.initModel=function(){},t.Field.prototype.createBorderRect_=function(){this.borderRect_=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)},t.Field.prototype.createTextElement_=function(){this.textElement_=t.utils.dom.createSvgElement(t.utils.Svg.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)},t.Field.prototype.bindEvents_=function(){t.Tooltip.bindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_=t.browserEvents.conditionalBind(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)},t.Field.prototype.fromXml=function(e){this.setValue(e.textContent)},t.Field.prototype.toXml=function(e){return e.textContent=this.getValue(),e},t.Field.prototype.dispose=function(){t.DropDownDiv.hideIfOwner(this),t.WidgetDiv.hideIfOwner(this),t.Tooltip.unbindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_&&t.browserEvents.unbind(this.mouseDownWrapper_),t.utils.dom.removeNode(this.fieldGroup_),this.disposed=!0},t.Field.prototype.updateEditable=function(){var e=this.fieldGroup_;this.EDITABLE&&e&&(this.sourceBlock_.isEditable()?(t.utils.dom.addClass(e,"blocklyEditableText"),t.utils.dom.removeClass(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(t.utils.dom.addClass(e,"blocklyNonEditableText"),t.utils.dom.removeClass(e,"blocklyEditableText"),e.style.cursor=""))},t.Field.prototype.isClickable=function(){return!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&!!this.showEditor_&&"function"==typeof this.showEditor_},t.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},t.Field.prototype.isSerializable=function(){var e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e},t.Field.prototype.isVisible=function(){return this.visible_},t.Field.prototype.setVisible=function(e){if(this.visible_!=e){this.visible_=e;var r=this.getSvgRoot();r&&(r.style.display=e?"block":"none")}},t.Field.prototype.setValidator=function(e){this.validator_=e},t.Field.prototype.getValidator=function(){return this.validator_},t.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},t.Field.prototype.applyColour=function(){},t.Field.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()},t.Field.prototype.showEditor=function(e){this.isClickable()&&this.showEditor_(e)},t.Field.prototype.updateSize_=function(e){var r=this.getConstants(),a=2*(e=null!=e?e:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0),c=r.FIELD_TEXT_HEIGHT,p=0;this.textElement_&&(a+=p=t.utils.dom.getFastTextWidth(this.textElement_,r.FIELD_TEXT_FONTSIZE,r.FIELD_TEXT_FONTWEIGHT,r.FIELD_TEXT_FONTFAMILY)),this.borderRect_&&(c=Math.max(c,r.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=c,this.size_.width=a,this.positionTextElement_(e,p),this.positionBorderRect_()},t.Field.prototype.positionTextElement_=function(e,r){if(this.textElement_){var a=this.getConstants(),c=this.size_.height/2;this.textElement_.setAttribute("x",this.sourceBlock_.RTL?this.size_.width-r-e:e),this.textElement_.setAttribute("y",a.FIELD_TEXT_BASELINE_CENTER?c:c-a.FIELD_TEXT_HEIGHT/2+a.FIELD_TEXT_BASELINE)}},t.Field.prototype.positionBorderRect_=function(){this.borderRect_&&(this.borderRect_.setAttribute("width",this.size_.width),this.borderRect_.setAttribute("height",this.size_.height),this.borderRect_.setAttribute("rx",this.getConstants().FIELD_BORDER_RECT_RADIUS),this.borderRect_.setAttribute("ry",this.getConstants().FIELD_BORDER_RECT_RADIUS))},t.Field.prototype.getSize=function(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0==this.size_.width&&(console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."),this.render_()),this.size_):new t.utils.Size(0,0)},t.Field.prototype.getScaledBBox=function(){if(this.borderRect_)e=this.borderRect_.getBoundingClientRect(),a=t.utils.style.getPageOffset(this.borderRect_),c=e.width,e=e.height;else{var e=this.sourceBlock_.getHeightWidth(),r=this.sourceBlock_.workspace.scale,a=this.getAbsoluteXY_(),c=e.width*r;e=e.height*r,t.utils.userAgent.GECKO?(a.x+=1.5*r,a.y+=1.5*r):t.utils.userAgent.EDGE||t.utils.userAgent.IE||(a.x-=.5*r,a.y-=.5*r),c+=1*r,e+=1*r}return new t.utils.Rect(a.y,a.y+e,a.x,a.x+c)},t.Field.prototype.getDisplayText_=function(){var e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"\u2026"),e=e.replace(/\s/g,t.Field.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="\u200f"),e):t.Field.NBSP},t.Field.prototype.getText=function(){if(this.getText_){var e=this.getText_.call(this);if(null!==e)return String(e)}return String(this.getValue())},t.Field.prototype.markDirty=function(){this.isDirty_=!0,this.constants_=null},t.Field.prototype.forceRerender=function(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())},t.Field.prototype.setValue=function(e){if(null!==e){var r=this.doClassValidation_(e);if(!((e=this.processValidation_(e,r))instanceof Error)){if((r=this.getValidator())&&(r=r.call(this,e),(e=this.processValidation_(e,r))instanceof Error))return;if(!(r=this.sourceBlock_)||!r.disposed){var a=this.getValue();a===e?this.doValueUpdate_(e):(r&&t.Events.isEnabled()&&t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(r,"field",this.name||null,a,e)),this.doValueUpdate_(e),this.isDirty_&&this.forceRerender())}}}},t.Field.prototype.processValidation_=function(e,r){return null===r?(this.doValueInvalid_(e),this.isDirty_&&this.forceRerender(),Error()):(void 0!==r&&(e=r),e)},t.Field.prototype.getValue=function(){return this.value_},t.Field.prototype.doClassValidation_=function(e){return null==e?null:e},t.Field.prototype.doValueUpdate_=function(e){this.value_=e,this.isDirty_=!0},t.Field.prototype.doValueInvalid_=function(e){},t.Field.prototype.onMouseDown_=function(e){this.sourceBlock_&&this.sourceBlock_.workspace&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)},t.Field.prototype.setTooltip=function(e){e||""===e||(e=this.sourceBlock_);var r=this.getClickTarget_();r?r.tooltip=e:this.tooltip_=e},t.Field.prototype.getTooltip=function(){var e=this.getClickTarget_();return t.Tooltip.getTooltipOfObject(e||{tooltip:this.tooltip_})},t.Field.prototype.getClickTarget_=function(){return this.clickTarget_||this.getSvgRoot()},t.Field.prototype.getAbsoluteXY_=function(){return t.utils.style.getPageOffset(this.getClickTarget_())},t.Field.prototype.referencesVariables=function(){return!1},t.Field.prototype.getParentInput=function(){for(var e=null,r=this.sourceBlock_,a=r.inputList,c=0;c<r.inputList.length;c++)for(var p=a[c],f=p.fieldRow,T=0;T<f.length;T++)if(f[T]===this){e=p;break}return e},t.Field.prototype.getFlipRtl=function(){return!1},t.Field.prototype.isTabNavigable=function(){return!1},t.Field.prototype.onShortcut=function(e){return!1},t.Field.prototype.setCursorSvg=function(e){e?(this.fieldGroup_.appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null},t.Field.prototype.setMarkerSvg=function(e){e?(this.fieldGroup_.appendChild(e),this.markerSvg_=e):this.markerSvg_=null},t.Field.prototype.updateMarkers_=function(){var e=this.sourceBlock_.workspace;e.keyboardAccessibilityMode&&this.cursorSvg_&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg_&&e.getMarker(t.MarkerManager.LOCAL_MARKER).draw()},t.FieldLabel=function(e,r,a){this.class_=null,t.FieldLabel.superClass_.constructor.call(this,e,null,a),a||(this.class_=r||null)},t.utils.object.inherits(t.FieldLabel,t.Field),t.FieldLabel.prototype.DEFAULT_VALUE="",t.FieldLabel.fromJson=function(e){var r=t.utils.replaceMessageReferences(e.text);return new t.FieldLabel(r,void 0,e)},t.FieldLabel.prototype.EDITABLE=!1,t.FieldLabel.prototype.configure_=function(e){t.FieldLabel.superClass_.configure_.call(this,e),this.class_=e.class},t.FieldLabel.prototype.initView=function(){this.createTextElement_(),this.class_&&t.utils.dom.addClass(this.textElement_,this.class_)},t.FieldLabel.prototype.doClassValidation_=function(e){return null==e?null:String(e)},t.FieldLabel.prototype.setClass=function(e){this.textElement_&&(this.class_&&t.utils.dom.removeClass(this.textElement_,this.class_),e&&t.utils.dom.addClass(this.textElement_,e)),this.class_=e},t.fieldRegistry.register("field_label",t.FieldLabel),t.Input=function(e,r,a,c){if(e!=t.inputTypes.DUMMY&&!r)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=e,this.name=r,this.sourceBlock_=a,this.connection=c,this.fieldRow=[]},t.Input.prototype.align=t.constants.ALIGN.LEFT,t.Input.prototype.visible_=!0,t.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},t.Input.prototype.appendField=function(e,r){return this.insertFieldAt(this.fieldRow.length,e,r),this},t.Input.prototype.insertFieldAt=function(e,r,a){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(r||""==r&&a)&&("string"==typeof r&&(r=t.fieldRegistry.fromJson({type:"field_label",text:r})),r.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&(r.init(),r.applyColour()),r.name=a,r.setVisible(this.isVisible()),r.prefixField&&(e=this.insertFieldAt(e,r.prefixField)),this.fieldRow.splice(e,0,r),++e,r.suffixField&&(e=this.insertFieldAt(e,r.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours())),e},t.Input.prototype.removeField=function(e,r){for(var c,a=0;c=this.fieldRow[a];a++)if(c.name===e)return c.dispose(),this.fieldRow.splice(a,1),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;if(r)return!1;throw Error('Field "'+e+'" not found.')},t.Input.prototype.isVisible=function(){return this.visible_},t.Input.prototype.setVisible=function(e){var r=[];if(this.visible_==e)return r;this.visible_=e;for(var c,a=0;c=this.fieldRow[a];a++)c.setVisible(e);return this.connection&&(this.connection=this.connection,e?r=this.connection.startTrackingAll():this.connection.stopTrackingAll(),a=this.connection.targetBlock())&&(a.getSvgRoot().style.display=e?"block":"none"),r},t.Input.prototype.markDirty=function(){for(var r,e=0;r=this.fieldRow[e];e++)r.markDirty()},t.Input.prototype.setCheck=function(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this},t.Input.prototype.setAlign=function(e){return this.align=e,this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render()),this},t.Input.prototype.setShadowDom=function(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this},t.Input.prototype.getShadowDom=function(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()},t.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init()},t.Input.prototype.dispose=function(){for(var r,e=0;r=this.fieldRow[e];e++)r.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},t.Block=function(e,r,a){if(t.Generator&&void 0!==t.Generator.prototype[r])throw Error('Block prototypeName "'+r+'" conflicts with Blockly.Generator members.');if(this.id=a&&!e.getBlockById(a)?a:t.utils.genUid(),e.setBlockById(this.id,this),this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=this.outputShape_=null,this.commentModel={text:null,pinned:!1,size:new t.utils.Size(160,80)},this.xy_=new t.utils.Coordinate(0,0),this.workspace=e,this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,this.isInsertionMarker_=!1,this.hat=void 0,this.rendered=null,this.statementInputCount=0,r){if(this.type=r,!(a=t.Blocks[r])||"object"!=typeof a)throw TypeError("Unknown block type: "+r);t.utils.object.mixin(this,a)}e.addTopBlock(this),e.addTypedBlock(this),(e=t.Events.getGroup())||t.Events.setGroup(!0),r=t.Events.recordUndo;try{"function"==typeof this.init&&(t.Events.recordUndo=!1,this.init(),t.Events.recordUndo=r),t.Events.isEnabled()&&t.Events.fire(new(t.Events.get(t.Events.BLOCK_CREATE))(this))}finally{e||t.Events.setGroup(!1),t.Events.recordUndo=r}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)},t.Block.COLLAPSED_INPUT_NAME=t.constants.COLLAPSED_INPUT_NAME,t.Block.COLLAPSED_FIELD_NAME=t.constants.COLLAPSED_FIELD_NAME,t.Block.prototype.data=null,t.Block.prototype.disposed=!1,t.Block.prototype.hue_=null,t.Block.prototype.colour_="#000000",t.Block.prototype.styleName_="",t.Block.prototype.dispose=function(e){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(e),t.Events.isEnabled()&&t.Events.fire(new(t.Events.get(t.Events.BLOCK_DELETE))(this)),t.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.workspace=null),t.selected==this&&(t.selected=null);for(var r=this.childBlocks_.length-1;0<=r;r--)this.childBlocks_[r].dispose(!1);r=0;for(var a;a=this.inputList[r];r++)a.dispose();this.inputList.length=0;var p,c=this.getConnections_(!0);for(r=0;p=c[r];r++)p.dispose()}finally{t.Events.enable(),this.disposed=!0}}},t.Block.prototype.initModel=function(){for(var r,e=0;r=this.inputList[e];e++)for(var c,a=0;c=r.fieldRow[a];a++)c.initModel&&c.initModel()},t.Block.prototype.unplug=function(e){this.outputConnection?this.unplugFromRow_(e):this.previousConnection&&this.unplugFromStack_(e)},t.Block.prototype.unplugFromRow_=function(e){var r=null;this.outputConnection.isConnected()&&(r=this.outputConnection.targetConnection,this.outputConnection.disconnect()),r&&e&&(e=this.getOnlyValueConnection_())&&e.isConnected()&&!e.targetBlock().isShadow()&&((e=e.targetConnection).disconnect(),this.workspace.connectionChecker.canConnect(e,r,!1)?r.connect(e):e.onFailedConnect(r))},t.Block.prototype.getOnlyValueConnection_=function(){for(var e=null,r=0;r<this.inputList.length;r++){var a=this.inputList[r].connection;if(a&&a.type==t.connectionTypes.INPUT_VALUE&&a.targetConnection){if(e)return null;e=a}}return e},t.Block.prototype.unplugFromStack_=function(e){var r=null;this.previousConnection.isConnected()&&(r=this.previousConnection.targetConnection,this.previousConnection.disconnect());var a=this.getNextBlock();e&&a&&!a.isShadow()&&((e=this.nextConnection.targetConnection).disconnect(),r&&this.workspace.connectionChecker.canConnect(r,e,!1)&&r.connect(e))},t.Block.prototype.getConnections_=function(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(var a,r=0;a=this.inputList[r];r++)a.connection&&e.push(a.connection);return e},t.Block.prototype.lastConnectionInStack=function(e){for(var r=this.nextConnection;r;){var a=r.targetBlock();if(!a||e&&a.isShadow())return r;r=a.nextConnection}return null},t.Block.prototype.bumpNeighbours=function(){},t.Block.prototype.getParent=function(){return this.parentBlock_},t.Block.prototype.getInputWithBlock=function(e){for(var a,r=0;a=this.inputList[r];r++)if(a.connection&&a.connection.targetBlock()==e)return a;return null},t.Block.prototype.getSurroundParent=function(){var e=this;do{var r=e;if(!(e=e.getParent()))return null}while(e.getNextBlock()==r);return e},t.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},t.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},t.Block.prototype.getFirstStatementConnection=function(){for(var r,e=0;r=this.inputList[e];e++)if(r.connection&&r.connection.type==t.connectionTypes.NEXT_STATEMENT)return r.connection;return null},t.Block.prototype.getRootBlock=function(){var e=this;do{var r=e;e=r.parentBlock_}while(e);return r},t.Block.prototype.getTopStackBlock=function(){var e=this;do{var r=e.getPreviousBlock()}while(r&&r.getNextBlock()==e&&(e=r));return e},t.Block.prototype.getChildren=function(e){if(!e)return this.childBlocks_;e=[];for(var a,r=0;a=this.inputList[r];r++)a.connection&&(a=a.connection.targetBlock())&&e.push(a);return(r=this.getNextBlock())&&e.push(r),e},t.Block.prototype.setParent=function(e){if(e!=this.parentBlock_){if(this.parentBlock_){if(t.utils.arrayRemove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw Error("Still connected to previous block.");if(this.outputConnection&&this.outputConnection.isConnected())throw Error("Still connected to parent block.");this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}},t.Block.prototype.getDescendants=function(e){for(var c,r=[this],a=this.getChildren(e),p=0;c=a[p];p++)r.push.apply(r,c.getDescendants(e));return r},t.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},t.Block.prototype.setDeletable=function(e){this.deletable_=e},t.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},t.Block.prototype.setMovable=function(e){this.movable_=e},t.Block.prototype.isDuplicatable=function(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(t.utils.getBlockTypeCounts(this,!0))},t.Block.prototype.isShadow=function(){return this.isShadow_},t.Block.prototype.setShadow=function(e){this.isShadow_=e},t.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},t.Block.prototype.setInsertionMarker=function(e){this.isInsertionMarker_=e},t.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},t.Block.prototype.setEditable=function(e){this.editable_=e,e=0;for(var r;r=this.inputList[e];e++)for(var c,a=0;c=r.fieldRow[a];a++)c.updateEditable()},t.Block.prototype.isDisposed=function(){return this.disposed},t.Block.prototype.getMatchingConnection=function(e,r){var a=this.getConnections_(!0);if(e=e.getConnections_(!0),a.length!=e.length)throw Error("Connection lists did not match in length.");for(var c=0;c<e.length;c++)if(e[c]==r)return a[c];return null},t.Block.prototype.setHelpUrl=function(e){this.helpUrl=e},t.Block.prototype.setTooltip=function(e){this.tooltip=e},t.Block.prototype.getTooltip=function(){return t.Tooltip.getTooltipOfObject(this)},t.Block.prototype.getColour=function(){return this.colour_},t.Block.prototype.getStyleName=function(){return this.styleName_},t.Block.prototype.getHue=function(){return this.hue_},t.Block.prototype.setColour=function(e){e=t.utils.parseBlockColour(e),this.hue_=e.hue,this.colour_=e.hex},t.Block.prototype.setStyle=function(e){this.styleName_=e},t.Block.prototype.setOnChange=function(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=e)&&(this.onchangeWrapper_=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},t.Block.prototype.getField=function(e){if("string"!=typeof e)throw TypeError("Blockly.Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(var a,r=0;a=this.inputList[r];r++)for(var p,c=0;p=a.fieldRow[c];c++)if(p.name===e)return p;return null},t.Block.prototype.getVars=function(){for(var a,e=[],r=0;a=this.inputList[r];r++)for(var p,c=0;p=a.fieldRow[c];c++)p.referencesVariables()&&e.push(p.getValue());return e},t.Block.prototype.getVarModels=function(){for(var a,e=[],r=0;a=this.inputList[r];r++)for(var p,c=0;p=a.fieldRow[c];c++)p.referencesVariables()&&(p=this.workspace.getVariableById(p.getValue()))&&e.push(p);return e},t.Block.prototype.updateVarName=function(e){for(var a,r=0;a=this.inputList[r];r++)for(var p,c=0;p=a.fieldRow[c];c++)p.referencesVariables()&&e.getId()==p.getValue()&&p.refreshVariableName()},t.Block.prototype.renameVarById=function(e,r){for(var c,a=0;c=this.inputList[a];a++)for(var f,p=0;f=c.fieldRow[p];p++)f.referencesVariables()&&e==f.getValue()&&f.setValue(r)},t.Block.prototype.getFieldValue=function(e){return(e=this.getField(e))?e.getValue():null},t.Block.prototype.setFieldValue=function(e,r){var a=this.getField(r);if(!a)throw Error('Field "'+r+'" not found.');a.setValue(e)},t.Block.prototype.setPreviousStatement=function(e,r){if(e){if(void 0===r&&(r=null),!this.previousConnection){if(this.outputConnection)throw Error("Remove output connection prior to adding previous connection.");this.previousConnection=this.makeConnection_(t.connectionTypes.PREVIOUS_STATEMENT)}this.previousConnection.setCheck(r)}else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}},t.Block.prototype.setNextStatement=function(e,r){if(e)void 0===r&&(r=null),this.nextConnection||(this.nextConnection=this.makeConnection_(t.connectionTypes.NEXT_STATEMENT)),this.nextConnection.setCheck(r);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}},t.Block.prototype.setOutput=function(e,r){if(e){if(void 0===r&&(r=null),!this.outputConnection){if(this.previousConnection)throw Error("Remove previous connection prior to adding output connection.");this.outputConnection=this.makeConnection_(t.connectionTypes.OUTPUT_VALUE)}this.outputConnection.setCheck(r)}else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}},t.Block.prototype.setInputsInline=function(e){this.inputsInline!=e&&(t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)},t.Block.prototype.getInputsInline=function(){if(null!=this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type==t.inputTypes.DUMMY&&this.inputList[e].type==t.inputTypes.DUMMY)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type==t.inputTypes.VALUE&&this.inputList[e].type==t.inputTypes.DUMMY)return!0;return!1},t.Block.prototype.setOutputShape=function(e){this.outputShape_=e},t.Block.prototype.getOutputShape=function(){return this.outputShape_},t.Block.prototype.isEnabled=function(){return!this.disabled},t.Block.prototype.setEnabled=function(e){this.isEnabled()!=e&&(t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(this,"disabled",null,this.disabled,!e)),this.disabled=!e)},t.Block.prototype.getInheritedDisabled=function(){for(var e=this.getSurroundParent();e;){if(e.disabled)return!0;e=e.getSurroundParent()}return!1},t.Block.prototype.isCollapsed=function(){return this.collapsed_},t.Block.prototype.setCollapsed=function(e){this.collapsed_!=e&&(t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)},t.Block.prototype.toString=function(e,r){function a(k){var G=k.getCheck();return!G&&k.targetConnection&&(G=k.targetConnection.getCheck()),!!G&&(-1!=G.indexOf("Boolean")||-1!=G.indexOf("Number"))}function c(){T&&T.getType()==y.getType()&&T.getLocation()==y.getLocation()&&(T=null)}var p=[];r=r||"?";var f=t.ASTNode.NAVIGATE_ALL_FIELDS;t.ASTNode.NAVIGATE_ALL_FIELDS=!0;for(var T=t.ASTNode.createBlockNode(this),y=T;T;){switch(T.getType()){case t.ASTNode.types.INPUT:var D=T.getLocation();T.in()?a(D)&&p.push("("):p.push(r);break;case t.ASTNode.types.FIELD:(D=T.getLocation()).name!=t.constants.COLLAPSED_FIELD_NAME&&p.push(D.getText())}if(!(T=(D=T).in()||D.next())){for(T=D.out(),c();T&&!T.next();)T=T.out(),c(),T&&T.getType()==t.ASTNode.types.INPUT&&a(T.getLocation())&&p.push(")");T&&(T=T.next())}}for(t.ASTNode.NAVIGATE_ALL_FIELDS=f,r=2;r<p.length;r++)"("==p[r-2]&&")"==p[r]&&(p[r-2]=p[r-1],p.splice(r-1,2));return p=(p=p.reduce(function(k,G){return k+("("==k.substr(-1)||")"==G?"":" ")+G},"")).trim()||"???",e&&p.length>e&&(p=p.substring(0,e-3)+"..."),p},t.Block.prototype.appendValueInput=function(e){return this.appendInput_(t.inputTypes.VALUE,e)},t.Block.prototype.appendStatementInput=function(e){return this.appendInput_(t.inputTypes.STATEMENT,e)},t.Block.prototype.appendDummyInput=function(e){return this.appendInput_(t.inputTypes.DUMMY,e||"")},t.Block.prototype.jsonInit=function(e){var r=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(r+"Must not have both an output and a previousStatement.");if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(r+"Must not have both a colour and a style.");e.style?this.jsonInitStyle_(e,r):this.jsonInitColour_(e,r);for(var a=0;void 0!==e["message"+a];)this.interpolate_(e["message"+a],e["args"+a]||[],e["lastDummyAlign"+a],r),a++;if(void 0!==e.inputsInline&&this.setInputsInline(e.inputsInline),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(a=t.utils.replaceMessageReferences(a=e.tooltip),this.setTooltip(a)),void 0!==e.enableContextMenu&&(this.contextMenu=!!(a=e.enableContextMenu)),void 0!==e.helpUrl&&(a=t.utils.replaceMessageReferences(a=e.helpUrl),this.setHelpUrl(a)),"string"==typeof e.extensions&&(console.warn(r+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&t.Extensions.apply(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(r=0;r<e.length;++r)t.Extensions.apply(e[r],this,!1)},t.Block.prototype.jsonInitColour_=function(e,r){if("colour"in e)if(void 0===e.colour)console.warn(r+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch(a){console.warn(r+"Illegal colour value: ",e)}}},t.Block.prototype.jsonInitStyle_=function(e,r){e=e.style;try{this.setStyle(e)}catch(a){console.warn(r+"Style does not exist: ",e)}},t.Block.prototype.mixin=function(e,r){if(void 0!==r&&"boolean"!=typeof r)throw Error("opt_disableCheck must be a boolean if provided");if(!r){for(var a in r=[],e)void 0!==this[a]&&r.push(a);if(r.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(r))}t.utils.object.mixin(this,e)},t.Block.prototype.interpolate_=function(e,r,a,c){e=t.utils.tokenizeInterpolation(e),this.validateTokens_(e,r.length),r=this.interpolateArguments_(e,r,a),a=[],e=0;for(var p;p=r[e];e++)if(this.isInputKeyword_(p.type)){if(p=this.inputFromJson_(p,c)){for(var T,f=0;T=a[f];f++)p.appendField(T[0],T[1]);a.length=0}}else(f=this.fieldFromJson_(p))&&a.push([f,p.name])},t.Block.prototype.validateTokens_=function(e,r){for(var a=[],c=0,p=0;p<e.length;p++){var f=e[p];if("number"==typeof f){if(1>f||f>r)throw Error('Block "'+this.type+'": Message index %'+f+" out of range.");if(a[f])throw Error('Block "'+this.type+'": Message index %'+f+" duplicated.");a[f]=!0,c++}}if(c!=r)throw Error('Block "'+this.type+'": Message does not reference all '+r+" arg(s).")},t.Block.prototype.interpolateArguments_=function(e,r,a){for(var c=[],p=0;p<e.length;p++){var f=e[p];"number"==typeof f&&(f=r[f-1]),("string"!=typeof f||(f=this.stringToFieldJson_(f)))&&c.push(f)}return(e=c.length)&&!this.isInputKeyword_(c[e-1].type)&&(e={type:"input_dummy"},a&&(e.align=a),c.push(e)),c},t.Block.prototype.fieldFromJson_=function(e){var r=t.fieldRegistry.fromJson(e);return!r&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson_(e.alt))?this.fieldFromJson_(e):null:this.fieldFromJson_(e.alt):r},t.Block.prototype.inputFromJson_=function(e,r){var a={LEFT:t.constants.ALIGN.LEFT,RIGHT:t.constants.ALIGN.RIGHT,CENTRE:t.constants.ALIGN.CENTRE,CENTER:t.constants.ALIGN.CENTRE},c=null;switch(e.type){case"input_value":c=this.appendValueInput(e.name);break;case"input_statement":c=this.appendStatementInput(e.name);break;case"input_dummy":c=this.appendDummyInput(e.name)}return c?(e.check&&c.setCheck(e.check),e.align&&(void 0===(a=a[e.align.toUpperCase()])?console.warn(r+"Illegal align value: ",e.align):c.setAlign(a)),c):null},t.Block.prototype.isInputKeyword_=function(e){return"input_value"==e||"input_statement"==e||"input_dummy"==e},t.Block.prototype.stringToFieldJson_=function(e){return(e=e.trim())?{type:"field_label",text:e}:null},t.Block.prototype.appendInput_=function(e,r){var a=null;return(e==t.inputTypes.VALUE||e==t.inputTypes.STATEMENT)&&(a=this.makeConnection_(e)),e==t.inputTypes.STATEMENT&&this.statementInputCount++,e=new t.Input(e,r,this,a),this.inputList.push(e),e},t.Block.prototype.moveInputBefore=function(e,r){if(e!=r){for(var f,a=-1,c=r?-1:this.inputList.length,p=0;f=this.inputList[p];p++)if(f.name==e){if(a=p,-1!=c)break}else if(r&&f.name==r&&(c=p,-1!=a))break;if(-1==a)throw Error('Named input "'+e+'" not found.');if(-1==c)throw Error('Reference input "'+r+'" not found.');this.moveNumberedInputBefore(a,c)}},t.Block.prototype.moveNumberedInputBefore=function(e,r){if(e==r)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(r>this.inputList.length)throw RangeError("Reference input "+r+" out of bounds.");var a=this.inputList[e];this.inputList.splice(e,1),e<r&&r--,this.inputList.splice(r,0,a)},t.Block.prototype.removeInput=function(e,r){for(var c,a=0;c=this.inputList[a];a++)if(c.name==e)return c.type==t.inputTypes.STATEMENT&&this.statementInputCount--,c.dispose(),this.inputList.splice(a,1),!0;if(r)return!1;throw Error("Input not found: "+e)},t.Block.prototype.getInput=function(e){for(var a,r=0;a=this.inputList[r];r++)if(a.name==e)return a;return null},t.Block.prototype.getInputTargetBlock=function(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()},t.Block.prototype.getCommentText=function(){return this.commentModel.text},t.Block.prototype.setCommentText=function(e){this.commentModel.text!=e&&(t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(this,"comment",null,this.commentModel.text,e)),this.comment=this.commentModel.text=e)},t.Block.prototype.setWarningText=function(e,r){},t.Block.prototype.setMutator=function(e){},t.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},t.Block.prototype.moveBy=function(e,r){if(this.parentBlock_)throw Error("Block has parent.");var a=new(t.Events.get(t.Events.BLOCK_MOVE))(this);this.xy_.translate(e,r),a.recordNew(),t.Events.fire(a)},t.Block.prototype.makeConnection_=function(e){return new t.Connection(this,e)},t.Block.prototype.allInputsFilled=function(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(var a,r=0;a=this.inputList[r];r++)if(a.connection&&(!(a=a.connection.targetBlock())||!a.allInputsFilled(e)))return!1;return!(r=this.getNextBlock())||r.allInputsFilled(e)},t.Block.prototype.toDevString=function(){var e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e},t.blockRendering.IPathObject=function(e,r){},t.utils.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},t.Menu=function(){this.menuItems_=[],this.roleName_=this.element_=this.onKeyDownHandler_=this.mouseLeaveHandler_=this.mouseEnterHandler_=this.clickHandler_=this.mouseOverHandler_=this.highlightedItem_=this.openingCoords=null},t.Menu.prototype.addChild=function(e){this.menuItems_.push(e)},t.Menu.prototype.render=function(e){var r=document.createElement("div");r.className="blocklyMenu goog-menu blocklyNonSelectable",r.tabIndex=0,this.roleName_&&t.utils.aria.setRole(r,this.roleName_),this.element_=r;for(var c,a=0;c=this.menuItems_[a];a++)r.appendChild(c.createDom());this.mouseOverHandler_=t.browserEvents.conditionalBind(r,"mouseover",this,this.handleMouseOver_,!0),this.clickHandler_=t.browserEvents.conditionalBind(r,"click",this,this.handleClick_,!0),this.mouseEnterHandler_=t.browserEvents.conditionalBind(r,"mouseenter",this,this.handleMouseEnter_,!0),this.mouseLeaveHandler_=t.browserEvents.conditionalBind(r,"mouseleave",this,this.handleMouseLeave_,!0),this.onKeyDownHandler_=t.browserEvents.conditionalBind(r,"keydown",this,this.handleKeyEvent_),e.appendChild(r)},t.Menu.prototype.getElement=function(){return this.element_},t.Menu.prototype.focus=function(){var e=this.getElement();e&&(e.focus({preventScroll:!0}),t.utils.dom.addClass(e,"blocklyFocused"))},t.Menu.prototype.blur_=function(){var e=this.getElement();e&&(e.blur(),t.utils.dom.removeClass(e,"blocklyFocused"))},t.Menu.prototype.setRole=function(e){this.roleName_=e},t.Menu.prototype.dispose=function(){this.mouseOverHandler_&&(t.browserEvents.unbind(this.mouseOverHandler_),this.mouseOverHandler_=null),this.clickHandler_&&(t.browserEvents.unbind(this.clickHandler_),this.clickHandler_=null),this.mouseEnterHandler_&&(t.browserEvents.unbind(this.mouseEnterHandler_),this.mouseEnterHandler_=null),this.mouseLeaveHandler_&&(t.browserEvents.unbind(this.mouseLeaveHandler_),this.mouseLeaveHandler_=null),this.onKeyDownHandler_&&(t.browserEvents.unbind(this.onKeyDownHandler_),this.onKeyDownHandler_=null);for(var r,e=0;r=this.menuItems_[e];e++)r.dispose();this.element_=null},t.Menu.prototype.getMenuItem_=function(e){for(var r=this.getElement();e&&e!=r;){if(t.utils.dom.hasClass(e,"blocklyMenuItem"))for(var c,a=0;c=this.menuItems_[a];a++)if(c.getElement()==e)return c;e=e.parentElement}return null},t.Menu.prototype.setHighlighted=function(e){var r=this.highlightedItem_;r&&(r.setHighlighted(!1),this.highlightedItem_=null),e&&(e.setHighlighted(!0),this.highlightedItem_=e,r=this.getElement(),t.utils.style.scrollIntoContainerView(e.getElement(),r),t.utils.aria.setState(r,t.utils.aria.State.ACTIVEDESCENDANT,e.getId()))},t.Menu.prototype.highlightNext=function(){var e=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(e,1)},t.Menu.prototype.highlightPrevious=function(){var e=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(0>e?this.menuItems_.length:e,-1)},t.Menu.prototype.highlightFirst_=function(){this.highlightHelper_(-1,1)},t.Menu.prototype.highlightLast_=function(){this.highlightHelper_(this.menuItems_.length,-1)},t.Menu.prototype.highlightHelper_=function(e,r){e+=r;for(var a;a=this.menuItems_[e];){if(a.isEnabled()){this.setHighlighted(a);break}e+=r}},t.Menu.prototype.handleMouseOver_=function(e){(e=this.getMenuItem_(e.target))&&(e.isEnabled()?this.highlightedItem_!=e&&this.setHighlighted(e):this.setHighlighted(null))},t.Menu.prototype.handleClick_=function(e){var r=this.openingCoords;if(this.openingCoords=null,r&&"number"==typeof e.clientX){var a=new t.utils.Coordinate(e.clientX,e.clientY);if(1>t.utils.Coordinate.distance(r,a))return}(e=this.getMenuItem_(e.target))&&e.performAction()},t.Menu.prototype.handleMouseEnter_=function(e){this.focus()},t.Menu.prototype.handleMouseLeave_=function(e){this.getElement()&&(this.blur_(),this.setHighlighted(null))},t.Menu.prototype.handleKeyEvent_=function(e){if(this.menuItems_.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var r=this.highlightedItem_;switch(e.keyCode){case t.utils.KeyCodes.ENTER:case t.utils.KeyCodes.SPACE:r&&r.performAction();break;case t.utils.KeyCodes.UP:this.highlightPrevious();break;case t.utils.KeyCodes.DOWN:this.highlightNext();break;case t.utils.KeyCodes.PAGE_UP:case t.utils.KeyCodes.HOME:this.highlightFirst_();break;case t.utils.KeyCodes.PAGE_DOWN:case t.utils.KeyCodes.END:this.highlightLast_();break;default:return}e.preventDefault(),e.stopPropagation()}},t.Menu.prototype.getSize=function(){var e=this.getElement(),r=t.utils.style.getSize(e);return r.height=e.scrollHeight,r},t.MenuItem=function(e,r){this.content_=e,this.value_=r,this.enabled_=!0,this.element_=null,this.rightToLeft_=!1,this.roleName_=null,this.highlight_=this.checked_=this.checkable_=!1,this.actionHandler_=null},t.MenuItem.prototype.createDom=function(){var e=document.createElement("div");e.id=t.utils.IdGenerator.getNextUniqueId(),this.element_=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled_?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked_?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight_?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft_?"blocklyMenuItemRtl goog-menuitem-rtl ":"");var r=document.createElement("div");if(r.className="blocklyMenuItemContent goog-menuitem-content",this.checkable_){var a=document.createElement("div");a.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",r.appendChild(a)}return a=this.content_,"string"==typeof this.content_&&(a=document.createTextNode(this.content_)),r.appendChild(a),e.appendChild(r),this.roleName_&&t.utils.aria.setRole(e,this.roleName_),t.utils.aria.setState(e,t.utils.aria.State.SELECTED,this.checkable_&&this.checked_||!1),t.utils.aria.setState(e,t.utils.aria.State.DISABLED,!this.enabled_),e},t.MenuItem.prototype.dispose=function(){this.element_=null},t.MenuItem.prototype.getElement=function(){return this.element_},t.MenuItem.prototype.getId=function(){return this.element_.id},t.MenuItem.prototype.getValue=function(){return this.value_},t.MenuItem.prototype.setRightToLeft=function(e){this.rightToLeft_=e},t.MenuItem.prototype.setRole=function(e){this.roleName_=e},t.MenuItem.prototype.setCheckable=function(e){this.checkable_=e},t.MenuItem.prototype.setChecked=function(e){this.checked_=e},t.MenuItem.prototype.setHighlighted=function(e){this.highlight_=e;var r=this.getElement();r&&this.isEnabled()&&(e?(t.utils.dom.addClass(r,"blocklyMenuItemHighlight"),t.utils.dom.addClass(r,"goog-menuitem-highlight")):(t.utils.dom.removeClass(r,"blocklyMenuItemHighlight"),t.utils.dom.removeClass(r,"goog-menuitem-highlight")))},t.MenuItem.prototype.isEnabled=function(){return this.enabled_},t.MenuItem.prototype.setEnabled=function(e){this.enabled_=e},t.MenuItem.prototype.performAction=function(){this.isEnabled()&&this.actionHandler_&&this.actionHandler_(this)},t.MenuItem.prototype.onAction=function(e,r){this.actionHandler_=e.bind(r)},t.ContextMenu={},t.ContextMenu.currentBlock=null,t.ContextMenu.menu_=null,t.ContextMenu.show=function(e,r,a){if(t.WidgetDiv.show(t.ContextMenu,a,t.ContextMenu.dispose),r.length){var c=t.ContextMenu.populate_(r,a);t.ContextMenu.menu_=c,t.ContextMenu.position_(c,e,a),setTimeout(function(){c.focus()},1),t.ContextMenu.currentBlock=null}else t.ContextMenu.hide()},t.ContextMenu.populate_=function(e,r){var a=new t.Menu;a.setRole(t.utils.aria.Role.MENU);for(var p,c=0;p=e[c];c++){var f=new t.MenuItem(p.text);f.setRightToLeft(r),f.setRole(t.utils.aria.Role.MENUITEM),a.addChild(f),f.setEnabled(p.enabled),p.enabled&&f.onAction(function(T){t.ContextMenu.hide(),this.callback(this.scope)},p)}return a},t.ContextMenu.position_=function(e,r,a){var c=t.utils.getViewportBBox();r=new t.utils.Rect(r.clientY+c.top,r.clientY+c.top,r.clientX+c.left,r.clientX+c.left),t.ContextMenu.createWidget_(e);var p=e.getSize();a&&(r.left+=p.width,r.right+=p.width,c.left+=p.width,c.right+=p.width),t.WidgetDiv.positionWithAnchor(c,r,p,a),e.focus()},t.ContextMenu.createWidget_=function(e){e.render(t.WidgetDiv.DIV);var r=e.getElement();t.utils.dom.addClass(r,"blocklyContextMenu"),t.browserEvents.conditionalBind(r,"contextmenu",null,t.utils.noEvent),e.focus()},t.ContextMenu.hide=function(){t.WidgetDiv.hideIfOwner(t.ContextMenu),t.ContextMenu.currentBlock=null},t.ContextMenu.dispose=function(){t.ContextMenu.menu_&&(t.ContextMenu.menu_.dispose(),t.ContextMenu.menu_=null)},t.ContextMenu.callbackFactory=function(e,r){return function(){t.Events.disable();try{var a=t.Xml.domToBlock(r,e.workspace),c=e.getRelativeToSurfaceXY();c.x=e.RTL?c.x-t.SNAP_RADIUS:c.x+t.SNAP_RADIUS,c.y+=2*t.SNAP_RADIUS,a.moveBy(c.x,c.y)}finally{t.Events.enable()}t.Events.isEnabled()&&!a.isShadow()&&t.Events.fire(new(t.Events.get(t.Events.BLOCK_CREATE))(a)),a.select()}},t.ContextMenu.commentDeleteOption=function(e){return{text:t.Msg.REMOVE_COMMENT,enabled:!0,callback:function(){t.Events.setGroup(!0),e.dispose(!0,!0),t.Events.setGroup(!1)}}},t.ContextMenu.commentDuplicateOption=function(e){return{text:t.Msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){t.duplicate(e)}}},t.ContextMenu.workspaceCommentOption=function(e,r){if(!t.WorkspaceCommentSvg)throw Error("Missing require for Blockly.WorkspaceCommentSvg");var a={enabled:!t.utils.userAgent.IE};return a.text=t.Msg.ADD_COMMENT,a.callback=function(){var c=new t.WorkspaceCommentSvg(e,t.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT,t.WorkspaceCommentSvg.DEFAULT_SIZE,t.WorkspaceCommentSvg.DEFAULT_SIZE),p=e.getInjectionDiv().getBoundingClientRect();p=new t.utils.Coordinate(r.clientX-p.left,r.clientY-p.top);var f=e.getOriginOffsetInPixels();(p=t.utils.Coordinate.difference(p,f)).scale(1/e.scale),c.moveBy(p.x,p.y),e.rendered&&(c.initSvg(),c.render(),c.select())},a},t.ContextMenuRegistry=function(){t.ContextMenuRegistry.registry=this,this.registry_=Object.create(null)},t.ContextMenuRegistry.ScopeType={BLOCK:"block",WORKSPACE:"workspace"},t.ContextMenuRegistry.registry=null,t.ContextMenuRegistry.prototype.register=function(e){if(this.registry_[e.id])throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registry_[e.id]=e},t.ContextMenuRegistry.prototype.unregister=function(e){if(!this.registry_[e])throw Error('Menu item with ID "'+e+'" not found.');delete this.registry_[e]},t.ContextMenuRegistry.prototype.getItem=function(e){return this.registry_[e]||null},t.ContextMenuRegistry.prototype.getContextMenuOptions=function(e,r){var a=[],c=this.registry_;return Object.keys(c).forEach(function(p){if(e==(p=c[p]).scopeType){var f=p.preconditionFn(r);"hidden"!=f&&(p={text:"function"==typeof p.displayText?p.displayText(r):p.displayText,enabled:"enabled"==f,callback:p.callback,scope:r,weight:p.weight},a.push(p))}}),a.sort(function(p,f){return p.weight-f.weight}),a},new t.ContextMenuRegistry,t.Events.Selected=function(e,r,a){t.Events.Selected.superClass_.constructor.call(this,a),this.oldElementId=e,this.newElementId=r},t.utils.object.inherits(t.Events.Selected,t.Events.UiBase),t.Events.Selected.prototype.type=t.Events.SELECTED,t.Events.Selected.prototype.toJson=function(){var e=t.Events.Selected.superClass_.toJson.call(this);return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e},t.Events.Selected.prototype.fromJson=function(e){t.Events.Selected.superClass_.fromJson.call(this,e),this.oldElementId=e.oldElementId,this.newElementId=e.newElementId},t.registry.register(t.registry.Type.EVENT,t.Events.SELECTED,t.Events.Selected),t.IBoundedElement=function(){},t.ICopyable=function(){},t.RenderedConnection=function(e,r){t.RenderedConnection.superClass_.constructor.call(this,e,r),this.db_=e.workspace.connectionDBList[r],this.dbOpposite_=e.workspace.connectionDBList[t.OPPOSITE_TYPE[r]],this.offsetInBlock_=new t.utils.Coordinate(0,0),this.trackedState_=t.RenderedConnection.TrackedState.WILL_TRACK,this.targetConnection=null},t.utils.object.inherits(t.RenderedConnection,t.Connection),t.RenderedConnection.TrackedState={WILL_TRACK:-1,UNTRACKED:0,TRACKED:1},t.RenderedConnection.prototype.dispose=function(){t.RenderedConnection.superClass_.dispose.call(this),this.trackedState_==t.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)},t.RenderedConnection.prototype.getSourceBlock=function(){return t.RenderedConnection.superClass_.getSourceBlock.call(this)},t.RenderedConnection.prototype.targetBlock=function(){return t.RenderedConnection.superClass_.targetBlock.call(this)},t.RenderedConnection.prototype.distanceFrom=function(e){var r=this.x-e.x;return e=this.y-e.y,Math.sqrt(r*r+e*e)},t.RenderedConnection.prototype.bumpAwayFrom=function(e){if(!this.sourceBlock_.workspace.isDragging()){var r=this.sourceBlock_.getRootBlock();if(!r.isInFlyout){var a=!1;if(!r.isMovable()){if(!(r=e.getSourceBlock().getRootBlock()).isMovable())return;e=this,a=!0}var c=t.selected==r;c||r.addSelect();var p=e.x+t.SNAP_RADIUS+Math.floor(Math.random()*t.BUMP_RANDOMNESS)-this.x,f=e.y+t.SNAP_RADIUS+Math.floor(Math.random()*t.BUMP_RANDOMNESS)-this.y;a&&(f=-f),r.RTL&&(p=e.x-t.SNAP_RADIUS-Math.floor(Math.random()*t.BUMP_RANDOMNESS)-this.x),r.moveBy(p,f),c||r.removeSelect()}}},t.RenderedConnection.prototype.moveTo=function(e,r){this.trackedState_==t.RenderedConnection.TrackedState.WILL_TRACK?(this.db_.addConnection(this,r),this.trackedState_=t.RenderedConnection.TrackedState.TRACKED):this.trackedState_==t.RenderedConnection.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,r)),this.x=e,this.y=r},t.RenderedConnection.prototype.moveBy=function(e,r){this.moveTo(this.x+e,this.y+r)},t.RenderedConnection.prototype.moveToOffset=function(e){this.moveTo(e.x+this.offsetInBlock_.x,e.y+this.offsetInBlock_.y)},t.RenderedConnection.prototype.setOffsetInBlock=function(e,r){this.offsetInBlock_.x=e,this.offsetInBlock_.y=r},t.RenderedConnection.prototype.getOffsetInBlock=function(){return this.offsetInBlock_},t.RenderedConnection.prototype.tighten=function(){var e=this.targetConnection.x-this.x,r=this.targetConnection.y-this.y;if(0!=e||0!=r){var a=this.targetBlock(),c=a.getSvgRoot();if(!c)throw Error("block is not rendered.");c=t.utils.getRelativeXY(c),a.getSvgRoot().setAttribute("transform","translate("+(c.x-e)+","+(c.y-r)+")"),a.moveConnections(-e,-r)}},t.RenderedConnection.prototype.closest=function(e,r){return this.dbOpposite_.searchForClosest(this,e,r)},t.RenderedConnection.prototype.highlight=function(){var e=this.sourceBlock_.workspace.getRenderer().getConstants(),r=e.shapeFor(this);r=this.type==t.connectionTypes.INPUT_VALUE||this.type==t.connectionTypes.OUTPUT_VALUE?t.utils.svgPaths.moveBy(0,-(e=e.TAB_OFFSET_FROM_TOP))+t.utils.svgPaths.lineOnAxis("v",e)+r.pathDown+t.utils.svgPaths.lineOnAxis("v",e):t.utils.svgPaths.moveBy(-(e=e.NOTCH_OFFSET_LEFT-e.CORNER_RADIUS),0)+t.utils.svgPaths.lineOnAxis("h",e)+r.pathLeft+t.utils.svgPaths.lineOnAxis("h",e),e=this.sourceBlock_.getRelativeToSurfaceXY(),t.Connection.highlightedPath_=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyHighlightedConnectionPath",d:r,transform:"translate("+(this.x-e.x)+","+(this.y-e.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},t.RenderedConnection.prototype.unhighlight=function(){t.utils.dom.removeNode(t.Connection.highlightedPath_),delete t.Connection.highlightedPath_},t.RenderedConnection.prototype.setTracking=function(e){e&&this.trackedState_==t.RenderedConnection.TrackedState.TRACKED||!e&&this.trackedState_==t.RenderedConnection.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db_.addConnection(this,this.y),this.trackedState_=t.RenderedConnection.TrackedState.TRACKED):(this.trackedState_==t.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=t.RenderedConnection.TrackedState.UNTRACKED))},t.RenderedConnection.prototype.stopTrackingAll=function(){if(this.setTracking(!1),this.targetConnection)for(var e=this.targetBlock().getDescendants(!1),r=0;r<e.length;r++){for(var a=e[r],c=a.getConnections_(!0),p=0;p<c.length;p++)c[p].setTracking(!1);for(a=a.getIcons(),p=0;p<a.length;p++)a[p].setVisible(!1)}},t.RenderedConnection.prototype.startTrackingAll=function(){this.setTracking(!0);var e=[];if(this.type!=t.connectionTypes.INPUT_VALUE&&this.type!=t.connectionTypes.NEXT_STATEMENT)return e;var r=this.targetBlock();if(r){if(r.isCollapsed()){var a=[];r.outputConnection&&a.push(r.outputConnection),r.nextConnection&&a.push(r.nextConnection),r.previousConnection&&a.push(r.previousConnection)}else a=r.getConnections_(!0);for(var c=0;c<a.length;c++)e.push.apply(e,a[c].startTrackingAll());e.length||(e[0]=r)}return e},t.RenderedConnection.prototype.isConnectionAllowed=function(e,r){return t.utils.deprecation.warn("RenderedConnection.prototype.isConnectionAllowed","July 2020","July 2021","Blockly.Workspace.prototype.getConnectionChecker().canConnect"),!(this.distanceFrom(e)>r)&&t.RenderedConnection.superClass_.isConnectionAllowed.call(this,e)},t.RenderedConnection.prototype.onFailedConnect=function(e){var r=this.getSourceBlock();if(t.Events.recordUndo){var a=t.Events.getGroup();setTimeout(function(){r.isDisposed()||r.getParent()||(t.Events.setGroup(a),this.bumpAwayFrom(e),t.Events.setGroup(!1))}.bind(this),t.BUMP_DELAY)}},t.RenderedConnection.prototype.disconnectInternal_=function(e,r){t.RenderedConnection.superClass_.disconnectInternal_.call(this,e,r),e.rendered&&e.render(),r.rendered&&(r.updateDisabled(),r.render(),r.getSvgRoot().style.display="block")},t.RenderedConnection.prototype.respawnShadow_=function(){t.RenderedConnection.superClass_.respawnShadow_.call(this);var e=this.targetBlock();e&&(e.initSvg(),e.render(!1),(e=this.getSourceBlock()).rendered&&e.render())},t.RenderedConnection.prototype.neighbours=function(e){return this.dbOpposite_.getNeighbours(this,e)},t.RenderedConnection.prototype.connect_=function(e){t.RenderedConnection.superClass_.connect_.call(this,e);var r=this.getSourceBlock();e=e.getSourceBlock();var a=r.rendered,c=e.rendered;a&&r.updateDisabled(),c&&e.updateDisabled(),a&&c&&(this.type==t.connectionTypes.NEXT_STATEMENT||this.type==t.connectionTypes.PREVIOUS_STATEMENT?e.render():r.render()),(r=r.getInputWithBlock(e))&&(r=r.isVisible(),e.getSvgRoot().style.display=r?"block":"none")},t.RenderedConnection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())},t.BasicCursor=function(){t.BasicCursor.superClass_.constructor.call(this)},t.utils.object.inherits(t.BasicCursor,t.Cursor),t.BasicCursor.registrationName="basicCursor",t.BasicCursor.prototype.next=function(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null},t.BasicCursor.prototype.in=function(){return this.next()},t.BasicCursor.prototype.prev=function(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null},t.BasicCursor.prototype.out=function(){return this.prev()},t.BasicCursor.prototype.getNextNode_=function(e,r){if(!e)return null;var a=e.in()||e.next();return r(a)?a:a?this.getNextNode_(a,r):r(e=this.findSiblingOrParent_(e.out()))?e:e?this.getNextNode_(e,r):null},t.BasicCursor.prototype.getPreviousNode_=function(e,r){if(!e)return null;var a=e.prev();return r(a=a?this.getRightMostChild_(a):e.out())?a:a?this.getPreviousNode_(a,r):null},t.BasicCursor.prototype.validNode_=function(e){var r=!1;return((e=e&&e.getType())==t.ASTNode.types.OUTPUT||e==t.ASTNode.types.INPUT||e==t.ASTNode.types.FIELD||e==t.ASTNode.types.NEXT||e==t.ASTNode.types.PREVIOUS||e==t.ASTNode.types.WORKSPACE)&&(r=!0),r},t.BasicCursor.prototype.findSiblingOrParent_=function(e){return e?e.next()||this.findSiblingOrParent_(e.out()):null},t.BasicCursor.prototype.getRightMostChild_=function(e){if(!e.in())return e;for(e=e.in();e.next();)e=e.next();return this.getRightMostChild_(e)},t.registry.register(t.registry.Type.CURSOR,t.BasicCursor.registrationName,t.BasicCursor),t.TabNavigateCursor=function(){t.TabNavigateCursor.superClass_.constructor.call(this)},t.utils.object.inherits(t.TabNavigateCursor,t.BasicCursor),t.TabNavigateCursor.prototype.validNode_=function(e){var r=!1,a=e&&e.getType();return e&&(e=e.getLocation(),a==t.ASTNode.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(r=!0)),r},t.BlockSvg=function(e,r,a){this.svgGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{},null),this.svgGroup_.translate_="",this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup_,this.style),this.renderIsInProgress_=this.rendered=!1,this.workspace=e,this.previousConnection=this.nextConnection=this.outputConnection=null,this.useDragSurface_=t.utils.is3dSupported()&&!!e.getBlockDragSurface();var c=this.pathObject.svgPath;c.tooltip=this,t.Tooltip.bindMouseEvents(c),t.BlockSvg.superClass_.constructor.call(this,e,r,a),this.svgGroup_.dataset?this.svgGroup_.dataset.id=this.id:t.utils.userAgent.IE&&this.svgGroup_.setAttribute("data-id",this.id)},t.utils.object.inherits(t.BlockSvg,t.Block),t.BlockSvg.prototype.height=0,t.BlockSvg.prototype.width=0,t.BlockSvg.prototype.warningTextDb_=null,t.BlockSvg.INLINE=-1,t.BlockSvg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",t.BlockSvg.prototype.initSvg=function(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var r,e=0;r=this.inputList[e];e++)r.init();for(r=this.getIcons(),e=0;e<r.length;e++)r[e].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||t.browserEvents.conditionalBind(e,"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,e.parentNode||this.workspace.getCanvas().appendChild(e)},t.BlockSvg.prototype.getColourSecondary=function(){return this.style.colourSecondary},t.BlockSvg.prototype.getColourTertiary=function(){return this.style.colourTertiary},t.BlockSvg.prototype.getColourShadow=function(){return t.utils.deprecation.warn("BlockSvg.prototype.getColourShadow","January 2020","January 2021","style.colourSecondary"),this.getColourSecondary()},t.BlockSvg.prototype.getColourBorder=function(){return t.utils.deprecation.warn("BlockSvg.prototype.getColourBorder","January 2020","January 2021","style.colourTertiary"),{colourBorder:this.getColourTertiary(),colourLight:null,colourDark:null}},t.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(t.selected!=this){var e=null;if(t.selected){e=t.selected.id,t.Events.disable();try{t.selected.unselect()}finally{t.Events.enable()}}e=new(t.Events.get(t.Events.SELECTED))(e,this.id,this.workspace.id),t.Events.fire(e),t.selected=this,this.addSelect()}},t.BlockSvg.prototype.unselect=function(){if(t.selected==this){var e=new(t.Events.get(t.Events.SELECTED))(this.id,null,this.workspace.id);e.workspaceId=this.workspace.id,t.Events.fire(e),t.selected=null,this.removeSelect()}},t.BlockSvg.prototype.mutator=null,t.BlockSvg.prototype.comment=null,t.BlockSvg.prototype.commentIcon_=null,t.BlockSvg.prototype.warning=null,t.BlockSvg.prototype.getIcons=function(){var e=[];return this.mutator&&e.push(this.mutator),this.commentIcon_&&e.push(this.commentIcon_),this.warning&&e.push(this.warning),e},t.BlockSvg.prototype.setParent=function(e){var r=this.parentBlock_;if(e!=r){t.utils.dom.startTextWidthCache(),t.BlockSvg.superClass_.setParent.call(this,e),t.utils.dom.stopTextWidthCache();var a=this.getSvgRoot();if(!this.workspace.isClearing&&a){var c=this.getRelativeToSurfaceXY();e?(e.getSvgRoot().appendChild(a),e=this.getRelativeToSurfaceXY(),this.moveConnections(e.x-c.x,e.y-c.y)):r&&(this.workspace.getCanvas().appendChild(a),this.translate(c.x,c.y)),this.applyColour()}}},t.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var e=0,r=0,a=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null,c=this.getSvgRoot();if(c)do{var p=t.utils.getRelativeXY(c);e+=p.x,r+=p.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()==c&&(e+=(p=this.workspace.getBlockDragSurface().getSurfaceTranslation()).x,r+=p.y),c=c.parentNode}while(c&&c!=this.workspace.getCanvas()&&c!=a);return new t.utils.Coordinate(e,r)},t.BlockSvg.prototype.moveBy=function(e,r){if(this.parentBlock_)throw Error("Block has parent.");var a=t.Events.isEnabled();if(a)var c=new(t.Events.get(t.Events.BLOCK_MOVE))(this);var p=this.getRelativeToSurfaceXY();this.translate(p.x+e,p.y+r),this.moveConnections(e,r),a&&(c.recordNew(),t.Events.fire(c)),this.workspace.resizeContents()},t.BlockSvg.prototype.translate=function(e,r){this.getSvgRoot().setAttribute("transform","translate("+e+","+r+")")},t.BlockSvg.prototype.moveToDragSurface=function(){if(this.useDragSurface_){var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(e.x,e.y),(e=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(e)}},t.BlockSvg.prototype.moveTo=function(e){var r=this.getRelativeToSurfaceXY();this.moveBy(e.x-r.x,e.y-r.y)},t.BlockSvg.prototype.moveOffDragSurface=function(e){this.useDragSurface_&&(this.translate(e.x,e.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))},t.BlockSvg.prototype.moveDuringDrag=function(e){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(e.x,e.y):(this.svgGroup_.translate_="translate("+e.x+","+e.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},t.BlockSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},t.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(e&&e.shouldSnap()){var r=e.getSpacing(),a=r/2,c=this.getRelativeToSurfaceXY();e=Math.round((c.x-a)/r)*r+a-c.x,r=Math.round((c.y-a)/r)*r+a-c.y,e=Math.round(e),r=Math.round(r),0==e&&0==r||this.moveBy(e,r)}}},t.BlockSvg.prototype.getBoundingRectangle=function(){var e=this.getRelativeToSurfaceXY(),r=this.getHeightWidth();if(this.RTL)var a=e.x-r.width,c=e.x;else a=e.x,c=e.x+r.width;return new t.utils.Rect(e.y,e.y+r.height,a,c)},t.BlockSvg.prototype.markDirty=function(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(var r,e=0;r=this.inputList[e];e++)r.markDirty()},t.BlockSvg.prototype.setCollapsed=function(e){this.collapsed_!=e&&(t.BlockSvg.superClass_.setCollapsed.call(this,e),e?this.rendered&&this.render():this.updateCollapsed_())},t.BlockSvg.prototype.updateCollapsed_=function(){for(var p,e=this.isCollapsed(),r=t.constants.COLLAPSED_INPUT_NAME,a=t.constants.COLLAPSED_FIELD_NAME,c=0;p=this.inputList[c];c++)p.name!=r&&p.setVisible(!e);if(e){for(p=this.getIcons(),c=0;e=p[c];c++)e.setVisible(!1);c=this.toString(t.COLLAPSE_CHARS),(p=this.getField(a))?p.setValue(c):(p=this.getInput(r)||this.appendDummyInput(r)).appendField(new t.FieldLabel(c),a)}else this.updateDisabled(),this.removeInput(r)},t.BlockSvg.prototype.tab=function(e,r){var a=new t.TabNavigateCursor;a.setCurNode(t.ASTNode.createFieldNode(e)),e=a.getCurNode(),r?a.next():a.prev(),(r=a.getCurNode())&&r!==e&&(r.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(r))},t.BlockSvg.prototype.onMouseDown_=function(e){var r=this.workspace&&this.workspace.getGesture(e);r&&r.handleBlockStart(e,this)},t.BlockSvg.prototype.showHelp=function(){var e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)},t.BlockSvg.prototype.generateContextMenu=function(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var e=t.ContextMenuRegistry.registry.getContextMenuOptions(t.ContextMenuRegistry.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e},t.BlockSvg.prototype.showContextMenu=function(e){var r=this.generateContextMenu();r&&r.length&&(t.ContextMenu.show(e,r,this.RTL),t.ContextMenu.currentBlock=this)},t.BlockSvg.prototype.moveConnections=function(e,r){if(this.rendered){for(var a=this.getConnections_(!1),c=0;c<a.length;c++)a[c].moveBy(e,r);for(a=this.getIcons(),c=0;c<a.length;c++)a[c].computeIconLocation();for(c=0;c<this.childBlocks_.length;c++)this.childBlocks_[c].moveConnections(e,r)}},t.BlockSvg.prototype.setDragging=function(e){if(e){var r=this.getSvgRoot();r.translate_="",r.skew_="",t.draggingConnections=t.draggingConnections.concat(this.getConnections_(!0)),t.utils.dom.addClass(this.svgGroup_,"blocklyDragging")}else t.draggingConnections=[],t.utils.dom.removeClass(this.svgGroup_,"blocklyDragging");for(r=0;r<this.childBlocks_.length;r++)this.childBlocks_[r].setDragging(e)},t.BlockSvg.prototype.setMovable=function(e){t.BlockSvg.superClass_.setMovable.call(this,e),this.pathObject.updateMovable(e)},t.BlockSvg.prototype.setEditable=function(e){t.BlockSvg.superClass_.setEditable.call(this,e),e=this.getIcons();for(var r=0;r<e.length;r++)e[r].updateEditable()},t.BlockSvg.prototype.setShadow=function(e){t.BlockSvg.superClass_.setShadow.call(this,e),this.applyColour()},t.BlockSvg.prototype.setInsertionMarker=function(e){this.isInsertionMarker_!=e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))},t.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},t.BlockSvg.prototype.dispose=function(e,r){if(this.workspace){t.Tooltip.dispose(),t.Tooltip.unbindMouseEvents(this.pathObject.svgPath),t.utils.dom.startTextWidthCache();var a=this.workspace;if(t.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),t.ContextMenu.currentBlock==this&&t.ContextMenu.hide(),r&&this.rendered&&(this.unplug(e),t.blockAnimations.disposeUiEffect(this)),this.rendered=!1,this.warningTextDb_){for(var c in this.warningTextDb_)clearTimeout(this.warningTextDb_[c]);this.warningTextDb_=null}for(r=this.getIcons(),c=0;c<r.length;c++)r[c].dispose();t.BlockSvg.superClass_.dispose.call(this,!!e),t.utils.dom.removeNode(this.svgGroup_),a.resizeContents(),this.svgGroup_=null,t.utils.dom.stopTextWidthCache()}},t.BlockSvg.prototype.toCopyData=function(){if(this.isInsertionMarker_)return null;var e=t.Xml.blockToDom(this,!0);t.Xml.deleteNext(e);var r=this.getRelativeToSurfaceXY();return e.setAttribute("x",this.RTL?-r.x:r.x),e.setAttribute("y",r.y),{xml:e,source:this.workspace,typeCounts:t.utils.getBlockTypeCounts(this,!0)}},t.BlockSvg.prototype.applyColour=function(){this.pathObject.applyColour(this);for(var e=this.getIcons(),r=0;r<e.length;r++)e[r].applyColour();for(e=0;r=this.inputList[e];e++)for(var c,a=0;c=r.fieldRow[a];a++)c.applyColour()},t.BlockSvg.prototype.updateDisabled=function(){var e=this.getChildren(!1);if(this.applyColour(),!this.isCollapsed())for(var a,r=0;a=e[r];r++)a.rendered&&a.updateDisabled()},t.BlockSvg.prototype.getCommentIcon=function(){return this.commentIcon_},t.BlockSvg.prototype.setCommentText=function(e){if(!t.Comment)throw Error("Missing require for Blockly.Comment");this.commentModel.text!=e&&(t.BlockSvg.superClass_.setCommentText.call(this,e),!!this.commentIcon_==(e=null!=e)?this.commentIcon_.updateText():(e?this.comment=this.commentIcon_=new t.Comment(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))},t.BlockSvg.prototype.setWarningText=function(e,r){if(!t.Warning)throw Error("Missing require for Blockly.Warning");this.warningTextDb_||(this.warningTextDb_=Object.create(null));var a=r||"";if(a)this.warningTextDb_[a]&&(clearTimeout(this.warningTextDb_[a]),delete this.warningTextDb_[a]);else for(var c in this.warningTextDb_)clearTimeout(this.warningTextDb_[c]),delete this.warningTextDb_[c];if(this.workspace.isDragging()){var p=this;this.warningTextDb_[a]=setTimeout(function(){p.workspace&&(delete p.warningTextDb_[a],p.setWarningText(e,a))},100)}else{if(this.isInFlyout&&(e=null),r=!1,"string"==typeof e){c=this.getSurroundParent();for(var f=null;c;)c.isCollapsed()&&(f=c),c=c.getSurroundParent();f&&f.setWarningText(t.Msg.COLLAPSED_WARNINGS_WARNING,t.BlockSvg.COLLAPSED_WARNING_ID),this.warning||(this.warning=new t.Warning(this),r=!0),this.warning.setText(e,a)}else this.warning&&!a?(this.warning.dispose(),r=!0):this.warning&&(r=this.warning.getText(),this.warning.setText("",a),(c=this.warning.getText())||this.warning.dispose(),r=r!=c);r&&this.rendered&&(this.render(),this.bumpNeighbours())}},t.BlockSvg.prototype.setMutator=function(e){this.mutator&&this.mutator!==e&&this.mutator.dispose(),e&&(e.setBlock(this),this.mutator=e,e.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())},t.BlockSvg.prototype.setEnabled=function(e){this.isEnabled()!=e&&(t.BlockSvg.superClass_.setEnabled.call(this,e),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())},t.BlockSvg.prototype.setHighlighted=function(e){this.rendered&&this.pathObject.updateHighlighted(e)},t.BlockSvg.prototype.addSelect=function(){this.pathObject.updateSelected(!0)},t.BlockSvg.prototype.removeSelect=function(){this.pathObject.updateSelected(!1)},t.BlockSvg.prototype.setDeleteStyle=function(e){this.pathObject.updateDraggingDelete(e)},t.BlockSvg.prototype.getColour=function(){return this.style.colourPrimary},t.BlockSvg.prototype.setColour=function(e){t.BlockSvg.superClass_.setColour.call(this,e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()},t.BlockSvg.prototype.setStyle=function(e){var r=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,!r)throw Error("Invalid style name: "+e);this.hat=r.hat,this.pathObject.setStyle(r),this.colour_=r.colourPrimary,this.style=r,this.applyColour()},t.BlockSvg.prototype.bringToFront=function(){var e=this;do{var r=e.getSvgRoot(),a=r.parentNode,c=a.childNodes;c[c.length-1]!==r&&a.appendChild(r),e=e.getParent()}while(e)},t.BlockSvg.prototype.setPreviousStatement=function(e,r){t.BlockSvg.superClass_.setPreviousStatement.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours())},t.BlockSvg.prototype.setNextStatement=function(e,r){t.BlockSvg.superClass_.setNextStatement.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours())},t.BlockSvg.prototype.setOutput=function(e,r){t.BlockSvg.superClass_.setOutput.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours())},t.BlockSvg.prototype.setInputsInline=function(e){t.BlockSvg.superClass_.setInputsInline.call(this,e),this.rendered&&(this.render(),this.bumpNeighbours())},t.BlockSvg.prototype.removeInput=function(e,r){return e=t.BlockSvg.superClass_.removeInput.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours()),e},t.BlockSvg.prototype.moveNumberedInputBefore=function(e,r){t.BlockSvg.superClass_.moveNumberedInputBefore.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours())},t.BlockSvg.prototype.appendInput_=function(e,r){return e=t.BlockSvg.superClass_.appendInput_.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours()),e},t.BlockSvg.prototype.setConnectionTracking=function(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var r=this.nextConnection.targetBlock();r&&r.setConnectionTracking(e)}if(!this.collapsed_)for(r=0;r<this.inputList.length;r++){var a=this.inputList[r].connection;a&&(a.setTracking(e),(a=a.targetBlock())&&a.setConnectionTracking(e))}},t.BlockSvg.prototype.getConnections_=function(e){var r=[];if((e||this.rendered)&&(this.outputConnection&&r.push(this.outputConnection),this.previousConnection&&r.push(this.previousConnection),this.nextConnection&&r.push(this.nextConnection),e||!this.collapsed_)){e=0;for(var a;a=this.inputList[e];e++)a.connection&&r.push(a.connection)}return r},t.BlockSvg.prototype.lastConnectionInStack=function(e){return t.BlockSvg.superClass_.lastConnectionInStack.call(this,e)},t.BlockSvg.prototype.getMatchingConnection=function(e,r){return t.BlockSvg.superClass_.getMatchingConnection.call(this,e,r)},t.BlockSvg.prototype.makeConnection_=function(e){return new t.RenderedConnection(this,e)},t.BlockSvg.prototype.bumpNeighbours=function(){if(this.workspace&&!this.workspace.isDragging()){var e=this.getRootBlock();if(!e.isInFlyout)for(var c,r=this.getConnections_(!1),a=0;c=r[a];a++){c.isConnected()&&c.isSuperior()&&c.targetBlock().bumpNeighbours();for(var T,p=c.neighbours(t.SNAP_RADIUS),f=0;T=p[f];f++)c.isConnected()&&T.isConnected()||T.getSourceBlock().getRootBlock()!=e&&(c.isSuperior()?T.bumpAwayFrom(c):c.bumpAwayFrom(T))}}},t.BlockSvg.prototype.scheduleSnapAndBump=function(){var e=this,r=t.Events.getGroup();setTimeout(function(){t.Events.setGroup(r),e.snapToGrid(),t.Events.setGroup(!1)},t.BUMP_DELAY/2),setTimeout(function(){t.Events.setGroup(r),e.bumpNeighbours(),t.Events.setGroup(!1)},t.BUMP_DELAY)},t.BlockSvg.prototype.positionNearConnection=function(e,r){e.type!=t.connectionTypes.NEXT_STATEMENT&&e.type!=t.connectionTypes.INPUT_VALUE||this.moveBy(r.x-e.x,r.y-e.y)},t.BlockSvg.prototype.getParent=function(){return t.BlockSvg.superClass_.getParent.call(this)},t.BlockSvg.prototype.getRootBlock=function(){return t.BlockSvg.superClass_.getRootBlock.call(this)},t.BlockSvg.prototype.render=function(e){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{if(this.rendered=!0,t.utils.dom.startTextWidthCache(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),!1!==e){var r=this.getParent();r?r.render(!0):this.workspace.resizeContents()}t.utils.dom.stopTextWidthCache(),this.updateMarkers_()}finally{this.renderIsInProgress_=!1}}},t.BlockSvg.prototype.updateMarkers_=function(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(t.MarkerManager.LOCAL_MARKER).draw()},t.BlockSvg.prototype.updateConnectionLocations_=function(){var e=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(e),this.outputConnection&&this.outputConnection.moveToOffset(e);for(var r=0;r<this.inputList.length;r++){var a=this.inputList[r].connection;a&&(a.moveToOffset(e),a.isConnected()&&a.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(e),this.nextConnection.isConnected()&&this.nextConnection.tighten())},t.BlockSvg.prototype.setCursorSvg=function(e){this.pathObject.setCursorSvg(e)},t.BlockSvg.prototype.setMarkerSvg=function(e){this.pathObject.setMarkerSvg(e)},t.BlockSvg.prototype.getHeightWidth=function(){var e=this.height,r=this.width,a=this.getNextBlock();if(a){a=a.getHeightWidth();var c=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=a.height-c,r=Math.max(r,a.width)}return{height:e,width:r}},t.BlockSvg.prototype.fadeForReplacement=function(e){this.pathObject.updateReplacementFade(e)},t.BlockSvg.prototype.highlightShapeForInput=function(e,r){this.pathObject.updateShapeForInputHighlight(e,r)},t.ConnectionDB=function(e){this.connections_=[],this.connectionChecker_=e},t.ConnectionDB.prototype.addConnection=function(e,r){r=this.calculateIndexForYPos_(r),this.connections_.splice(r,0,e)},t.ConnectionDB.prototype.findIndexOfConnection_=function(e,r){if(!this.connections_.length)return-1;var a=this.calculateIndexForYPos_(r);if(a>=this.connections_.length)return-1;r=e.y;for(var c=a;0<=c&&this.connections_[c].y==r;){if(this.connections_[c]==e)return c;c--}for(c=a;c<this.connections_.length&&this.connections_[c].y==r;){if(this.connections_[c]==e)return c;c++}return-1},t.ConnectionDB.prototype.calculateIndexForYPos_=function(e){if(!this.connections_.length)return 0;for(var r=0,a=this.connections_.length;r<a;){var c=Math.floor((r+a)/2);if(this.connections_[c].y<e)r=c+1;else{if(!(this.connections_[c].y>e)){r=c;break}a=c}}return r},t.ConnectionDB.prototype.removeConnection=function(e,r){if(-1==(e=this.findIndexOfConnection_(e,r)))throw Error("Unable to find connection in connectionDB.");this.connections_.splice(e,1)},t.ConnectionDB.prototype.getNeighbours=function(e,r){function a(k){var G=p-c[k].x,Se=f-c[k].y;return Math.sqrt(G*G+Se*Se)<=r&&D.push(c[k]),Se<r}var c=this.connections_,p=e.x,f=e.y;e=0;for(var T=c.length-2,y=T;e<y;)c[y].y<f?e=y:T=y,y=Math.floor((e+T)/2);var D=[];if(T=e=y,c.length){for(;0<=e&&a(e);)e--;do{T++}while(T<c.length&&a(T))}return D},t.ConnectionDB.prototype.isInYRange_=function(e,r,a){return Math.abs(this.connections_[e].y-r)<=a},t.ConnectionDB.prototype.searchForClosest=function(e,r,a){if(!this.connections_.length)return{connection:null,radius:r};var c=e.y,p=e.x;e.x=p+a.x,e.y=c+a.y;var f=this.calculateIndexForYPos_(e.y);a=null;for(var y,T=r,D=f-1;0<=D&&this.isInYRange_(D,e.y,r);)this.connectionChecker_.canConnect(e,y=this.connections_[D],!0,T)&&(a=y,T=y.distanceFrom(e)),D--;for(;f<this.connections_.length&&this.isInYRange_(f,e.y,r);)this.connectionChecker_.canConnect(e,y=this.connections_[f],!0,T)&&(a=y,T=y.distanceFrom(e)),f++;return e.x=p,e.y=c,{connection:a,radius:T}},t.ConnectionDB.init=function(e){var r=[];return r[t.connectionTypes.INPUT_VALUE]=new t.ConnectionDB(e),r[t.connectionTypes.OUTPUT_VALUE]=new t.ConnectionDB(e),r[t.connectionTypes.NEXT_STATEMENT]=new t.ConnectionDB(e),r[t.connectionTypes.PREVIOUS_STATEMENT]=new t.ConnectionDB(e),r},t.Events.ThemeChange=function(e,r){t.Events.ThemeChange.superClass_.constructor.call(this,r),this.themeName=e},t.utils.object.inherits(t.Events.ThemeChange,t.Events.UiBase),t.Events.ThemeChange.prototype.type=t.Events.THEME_CHANGE,t.Events.ThemeChange.prototype.toJson=function(){var e=t.Events.ThemeChange.superClass_.toJson.call(this);return e.themeName=this.themeName,e},t.Events.ThemeChange.prototype.fromJson=function(e){t.Events.ThemeChange.superClass_.fromJson.call(this,e),this.themeName=e.themeName},t.registry.register(t.registry.Type.EVENT,t.Events.THEME_CHANGE,t.Events.ThemeChange),t.Events.ViewportChange=function(e,r,a,c,p){t.Events.ViewportChange.superClass_.constructor.call(this,c),this.viewTop=e,this.viewLeft=r,this.scale=a,this.oldScale=p},t.utils.object.inherits(t.Events.ViewportChange,t.Events.UiBase),t.Events.ViewportChange.prototype.type=t.Events.VIEWPORT_CHANGE,t.Events.ViewportChange.prototype.toJson=function(){var e=t.Events.ViewportChange.superClass_.toJson.call(this);return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e},t.Events.ViewportChange.prototype.fromJson=function(e){t.Events.ViewportChange.superClass_.fromJson.call(this,e),this.viewTop=e.viewTop,this.viewLeft=e.viewLeft,this.scale=e.scale,this.oldScale=e.oldScale},t.registry.register(t.registry.Type.EVENT,t.Events.VIEWPORT_CHANGE,t.Events.ViewportChange),t.IMetricsManager=function(){},t.MetricsManager=function(e){this.workspace_=e},t.MetricsManager.prototype.getDimensionsPx_=function(e){var r=0,a=0;return e&&(r=e.getWidth(),a=e.getHeight()),new t.utils.Size(r,a)},t.MetricsManager.prototype.getFlyoutMetrics=function(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}},t.MetricsManager.prototype.getToolboxMetrics=function(){var e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}},t.MetricsManager.prototype.getSvgMetrics=function(){return this.workspace_.getCachedParentSvgSize()},t.MetricsManager.prototype.getAbsoluteMetrics=function(){var e=0,r=this.getToolboxMetrics(),a=this.getFlyoutMetrics(!0),c=!!this.workspace_.getToolbox(),p=!!this.workspace_.getFlyout(!0),f=c?r.position:a.position,T=f==t.utils.toolbox.Position.LEFT;return f=f==t.utils.toolbox.Position.TOP,c&&T?e=r.width:p&&T&&(e=a.width),T=0,c&&f?T=r.height:p&&f&&(T=a.height),{top:T,left:e}},t.MetricsManager.prototype.getViewMetrics=function(e){e=e?this.workspace_.scale:1;var r=this.getSvgMetrics(),a=this.getToolboxMetrics(),c=this.getFlyoutMetrics(!0),p=this.workspace_.getToolbox()?a.position:c.position;return this.workspace_.getToolbox()?p==t.utils.toolbox.Position.TOP||p==t.utils.toolbox.Position.BOTTOM?r.height-=a.height:(p==t.utils.toolbox.Position.LEFT||p==t.utils.toolbox.Position.RIGHT)&&(r.width-=a.width):this.workspace_.getFlyout(!0)&&(p==t.utils.toolbox.Position.TOP||p==t.utils.toolbox.Position.BOTTOM?r.height-=c.height:(p==t.utils.toolbox.Position.LEFT||p==t.utils.toolbox.Position.RIGHT)&&(r.width-=c.width)),{height:r.height/e,width:r.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}},t.MetricsManager.prototype.getContentMetrics=function(e){e=e?1:this.workspace_.scale;var r=this.workspace_.getBlocksBoundingBox();return{height:(r.bottom-r.top)*e,width:(r.right-r.left)*e,top:r.top*e,left:r.left*e}},t.MetricsManager.prototype.hasFixedEdges=function(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()},t.MetricsManager.prototype.getComputedFixedEdges_=function(e){if(!this.hasFixedEdges())return{};var r=this.workspace_.isMovableHorizontally(),a=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);var c={};return a||(c.top=e.top,c.bottom=e.top+e.height),r||(c.left=e.left,c.right=e.left+e.width),c},t.MetricsManager.prototype.getPaddedContent_=function(e,r){var a=r.top+r.height,c=r.left+r.width,p=e.width,f=p/2,T=(e=e.height)/2;return{top:Math.min(r.top-T,a-e),bottom:Math.max(a+T,r.top+e),left:Math.min(r.left-f,c-p),right:Math.max(c+f,r.left+p)}},t.MetricsManager.prototype.getScrollMetrics=function(e,r,a){e=e?this.workspace_.scale:1,r=r||this.getViewMetrics(!1);var c=a||this.getContentMetrics();a=this.getComputedFixedEdges_(r),r=this.getPaddedContent_(r,c);var p=void 0!==a.left?a.left:r.left;return{top:(c=void 0!==a.top?a.top:r.top)/e,left:p/e,width:((void 0!==a.right?a.right:r.right)-p)/e,height:((void 0!==a.bottom?a.bottom:r.bottom)-c)/e}},t.MetricsManager.prototype.getUiMetrics=function(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}},t.MetricsManager.prototype.getMetrics=function(){var e=this.getToolboxMetrics(),r=this.getFlyoutMetrics(!0),a=this.getSvgMetrics(),c=this.getAbsoluteMetrics(),p=this.getViewMetrics(),f=this.getContentMetrics(),T=this.getScrollMetrics(!1,p,f);return{contentHeight:f.height,contentWidth:f.width,contentTop:f.top,contentLeft:f.left,scrollHeight:T.height,scrollWidth:T.width,scrollTop:T.top,scrollLeft:T.left,viewHeight:p.height,viewWidth:p.width,viewTop:p.top,viewLeft:p.left,absoluteTop:c.top,absoluteLeft:c.left,svgHeight:a.height,svgWidth:a.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:r.width,flyoutHeight:r.height}},t.registry.register(t.registry.Type.METRICS_MANAGER,t.registry.DEFAULT,t.MetricsManager),t.FlyoutMetricsManager=function(e,r){this.flyout_=r,t.FlyoutMetricsManager.superClass_.constructor.call(this,e)},t.utils.object.inherits(t.FlyoutMetricsManager,t.MetricsManager),t.FlyoutMetricsManager.prototype.getBoundingBox_=function(){try{var e=this.workspace_.getCanvas().getBBox()}catch(r){e={height:0,y:0,width:0,x:0}}return e},t.FlyoutMetricsManager.prototype.getContentMetrics=function(e){var r=this.getBoundingBox_();return{height:r.height*(e=e?1:this.workspace_.scale),width:r.width*e,top:r.y*e,left:r.x*e}},t.FlyoutMetricsManager.prototype.getScrollMetrics=function(e,r,a){return{height:((r=a||this.getContentMetrics()).height+2*(a=this.flyout_.MARGIN*this.workspace_.scale))/(e=e?this.workspace_.scale:1),width:(r.width+r.left+a)/e,top:0,left:0}},t.ThemeManager=function(e,r){this.workspace_=e,this.theme_=r,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)},t.ThemeManager.prototype.getTheme=function(){return this.theme_},t.ThemeManager.prototype.setTheme=function(e){var a,r=this.theme_;for(this.theme_=e,(e=this.workspace_.getInjectionDiv())&&(r&&t.utils.dom.removeClass(e,r.getClassName()),t.utils.dom.addClass(e,this.theme_.getClassName())),r=0;e=this.subscribedWorkspaces_[r];r++)e.refreshTheme();for(r=0,e=Object.keys(this.componentDB_);a=e[r];r++)for(var p,c=0;p=this.componentDB_[a][c];c++){var f=p.element;p=p.propertyName;var T=this.theme_&&this.theme_.getComponentStyle(a);f.style[p]=T||""}t.hideChaff()},t.ThemeManager.prototype.subscribeWorkspace=function(e){this.subscribedWorkspaces_.push(e)},t.ThemeManager.prototype.unsubscribeWorkspace=function(e){if(0>(e=this.subscribedWorkspaces_.indexOf(e)))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");this.subscribedWorkspaces_.splice(e,1)},t.ThemeManager.prototype.subscribe=function(e,r,a){this.componentDB_[r]||(this.componentDB_[r]=[]),this.componentDB_[r].push({element:e,propertyName:a}),r=this.theme_&&this.theme_.getComponentStyle(r),e.style[a]=r||""},t.ThemeManager.prototype.unsubscribe=function(e){if(e)for(var c,r=Object.keys(this.componentDB_),a=0;c=r[a];a++){for(var p=this.componentDB_[c],f=p.length-1;0<=f;f--)p[f].element===e&&p.splice(f,1);this.componentDB_[c].length||delete this.componentDB_[c]}},t.ThemeManager.prototype.dispose=function(){this.componentDB_=this.subscribedWorkspaces_=this.theme_=this.owner_=null},t.TouchGesture=function(e,r){t.TouchGesture.superClass_.constructor.call(this,e,r),this.isMultiTouch_=!1,this.cachedPoints_=Object.create(null),this.startDistance_=this.previousScale_=0,this.isPinchZoomEnabled_=this.onStartWrapper_=null},t.utils.object.inherits(t.TouchGesture,t.Gesture),t.TouchGesture.ZOOM_IN_MULTIPLIER=5,t.TouchGesture.ZOOM_OUT_MULTIPLIER=6,t.TouchGesture.prototype.doStart=function(e){this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,t.TouchGesture.superClass_.doStart.call(this,e),!this.isEnding_&&t.Touch.isTouchEvent(e)&&this.handleTouchStart(e)},t.TouchGesture.prototype.bindMouseEvents=function(e){this.onStartWrapper_=t.browserEvents.conditionalBind(document,"mousedown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=t.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=t.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this),!0),e.preventDefault(),e.stopPropagation()},t.TouchGesture.prototype.handleStart=function(e){!this.isDragging()&&t.Touch.isTouchEvent(e)&&(this.handleTouchStart(e),this.isMultiTouch()&&t.longStop_())},t.TouchGesture.prototype.handleMove=function(e){this.isDragging()?t.Touch.shouldHandleEvent(e)&&t.TouchGesture.superClass_.handleMove.call(this,e):this.isMultiTouch()?(t.Touch.isTouchEvent(e)&&this.handleTouchMove(e),t.longStop_()):t.TouchGesture.superClass_.handleMove.call(this,e)},t.TouchGesture.prototype.handleUp=function(e){t.Touch.isTouchEvent(e)&&!this.isDragging()&&this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()?t.Touch.shouldHandleEvent(e)&&t.TouchGesture.superClass_.handleUp.call(this,e):(e.preventDefault(),e.stopPropagation(),this.dispose())},t.TouchGesture.prototype.isMultiTouch=function(){return this.isMultiTouch_},t.TouchGesture.prototype.dispose=function(){t.TouchGesture.superClass_.dispose.call(this),this.onStartWrapper_&&t.browserEvents.unbind(this.onStartWrapper_)},t.TouchGesture.prototype.handleTouchStart=function(e){var r=t.Touch.getTouchIdentifierFromEvent(e);this.cachedPoints_[r]=this.getTouchPoint(e),2==(r=Object.keys(this.cachedPoints_)).length&&(this.startDistance_=t.utils.Coordinate.distance(this.cachedPoints_[r[0]],this.cachedPoints_[r[1]]),this.isMultiTouch_=!0,e.preventDefault())},t.TouchGesture.prototype.handleTouchMove=function(e){var r=t.Touch.getTouchIdentifierFromEvent(e);this.cachedPoints_[r]=this.getTouchPoint(e),r=Object.keys(this.cachedPoints_),this.isPinchZoomEnabled_&&2===r.length?this.handlePinch_(e):t.TouchGesture.superClass_.handleMove.call(this,e)},t.TouchGesture.prototype.handlePinch_=function(e){var r=Object.keys(this.cachedPoints_);if(r=t.utils.Coordinate.distance(this.cachedPoints_[r[0]],this.cachedPoints_[r[1]])/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){var a=r-this.previousScale_;a=0<a?a*t.TouchGesture.ZOOM_IN_MULTIPLIER:a*t.TouchGesture.ZOOM_OUT_MULTIPLIER;var c=this.startWorkspace_,p=t.utils.mouseToSvg(e,c.getParentSvg(),c.getInverseScreenCTM());c.zoom(p.x,p.y,a)}this.previousScale_=r,e.preventDefault()},t.TouchGesture.prototype.handleTouchEnd=function(e){e=t.Touch.getTouchIdentifierFromEvent(e),this.cachedPoints_[e]&&delete this.cachedPoints_[e],2>Object.keys(this.cachedPoints_).length&&(this.cachedPoints_=Object.create(null),this.previousScale_=0)},t.TouchGesture.prototype.getTouchPoint=function(e){return this.startWorkspace_?new t.utils.Coordinate(e.pageX?e.pageX:e.changedTouches[0].pageX,e.pageY?e.pageY:e.changedTouches[0].pageY):null},t.WorkspaceAudio=function(e){this.parentWorkspace_=e,this.SOUNDS_=Object.create(null)},t.WorkspaceAudio.prototype.lastSound_=null,t.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},t.WorkspaceAudio.prototype.load=function(e,r){if(e.length){try{var a=new t.utils.global.Audio}catch(y){return}for(var c,p=0;p<e.length;p++){var f=e[p],T=f.match(/\.(\w+)$/);if(T&&a.canPlayType("audio/"+T[1])){c=new t.utils.global.Audio(f);break}}c&&c.play&&(this.SOUNDS_[r]=c)}},t.WorkspaceAudio.prototype.preload=function(){for(var e in this.SOUNDS_){var r=this.SOUNDS_[e];r.volume=.01;var a=r.play();if(void 0!==a?a.then(r.pause).catch(function(){}):r.pause(),t.utils.userAgent.IPAD||t.utils.userAgent.IPHONE)break}},t.WorkspaceAudio.prototype.play=function(e,r){var a=this.SOUNDS_[e];a?(e=new Date,null!=this.lastSound_&&e-this.lastSound_<t.SOUND_LIMIT||(this.lastSound_=e,(a=t.utils.userAgent.IPAD||t.utils.userAgent.ANDROID?a:a.cloneNode()).volume=void 0===r?1:r,a.play())):this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(e,r)},t.WorkspaceSvg=function(e,r,a){t.WorkspaceSvg.superClass_.constructor.call(this,e),this.metricsManager_=new(t.registry.getClassFromOptions(t.registry.Type.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager_.getMetrics.bind(this.metricsManager_),this.setMetrics=e.setMetrics||t.WorkspaceSvg.setTopLevelWorkspaceMetrics_,this.componentManager_=new t.ComponentManager,this.connectionDBList=t.ConnectionDB.init(this.connectionChecker),r&&(this.blockDragSurface_=r),a&&(this.workspaceDragSurface_=a),this.useWorkspaceDragSurface_=!!this.workspaceDragSurface_&&t.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new t.WorkspaceAudio(e.parentWorkspace),this.grid_=this.options.gridPattern?new t.Grid(this.options.gridPattern,e.gridOptions):null,this.markerManager_=new t.MarkerManager(this),this.toolboxCategoryCallbacks_=Object.create(null),this.flyoutButtonCallbacks_=Object.create(null),t.Variables&&t.Variables.flyoutCategory&&this.registerToolboxCategoryCallback(t.VARIABLE_CATEGORY_NAME,t.Variables.flyoutCategory),t.VariablesDynamic&&t.VariablesDynamic.flyoutCategory&&this.registerToolboxCategoryCallback(t.VARIABLE_DYNAMIC_CATEGORY_NAME,t.VariablesDynamic.flyoutCategory),t.Procedures&&t.Procedures.flyoutCategory&&(this.registerToolboxCategoryCallback(t.PROCEDURE_CATEGORY_NAME,t.Procedures.flyoutCategory),this.addChangeListener(t.Procedures.mutatorOpenListener)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new t.ThemeManager(this,this.options.theme||t.Themes.Classic),this.themeManager_.subscribeWorkspace(this),this.renderer_=t.blockRendering.init(this.options.renderer||"geras",this.getTheme(),this.options.rendererOverrides),this.cachedParentSvg_=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements_=[],this.dragTargetAreas_=[],this.cachedParentSvgSize_=new t.utils.Size(0,0)},t.utils.object.inherits(t.WorkspaceSvg,t.Workspace),t.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,t.WorkspaceSvg.prototype.rendered=!0,t.WorkspaceSvg.prototype.isVisible_=!0,t.WorkspaceSvg.prototype.isFlyout=!1,t.WorkspaceSvg.prototype.isMutator=!1,t.WorkspaceSvg.prototype.resizesEnabled_=!0,t.WorkspaceSvg.prototype.scrollX=0,t.WorkspaceSvg.prototype.scrollY=0,t.WorkspaceSvg.prototype.startScrollX=0,t.WorkspaceSvg.prototype.startScrollY=0,t.WorkspaceSvg.prototype.dragDeltaXY_=null,t.WorkspaceSvg.prototype.scale=1,t.WorkspaceSvg.prototype.oldScale_=1,t.WorkspaceSvg.prototype.oldTop_=0,t.WorkspaceSvg.prototype.oldLeft_=0,t.WorkspaceSvg.prototype.trashcan=null,t.WorkspaceSvg.prototype.scrollbar=null,t.WorkspaceSvg.prototype.flyout_=null,t.WorkspaceSvg.prototype.toolbox_=null,t.WorkspaceSvg.prototype.currentGesture_=null,t.WorkspaceSvg.prototype.blockDragSurface_=null,t.WorkspaceSvg.prototype.workspaceDragSurface_=null,t.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,t.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,t.WorkspaceSvg.prototype.injectionDiv_=null,t.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,t.WorkspaceSvg.prototype.targetWorkspace=null,t.WorkspaceSvg.prototype.inverseScreenCTM_=null,t.WorkspaceSvg.prototype.inverseScreenCTMDirty_=!0,t.WorkspaceSvg.prototype.getMarkerManager=function(){return this.markerManager_},t.WorkspaceSvg.prototype.getMetricsManager=function(){return this.metricsManager_},t.WorkspaceSvg.prototype.setMetricsManager=function(e){this.metricsManager_=e,this.getMetrics=this.metricsManager_.getMetrics.bind(this.metricsManager_)},t.WorkspaceSvg.prototype.getComponentManager=function(){return this.componentManager_},t.WorkspaceSvg.prototype.setCursorSvg=function(e){this.markerManager_.setCursorSvg(e)},t.WorkspaceSvg.prototype.setMarkerSvg=function(e){this.markerManager_.setMarkerSvg(e)},t.WorkspaceSvg.prototype.getMarker=function(e){return this.markerManager_?this.markerManager_.getMarker(e):null},t.WorkspaceSvg.prototype.getCursor=function(){return this.markerManager_?this.markerManager_.getCursor():null},t.WorkspaceSvg.prototype.getRenderer=function(){return this.renderer_},t.WorkspaceSvg.prototype.getThemeManager=function(){return this.themeManager_},t.WorkspaceSvg.prototype.getTheme=function(){return this.themeManager_.getTheme()},t.WorkspaceSvg.prototype.setTheme=function(e){e||(e=t.Themes.Classic),this.themeManager_.setTheme(e)},t.WorkspaceSvg.prototype.refreshTheme=function(){this.svgGroup_&&this.renderer_.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(r){return!!r.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);var e=new(t.Events.get(t.Events.THEME_CHANGE))(this.getTheme().name,this.id);t.Events.fire(e)},t.WorkspaceSvg.prototype.updateBlockStyles_=function(e){for(var a,r=0;a=e[r];r++){var c=a.getStyleName();c&&(a.setStyle(c),a.mutator&&a.mutator.updateBlockStyle())}},t.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM_=e.inverse(),this.inverseScreenCTMDirty_=!1)}return this.inverseScreenCTM_},t.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=!0},t.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_},t.WorkspaceSvg.prototype.getSvgXY=function(e){var r=0,a=0,c=1;(t.utils.dom.containsNode(this.getCanvas(),e)||t.utils.dom.containsNode(this.getBubbleCanvas(),e))&&(c=this.scale);do{var p=t.utils.getRelativeXY(e);(e==this.getCanvas()||e==this.getBubbleCanvas())&&(c=1),r+=p.x*c,a+=p.y*c,e=e.parentNode}while(e&&e!=this.getParentSvg());return new t.utils.Coordinate(r,a)},t.WorkspaceSvg.prototype.getCachedParentSvgSize=function(){var e=this.cachedParentSvgSize_;return new t.utils.Size(e.width,e.height)},t.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return t.utils.getInjectionDivXY_(this.getCanvas())},t.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var e=this.svgGroup_;e;){if(-1!=(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=e;break}e=e.parentNode}return this.injectionDiv_},t.WorkspaceSvg.prototype.getBlockCanvas=function(){return this.svgBlockCanvas_},t.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(e){this.resizeHandlerWrapper_=e},t.WorkspaceSvg.prototype.createDom=function(e){return this.svgGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:"blocklyWorkspace"},null),e&&(this.svgBackground_=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"==e&&this.grid_?this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(t.browserEvents.conditionalBind(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),t.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(t.registry.getClassFromOptions(t.registry.Type.TOOLBOX,this.options,!0))(this)),this.grid_&&this.grid_.update(this.scale),this.recordDragTargets(),(e=t.registry.getClassFromOptions(t.registry.Type.CURSOR,this.options))&&this.markerManager_.setCursor(new e),this.renderer_.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_},t.WorkspaceSvg.prototype.dispose=function(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&(t.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.renderer_.dispose(),this.markerManager_&&(this.markerManager_.dispose(),this.markerManager_=null),t.WorkspaceSvg.superClass_.dispose.call(this),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||(this.themeManager_.dispose(),this.themeManager_=null)),this.flyoutButtonCallbacks_=this.toolboxCategoryCallbacks_=this.connectionDBList=null,!this.options.parentWorkspace){var e=this.getParentSvg();e&&e.parentNode&&t.utils.dom.removeNode(e.parentNode)}this.resizeHandlerWrapper_&&(t.browserEvents.unbind(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},t.WorkspaceSvg.prototype.newBlock=function(e,r){return new t.BlockSvg(this,e,r)},t.WorkspaceSvg.prototype.addTrashcan=function(){if(!t.Trashcan)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new t.Trashcan(this);var e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.svgBlockCanvas_)},t.WorkspaceSvg.prototype.addZoomControls=function(){if(!t.ZoomControls)throw Error("Missing require for Blockly.ZoomControls");this.zoomControls_=new t.ZoomControls(this);var e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)},t.WorkspaceSvg.prototype.addFlyout=function(e){var r=new t.Options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return r.toolboxPosition=this.options.toolboxPosition,this.flyout_=this.horizontalLayout?new(t.registry.getClassFromOptions(t.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(r):new(t.registry.getClassFromOptions(t.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(r),this.flyout_.autoClose=!1,this.flyout_.getWorkspace().setVisible(!0),this.flyout_.createDom(e)},t.WorkspaceSvg.prototype.getFlyout=function(e){return this.flyout_||e?this.flyout_:this.toolbox_?this.toolbox_.getFlyout():null},t.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_},t.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDragTargets()},t.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},t.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position();for(var p,e=this.componentManager_.getComponents(t.ComponentManager.Capability.POSITIONABLE,!0),r=this.getMetricsManager().getUiMetrics(),a=[],c=0;p=e[c];c++)p.position(r,a),(p=p.getBoundingRectangle())&&a.push(p);this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},t.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var e=t.utils.getDocumentScroll();t.utils.Coordinate.equals(this.lastRecordedPageScroll_,e)||(this.lastRecordedPageScroll_=e,this.updateScreenCalculations_())},t.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},t.WorkspaceSvg.prototype.setCachedParentSvgSize=function(e,r){var a=this.getParentSvg();e&&(this.cachedParentSvgSize_.width=e,a.cachedWidth_=e),r&&(this.cachedParentSvgSize_.height=r,a.cachedHeight_=r)},t.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},t.WorkspaceSvg.prototype.getParentSvg=function(){if(!this.cachedParentSvg_)for(var e=this.svgGroup_;e;){if("svg"==e.tagName){this.cachedParentSvg_=e;break}e=e.parentNode}return this.cachedParentSvg_},t.WorkspaceSvg.prototype.maybeFireViewportChangeEvent=function(){if(t.Events.isEnabled()){var e=this.scale,r=-this.scrollY,a=-this.scrollX;if(!(e==this.oldScale_&&1>Math.abs(r-this.oldTop_)&&1>Math.abs(a-this.oldLeft_))){var c=new(t.Events.get(t.Events.VIEWPORT_CHANGE))(r,a,e,this.id,this.oldScale_);this.oldScale_=e,this.oldTop_=r,this.oldLeft_=a,t.Events.fire(c)}}},t.WorkspaceSvg.prototype.translate=function(e,r){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(e,r);else{var a="translate("+e+","+r+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",a),this.svgBubbleCanvas_.setAttribute("transform",a)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(e,r,this.scale),this.grid_&&this.grid_.moveTo(e,r),this.maybeFireViewportChangeEvent()},t.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var e=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),this.svgBlockCanvas_.setAttribute("transform",e="translate("+e.x+","+e.y+") scale("+this.scale+")"),this.svgBubbleCanvas_.setAttribute("transform",e)}},t.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var e=this.svgBlockCanvas_.previousSibling,r=parseInt(this.getParentSvg().getAttribute("width"),10),a=parseInt(this.getParentSvg().getAttribute("height"),10),c=t.utils.getRelativeXY(this.getCanvas());this.workspaceDragSurface_.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),e,r,a,this.scale),this.workspaceDragSurface_.translateSurface(c.x,c.y)}},t.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},t.WorkspaceSvg.prototype.getWidth=function(){var e=this.getMetrics();return e?e.viewWidth/this.scale:0},t.WorkspaceSvg.prototype.setVisible=function(e){if(this.isVisible_=e,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox_&&this.toolbox_.setVisible(e),e){for(var r=(e=this.getAllBlocks(!1)).length-1;0<=r;r--)e[r].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else t.hideChaff(!0)},t.WorkspaceSvg.prototype.render=function(){for(var e=this.getAllBlocks(!1),r=e.length-1;0<=r;r--)e[r].render(!1);if(this.currentGesture_)for(e=this.currentGesture_.getInsertionMarkers(),r=0;r<e.length;r++)e[r].render(!1);this.markerManager_.updateMarkers()},t.WorkspaceSvg.prototype.highlightBlock=function(e,r){if(void 0===r){for(var c,a=0;c=this.highlightedBlocks_[a];a++)c.setHighlighted(!1);this.highlightedBlocks_.length=0}(c=e?this.getBlockById(e):null)&&((e=void 0===r||r)?-1==this.highlightedBlocks_.indexOf(c)&&this.highlightedBlocks_.push(c):t.utils.arrayRemove(this.highlightedBlocks_,c),c.setHighlighted(e))},t.WorkspaceSvg.prototype.paste=function(e){!this.rendered||!e.tagName||e.getElementsByTagName("block").length>=this.remainingCapacity()||(this.currentGesture_&&this.currentGesture_.cancel(),"comment"==e.tagName.toLowerCase()?this.pasteWorkspaceComment_(e):this.pasteBlock_(e))},t.WorkspaceSvg.prototype.pasteBlock_=function(e){t.Events.disable();try{var r=t.Xml.domToBlock(e,this),a=parseInt(e.getAttribute("x"),10),c=parseInt(e.getAttribute("y"),10);if(!isNaN(a)&&!isNaN(c)){this.RTL&&(a=-a);do{e=!1;for(var T,p=this.getAllBlocks(!1),f=0;T=p[f];f++){var y=T.getRelativeToSurfaceXY();if(1>=Math.abs(a-y.x)&&1>=Math.abs(c-y.y)){e=!0;break}}if(!e){var k,D=r.getConnections_(!1);for(f=0;k=D[f];f++)if(k.closest(t.SNAP_RADIUS,new t.utils.Coordinate(a,c)).connection){e=!0;break}}e&&(a=this.RTL?a-t.SNAP_RADIUS:a+t.SNAP_RADIUS,c+=2*t.SNAP_RADIUS)}while(e);r.moveBy(a,c)}}finally{t.Events.enable()}t.Events.isEnabled()&&!r.isShadow()&&t.Events.fire(new(t.Events.get(t.Events.BLOCK_CREATE))(r)),r.select()},t.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(e){t.Events.disable();try{var r=t.WorkspaceCommentSvg.fromXml(e,this),a=parseInt(e.getAttribute("x"),10),c=parseInt(e.getAttribute("y"),10);isNaN(a)||isNaN(c)||(this.RTL&&(a=-a),r.moveBy(a+50,c+50))}finally{t.Events.enable()}t.Events.isEnabled()&&t.WorkspaceComment.fireCreateEvent(r),r.select()},t.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox_&&e.toolbox_.getFlyout()&&e.toolbox_.refreshSelection()},t.WorkspaceSvg.prototype.renameVariableById=function(e,r){t.WorkspaceSvg.superClass_.renameVariableById.call(this,e,r),this.refreshToolboxSelection()},t.WorkspaceSvg.prototype.deleteVariableById=function(e){t.WorkspaceSvg.superClass_.deleteVariableById.call(this,e),this.refreshToolboxSelection()},t.WorkspaceSvg.prototype.createVariable=function(e,r,a){return e=t.WorkspaceSvg.superClass_.createVariable.call(this,e,r,a),this.refreshToolboxSelection(),e},t.WorkspaceSvg.prototype.recordDeleteAreas=function(){t.utils.deprecation.warn("WorkspaceSvg.prototype.recordDeleteAreas","June 2021","June 2022","WorkspaceSvg.prototype.recordDragTargets"),this.recordDragTargets()},t.WorkspaceSvg.prototype.recordDragTargets=function(){var e=this.componentManager_.getComponents(t.ComponentManager.Capability.DRAG_TARGET,!0);this.dragTargetAreas_=[];for(var a,r=0;a=e[r];r++){var c=a.getClientRect();c&&this.dragTargetAreas_.push({component:a,clientRect:c})}},t.WorkspaceSvg.prototype.getDragTarget=function(e){for(var a,r=0;a=this.dragTargetAreas_[r];r++)if(a.clientRect.contains(e.clientX,e.clientY))return a.component;return null},t.WorkspaceSvg.prototype.onMouseDown_=function(e){var r=this.getGesture(e);r&&r.handleWsStart(e,this)},t.WorkspaceSvg.prototype.startDrag=function(e,r){(e=t.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,this.dragDeltaXY_=t.utils.Coordinate.difference(r,e)},t.WorkspaceSvg.prototype.moveDrag=function(e){return(e=t.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,t.utils.Coordinate.sum(this.dragDeltaXY_,e)},t.WorkspaceSvg.prototype.isDragging=function(){return null!=this.currentGesture_&&this.currentGesture_.isDragging()},t.WorkspaceSvg.prototype.isDraggable=function(){return this.options.moveOptions&&this.options.moveOptions.drag},t.WorkspaceSvg.prototype.isMovable=function(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},t.WorkspaceSvg.prototype.isMovableHorizontally=function(){var e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())},t.WorkspaceSvg.prototype.isMovableVertically=function(){var e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())},t.WorkspaceSvg.prototype.onMouseWheel_=function(e){if(t.Gesture.inProgress())e.preventDefault(),e.stopPropagation();else{var r=this.options.zoomOptions&&this.options.zoomOptions.wheel,a=this.options.moveOptions&&this.options.moveOptions.wheel;if(r||a){var c=t.utils.getScrollDeltaPixels(e);!r||!e.ctrlKey&&a?(r=this.scrollX-c.x,a=this.scrollY-c.y,e.shiftKey&&!c.x&&(r=this.scrollX-c.y,a=this.scrollY),this.scroll(r,a)):(c=-c.y/50,r=t.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(r.x,r.y,c)),e.preventDefault()}}},t.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var e=this.getTopBoundedElements();if(!e.length)return new t.utils.Rect(0,0,0,0);for(var r=e[0].getBoundingRectangle(),a=1;a<e.length;a++){var c=e[a];c.isInsertionMarker&&c.isInsertionMarker()||((c=c.getBoundingRectangle()).top<r.top&&(r.top=c.top),c.bottom>r.bottom&&(r.bottom=c.bottom),c.left<r.left&&(r.left=c.left),c.right>r.right&&(r.right=c.right))}return r},t.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),t.Events.setGroup(!0);for(var c,e=this.getTopBlocks(!0),r=0,a=0;c=e[a];a++)if(c.isMovable()){var p=c.getRelativeToSurfaceXY();c.moveBy(-p.x,r-p.y),c.snapToGrid(),r=c.getRelativeToSurfaceXY().y+c.getHeightWidth().height+this.renderer_.getConstants().MIN_BLOCK_HEIGHT}t.Events.setGroup(!1),this.setResizesEnabled(!0)},t.WorkspaceSvg.prototype.showContextMenu=function(e){if(!this.options.readOnly&&!this.isFlyout){var r=t.ContextMenuRegistry.registry.getContextMenuOptions(t.ContextMenuRegistry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(r,e),t.ContextMenu.show(e,r,this.RTL)}},t.WorkspaceSvg.prototype.updateToolbox=function(e){if(e=t.utils.toolbox.convertToolboxDefToJson(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(t.utils.toolbox.hasCategories(e)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox_.render(e)}else{if(!this.flyout_)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout_.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")},t.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(t.mainWorkspace=this,this.setBrowserFocus())},t.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0})}catch(e){try{this.getParentSvg().parentNode.setActive()}catch(r){this.getParentSvg().parentNode.focus({preventScroll:!0})}}},t.WorkspaceSvg.prototype.zoom=function(e,r,a){a=Math.pow(this.options.zoomOptions.scaleSpeed,a);var c=this.scale*a;if(this.scale!=c){c>this.options.zoomOptions.maxScale?a=this.options.zoomOptions.maxScale/this.scale:c<this.options.zoomOptions.minScale&&(a=this.options.zoomOptions.minScale/this.scale);var p=this.getCanvas().getCTM(),f=this.getParentSvg().createSVGPoint();f.x=e,f.y=r,f=f.matrixTransform(p.inverse()),p=p.translate((e=f.x)*(1-a),(r=f.y)*(1-a)).scale(a),this.scrollX=p.e,this.scrollY=p.f,this.setScale(c)}},t.WorkspaceSvg.prototype.zoomCenter=function(e){var r=this.getMetrics();if(this.flyout_){var a=r.svgWidth?r.svgWidth/2:0;r=r.svgHeight?r.svgHeight/2:0}else a=r.viewWidth/2+r.absoluteLeft,r=r.viewHeight/2+r.absoluteTop;this.zoom(a,r,e)},t.WorkspaceSvg.prototype.zoomToFit=function(){if(this.isMovable()){var e=this.getMetrics(),r=e.viewWidth;e=e.viewHeight;var a=this.getBlocksBoundingBox(),c=a.right-a.left;if(a=a.bottom-a.top,c){this.flyout_&&(this.horizontalLayout?(e+=this.flyout_.getHeight(),a+=this.flyout_.getHeight()/this.scale):(r+=this.flyout_.getWidth(),c+=this.flyout_.getWidth()/this.scale)),r/=c,e/=a,t.Events.disable();try{this.setScale(Math.min(r,e)),this.scrollCenter()}finally{t.Events.enable()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},t.WorkspaceSvg.prototype.beginCanvasTransition=function(){t.utils.dom.addClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),t.utils.dom.addClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},t.WorkspaceSvg.prototype.endCanvasTransition=function(){t.utils.dom.removeClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),t.utils.dom.removeClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},t.WorkspaceSvg.prototype.scrollCenter=function(){if(this.isMovable()){var e=this.getMetrics(),r=(e.scrollWidth-e.viewWidth)/2,a=(e.scrollHeight-e.viewHeight)/2;this.scroll(r=-r-e.scrollLeft,a=-a-e.scrollTop)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},t.WorkspaceSvg.prototype.centerOnBlock=function(e){if(this.isMovable()){if(e=e?this.getBlockById(e):null){var r=e.getRelativeToSurfaceXY(),a=e.getHeightWidth(),c=this.scale;e=(r.x+(this.RTL?-1:1)*a.width/2)*c,r=(r.y+a.height/2)*c,a=this.getMetrics(),this.scroll(-(e-a.viewWidth/2),-(r-a.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},t.WorkspaceSvg.prototype.setScale=function(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,t.hideChaff(!1),this.flyout_&&(this.flyout_.reflow(),this.recordDragTargets()),this.grid_&&this.grid_.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout_?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))},t.WorkspaceSvg.prototype.getScale=function(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale},t.WorkspaceSvg.prototype.scroll=function(e,r){t.hideChaff(!0);var a=this.getMetrics();e=Math.min(e,-a.scrollLeft),r=Math.min(r,-a.scrollTop);var c=a.scrollTop+Math.max(0,a.scrollHeight-a.viewHeight);e=Math.max(e,-(a.scrollLeft+Math.max(0,a.scrollWidth-a.viewWidth))),r=Math.max(r,-c),this.scrollX=e,this.scrollY=r,this.scrollbar&&this.scrollbar.set(-(e+a.scrollLeft),-(r+a.scrollTop),!1),this.translate(e+=a.absoluteLeft,r+=a.absoluteTop)},t.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(e){var r=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(r.scrollLeft+(r.scrollWidth-r.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(r.scrollTop+(r.scrollHeight-r.viewHeight)*e.y)),this.translate(this.scrollX+r.absoluteLeft,this.scrollY+r.absoluteTop)},t.WorkspaceSvg.prototype.getBlockById=function(e){return t.WorkspaceSvg.superClass_.getBlockById.call(this,e)},t.WorkspaceSvg.prototype.getTopBlocks=function(e){return t.WorkspaceSvg.superClass_.getTopBlocks.call(this,e)},t.WorkspaceSvg.prototype.addTopBlock=function(e){this.addTopBoundedElement(e),t.WorkspaceSvg.superClass_.addTopBlock.call(this,e)},t.WorkspaceSvg.prototype.removeTopBlock=function(e){this.removeTopBoundedElement(e),t.WorkspaceSvg.superClass_.removeTopBlock.call(this,e)},t.WorkspaceSvg.prototype.addTopComment=function(e){this.addTopBoundedElement(e),t.WorkspaceSvg.superClass_.addTopComment.call(this,e)},t.WorkspaceSvg.prototype.removeTopComment=function(e){this.removeTopBoundedElement(e),t.WorkspaceSvg.superClass_.removeTopComment.call(this,e)},t.WorkspaceSvg.prototype.addTopBoundedElement=function(e){this.topBoundedElements_.push(e)},t.WorkspaceSvg.prototype.removeTopBoundedElement=function(e){t.utils.arrayRemove(this.topBoundedElements_,e)},t.WorkspaceSvg.prototype.getTopBoundedElements=function(){return[].concat(this.topBoundedElements_)},t.WorkspaceSvg.prototype.setResizesEnabled=function(e){var r=!this.resizesEnabled_&&e;this.resizesEnabled_=e,r&&this.resizeContents()},t.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),t.WorkspaceSvg.superClass_.clear.call(this),this.topBoundedElements_=[],this.setResizesEnabled(!0)},t.WorkspaceSvg.prototype.registerButtonCallback=function(e,r){if("function"!=typeof r)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks_[e]=r},t.WorkspaceSvg.prototype.getButtonCallback=function(e){return(e=this.flyoutButtonCallbacks_[e])?e:null},t.WorkspaceSvg.prototype.removeButtonCallback=function(e){this.flyoutButtonCallbacks_[e]=null},t.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(e,r){if("function"!=typeof r)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[e]=r},t.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(e){return this.toolboxCategoryCallbacks_[e]||null},t.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(e){this.toolboxCategoryCallbacks_[e]=null},t.WorkspaceSvg.prototype.getGesture=function(e){var r="mousedown"==e.type||"touchstart"==e.type||"pointerdown"==e.type,a=this.currentGesture_;return a?r&&a.hasStarted()?(console.warn("Tried to start the same gesture twice."),a.cancel(),null):a:r?this.currentGesture_=new t.TouchGesture(e,this):null},t.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},t.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},t.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},t.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},t.inject=function(e,r){if(t.checkBlockColourConstants(),"string"==typeof e&&(e=document.getElementById(e)||document.querySelector(e)),!e||!t.utils.dom.containsNode(document,e))throw Error("Error: container is not in current document.");r=new t.Options(r||{});var a=document.createElement("div");a.className="injectionDiv",a.tabIndex=0,t.utils.aria.setState(a,t.utils.aria.State.LABEL,t.Msg.WORKSPACE_ARIA_LABEL),e.appendChild(a),e=t.createDom_(a,r);var c=new t.BlockDragSurfaceSvg(a),p=new t.WorkspaceDragSurfaceSvg(a),f=t.createMainWorkspace_(e,r,c,p);return t.init_(f),t.mainWorkspace=f,t.svgResize(f),a.addEventListener("focusin",function(){t.mainWorkspace=f}),f},t.createDom_=function(e,r){e.setAttribute("dir","LTR"),t.Css.inject(r.hasCss,r.pathToMedia),e=t.utils.dom.createSvgElement(t.utils.Svg.SVG,{xmlns:t.utils.dom.SVG_NS,"xmlns:html":t.utils.dom.HTML_NS,"xmlns:xlink":t.utils.dom.XLINK_NS,version:"1.1",class:"blocklySvg",tabindex:"0"},e);var a=t.utils.dom.createSvgElement(t.utils.Svg.DEFS,{},e),c=String(Math.random()).substring(2);return r.gridPattern=t.Grid.createDom(c,r.gridOptions,a),e},t.createMainWorkspace_=function(e,r,a,c){return r.parentWorkspace=null,(r=new t.WorkspaceSvg(r,a,c)).scale=(a=r.options).zoomOptions.startScale,e.appendChild(r.createDom("blocklyMainBackground")),t.utils.dom.addClass(r.getInjectionDiv(),r.getRenderer().getClassName()),t.utils.dom.addClass(r.getInjectionDiv(),r.getTheme().getClassName()),!a.hasCategories&&a.languageTree&&(c=r.addFlyout(t.utils.Svg.SVG),t.utils.dom.insertAfter(c,e)),a.hasTrashcan&&r.addTrashcan(),a.zoomOptions&&a.zoomOptions.controls&&r.addZoomControls(),r.getThemeManager().subscribe(e,"workspaceBackgroundColour","background-color"),r.translate(0,0),r.addChangeListener(t.bumpIntoBoundsHandler_(r)),t.svgResize(r),t.WidgetDiv.createDom(),t.DropDownDiv.createDom(),t.Tooltip.createDom(),r},t.extractObjectFromEvent_=function(e,r){var a=null;switch(r.type){case t.Events.BLOCK_CREATE:case t.Events.BLOCK_MOVE:(a=e.getBlockById(r.blockId))&&(a=a.getRootBlock());break;case t.Events.COMMENT_CREATE:case t.Events.COMMENT_MOVE:a=e.getCommentById(r.commentId)}return a},t.bumpTopObjectsIntoBounds_=function(e){var r=e.getMetricsManager();if(r.hasFixedEdges()&&!e.isDragging()){r=r.getScrollMetrics(!0);for(var p,a=e.getTopBoundedElements(),c=0;p=a[c];c++)t.bumpObjectIntoBounds_(e,r,p)}},t.bumpIntoBoundsHandler_=function(e){return function(r){var a=e.getMetricsManager();if(a.hasFixedEdges()&&!e.isDragging())if(-1!==t.Events.BUMP_EVENTS.indexOf(r.type)){a=a.getScrollMetrics(!0);var c=t.extractObjectFromEvent_(e,r);if(c){var p=t.Events.getGroup();t.Events.setGroup(r.group),t.bumpObjectIntoBounds_(e,a,c)&&!r.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),null!==p&&t.Events.setGroup(p)}}else r.type===t.Events.VIEWPORT_CHANGE&&r.scale>r.oldScale&&t.bumpTopObjectsIntoBounds_(e)}},t.bumpObjectIntoBounds_=function(e,r,a){var c=a.getBoundingRectangle(),p=c.right-c.left,f=t.utils.math.clamp(r.top,c.top,r.top+r.height-(c.bottom-c.top))-c.top,T=r.left;return r=r.left+r.width-p,e.RTL?T=Math.min(r,T):r=Math.max(T,r),!(!(e=t.utils.math.clamp(T,c.left,r)-c.left)&&!f||(a.moveBy(e,f),0))},t.init_=function(e){var r=e.options,a=e.getParentSvg();if(t.browserEvents.conditionalBind(a.parentNode,"contextmenu",null,function(p){t.utils.isTargetInput(p)||p.preventDefault()}),a=t.browserEvents.conditionalBind(window,"resize",null,function(){t.hideChaff(!0),t.svgResize(e),t.bumpTopObjectsIntoBounds_(e)}),e.setResizeHandlerWrapper(a),t.inject.bindDocumentEvents_(),r.languageTree){a=e.getToolbox();var c=e.getFlyout(!0);a?a.init():c&&(c.init(e),c.show(r.languageTree),"function"==typeof c.scrollToStart&&c.scrollToStart())}r.hasTrashcan&&e.trashcan.init(),r.zoomOptions&&r.zoomOptions.controls&&e.zoomControls_.init(),r.moveOptions&&r.moveOptions.scrollbars?(e.scrollbar=new t.ScrollbarPair(e,!0===r.moveOptions.scrollbars||!!r.moveOptions.scrollbars.horizontal,!0===r.moveOptions.scrollbars||!!r.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),r.hasSounds&&t.inject.loadSounds_(r.pathToMedia,e)},t.inject.bindDocumentEvents_=function(){t.documentEventsBound_||(t.browserEvents.conditionalBind(document,"scroll",null,function(){for(var a,e=t.Workspace.getAll(),r=0;a=e[r];r++)a.updateInverseScreenCTM&&a.updateInverseScreenCTM()}),t.browserEvents.conditionalBind(document,"keydown",null,t.onKeyDown),t.browserEvents.bind(document,"touchend",null,t.longStop_),t.browserEvents.bind(document,"touchcancel",null,t.longStop_),t.utils.userAgent.IPAD&&t.browserEvents.conditionalBind(window,"orientationchange",document,function(){t.svgResize(t.getMainWorkspace())})),t.documentEventsBound_=!0},t.inject.loadSounds_=function(e,r){var a=r.getAudioManager();a.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),a.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),a.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");var c=[];e=function(){for(;c.length;)t.browserEvents.unbind(c.pop());a.preload()},c.push(t.browserEvents.conditionalBind(document,"mousemove",null,e,!0)),c.push(t.browserEvents.conditionalBind(document,"touchstart",null,e,!0))},t.Names=function(e,r){if(this.variablePrefix_=r||"",this.reservedDict_=Object.create(null),e)for(e=e.split(","),r=0;r<e.length;r++)this.reservedDict_[e[r]]=!0;this.reset()},t.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",t.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},t.Names.prototype.setVariableMap=function(e){this.variableMap_=e},t.Names.prototype.getNameForUserVariable_=function(e){return this.variableMap_?(e=this.variableMap_.getVariableById(e))?e.name:null:(console.warn("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)},t.Names.prototype.populateVariables=function(e){e=t.Variables.allUsedVarModels(e);for(var r=0;r<e.length;r++)this.getName(e[r].getId(),t.VARIABLE_CATEGORY_NAME)},t.Names.prototype.populateProcedures=function(e){e=(e=t.Procedures.allProcedures(e))[0].concat(e[1]);for(var r=0;r<e.length;r++)this.getName(e[r][0],t.PROCEDURE_CATEGORY_NAME)},t.Names.prototype.getName=function(e,r){var a=e;r==t.VARIABLE_CATEGORY_NAME&&(e=this.getNameForUserVariable_(e))&&(a=e),e=a.toLowerCase();var c=r==t.VARIABLE_CATEGORY_NAME||r==t.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";r in this.db_||(this.db_[r]=Object.create(null));var p=this.db_[r];return e in p?c+p[e]:(r=this.getDistinctName(a,r),p[e]=r.substr(c.length),r)},t.Names.prototype.getUserNames=function(e){return Object.keys(this.db_[e]||{})},t.Names.prototype.getDistinctName=function(e,r){e=this.safeName_(e);for(var a="";this.dbReverse_[e+a]||e+a in this.reservedDict_;)a=a?a+1:2;return this.dbReverse_[e+=a]=!0,(r==t.VARIABLE_CATEGORY_NAME||r==t.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+e},t.Names.prototype.safeName_=function(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(e[0])&&(e="my_"+e)):e=t.Msg.UNNAMED_KEY||"unnamed",e},t.Names.equals=function(e,r){return e.toLowerCase()==r.toLowerCase()},t.Procedures={},t.Procedures.NAME_TYPE=t.PROCEDURE_CATEGORY_NAME,t.Procedures.DEFAULT_ARG="x",t.Procedures.allProcedures=function(e){var r=e.getBlocksByType("procedures_defnoreturn",!1).map(function(a){return a.getProcedureDef()});return e=e.getBlocksByType("procedures_defreturn",!1).map(function(a){return a.getProcedureDef()}),r.sort(t.Procedures.procTupleComparator_),e.sort(t.Procedures.procTupleComparator_),[r,e]},t.Procedures.procTupleComparator_=function(e,r){return e[0].localeCompare(r[0],void 0,{sensitivity:"base"})},t.Procedures.findLegalName=function(e,r){if(r.isInFlyout)return e;for(e=e||t.Msg.UNNAMED_KEY||"unnamed";!t.Procedures.isLegalName_(e,r.workspace,r);){var a=e.match(/^(.*?)(\d+)$/);e=a?a[1]+(parseInt(a[2],10)+1):e+"2"}return e},t.Procedures.isLegalName_=function(e,r,a){return!t.Procedures.isNameUsed(e,r,a)},t.Procedures.isNameUsed=function(e,r,a){r=r.getAllBlocks(!1);for(var c=0;c<r.length;c++)if(r[c]!=a&&r[c].getProcedureDef){var p=r[c].getProcedureDef();if(t.Names.equals(p[0],e))return!0}return!1},t.Procedures.rename=function(e){e=e.trim();var r=t.Procedures.findLegalName(e,this.getSourceBlock()),a=this.getValue();if(a!=e&&a!=r){e=this.getSourceBlock().workspace.getAllBlocks(!1);for(var c=0;c<e.length;c++)e[c].renameProcedure&&e[c].renameProcedure(a,r)}return r},t.Procedures.flyoutCategory=function(e){function r(f,T){for(var y=0;y<f.length;y++){var D=f[y][0],k=f[y][1],G=t.utils.xml.createElement("block");G.setAttribute("type",T),G.setAttribute("gap",16);var Se=t.utils.xml.createElement("mutation");for(Se.setAttribute("name",D),G.appendChild(Se),D=0;D<k.length;D++){var De=t.utils.xml.createElement("arg");De.setAttribute("name",k[D]),Se.appendChild(De)}a.push(G)}}var a=[];if(t.Blocks.procedures_defnoreturn){var c=t.utils.xml.createElement("block");c.setAttribute("type","procedures_defnoreturn"),c.setAttribute("gap",16);var p=t.utils.xml.createElement("field");p.setAttribute("name","NAME"),p.appendChild(t.utils.xml.createTextNode(t.Msg.PROCEDURES_DEFNORETURN_PROCEDURE)),c.appendChild(p),a.push(c)}return t.Blocks.procedures_defreturn&&((c=t.utils.xml.createElement("block")).setAttribute("type","procedures_defreturn"),c.setAttribute("gap",16),(p=t.utils.xml.createElement("field")).setAttribute("name","NAME"),p.appendChild(t.utils.xml.createTextNode(t.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),c.appendChild(p),a.push(c)),t.Blocks.procedures_ifreturn&&((c=t.utils.xml.createElement("block")).setAttribute("type","procedures_ifreturn"),c.setAttribute("gap",16),a.push(c)),a.length&&a[a.length-1].setAttribute("gap",24),r((e=t.Procedures.allProcedures(e))[0],"procedures_callnoreturn"),r(e[1],"procedures_callreturn"),a},t.Procedures.updateMutatorFlyout_=function(e){for(var p,r=[],a=e.getBlocksByType("procedures_mutatorarg",!1),c=0;p=a[c];c++)r.push(p.getFieldValue("NAME"));a=t.utils.xml.createElement("xml"),(c=t.utils.xml.createElement("block")).setAttribute("type","procedures_mutatorarg"),(p=t.utils.xml.createElement("field")).setAttribute("name","NAME"),r=t.Variables.generateUniqueNameFromOptions(t.Procedures.DEFAULT_ARG,r),r=t.utils.xml.createTextNode(r),p.appendChild(r),c.appendChild(p),a.appendChild(c),e.updateToolbox(a)},t.Procedures.mutatorOpenListener=function(e){if(e.type==t.Events.BUBBLE_OPEN&&"mutator"===e.bubbleType&&e.isOpen){var r=(e=t.Workspace.getById(e.workspaceId).getBlockById(e.blockId)).type;("procedures_defnoreturn"==r||"procedures_defreturn"==r)&&(e=e.mutator.getWorkspace(),t.Procedures.updateMutatorFlyout_(e),e.addChangeListener(t.Procedures.mutatorChangeListener_))}},t.Procedures.mutatorChangeListener_=function(e){(e.type==t.Events.BLOCK_CREATE||e.type==t.Events.BLOCK_DELETE||e.type==t.Events.BLOCK_CHANGE)&&(e=t.Workspace.getById(e.workspaceId),t.Procedures.updateMutatorFlyout_(e))},t.Procedures.getCallers=function(e,r){var a=[];r=r.getAllBlocks(!1);for(var c=0;c<r.length;c++)if(r[c].getProcedureCall){var p=r[c].getProcedureCall();p&&t.Names.equals(p,e)&&a.push(r[c])}return a},t.Procedures.mutateCallers=function(e){var p,r=t.Events.recordUndo,a=e.getProcedureDef()[0],c=e.mutationToDom(!0);for(e=t.Procedures.getCallers(a,e.workspace),a=0;p=e[a];a++){var f=p.mutationToDom();f=f&&t.Xml.domToText(f),p.domToMutation(c);var T=p.mutationToDom();f!=(T=T&&t.Xml.domToText(T))&&(t.Events.recordUndo=!1,t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(p,"mutation",null,f,T)),t.Events.recordUndo=r)}},t.Procedures.getDefinition=function(e,r){r=r.getAllBlocks(!1);for(var a=0;a<r.length;a++)if(r[a].getProcedureDef){var c=r[a].getProcedureDef();if(c&&t.Names.equals(c[0],e))return r[a]}return null},t.ShortcutRegistry=function(){t.ShortcutRegistry.registry=this,this.registry_=Object.create(null),this.keyMap_=Object.create(null)},t.ShortcutRegistry.modifierKeys={Shift:t.utils.KeyCodes.SHIFT,Control:t.utils.KeyCodes.CTRL,Alt:t.utils.KeyCodes.ALT,Meta:t.utils.KeyCodes.META},t.ShortcutRegistry.prototype.register=function(e,r){if(this.registry_[e.name]&&!r)throw Error('Shortcut with name "'+e.name+'" already exists.');this.registry_[e.name]=e},t.ShortcutRegistry.prototype.unregister=function(e){return this.registry_[e]?(this.removeAllKeyMappings(e),delete this.registry_[e],!0):(console.warn('Keyboard shortcut with name "'+e+'" not found.'),!1)},t.ShortcutRegistry.prototype.addKeyMapping=function(e,r,a){e=String(e);var c=this.keyMap_[e];if(c&&!a)throw Error('Shortcut with name "'+r+'" collides with shortcuts '+c.toString());c&&a?c.unshift(r):this.keyMap_[e]=[r]},t.ShortcutRegistry.prototype.removeKeyMapping=function(e,r,a){var c=this.keyMap_[e];if(!c&&!a)return console.warn('No keyboard shortcut with name "'+r+'" registered with key code "'+e+'"'),!1;var p=c.indexOf(r);return-1<p?(c.splice(p,1),0==c.length&&delete this.keyMap_[e],!0):(a||console.warn('No keyboard shortcut with name "'+r+'" registered with key code "'+e+'"'),!1)},t.ShortcutRegistry.prototype.removeAllKeyMappings=function(e){for(var r in this.keyMap_)this.removeKeyMapping(r,e,!0)},t.ShortcutRegistry.prototype.setKeyMap=function(e){this.keyMap_=e},t.ShortcutRegistry.prototype.getKeyMap=function(){return t.utils.object.deepMerge(Object.create(null),this.keyMap_)},t.ShortcutRegistry.prototype.getRegistry=function(){return t.utils.object.deepMerge(Object.create(null),this.registry_)},t.ShortcutRegistry.prototype.onKeyDown=function(e,r){var a=this.serializeKeyEvent_(r);if(!(a=this.getShortcutNamesByKeyCode(a)))return!1;for(var p,c=0;p=a[c];c++)if((!(p=this.registry_[p]).preconditionFn||p.preconditionFn(e))&&p.callback&&p.callback(e,r,p))return!0;return!1},t.ShortcutRegistry.prototype.getShortcutNamesByKeyCode=function(e){return this.keyMap_[e]||[]},t.ShortcutRegistry.prototype.getKeyCodesByShortcutName=function(e){var a,r=[];for(a in this.keyMap_)-1<this.keyMap_[a].indexOf(e)&&r.push(a);return r},t.ShortcutRegistry.prototype.serializeKeyEvent_=function(e){var a,r="";for(a in t.ShortcutRegistry.modifierKeys)e.getModifierState(a)&&(""!=r&&(r+="+"),r+=a);return""!=r&&e.keyCode?r=r+"+"+e.keyCode:e.keyCode&&(r=e.keyCode.toString()),r},t.ShortcutRegistry.prototype.checkModifiers_=function(e){for(var c,r=t.utils.object.values(t.ShortcutRegistry.modifierKeys),a=0;c=e[a];a++)if(0>r.indexOf(c))throw Error(c+" is not a valid modifier key.")},t.ShortcutRegistry.prototype.createSerializedKey=function(e,r){var a="";if(r)for(var c in this.checkModifiers_(r),t.ShortcutRegistry.modifierKeys)-1<r.indexOf(t.ShortcutRegistry.modifierKeys[c])&&(""!=a&&(a+="+"),a+=c);return""!=a&&e?a=a+"+"+e:e&&(a=e.toString()),a},new t.ShortcutRegistry,t.VariableModel=function(e,r,a,c){this.workspace=e,this.name=r,this.type=a||"",this.id_=c||t.utils.genUid(),t.Events.fire(new(t.Events.get(t.Events.VAR_CREATE))(this))},t.VariableModel.prototype.getId=function(){return this.id_},t.VariableModel.compareByName=function(e,r){return e.name.localeCompare(r.name,void 0,{sensitivity:"base"})},t.Variables={},t.Variables.NAME_TYPE=t.VARIABLE_CATEGORY_NAME,t.Variables.allUsedVarModels=function(e){var r=e.getAllBlocks(!1);e=Object.create(null);for(var a=0;a<r.length;a++){var c=r[a].getVarModels();if(c)for(var p=0;p<c.length;p++){var f=c[p],T=f.getId();T&&(e[T]=f)}}for(T in r=[],e)r.push(e[T]);return r},t.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_={},t.Variables.allDeveloperVariables=function(e){e=e.getAllBlocks(!1);for(var c,r=Object.create(null),a=0;c=e[a];a++){var p=c.getDeveloperVariables;if(!p&&c.getDeveloperVars&&(p=c.getDeveloperVars,t.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[c.type]||(console.warn("Function getDeveloperVars() deprecated. Use getDeveloperVariables() (block type '"+c.type+"')"),t.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[c.type]=!0)),p)for(c=p(),p=0;p<c.length;p++)r[c[p]]=!0}return Object.keys(r)},t.Variables.flyoutCategory=function(e){var r=[],a=document.createElement("button");return a.setAttribute("text","%{BKY_NEW_VARIABLE}"),a.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(c){t.Variables.createVariableButtonHandler(c.getTargetWorkspace())}),r.push(a),e=t.Variables.flyoutCategoryBlocks(e),r.concat(e)},t.Variables.flyoutCategoryBlocks=function(e){var r=[];if(0<(e=e.getVariablesOfType("")).length){var a=e[e.length-1];if(t.Blocks.variables_set){var c=t.utils.xml.createElement("block");c.setAttribute("type","variables_set"),c.setAttribute("gap",t.Blocks.math_change?8:24),c.appendChild(t.Variables.generateVariableFieldDom(a)),r.push(c)}if(t.Blocks.math_change&&((c=t.utils.xml.createElement("block")).setAttribute("type","math_change"),c.setAttribute("gap",t.Blocks.variables_get?20:8),c.appendChild(t.Variables.generateVariableFieldDom(a)),a=t.Xml.textToDom('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),c.appendChild(a),r.push(c)),t.Blocks.variables_get){e.sort(t.VariableModel.compareByName),a=0;for(var p;p=e[a];a++)(c=t.utils.xml.createElement("block")).setAttribute("type","variables_get"),c.setAttribute("gap",8),c.appendChild(t.Variables.generateVariableFieldDom(p)),r.push(c)}}return r},t.Variables.VAR_LETTER_OPTIONS="ijkmnopqrstuvwxyzabcdefgh",t.Variables.generateUniqueName=function(e){return t.Variables.generateUniqueNameFromOptions(t.Variables.VAR_LETTER_OPTIONS.charAt(0),e.getAllVariableNames())},t.Variables.generateUniqueNameFromOptions=function(e,r){if(!r.length)return e;for(var a=t.Variables.VAR_LETTER_OPTIONS,c="",p=a.indexOf(e);;){for(var f=!1,T=0;T<r.length;T++)if(r[T].toLowerCase()==e){f=!0;break}if(!f)return e;++p==a.length&&(p=0,c=Number(c)+1),e=a.charAt(p)+c}},t.Variables.createVariableButtonHandler=function(e,r,a){var c=a||"",p=function(f){t.Variables.promptName(t.Msg.NEW_VARIABLE_TITLE,f,function(T){if(T){var y=t.Variables.nameUsedWithAnyType(T,e);if(y){if(y.type==c)var D=t.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",y.name);else D=(D=t.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",y.name).replace("%2",y.type);t.alert(D,function(){p(T)})}else e.createVariable(T,c),r&&r(T)}else r&&r(null)})};p("")},t.Variables.createVariable=t.Variables.createVariableButtonHandler,t.Variables.renameVariable=function(e,r,a){var c=function(p){var f=t.Msg.RENAME_VARIABLE_TITLE.replace("%1",r.name);t.Variables.promptName(f,p,function(T){if(T){var y=t.Variables.nameUsedWithOtherType_(T,r.type,e);y?(y=t.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",y.name).replace("%2",y.type),t.alert(y,function(){c(T)})):(e.renameVariableById(r.getId(),T),a&&a(T))}else a&&a(null)})};c("")},t.Variables.promptName=function(e,r,a){t.prompt(e,r,function(c){c&&((c=c.replace(/[\s\xa0]+/g," ").trim())==t.Msg.RENAME_VARIABLE||c==t.Msg.NEW_VARIABLE)&&(c=null),a(c)})},t.Variables.nameUsedWithOtherType_=function(e,r,a){a=a.getVariableMap().getAllVariables(),e=e.toLowerCase();for(var p,c=0;p=a[c];c++)if(p.name.toLowerCase()==e&&p.type!=r)return p;return null},t.Variables.nameUsedWithAnyType=function(e,r){r=r.getVariableMap().getAllVariables(),e=e.toLowerCase();for(var c,a=0;c=r[a];a++)if(c.name.toLowerCase()==e)return c;return null},t.Variables.generateVariableFieldDom=function(e){var r=t.utils.xml.createElement("field");return r.setAttribute("name","VAR"),r.setAttribute("id",e.getId()),r.setAttribute("variabletype",e.type),e=t.utils.xml.createTextNode(e.name),r.appendChild(e),r},t.Variables.getOrCreateVariablePackage=function(e,r,a,c){var p=t.Variables.getVariable(e,r,a,c);return p||(p=t.Variables.createVariable_(e,r,a,c)),p},t.Variables.getVariable=function(e,r,a,c){var p=e.getPotentialVariableMap(),f=null;if(r&&(!(f=e.getVariableById(r))&&p&&(f=p.getVariableById(r)),f))return f;if(a){if(null==c)throw Error("Tried to look up a variable by name without a type");!(f=e.getVariable(a,c))&&p&&(f=p.getVariable(a,c))}return f},t.Variables.createVariable_=function(e,r,a,c){var p=e.getPotentialVariableMap();return a||(a=t.Variables.generateUniqueName(e.isFlyout?e.targetWorkspace:e)),p?p.createVariable(a,c,r):e.createVariable(a,c,r)},t.Variables.getAddedVariables=function(e,r){e=e.getAllVariables();var a=[];if(r.length!=e.length)for(var c=0;c<e.length;c++){var p=e[c];-1==r.indexOf(p)&&a.push(p)}return a},t.VERSION="6.20210701.0",t.mainWorkspace=null,t.selected=null,t.draggingConnections=[],t.clipboardXml_=null,t.clipboardSource_=null,t.clipboardTypeCounts_=null,t.cache3dSupported_=null,t.parentContainer=null,t.svgSize=function(e){return t.utils.deprecation.warn("Blockly.svgSize","March 2021","March 2022","workspace.getCachedParentSvgSize"),new t.utils.Size(e.cachedWidth_,e.cachedHeight_)},t.resizeSvgContents=function(e){e.resizeContents()},t.svgResize=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;var r=e.getParentSvg(),a=e.getCachedParentSvgSize(),c=r.parentNode;if(c){var p=c.offsetWidth;c=c.offsetHeight,a.width!=p&&(r.setAttribute("width",p+"px"),e.setCachedParentSvgSize(p,null)),a.height!=c&&(r.setAttribute("height",c+"px"),e.setCachedParentSvgSize(null,c)),e.resize()}},t.onKeyDown=function(e){var r=t.mainWorkspace;r&&!(t.utils.isTargetInput(e)||r.rendered&&!r.isVisible())&&t.ShortcutRegistry.registry.onKeyDown(r,e)},t.deleteBlock=function(e){e.workspace.isFlyout||(t.Events.setGroup(!0),t.hideChaff(),e.dispose(!e.outputConnection,!0),t.Events.setGroup(!1))},t.copy=function(e){(e=e.toCopyData())&&(t.clipboardXml_=e.xml,t.clipboardSource_=e.source,t.clipboardTypeCounts_=e.typeCounts)},t.paste=function(){if(!t.clipboardXml_)return!1;var e=t.clipboardSource_;return e.isFlyout&&(e=e.targetWorkspace),!(!t.clipboardTypeCounts_||!e.isCapacityAvailable(t.clipboardTypeCounts_)||(t.Events.setGroup(!0),e.paste(t.clipboardXml_),t.Events.setGroup(!1),0))},t.duplicate=function(e){var r=t.clipboardXml_,a=t.clipboardSource_;t.copy(e),e.workspace.paste(t.clipboardXml_),t.clipboardXml_=r,t.clipboardSource_=a},t.onContextMenu_=function(e){t.utils.isTargetInput(e)||e.preventDefault()},t.hideChaff=function(e){t.Tooltip.hide(),t.WidgetDiv.hide(),t.DropDownDiv.hideWithoutAnimation();var r=!!e;t.getMainWorkspace().getComponentManager().getComponents(t.ComponentManager.Capability.AUTOHIDEABLE,!0).forEach(function(a){a.autoHide(r)})},t.getMainWorkspace=function(){return t.mainWorkspace},t.alert=function(e,r){alert(e),r&&r()},t.confirm=function(e,r){r(confirm(e))},t.prompt=function(e,r,a){a(prompt(e,r))},t.jsonInitFactory_=function(e){return function(){this.jsonInit(e)}},t.defineBlocksWithJsonArray=function(e){for(var r=0;r<e.length;r++){var a=e[r];if(a){var c=a.type;null==c||""===c?console.warn("Block definition #"+r+" in JSON array is missing a type attribute. Skipping."):(t.Blocks[c]&&console.warn("Block definition #"+r+' in JSON array overwrites prior definition of "'+c+'".'),t.Blocks[c]={init:t.jsonInitFactory_(a)})}else console.warn("Block definition #"+r+" in JSON array is "+a+". Skipping.")}},t.isNumber=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},t.hueToHex=function(e){return t.utils.colour.hsvToHex(e,t.HSV_SATURATION,255*t.HSV_VALUE)},t.checkBlockColourConstants=function(){t.checkBlockColourConstant_("LOGIC_HUE",["Blocks","logic","HUE"],void 0),t.checkBlockColourConstant_("LOGIC_HUE",["Constants","Logic","HUE"],210),t.checkBlockColourConstant_("LOOPS_HUE",["Blocks","loops","HUE"],void 0),t.checkBlockColourConstant_("LOOPS_HUE",["Constants","Loops","HUE"],120),t.checkBlockColourConstant_("MATH_HUE",["Blocks","math","HUE"],void 0),t.checkBlockColourConstant_("MATH_HUE",["Constants","Math","HUE"],230),t.checkBlockColourConstant_("TEXTS_HUE",["Blocks","texts","HUE"],void 0),t.checkBlockColourConstant_("TEXTS_HUE",["Constants","Text","HUE"],160),t.checkBlockColourConstant_("LISTS_HUE",["Blocks","lists","HUE"],void 0),t.checkBlockColourConstant_("LISTS_HUE",["Constants","Lists","HUE"],260),t.checkBlockColourConstant_("COLOUR_HUE",["Blocks","colour","HUE"],void 0),t.checkBlockColourConstant_("COLOUR_HUE",["Constants","Colour","HUE"],20),t.checkBlockColourConstant_("VARIABLES_HUE",["Blocks","variables","HUE"],void 0),t.checkBlockColourConstant_("VARIABLES_HUE",["Constants","Variables","HUE"],330),t.checkBlockColourConstant_("VARIABLES_DYNAMIC_HUE",["Constants","VariablesDynamic","HUE"],310),t.checkBlockColourConstant_("PROCEDURES_HUE",["Blocks","procedures","HUE"],void 0)},t.checkBlockColourConstant_=function(e,r,a){for(var c="Blockly",p=t,f=0;f<r.length;++f)c+="."+r[f],p&&(p=p[r[f]]);p&&p!==a&&(e=(void 0===a?'%1 has been removed. Use Blockly.Msg["%2"].':'%1 is deprecated and unused. Override Blockly.Msg["%2"].').replace("%1",c).replace("%2",e),console.warn(e))},t.setParentContainer=function(e){t.parentContainer=e},t.bindEvent_=t.browserEvents.bind,t.unbindEvent_=t.browserEvents.unbind,t.bindEventWithChecks_=t.browserEvents.conditionalBind,t.ALIGN_LEFT=t.constants.ALIGN.LEFT,t.ALIGN_CENTRE=t.constants.ALIGN.CENTRE,t.ALIGN_RIGHT=t.constants.ALIGN.RIGHT,t.INPUT_VALUE=t.connectionTypes.INPUT_VALUE,t.OUTPUT_VALUE=t.connectionTypes.OUTPUT_VALUE,t.NEXT_STATEMENT=t.connectionTypes.NEXT_STATEMENT,t.PREVIOUS_STATEMENT=t.connectionTypes.PREVIOUS_STATEMENT,t.DUMMY_INPUT=t.inputTypes.DUMMY,t.TOOLBOX_AT_TOP=t.utils.toolbox.Position.TOP,t.TOOLBOX_AT_BOTTOM=t.utils.toolbox.Position.BOTTOM,t.TOOLBOX_AT_LEFT=t.utils.toolbox.Position.LEFT,t.TOOLBOX_AT_RIGHT=t.utils.toolbox.Position.RIGHT,t.Events.BubbleOpen=function(e,r,a){t.Events.BubbleOpen.superClass_.constructor.call(this,e?e.workspace.id:void 0),this.blockId=e?e.id:null,this.isOpen=r,this.bubbleType=a},t.utils.object.inherits(t.Events.BubbleOpen,t.Events.UiBase),t.Events.BubbleOpen.prototype.type=t.Events.BUBBLE_OPEN,t.Events.BubbleOpen.prototype.toJson=function(){var e=t.Events.BubbleOpen.superClass_.toJson.call(this);return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId,e},t.Events.BubbleOpen.prototype.fromJson=function(e){t.Events.BubbleOpen.superClass_.fromJson.call(this,e),this.isOpen=e.isOpen,this.bubbleType=e.bubbleType,this.blockId=e.blockId},t.registry.register(t.registry.Type.EVENT,t.Events.BUBBLE_OPEN,t.Events.BubbleOpen),t.Icon=function(e){this.block_=e,this.iconGroup_=null},t.Icon.prototype.collapseHidden=!0,t.Icon.prototype.SIZE=17,t.Icon.prototype.bubble_=null,t.Icon.prototype.iconXY_=null,t.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&t.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),t.browserEvents.conditionalBind(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},t.Icon.prototype.dispose=function(){t.utils.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},t.Icon.prototype.updateEditable=function(){},t.Icon.prototype.isVisible=function(){return!!this.bubble_},t.Icon.prototype.iconClick_=function(e){this.block_.workspace.isDragging()||this.block_.isInFlyout||t.utils.isRightButton(e)||this.setVisible(!this.isVisible())},t.Icon.prototype.applyColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.style.colourPrimary)},t.Icon.prototype.setIconLocation=function(e){this.iconXY_=e,this.isVisible()&&this.bubble_.setAnchorLocation(e)},t.Icon.prototype.computeIconLocation=function(){var e=this.block_.getRelativeToSurfaceXY(),r=t.utils.getRelativeXY(this.iconGroup_);e=new t.utils.Coordinate(e.x+r.x+this.SIZE/2,e.y+r.y+this.SIZE/2),t.utils.Coordinate.equals(this.getIconLocation(),e)||this.setIconLocation(e)},t.Icon.prototype.getIconLocation=function(){return this.iconXY_},t.Icon.prototype.getCorrectedSize=function(){return new t.utils.Size(t.Icon.prototype.SIZE,t.Icon.prototype.SIZE-2)},t.Warning=function(e){t.Warning.superClass_.constructor.call(this,e),this.createIcon(),this.text_=Object.create(null)},t.utils.object.inherits(t.Warning,t.Icon),t.Warning.prototype.collapseHidden=!1,t.Warning.prototype.drawIcon_=function(e){t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},e),t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},e),t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},e)},t.Warning.prototype.setVisible=function(e){e!=this.isVisible()&&(t.Events.fire(new(t.Events.get(t.Events.BUBBLE_OPEN))(this.block_,e,"warning")),e?this.createBubble_():this.disposeBubble_())},t.Warning.prototype.createBubble_=function(){this.paragraphElement_=t.Bubble.textToDom(this.getText()),this.bubble_=t.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},t.Warning.prototype.disposeBubble_=function(){this.bubble_.dispose(),this.paragraphElement_=this.bubble_=null},t.Warning.prototype.setText=function(e,r){this.text_[r]!=e&&(e?this.text_[r]=e:delete this.text_[r],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},t.Warning.prototype.getText=function(){var r,e=[];for(r in this.text_)e.push(this.text_[r]);return e.join("\n")},t.Warning.prototype.dispose=function(){this.block_.warning=null,t.Icon.prototype.dispose.call(this)},t.Comment=function(e){t.Comment.superClass_.constructor.call(this,e),this.model_=e.commentModel,this.model_.text=this.model_.text||"",this.cachedText_="",this.onInputWrapper_=this.onChangeWrapper_=this.onWheelWrapper_=this.onMouseUpWrapper_=null,this.createIcon()},t.utils.object.inherits(t.Comment,t.Icon),t.Comment.prototype.drawIcon_=function(e){t.utils.dom.createSvgElement(t.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},e),t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},e),t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},e)},t.Comment.prototype.createEditor_=function(){this.foreignObject_=t.utils.dom.createSvgElement(t.utils.Svg.FOREIGNOBJECT,{x:t.Bubble.BORDER_WIDTH,y:t.Bubble.BORDER_WIDTH},null);var e=document.createElementNS(t.utils.dom.HTML_NS,"body");e.setAttribute("xmlns",t.utils.dom.HTML_NS),e.className="blocklyMinimalBody";var r=this.textarea_=document.createElementNS(t.utils.dom.HTML_NS,"textarea");return r.className="blocklyCommentTextarea",r.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),r.value=this.model_.text,this.resizeTextarea_(),e.appendChild(r),this.foreignObject_.appendChild(e),this.onMouseUpWrapper_=t.browserEvents.conditionalBind(r,"mouseup",this,this.startEdit_,!0,!0),this.onWheelWrapper_=t.browserEvents.conditionalBind(r,"wheel",this,function(a){a.stopPropagation()}),this.onChangeWrapper_=t.browserEvents.conditionalBind(r,"change",this,function(a){this.cachedText_!=this.model_.text&&t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(this.block_,"comment",null,this.cachedText_,this.model_.text))}),this.onInputWrapper_=t.browserEvents.conditionalBind(r,"input",this,function(a){this.model_.text=r.value}),setTimeout(r.focus.bind(r),0),this.foreignObject_},t.Comment.prototype.updateEditable=function(){t.Comment.superClass_.updateEditable.call(this),this.isVisible()&&(this.disposeBubble_(),this.createBubble_())},t.Comment.prototype.onBubbleResize_=function(){this.isVisible()&&(this.model_.size=this.bubble_.getBubbleSize(),this.resizeTextarea_())},t.Comment.prototype.resizeTextarea_=function(){var e=this.model_.size,r=2*t.Bubble.BORDER_WIDTH,a=e.width-r;e=e.height-r,this.foreignObject_.setAttribute("width",a),this.foreignObject_.setAttribute("height",e),this.textarea_.style.width=a-4+"px",this.textarea_.style.height=e-4+"px"},t.Comment.prototype.setVisible=function(e){e!=this.isVisible()&&(t.Events.fire(new(t.Events.get(t.Events.BUBBLE_OPEN))(this.block_,e,"comment")),(this.model_.pinned=e)?this.createBubble_():this.disposeBubble_())},t.Comment.prototype.createBubble_=function(){!this.block_.isEditable()||t.utils.userAgent.IE?this.createNonEditableBubble_():this.createEditableBubble_()},t.Comment.prototype.createEditableBubble_=function(){this.bubble_=new t.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,this.model_.size.width,this.model_.size.height),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this)),this.applyColour()},t.Comment.prototype.createNonEditableBubble_=function(){this.paragraphElement_=t.Bubble.textToDom(this.block_.getCommentText()),this.bubble_=t.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},t.Comment.prototype.disposeBubble_=function(){this.onMouseUpWrapper_&&(t.browserEvents.unbind(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onWheelWrapper_&&(t.browserEvents.unbind(this.onWheelWrapper_),this.onWheelWrapper_=null),this.onChangeWrapper_&&(t.browserEvents.unbind(this.onChangeWrapper_),this.onChangeWrapper_=null),this.onInputWrapper_&&(t.browserEvents.unbind(this.onInputWrapper_),this.onInputWrapper_=null),this.bubble_.dispose(),this.paragraphElement_=this.foreignObject_=this.textarea_=this.bubble_=null},t.Comment.prototype.startEdit_=function(e){this.bubble_.promote()&&this.textarea_.focus(),this.cachedText_=this.model_.text},t.Comment.prototype.getBubbleSize=function(){return this.model_.size},t.Comment.prototype.setBubbleSize=function(e,r){this.bubble_?this.bubble_.setBubbleSize(e,r):(this.model_.size.width=e,this.model_.size.height=r)},t.Comment.prototype.updateText=function(){this.textarea_?this.textarea_.value=this.model_.text:this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model_.text)},t.Comment.prototype.dispose=function(){this.block_.comment=null,t.Icon.prototype.dispose.call(this)},t.Css.register(".blocklyCommentTextarea {,background-color: #fef49c;,border: 0;,outline: 0;,margin: 0;,padding: 3px;,resize: none;,display: block;,text-overflow: hidden;,}".split(",")),t.IComponent=function(){},t.IDragTarget=function(){},t.DragTarget=function(){},t.DragTarget.prototype.onDragEnter=function(e){},t.DragTarget.prototype.onDragOver=function(e){},t.DragTarget.prototype.onDragExit=function(e){},t.DragTarget.prototype.onDrop=function(e){},t.DragTarget.prototype.shouldPreventMove=function(e){return!1},t.IDeleteArea=function(){},t.DeleteArea=function(){t.DeleteArea.superClass_.constructor.call(this),this.wouldDelete_=!1},t.utils.object.inherits(t.DeleteArea,t.DragTarget),t.DeleteArea.prototype.wouldDelete=function(e,r){return e instanceof t.BlockSvg?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e&&!r)):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_},t.DeleteArea.prototype.updateWouldDelete_=function(e){this.wouldDelete_=e},t.IFlyout=function(){},t.Flyout=function(e){t.Flyout.superClass_.constructor.call(this),e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new t.WorkspaceSvg(e),this.workspace_.setMetricsManager(new t.FlyoutMetricsManager(this.workspace_,this)),this.workspace_.isFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=t.utils.genUid(),this.RTL=!!e.RTL,this.horizontalLayout=!1,this.toolboxPosition_=e.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.targetWorkspace=null},t.utils.object.inherits(t.Flyout,t.DeleteArea),t.Flyout.prototype.autoClose=!0,t.Flyout.prototype.isVisible_=!1,t.Flyout.prototype.containerVisible_=!0,t.Flyout.prototype.CORNER_RADIUS=8,t.Flyout.prototype.MARGIN=t.Flyout.prototype.CORNER_RADIUS,t.Flyout.prototype.GAP_X=3*t.Flyout.prototype.MARGIN,t.Flyout.prototype.GAP_Y=3*t.Flyout.prototype.MARGIN,t.Flyout.prototype.SCROLLBAR_MARGIN=2.5,t.Flyout.prototype.width_=0,t.Flyout.prototype.height_=0,t.Flyout.prototype.dragAngleRange_=70,t.Flyout.prototype.createDom=function(e){return this.svgGroup_=t.utils.dom.createSvgElement(e,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_},t.Flyout.prototype.init=function(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new t.ScrollbarPair(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,t.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,t.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:1,capabilities:[t.ComponentManager.Capability.DELETE_AREA,t.ComponentManager.Capability.DRAG_TARGET]})},t.Flyout.prototype.dispose=function(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),t.browserEvents.unbind(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(t.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace=this.svgBackground_=null},t.Flyout.prototype.getWidth=function(){return this.width_},t.Flyout.prototype.getHeight=function(){return this.height_},t.Flyout.prototype.getFlyoutScale=function(){return this.targetWorkspace.scale},t.Flyout.prototype.getWorkspace=function(){return this.workspace_},t.Flyout.prototype.isVisible=function(){return this.isVisible_},t.Flyout.prototype.setVisible=function(e){var r=e!=this.isVisible();this.isVisible_=e,r&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())},t.Flyout.prototype.setContainerVisible=function(e){var r=e!=this.containerVisible_;this.containerVisible_=e,r&&this.updateDisplay_()},t.Flyout.prototype.updateDisplay_=function(){var e=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=e?"block":"none",this.workspace_.scrollbar.setContainerVisible(e)},t.Flyout.prototype.positionAt_=function(e,r,a,c){this.svgGroup_.setAttribute("width",e),this.svgGroup_.setAttribute("height",r),this.workspace_.setCachedParentSvgSize(e,r),"svg"==this.svgGroup_.tagName?t.utils.dom.setCssTransform(this.svgGroup_,"translate("+a+"px,"+c+"px)"):this.svgGroup_.setAttribute("transform","translate("+a+","+c+")"),(e=this.workspace_.scrollbar)&&(e.setOrigin(a,c),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))},t.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var r,e=0;r=this.listeners_[e];e++)t.browserEvents.unbind(r);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},t.Flyout.prototype.show=function(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof e&&(e=this.getDynamicCategoryContents_(e)),this.setVisible(!0),e=t.utils.toolbox.convertFlyoutDefToJsonArray(e),e=this.createFlyoutInfo_(e),this.layout_(e.contents,e.gaps),this.listeners_.push(t.browserEvents.conditionalBind(this.svgBackground_,"mouseover",this,function(){for(var c,r=this.workspace_.getTopBlocks(!1),a=0;c=r[a];a++)c.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},t.Flyout.prototype.createFlyoutInfo_=function(e){var r=[],a=[];this.permanentlyDisabled_.length=0;for(var f,c=this.horizontalLayout?this.GAP_X:this.GAP_Y,p=0;f=e[p];p++)switch(f.custom&&(f=this.getDynamicCategoryContents_(f.custom),f=t.utils.toolbox.convertFlyoutDefToJsonArray(f),e.splice.apply(e,[p,1].concat(f)),f=e[p]),f.kind.toUpperCase()){case"BLOCK":var T=f,y=this.getBlockXml_(T);f=this.createBlock_(y),T=parseInt(T.gap||y.getAttribute("gap"),10),a.push(isNaN(T)?c:T),r.push({type:"block",block:f});break;case"SEP":this.addSeparatorGap_(f,a,c);break;case"LABEL":f=this.createButton_(f,!0),r.push({type:"button",button:f}),a.push(c);break;case"BUTTON":f=this.createButton_(f,!1),r.push({type:"button",button:f}),a.push(c)}return{contents:r,gaps:a}},t.Flyout.prototype.getDynamicCategoryContents_=function(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");if(e=e(this.workspace_.targetWorkspace),!Array.isArray(e))throw new TypeError("Result of toolbox category callback must be an array.");return e},t.Flyout.prototype.createButton_=function(e,r){if(!t.FlyoutButton)throw Error("Missing require for Blockly.FlyoutButton");return new t.FlyoutButton(this.workspace_,this.targetWorkspace,e,r)},t.Flyout.prototype.createBlock_=function(e){return(e=t.Xml.domToBlock(e,this.workspace_)).isEnabled()||this.permanentlyDisabled_.push(e),e},t.Flyout.prototype.getBlockXml_=function(e){var r=null,a=e.blockxml;if(a&&"string"!=typeof a?r=a:a&&"string"==typeof a?(r=t.Xml.textToDom(a),e.blockxml=r):e.type&&((r=t.utils.xml.createElement("xml")).setAttribute("type",e.type),r.setAttribute("disabled",e.disabled),e.blockxml=r),!r)throw Error("Error: Invalid block definition. Block definition must have blockxml or type.");return r},t.Flyout.prototype.addSeparatorGap_=function(e,r,a){e=parseInt(e.gap,10),!isNaN(e)&&0<r.length?r[r.length-1]=e:r.push(a)},t.Flyout.prototype.clearOldBlocks_=function(){for(var a,e=this.workspace_.getTopBlocks(!1),r=0;a=e[r];r++)a.workspace==this.workspace_&&a.dispose(!1,!1);for(r=0;r<this.mats_.length;r++)(e=this.mats_[r])&&(t.Tooltip.unbindMouseEvents(e),t.utils.dom.removeNode(e));for(r=this.mats_.length=0;e=this.buttons_[r];r++)e.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},t.Flyout.prototype.addBlockListeners_=function(e,r,a){this.listeners_.push(t.browserEvents.conditionalBind(e,"mousedown",null,this.blockMouseDown_(r))),this.listeners_.push(t.browserEvents.conditionalBind(a,"mousedown",null,this.blockMouseDown_(r))),this.listeners_.push(t.browserEvents.bind(e,"mouseenter",r,r.addSelect)),this.listeners_.push(t.browserEvents.bind(e,"mouseleave",r,r.removeSelect)),this.listeners_.push(t.browserEvents.bind(a,"mouseenter",r,r.addSelect)),this.listeners_.push(t.browserEvents.bind(a,"mouseleave",r,r.removeSelect))},t.Flyout.prototype.blockMouseDown_=function(e){var r=this;return function(a){var c=r.targetWorkspace.getGesture(a);c&&(c.setStartBlock(e),c.handleFlyoutStart(a,r))}},t.Flyout.prototype.onMouseDown_=function(e){var r=this.targetWorkspace.getGesture(e);r&&r.handleFlyoutStart(e,this)},t.Flyout.prototype.isBlockCreatable_=function(e){return e.isEnabled()},t.Flyout.prototype.createBlock=function(e){var r=null;t.Events.disable();var a=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{r=this.placeNewBlock_(e)}finally{t.Events.enable()}if(t.hideChaff(),e=t.Variables.getAddedVariables(this.targetWorkspace,a),t.Events.isEnabled()){for(t.Events.setGroup(!0),a=0;a<e.length;a++){var c=e[a];t.Events.fire(new(t.Events.get(t.Events.VAR_CREATE))(c))}t.Events.fire(new(t.Events.get(t.Events.BLOCK_CREATE))(r))}return this.autoClose?this.hide():this.filterForCapacity_(),r},t.Flyout.prototype.initFlyoutButton_=function(e,r,a){var c=e.createDom();e.moveTo(r,a),e.show(),this.listeners_.push(t.browserEvents.conditionalBind(c,"mousedown",this,this.onMouseDown_)),this.buttons_.push(e)},t.Flyout.prototype.createRect_=function(e,r,a,c,p){return(r=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{"fill-opacity":0,x:r,y:a,height:c.height,width:c.width},null)).tooltip=e,t.Tooltip.bindMouseEvents(r),this.workspace_.getCanvas().insertBefore(r,e.getSvgRoot()),e.flyoutRect_=r,this.mats_[p]=r},t.Flyout.prototype.moveRectToBlock_=function(e,r){var a=r.getHeightWidth();e.setAttribute("width",a.width),e.setAttribute("height",a.height),r=r.getRelativeToSurfaceXY(),e.setAttribute("y",r.y),e.setAttribute("x",this.RTL?r.x-a.width:r.x)},t.Flyout.prototype.filterForCapacity_=function(){for(var a,e=this.workspace_.getTopBlocks(!1),r=0;a=e[r];r++)if(-1==this.permanentlyDisabled_.indexOf(a))for(var c=this.targetWorkspace.isCapacityAvailable(t.utils.getBlockTypeCounts(a));a;)a.setEnabled(c),a=a.getNextBlock()},t.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},t.Flyout.prototype.isScrollable=function(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()},t.Flyout.prototype.placeNewBlock_=function(e){var r=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered.");var a=t.Xml.blockToDom(e,!0);if(r.setResizesEnabled(!1),!(a=t.Xml.domToBlock(a,r)).getSvgRoot())throw Error("block is not rendered.");var c=r.getOriginOffsetInPixels(),p=this.workspace_.getOriginOffsetInPixels();return(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),e=t.utils.Coordinate.sum(p,e),(c=t.utils.Coordinate.difference(e,c)).scale(1/r.scale),a.moveBy(c.x,c.y),a},t.HorizontalFlyout=function(e){t.HorizontalFlyout.superClass_.constructor.call(this,e),this.horizontalLayout=!0},t.utils.object.inherits(t.HorizontalFlyout,t.Flyout),t.HorizontalFlyout.prototype.setMetrics_=function(e){if(this.isVisible()){var r=this.workspace_.getMetricsManager(),a=r.getScrollMetrics(),c=r.getViewMetrics();r=r.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(a.left+(a.width-c.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+r.left,this.workspace_.scrollY+r.top)}},t.HorizontalFlyout.prototype.getX=function(){return 0},t.HorizontalFlyout.prototype.getY=function(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager(),r=e.getAbsoluteMetrics(),a=e.getViewMetrics();e=e.getToolboxMetrics();var c=this.toolboxPosition_==t.utils.toolbox.Position.TOP;return this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?c?e.height:a.height-this.height_:c?0:a.height:c?0:a.height+r.top-this.height_},t.HorizontalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath_(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var r=this.getY();this.positionAt_(this.width_,this.height_,e,r)}},t.HorizontalFlyout.prototype.setBackgroundPath_=function(e,r){var a=this.toolboxPosition_==t.utils.toolbox.Position.TOP,c=["M 0,"+(a?0:this.CORNER_RADIUS)];a?(c.push("h",e+2*this.CORNER_RADIUS),c.push("v",r),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("h",-e),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),c.push("h",e),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("v",r),c.push("h",-e-2*this.CORNER_RADIUS)),c.push("z"),this.svgBackground_.setAttribute("d",c.join(" "))},t.HorizontalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setX(this.RTL?1/0:0)},t.HorizontalFlyout.prototype.wheel_=function(e){var r=t.utils.getScrollDeltaPixels(e);if(r=r.x||r.y){var a=this.workspace_.getMetricsManager(),c=a.getScrollMetrics();r=a.getViewMetrics().left-c.left+r,this.workspace_.scrollbar.setX(r),t.WidgetDiv.hide(),t.DropDownDiv.hideWithoutAnimation()}e.preventDefault(),e.stopPropagation()},t.HorizontalFlyout.prototype.layout_=function(e,r){this.workspace_.scale=this.targetWorkspace.scale;var a=this.MARGIN,c=a+this.tabWidth_;this.RTL&&(e=e.reverse());for(var f,p=0;f=e[p];p++)if("block"==f.type){for(var D,T=(f=f.block).getDescendants(!1),y=0;D=T[y];y++)D.isInFlyout=!0;f.render(),T=f.getSvgRoot(),y=f.getHeightWidth(),D=f.outputConnection?this.tabWidth_:0,f.moveBy(D=this.RTL?c+y.width:c-D,a),D=this.createRect_(f,D,a,y,p),c+=y.width+r[p],this.addBlockListeners_(T,f,D)}else"button"==f.type&&(this.initFlyoutButton_(f.button,c,a),c+=f.button.width+r[p])},t.HorizontalFlyout.prototype.isDragTowardWorkspace=function(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var r=this.dragAngleRange_;return e<90+r&&e>90-r||e>-90-r&&e<-90+r},t.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var e=this.svgGroup_.getBoundingClientRect(),r=e.top;return this.toolboxPosition_==t.utils.toolbox.Position.TOP?new t.utils.Rect(-1e9,r+e.height,-1e9,1e9):new t.utils.Rect(r,1e9,-1e9,1e9)},t.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var c,e=0,r=this.workspace_.getTopBlocks(!1),a=0;c=r[a];a++)e=Math.max(e,c.getHeightWidth().height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,this.height_!=(e+=t.Scrollbar.scrollbarThickness)){for(a=0;c=r[a];a++)c.flyoutRect_&&this.moveRectToBlock_(c.flyoutRect_,c);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=t.utils.toolbox.Position.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.recordDragTargets()}},t.registry.register(t.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,t.registry.DEFAULT,t.HorizontalFlyout),t.VerticalFlyout=function(e){t.VerticalFlyout.superClass_.constructor.call(this,e)},t.utils.object.inherits(t.VerticalFlyout,t.Flyout),t.VerticalFlyout.registryName="verticalFlyout",t.VerticalFlyout.prototype.setMetrics_=function(e){if(this.isVisible()){var r=this.workspace_.getMetricsManager(),a=r.getScrollMetrics(),c=r.getViewMetrics();r=r.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(a.top+(a.height-c.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+r.left,this.workspace_.scrollY+r.top)}},t.VerticalFlyout.prototype.getX=function(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager(),r=e.getAbsoluteMetrics(),a=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_==t.utils.toolbox.Position.LEFT?e.width:a.width-this.width_:this.toolboxPosition_==t.utils.toolbox.Position.LEFT?0:a.width:this.toolboxPosition_==t.utils.toolbox.Position.LEFT?0:a.width+r.left-this.width_},t.VerticalFlyout.prototype.getY=function(){return 0},t.VerticalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var r=this.getY();this.positionAt_(this.width_,this.height_,e,r)}},t.VerticalFlyout.prototype.setBackgroundPath_=function(e,r){var a=this.toolboxPosition_==t.utils.toolbox.Position.RIGHT,c=e+this.CORNER_RADIUS;(c=["M "+(a?c:0)+",0"]).push("h",a?-e:e),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,a?0:1,a?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("v",Math.max(0,r)),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,a?0:1,a?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("h",a?e:-e),c.push("z"),this.svgBackground_.setAttribute("d",c.join(" "))},t.VerticalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setY(0)},t.VerticalFlyout.prototype.wheel_=function(e){var r=t.utils.getScrollDeltaPixels(e);if(r.y){var a=this.workspace_.getMetricsManager(),c=a.getScrollMetrics();r=a.getViewMetrics().top-c.top+r.y,this.workspace_.scrollbar.setY(r),t.WidgetDiv.hide(),t.DropDownDiv.hideWithoutAnimation()}e.preventDefault(),e.stopPropagation()},t.VerticalFlyout.prototype.layout_=function(e,r){this.workspace_.scale=this.targetWorkspace.scale;for(var f,a=this.MARGIN,c=this.RTL?a:a+this.tabWidth_,p=0;f=e[p];p++)if("block"==f.type){for(var D,T=(f=f.block).getDescendants(!1),y=0;D=T[y];y++)D.isInFlyout=!0;f.render(),T=f.getSvgRoot(),y=f.getHeightWidth(),f.moveBy(D=f.outputConnection?c-this.tabWidth_:c,a),D=this.createRect_(f,this.RTL?D-y.width:D,a,y,p),this.addBlockListeners_(T,f,D),a+=y.height+r[p]}else"button"==f.type&&(this.initFlyoutButton_(f.button,c,a),a+=f.button.height+r[p])},t.VerticalFlyout.prototype.isDragTowardWorkspace=function(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var r=this.dragAngleRange_;return e<r&&e>-r||e<-180+r||e>180-r},t.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var e=this.svgGroup_.getBoundingClientRect(),r=e.left;return this.toolboxPosition_==t.utils.toolbox.Position.LEFT?new t.utils.Rect(-1e9,1e9,-1e9,r+e.width):new t.utils.Rect(-1e9,1e9,r,1e9)},t.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var c,e=0,r=this.workspace_.getTopBlocks(!1),a=0;c=r[a];a++){var p=c.getHeightWidth().width;c.outputConnection&&(p-=this.tabWidth_),e=Math.max(e,p)}for(a=0;c=this.buttons_[a];a++)e=Math.max(e,c.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,this.width_!=(e+=t.Scrollbar.scrollbarThickness)){for(a=0;c=r[a];a++){if(this.RTL){p=c.getRelativeToSurfaceXY().x;var f=e/this.workspace_.scale-this.MARGIN;c.outputConnection||(f-=this.tabWidth_),c.moveBy(f-p,0)}c.flyoutRect_&&this.moveRectToBlock_(c.flyoutRect_,c)}if(this.RTL)for(a=0;c=this.buttons_[a];a++)r=c.getPosition().y,c.moveTo(e/this.workspace_.scale-c.width-this.MARGIN-this.tabWidth_,r);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=t.utils.toolbox.Position.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.recordDragTargets()}},t.registry.register(t.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,t.registry.DEFAULT,t.VerticalFlyout),t.FlyoutButton=function(e,r,a,c){this.workspace_=e,this.targetWorkspace_=r,this.text_=a.text,this.position_=new t.utils.Coordinate(0,0),this.isLabel_=c,this.callbackKey_=a.callbackKey||a.callbackkey,this.cssClass_=a["web-class"]||null,this.onMouseUpWrapper_=null,this.info=a},t.FlyoutButton.MARGIN_X=5,t.FlyoutButton.MARGIN_Y=2,t.FlyoutButton.prototype.width=0,t.FlyoutButton.prototype.height=0,t.FlyoutButton.prototype.createDom=function(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_&&(e+=" "+this.cssClass_),this.svgGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:e},this.workspace_.getCanvas()),!this.isLabel_)var r=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);e=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var a=t.utils.dom.createSvgElement(t.utils.Svg.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_),c=t.utils.replaceMessageReferences(this.text_);this.workspace_.RTL&&(c+="\u200f"),a.textContent=c,this.isLabel_&&(this.svgText_=a,this.workspace_.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));var p=t.utils.style.getComputedStyle(a,"fontSize"),f=t.utils.style.getComputedStyle(a,"fontWeight"),T=t.utils.style.getComputedStyle(a,"fontFamily");return this.width=t.utils.dom.getFastTextWidthWithSizeString(a,p,f,T),c=t.utils.dom.measureFontMetrics(c,p,f,T),this.height=c.height,this.isLabel_||(this.width+=2*t.FlyoutButton.MARGIN_X,this.height+=2*t.FlyoutButton.MARGIN_Y,r.setAttribute("width",this.width),r.setAttribute("height",this.height)),e.setAttribute("width",this.width),e.setAttribute("height",this.height),a.setAttribute("x",this.width/2),a.setAttribute("y",this.height/2-c.height/2+c.baseline),this.updateTransform_(),this.onMouseUpWrapper_=t.browserEvents.conditionalBind(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},t.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},t.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},t.FlyoutButton.prototype.moveTo=function(e,r){this.position_.x=e,this.position_.y=r,this.updateTransform_()},t.FlyoutButton.prototype.isLabel=function(){return this.isLabel_},t.FlyoutButton.prototype.getPosition=function(){return this.position_},t.FlyoutButton.prototype.getButtonText=function(){return this.text_},t.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},t.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&t.browserEvents.unbind(this.onMouseUpWrapper_),this.svgGroup_&&t.utils.dom.removeNode(this.svgGroup_),this.svgText_&&this.workspace_.getThemeManager().unsubscribe(this.svgText_)},t.FlyoutButton.prototype.onMouseUp_=function(e){(e=this.targetWorkspace_.getGesture(e))&&e.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace_.getButtonCallback(this.callbackKey_)?this.isLabel_||this.targetWorkspace_.getButtonCallback(this.callbackKey_)(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)},t.Css.register(".blocklyFlyoutButton {,fill: #888;,cursor: default;,},.blocklyFlyoutButtonShadow {,fill: #666;,},.blocklyFlyoutButton:hover {,fill: #aaa;,},.blocklyFlyoutLabel {,cursor: default;,},.blocklyFlyoutLabelBackground {,opacity: 0;,}".split(",")),t.Generator=function(e){this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},t.Generator.prototype.INFINITE_LOOP_TRAP=null,t.Generator.prototype.STATEMENT_PREFIX=null,t.Generator.prototype.STATEMENT_SUFFIX=null,t.Generator.prototype.INDENT="  ",t.Generator.prototype.COMMENT_WRAP=60,t.Generator.prototype.ORDER_OVERRIDES=[],t.Generator.prototype.isInitialized=null,t.Generator.prototype.workspaceToCode=function(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=t.getMainWorkspace());var r=[];this.init(e),e=e.getTopBlocks(!0);for(var c,a=0;c=e[a];a++){var p=this.blockToCode(c);Array.isArray(p)&&(p=p[0]),p&&(c.outputConnection&&(p=this.scrubNakedValue(p),this.STATEMENT_PREFIX&&!c.suppressPrefixSuffix&&(p=this.injectId(this.STATEMENT_PREFIX,c)+p),this.STATEMENT_SUFFIX&&!c.suppressPrefixSuffix&&(p+=this.injectId(this.STATEMENT_SUFFIX,c))),r.push(p))}return r=r.join("\n"),(r=(r=(r=this.finish(r)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},t.Generator.prototype.prefixLines=function(e,r){return r+e.replace(/(?!\n$)\n/g,"\n"+r)},t.Generator.prototype.allNestedComments=function(e){var r=[];e=e.getDescendants(!0);for(var a=0;a<e.length;a++){var c=e[a].getCommentText();c&&r.push(c)}return r.length&&r.push(""),r.join("\n")},t.Generator.prototype.blockToCode=function(e,r){if(!1===this.isInitialized&&console.warn("Generator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return r?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return r?"":this.blockToCode(e.getChildren(!1)[0]);var a=this[e.type];if("function"!=typeof a)throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+e.type+'".');if(a=a.call(e,e),Array.isArray(a)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,a[0],r),a[1]]}if("string"==typeof a)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(a=this.injectId(this.STATEMENT_PREFIX,e)+a),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(a+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,a,r);if(null===a)return"";throw SyntaxError("Invalid code generated: "+a)},t.Generator.prototype.valueToCode=function(e,r,a){if(isNaN(a))throw TypeError("Expecting valid order from block: "+e.type);var c=e.getInputTargetBlock(r);if(!c||""===(r=this.blockToCode(c)))return"";if(!Array.isArray(r))throw TypeError("Expecting tuple from value block: "+c.type);if(e=r[0],r=r[1],isNaN(r))throw TypeError("Expecting valid order from value block: "+c.type);if(!e)return"";c=!1;var p=Math.floor(a),f=Math.floor(r);if(p<=f&&(p!=f||0!=p&&99!=p))for(c=!0,p=0;p<this.ORDER_OVERRIDES.length;p++)if(this.ORDER_OVERRIDES[p][0]==a&&this.ORDER_OVERRIDES[p][1]==r){c=!1;break}return c&&(e="("+e+")"),e},t.Generator.prototype.statementToCode=function(e,r){if(e=e.getInputTargetBlock(r),"string"!=typeof(r=this.blockToCode(e)))throw TypeError("Expecting code from statement block: "+(e&&e.type));return r&&(r=this.prefixLines(r,this.INDENT)),r},t.Generator.prototype.addLoopTrap=function(e,r){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,r),this.INDENT)+e),this.STATEMENT_SUFFIX&&!r.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,r),this.INDENT)+e),this.STATEMENT_PREFIX&&!r.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,r),this.INDENT)),e},t.Generator.prototype.injectId=function(e,r){return r=r.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+r+"'")},t.Generator.prototype.RESERVED_WORDS_="",t.Generator.prototype.addReservedWords=function(e){this.RESERVED_WORDS_+=e+","},t.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",Object.defineProperty(t.Generator.prototype,"variableDB_",{get:function(){return t.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_},set:function(e){t.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_=e}}),t.Generator.prototype.provideFunction_=function(e,r){if(!this.definitions_[e]){var c,a=this.nameDB_.getDistinctName(e,t.PROCEDURE_CATEGORY_NAME);for(this.functionNames_[e]=a,r=r.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,a);c!=r;)c=r,r=r.replace(/^(( {2})*) {2}/gm,"$1\0");r=r.replace(/\0/g,this.INDENT),this.definitions_[e]=r}return this.functionNames_[e]},t.Generator.prototype.init=function(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)},t.Generator.prototype.scrub_=function(e,r,a){return r},t.Generator.prototype.finish=function(e){return delete this.definitions_,delete this.functionNames_,e},t.Generator.prototype.scrubNakedValue=function(e){return e},t.IToolboxItem=function(){},t.ISelectableToolboxItem=function(){},t.ICollapsibleToolboxItem=function(){},t.ToolboxItem=function(e,r,a){this.id_=e.toolboxitemid||t.utils.IdGenerator.getNextUniqueId(),this.level_=(this.parent_=a||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=r,this.workspace_=this.parentToolbox_.getWorkspace()},t.ToolboxItem.prototype.init=function(){},t.ToolboxItem.prototype.getDiv=function(){return null},t.ToolboxItem.prototype.getId=function(){return this.id_},t.ToolboxItem.prototype.getParent=function(){return null},t.ToolboxItem.prototype.getLevel=function(){return this.level_},t.ToolboxItem.prototype.isSelectable=function(){return!1},t.ToolboxItem.prototype.isCollapsible=function(){return!1},t.ToolboxItem.prototype.dispose=function(){},t.ToolboxCategory=function(e,r,a){t.ToolboxCategory.superClass_.constructor.call(this,e,r,a),this.name_=t.utils.replaceMessageReferences(e.name),this.colour_=this.getColour_(e),this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.cssConfig_=this.makeDefaultCssConfig_(),t.utils.object.mixin(this.cssConfig_,e.cssconfig||e.cssConfig),this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.parseContents_(e)},t.utils.object.inherits(t.ToolboxCategory,t.ToolboxItem),t.ToolboxCategory.registrationName="category",t.ToolboxCategory.nestedPadding=19,t.ToolboxCategory.borderWidth=8,t.ToolboxCategory.defaultBackgroundColour="#57e",t.ToolboxCategory.prototype.makeDefaultCssConfig_=function(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}},t.ToolboxCategory.prototype.parseContents_=function(e){var r=e.contents;if(e.custom)this.flyoutItems_=e.custom;else if(r){e=0;for(var a;a=r[e];e++)this.flyoutItems_.push(a)}},t.ToolboxCategory.prototype.init=function(){this.createDom_(),"true"==this.toolboxItemDef_.hidden&&this.hide()},t.ToolboxCategory.prototype.createDom_=function(){return this.htmlDiv_=this.createContainer_(),t.utils.aria.setRole(this.htmlDiv_,t.utils.aria.Role.TREEITEM),t.utils.aria.setState(this.htmlDiv_,t.utils.aria.State.SELECTED,!1),t.utils.aria.setState(this.htmlDiv_,t.utils.aria.State.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),t.utils.aria.setRole(this.iconDom_,t.utils.aria.Role.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_),t.utils.aria.setState(this.htmlDiv_,t.utils.aria.State.LABELLEDBY,this.labelDom_.getAttribute("id")),this.addColourBorder_(this.colour_),this.htmlDiv_},t.ToolboxCategory.prototype.createContainer_=function(){var e=document.createElement("div");return t.utils.dom.addClass(e,this.cssConfig_.container),e},t.ToolboxCategory.prototype.createRowContainer_=function(){var e=document.createElement("div");t.utils.dom.addClass(e,this.cssConfig_.row);var r=t.ToolboxCategory.nestedPadding*this.getLevel();return r=r.toString()+"px",this.workspace_.RTL?e.style.paddingRight=r:e.style.paddingLeft=r,e},t.ToolboxCategory.prototype.createRowContentsContainer_=function(){var e=document.createElement("div");return t.utils.dom.addClass(e,this.cssConfig_.rowcontentcontainer),e},t.ToolboxCategory.prototype.createIconDom_=function(){var e=document.createElement("span");return this.parentToolbox_.isHorizontal()||t.utils.dom.addClass(e,this.cssConfig_.icon),e.style.display="inline-block",e},t.ToolboxCategory.prototype.createLabelDom_=function(e){var r=document.createElement("span");return r.setAttribute("id",this.getId()+".label"),r.textContent=e,t.utils.dom.addClass(r,this.cssConfig_.label),r},t.ToolboxCategory.prototype.refreshTheme=function(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)},t.ToolboxCategory.prototype.addColourBorder_=function(e){e&&(e=t.ToolboxCategory.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)},t.ToolboxCategory.prototype.getColour_=function(e){var r=e.categorystyle||e.categoryStyle;return(e=e.colour)&&r?(console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour'),""):r?this.getColourfromStyle_(r):this.parseColour_(e)},t.ToolboxCategory.prototype.getColourfromStyle_=function(e){var r=this.workspace_.getTheme();if(e&&r){if((r=r.categoryStyles[e])&&r.colour)return this.parseColour_(r.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""},t.ToolboxCategory.prototype.getClickTarget=function(){return this.rowDiv_},t.ToolboxCategory.prototype.parseColour_=function(e){if(null==(e=t.utils.replaceMessageReferences(e))||""===e)return"";var r=Number(e);return isNaN(r)?(r=t.utils.colour.parse(e))?r:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):t.hueToHex(r)},t.ToolboxCategory.prototype.openIcon_=function(e){e&&(t.utils.dom.removeClasses(e,this.cssConfig_.closedicon),t.utils.dom.addClass(e,this.cssConfig_.openicon))},t.ToolboxCategory.prototype.closeIcon_=function(e){e&&(t.utils.dom.removeClasses(e,this.cssConfig_.openicon),t.utils.dom.addClass(e,this.cssConfig_.closedicon))},t.ToolboxCategory.prototype.setVisible_=function(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},t.ToolboxCategory.prototype.hide=function(){this.setVisible_(!1)},t.ToolboxCategory.prototype.show=function(){this.setVisible_(!0)},t.ToolboxCategory.prototype.isVisible=function(){return!this.isHidden_&&this.allAncestorsExpanded_()},t.ToolboxCategory.prototype.allAncestorsExpanded_=function(){for(var e=this;e.getParent();)if(!(e=e.getParent()).isExpanded())return!1;return!0},t.ToolboxCategory.prototype.isSelectable=function(){return this.isVisible()&&!this.isDisabled_},t.ToolboxCategory.prototype.onClick=function(e){},t.ToolboxCategory.prototype.setSelected=function(e){if(e){var r=this.parseColour_(t.ToolboxCategory.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||r,t.utils.dom.addClass(this.rowDiv_,this.cssConfig_.selected)}else this.rowDiv_.style.backgroundColor="",t.utils.dom.removeClass(this.rowDiv_,this.cssConfig_.selected);t.utils.aria.setState(this.htmlDiv_,t.utils.aria.State.SELECTED,e)},t.ToolboxCategory.prototype.setDisabled=function(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",e),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")},t.ToolboxCategory.prototype.getName=function(){return this.name_},t.ToolboxCategory.prototype.getParent=function(){return this.parent_},t.ToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},t.ToolboxCategory.prototype.getContents=function(){return this.flyoutItems_},t.ToolboxCategory.prototype.updateFlyoutContents=function(e){this.flyoutItems_=[],"string"==typeof e?this.toolboxItemDef_.custom=e:(delete this.toolboxItemDef_.custom,this.toolboxItemDef_.contents=t.utils.toolbox.convertFlyoutDefToJsonArray(e)),this.parseContents_(this.toolboxItemDef_)},t.ToolboxCategory.prototype.dispose=function(){t.utils.dom.removeNode(this.htmlDiv_)},t.Css.register([".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: rgba(255, 255, 255, 0.2);","}",'.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {',"margin: 1px 5px 1px 0;","}",'.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {',"margin: 1px 0 1px 5px;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","padding-right: 0px","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","visibility: hidden;","width: 16px;","}",".blocklyTreeIconClosed {","background-position: -32px -1px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {',"background-position: 0 -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosed {","background-position: -32px -17px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {',"background-position: 0 -17px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeLabel {","cursor: default;","font: 16px sans-serif;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}"]),t.registry.register(t.registry.Type.TOOLBOX_ITEM,t.ToolboxCategory.registrationName,t.ToolboxCategory),t.ToolboxSeparator=function(e,r){t.ToolboxSeparator.superClass_.constructor.call(this,e,r),this.cssConfig_={container:"blocklyTreeSeparator"},t.utils.object.mixin(this.cssConfig_,e.cssconfig||e.cssConfig)},t.utils.object.inherits(t.ToolboxSeparator,t.ToolboxItem),t.ToolboxSeparator.registrationName="sep",t.ToolboxSeparator.prototype.init=function(){this.createDom_()},t.ToolboxSeparator.prototype.createDom_=function(){var e=document.createElement("div");return t.utils.dom.addClass(e,this.cssConfig_.container),this.htmlDiv_=e},t.ToolboxSeparator.prototype.getDiv=function(){return this.htmlDiv_},t.ToolboxSeparator.prototype.dispose=function(){t.utils.dom.removeNode(this.htmlDiv_)},t.Css.register('.blocklyTreeSeparator {,border-bottom: solid #e5e5e5 1px;,height: 0;,margin: 5px 0;,},.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {,border-right: solid #e5e5e5 1px;,border-bottom: none;,height: auto;,margin: 0 5px 0 5px;,padding: 5px 0;,width: 0;,}'.split(",")),t.registry.register(t.registry.Type.TOOLBOX_ITEM,t.ToolboxSeparator.registrationName,t.ToolboxSeparator),t.CollapsibleToolboxCategory=function(e,r,a){this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[],t.CollapsibleToolboxCategory.superClass_.constructor.call(this,e,r,a)},t.utils.object.inherits(t.CollapsibleToolboxCategory,t.ToolboxCategory),t.CollapsibleToolboxCategory.registrationName="collapsibleCategory",t.CollapsibleToolboxCategory.prototype.makeDefaultCssConfig_=function(){var e=t.CollapsibleToolboxCategory.superClass_.makeDefaultCssConfig_.call(this);return e.contents="blocklyToolboxContents",e},t.CollapsibleToolboxCategory.prototype.parseContents_=function(e){var r=e.contents,a=!0;if(e.custom)this.flyoutItems_=e.custom;else if(r){e=0;for(var c;c=r[e];e++)!t.registry.hasItem(t.registry.Type.TOOLBOX_ITEM,c.kind)||c.kind.toLowerCase()==t.ToolboxSeparator.registrationName&&a?(this.flyoutItems_.push(c),a=!0):(this.createToolboxItem_(c),a=!1)}},t.CollapsibleToolboxCategory.prototype.createToolboxItem_=function(e){var r=e.kind;"CATEGORY"==r.toUpperCase()&&t.utils.toolbox.isCategoryCollapsible(e)&&(r=t.CollapsibleToolboxCategory.registrationName),e=new(t.registry.getClass(t.registry.Type.TOOLBOX_ITEM,r))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)},t.CollapsibleToolboxCategory.prototype.init=function(){t.CollapsibleToolboxCategory.superClass_.init.call(this),this.setExpanded("true"==this.toolboxItemDef_.expanded||this.toolboxItemDef_.expanded)},t.CollapsibleToolboxCategory.prototype.createDom_=function(){t.CollapsibleToolboxCategory.superClass_.createDom_.call(this);var e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),t.utils.aria.setRole(this.subcategoriesDiv_,t.utils.aria.Role.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_},t.CollapsibleToolboxCategory.prototype.createIconDom_=function(){var e=document.createElement("span");return this.parentToolbox_.isHorizontal()||(t.utils.dom.addClass(e,this.cssConfig_.icon),e.style.visibility="visible"),e.style.display="inline-block",e},t.CollapsibleToolboxCategory.prototype.createSubCategoriesDom_=function(e){var r=document.createElement("div");t.utils.dom.addClass(r,this.cssConfig_.contents);for(var a=0;a<e.length;a++){var c=e[a];c.init();var p=c.getDiv();r.appendChild(p),c.getClickTarget&&c.getClickTarget().setAttribute("id",c.getId())}return r},t.CollapsibleToolboxCategory.prototype.setExpanded=function(e){this.expanded_!=e&&((this.expanded_=e)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),t.utils.aria.setState(this.htmlDiv_,t.utils.aria.State.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize())},t.CollapsibleToolboxCategory.prototype.setVisible_=function(e){this.htmlDiv_.style.display=e?"block":"none";for(var a,r=0;a=this.getChildToolboxItems()[r];r++)a.setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},t.CollapsibleToolboxCategory.prototype.isExpanded=function(){return this.expanded_},t.CollapsibleToolboxCategory.prototype.isCollapsible=function(){return!0},t.CollapsibleToolboxCategory.prototype.onClick=function(e){this.toggleExpanded()},t.CollapsibleToolboxCategory.prototype.toggleExpanded=function(){this.setExpanded(!this.expanded_)},t.CollapsibleToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},t.CollapsibleToolboxCategory.prototype.getChildToolboxItems=function(){return this.toolboxItems_},t.registry.register(t.registry.Type.TOOLBOX_ITEM,t.CollapsibleToolboxCategory.registrationName,t.CollapsibleToolboxCategory),t.Events.ToolboxItemSelect=function(e,r,a){t.Events.ToolboxItemSelect.superClass_.constructor.call(this,a),this.oldItem=e,this.newItem=r},t.utils.object.inherits(t.Events.ToolboxItemSelect,t.Events.UiBase),t.Events.ToolboxItemSelect.prototype.type=t.Events.TOOLBOX_ITEM_SELECT,t.Events.ToolboxItemSelect.prototype.toJson=function(){var e=t.Events.ToolboxItemSelect.superClass_.toJson.call(this);return e.oldItem=this.oldItem,e.newItem=this.newItem,e},t.Events.ToolboxItemSelect.prototype.fromJson=function(e){t.Events.ToolboxItemSelect.superClass_.fromJson.call(this,e),this.oldItem=e.oldItem,this.newItem=e.newItem},t.registry.register(t.registry.Type.EVENT,t.Events.TOOLBOX_ITEM_SELECT,t.Events.ToolboxItemSelect),t.IAutoHideable=function(){},t.IStyleable=function(){},t.IToolbox=function(){},t.Toolbox=function(e){t.Toolbox.superClass_.constructor.call(this),this.workspace_=e,this.id="toolbox",this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout_=e.options.horizontalLayout,this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.RTL=e.options.RTL,this.flyout_=null,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[]},t.utils.object.inherits(t.Toolbox,t.DeleteArea),t.Toolbox.prototype.onShortcut=function(e){return!1},t.Toolbox.prototype.init=function(){var e=this.workspace_,r=e.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),t.utils.dom.insertAfter(this.flyout_.createDom("svg"),r),this.setVisible(!0),this.flyout_.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[t.ComponentManager.Capability.AUTOHIDEABLE,t.ComponentManager.Capability.DELETE_AREA,t.ComponentManager.Capability.DRAG_TARGET]})},t.Toolbox.prototype.createDom_=function(e){e=e.getParentSvg();var r=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,t.utils.aria.setRole(this.contentsDiv_,t.utils.aria.Role.TREE),r.appendChild(this.contentsDiv_),e.parentNode.insertBefore(r,e),this.attachEvents_(r,this.contentsDiv_),r},t.Toolbox.prototype.createContainer_=function(){var e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),t.utils.dom.addClass(e,"blocklyToolboxDiv"),t.utils.dom.addClass(e,"blocklyNonSelectable"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e},t.Toolbox.prototype.createContentsContainer_=function(){var e=document.createElement("div");return t.utils.dom.addClass(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e},t.Toolbox.prototype.attachEvents_=function(e,r){e=t.browserEvents.conditionalBind(e,"click",this,this.onClick_,!1,!0),this.boundEvents_.push(e),r=t.browserEvents.conditionalBind(r,"keydown",this,this.onKeyDown_,!1,!0),this.boundEvents_.push(r)},t.Toolbox.prototype.onClick_=function(e){if(t.utils.isRightButton(e)||e.target==this.HtmlDiv)t.hideChaff(!1);else{var r=e.target.getAttribute("id");r&&(r=this.getToolboxItemById(r)).isSelectable()&&(this.setSelectedItem(r),r.onClick(e)),t.hideChaff(!0)}t.Touch.clearTouchIdentifier()},t.Toolbox.prototype.onKeyDown_=function(e){var r=!1;switch(e.keyCode){case t.utils.KeyCodes.DOWN:r=this.selectNext_();break;case t.utils.KeyCodes.UP:r=this.selectPrevious_();break;case t.utils.KeyCodes.LEFT:r=this.selectParent_();break;case t.utils.KeyCodes.RIGHT:r=this.selectChild_();break;case t.utils.KeyCodes.ENTER:case t.utils.KeyCodes.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),r=!0);break;default:r=!1}!r&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(r=this.selectedItem_.onKeyDown(e)),r&&e.preventDefault()},t.Toolbox.prototype.createFlyout_=function(){var e=this.workspace_,r=new t.Options({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:!0}});return r.toolboxPosition=e.options.toolboxPosition,new(t.registry.getClassFromOptions(e.horizontalLayout?t.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX:t.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(r)},t.Toolbox.prototype.render=function(e){this.toolboxDef_=e;for(var r=0;r<this.contents_.length;r++){var a=this.contents_[r];a&&a.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()},t.Toolbox.prototype.renderContents_=function(e){for(var c,r=document.createDocumentFragment(),a=0;c=e[a];a++)this.createToolboxItem_(c,r);this.contentsDiv_.appendChild(r)},t.Toolbox.prototype.createToolboxItem_=function(e,r){var a=e.kind;"CATEGORY"==a.toUpperCase()&&t.utils.toolbox.isCategoryCollapsible(e)&&(a=t.CollapsibleToolboxCategory.registrationName),(a=t.registry.getClass(t.registry.Type.TOOLBOX_ITEM,a.toLowerCase()))&&(e=new a(e,this),this.addToolboxItem_(e),e.init(),(a=e.getDiv())&&r.appendChild(a),e.getClickTarget&&e.getClickTarget().setAttribute("id",e.getId()))},t.Toolbox.prototype.addToolboxItem_=function(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible())for(var a,r=0;a=e.getChildToolboxItems()[r];r++)this.addToolboxItem_(a)},t.Toolbox.prototype.getToolboxItems=function(){return this.contents_},t.Toolbox.prototype.addStyle=function(e){t.utils.dom.addClass(this.HtmlDiv,e)},t.Toolbox.prototype.removeStyle=function(e){t.utils.dom.removeClass(this.HtmlDiv,e)},t.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect(),r=e.top,a=r+e.height,c=e.left;return e=c+e.width,this.toolboxPosition==t.utils.toolbox.Position.TOP?new t.utils.Rect(-1e7,a,-1e7,1e7):this.toolboxPosition==t.utils.toolbox.Position.BOTTOM?new t.utils.Rect(r,1e7,-1e7,1e7):this.toolboxPosition==t.utils.toolbox.Position.LEFT?new t.utils.Rect(-1e7,1e7,-1e7,e):new t.utils.Rect(-1e7,1e7,c,1e7)},t.Toolbox.prototype.wouldDelete=function(e,r){return this.updateWouldDelete_(e instanceof t.BlockSvg?!e.getParent()&&e.isDeletable():e.isDeletable()),this.wouldDelete_},t.Toolbox.prototype.onDragEnter=function(e){this.updateCursorDeleteStyle_(!0)},t.Toolbox.prototype.onDragExit=function(e){this.updateCursorDeleteStyle_(!1)},t.Toolbox.prototype.onDrop=function(e){this.updateCursorDeleteStyle_(!1)},t.Toolbox.prototype.updateWouldDelete_=function(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))},t.Toolbox.prototype.updateCursorDeleteStyle_=function(e){var r=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(r):this.removeStyle(r)},t.Toolbox.prototype.getToolboxItemById=function(e){return this.contentMap_[e]||null},t.Toolbox.prototype.getWidth=function(){return this.width_},t.Toolbox.prototype.getHeight=function(){return this.height_},t.Toolbox.prototype.getFlyout=function(){return this.flyout_},t.Toolbox.prototype.getWorkspace=function(){return this.workspace_},t.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_},t.Toolbox.prototype.getPreviouslySelectedItem=function(){return this.previouslySelectedItem_},t.Toolbox.prototype.isHorizontal=function(){return this.horizontalLayout_},t.Toolbox.prototype.position=function(){var e=this.workspace_.getMetrics(),r=this.HtmlDiv;r&&(this.horizontalLayout_?(r.style.left="0",r.style.height="auto",r.style.width="100%",this.height_=r.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition==t.utils.toolbox.Position.TOP?r.style.top="0":r.style.bottom="0"):(this.toolboxPosition==t.utils.toolbox.Position.RIGHT?r.style.right="0":r.style.left="0",r.style.height="100%",this.width_=r.offsetWidth,this.height_=e.viewHeight),this.flyout_.position())},t.Toolbox.prototype.handleToolboxItemResize=function(){var e=this.workspace_,r=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition==t.utils.toolbox.Position.LEFT?e.scrollX+r.width:e.scrollX,this.toolboxPosition==t.utils.toolbox.Position.TOP?e.scrollY+r.height:e.scrollY),t.svgResize(e)},t.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)},t.Toolbox.prototype.refreshTheme=function(){for(var e=0;e<this.contents_.length;e++){var r=this.contents_[e];r.refreshTheme&&r.refreshTheme()}},t.Toolbox.prototype.refreshSelection=function(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())},t.Toolbox.prototype.setVisible=function(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())},t.Toolbox.prototype.autoHide=function(e){!e&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()},t.Toolbox.prototype.setSelectedItem=function(e){var r=this.selectedItem_;!e&&!r||e&&!e.isSelectable()||(this.shouldDeselectItem_(r,e)&&null!=r&&this.deselectItem_(r),this.shouldSelectItem_(r,e)&&null!=e&&this.selectItem_(r,e),this.updateFlyout_(r,e),this.fireSelectEvent_(r,e))},t.Toolbox.prototype.shouldDeselectItem_=function(e,r){return null!=e&&(!e.isCollapsible()||e!=r)},t.Toolbox.prototype.shouldSelectItem_=function(e,r){return null!=r&&r!=e},t.Toolbox.prototype.deselectItem_=function(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),t.utils.aria.setState(this.contentsDiv_,t.utils.aria.State.ACTIVEDESCENDANT,"")},t.Toolbox.prototype.selectItem_=function(e,r){this.selectedItem_=r,this.previouslySelectedItem_=e,r.setSelected(!0),t.utils.aria.setState(this.contentsDiv_,t.utils.aria.State.ACTIVEDESCENDANT,r.getId())},t.Toolbox.prototype.selectItemByPosition=function(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e]).isSelectable()&&this.setSelectedItem(e)},t.Toolbox.prototype.updateFlyout_=function(e,r){(e!=r||r.isCollapsible())&&r&&r.getContents().length?(this.flyout_.show(r.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()},t.Toolbox.prototype.fireSelectEvent_=function(e,r){var a=e&&e.getName(),c=r&&r.getName();e==r&&(c=null),e=new(t.Events.get(t.Events.TOOLBOX_ITEM_SELECT))(a,c,this.workspace_.id),t.Events.fire(e)},t.Toolbox.prototype.selectParent_=function(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.setExpanded(!1),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))},t.Toolbox.prototype.selectChild_=function(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;var e=this.selectedItem_;return e.isExpanded()?this.selectNext_():e.setExpanded(!0),!0},t.Toolbox.prototype.selectNext_=function(){if(!this.selectedItem_)return!1;var e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){for(var r=this.contents_[e];r&&!r.isSelectable();)r=this.contents_[++e];if(r&&r.isSelectable())return this.setSelectedItem(r),!0}return!1},t.Toolbox.prototype.selectPrevious_=function(){if(!this.selectedItem_)return!1;var e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){for(var r=this.contents_[e];r&&!r.isSelectable();)r=this.contents_[--e];if(r&&r.isSelectable())return this.setSelectedItem(r),!0}return!1},t.Toolbox.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)t.browserEvents.unbind(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),t.utils.dom.removeNode(this.HtmlDiv)},t.Css.register([".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","padding: 4px 0 4px 0;","position: absolute;","z-index: 70;","-webkit-tap-highlight-color: transparent;","}",".blocklyToolboxContents {","display: flex;","flex-wrap: wrap;","flex-direction: column;","}",".blocklyToolboxContents:focus {","outline: none;","}"]),t.registry.register(t.registry.Type.TOOLBOX,t.registry.DEFAULT,t.Toolbox),t.Events.TrashcanOpen=function(e,r){t.Events.TrashcanOpen.superClass_.constructor.call(this,r),this.isOpen=e},t.utils.object.inherits(t.Events.TrashcanOpen,t.Events.UiBase),t.Events.TrashcanOpen.prototype.type=t.Events.TRASHCAN_OPEN,t.Events.TrashcanOpen.prototype.toJson=function(){var e=t.Events.TrashcanOpen.superClass_.toJson.call(this);return e.isOpen=this.isOpen,e},t.Events.TrashcanOpen.prototype.fromJson=function(e){t.Events.TrashcanOpen.superClass_.fromJson.call(this,e),this.isOpen=e.isOpen},t.registry.register(t.registry.Type.EVENT,t.Events.TRASHCAN_OPEN,t.Events.TrashcanOpen),t.IPositionable=function(){},t.uiPosition={},t.uiPosition.verticalPosition={TOP:0,BOTTOM:1},t.uiPosition.horizontalPosition={LEFT:0,RIGHT:1},t.uiPosition.bumpDirection={UP:0,DOWN:1},t.uiPosition.getStartPositionRect=function(e,r,a,c,p,f){var T=f.scrollbar&&f.scrollbar.canScrollVertically();return e.horizontal===t.uiPosition.horizontalPosition.LEFT?(a=p.absoluteMetrics.left+a,T&&f.RTL&&(a+=t.Scrollbar.scrollbarThickness)):(a=p.absoluteMetrics.left+p.viewMetrics.width-r.width-a,T&&!f.RTL&&(a-=t.Scrollbar.scrollbarThickness)),e.vertical===t.uiPosition.verticalPosition.TOP?e=p.absoluteMetrics.top+c:(e=p.absoluteMetrics.top+p.viewMetrics.height-r.height-c,f.scrollbar&&f.scrollbar.canScrollHorizontally()&&(e-=t.Scrollbar.scrollbarThickness)),new t.utils.Rect(e,e+r.height,a,a+r.width)},t.uiPosition.getCornerOppositeToolbox=function(e,r){return{horizontal:r.toolboxMetrics.position===t.utils.toolbox.Position.LEFT||e.horizontalLayout&&!e.RTL?t.uiPosition.horizontalPosition.RIGHT:t.uiPosition.horizontalPosition.LEFT,vertical:r.toolboxMetrics.position===t.utils.toolbox.Position.BOTTOM?t.uiPosition.verticalPosition.TOP:t.uiPosition.verticalPosition.BOTTOM}},t.uiPosition.bumpPositionRect=function(e,r,a,c){for(var D,p=e.left,f=e.right-e.left,T=e.bottom-e.top,y=0;D=c[y];y++)e.intersects(D)&&(e=new t.utils.Rect(e=a===t.uiPosition.bumpDirection.UP?D.top-T-r:D.bottom+r,e+T,p,p+f),y=-1);return e},t.Trashcan=function(e){t.Trashcan.superClass_.constructor.call(this),this.workspace_=e,this.id="trashcan",this.contents_=[],this.flyout=null,0>=this.workspace_.options.maxTrashcanContents||(e=new t.Options({scrollbars:!0,parentWorkspace:this.workspace_,rtl:this.workspace_.RTL,oneBasedIndex:this.workspace_.options.oneBasedIndex,renderer:this.workspace_.options.renderer,rendererOverrides:this.workspace_.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace_.horizontalLayout?(e.toolboxPosition=this.workspace_.toolboxPosition==t.utils.toolbox.Position.TOP?t.utils.toolbox.Position.BOTTOM:t.utils.toolbox.Position.TOP,this.flyout=new(t.registry.getClassFromOptions(t.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace_.options,!0))(e)):(e.toolboxPosition=this.workspace_.toolboxPosition==t.utils.toolbox.Position.RIGHT?t.utils.toolbox.Position.LEFT:t.utils.toolbox.Position.RIGHT,this.flyout=new(t.registry.getClassFromOptions(t.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.workspace_.options,!0))(e)),this.workspace_.addChangeListener(this.onDelete_.bind(this)))},t.utils.object.inherits(t.Trashcan,t.DeleteArea),t.Trashcan.prototype.WIDTH_=47,t.Trashcan.prototype.BODY_HEIGHT_=44,t.Trashcan.prototype.LID_HEIGHT_=16,t.Trashcan.prototype.MARGIN_VERTICAL_=20,t.Trashcan.prototype.MARGIN_HORIZONTAL_=20,t.Trashcan.prototype.MARGIN_HOTSPOT_=10,t.Trashcan.prototype.SPRITE_LEFT_=0,t.Trashcan.prototype.SPRITE_TOP_=32,t.Trashcan.prototype.HAS_BLOCKS_LID_ANGLE_=.1,t.Trashcan.ANIMATION_LENGTH_=80,t.Trashcan.ANIMATION_FRAMES_=4,t.Trashcan.OPACITY_MIN_=.4,t.Trashcan.OPACITY_MAX_=.8,t.Trashcan.MAX_LID_ANGLE_=45,t.Trashcan.prototype.isLidOpen=!1,t.Trashcan.prototype.minOpenness_=0,t.Trashcan.prototype.svgGroup_=null,t.Trashcan.prototype.svgLid_=null,t.Trashcan.prototype.lidTask_=0,t.Trashcan.prototype.lidOpen_=0,t.Trashcan.prototype.left_=0,t.Trashcan.prototype.top_=0,t.Trashcan.prototype.initialized_=!1,t.Trashcan.prototype.createDom=function(){this.svgGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:"blocklyTrash"},null);var e=String(Math.random()).substring(2),r=t.utils.dom.createSvgElement(t.utils.Svg.CLIPPATH,{id:"blocklyTrashBodyClipPath"+e},this.svgGroup_);t.utils.dom.createSvgElement(t.utils.Svg.RECT,{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},r);var a=t.utils.dom.createSvgElement(t.utils.Svg.IMAGE,{width:t.SPRITE.width,x:-this.SPRITE_LEFT_,height:t.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+e+")"},this.svgGroup_);return a.setAttributeNS(t.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+t.SPRITE.url),r=t.utils.dom.createSvgElement(t.utils.Svg.CLIPPATH,{id:"blocklyTrashLidClipPath"+e},this.svgGroup_),t.utils.dom.createSvgElement(t.utils.Svg.RECT,{width:this.WIDTH_,height:this.LID_HEIGHT_},r),this.svgLid_=t.utils.dom.createSvgElement(t.utils.Svg.IMAGE,{width:t.SPRITE.width,x:-this.SPRITE_LEFT_,height:t.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+e+")"},this.svgGroup_),this.svgLid_.setAttributeNS(t.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+t.SPRITE.url),t.browserEvents.bind(this.svgGroup_,"mousedown",this,this.blockMouseDownWhenOpenable_),t.browserEvents.bind(this.svgGroup_,"mouseup",this,this.click),t.browserEvents.bind(a,"mouseover",this,this.mouseOver_),t.browserEvents.bind(a,"mouseout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_},t.Trashcan.prototype.init=function(){0<this.workspace_.options.maxTrashcanContents&&(t.utils.dom.insertAfter(this.flyout.createDom(t.utils.Svg.SVG),this.workspace_.getParentSvg()),this.flyout.init(this.workspace_)),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[t.ComponentManager.Capability.AUTOHIDEABLE,t.ComponentManager.Capability.DELETE_AREA,t.ComponentManager.Capability.DRAG_TARGET,t.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0,this.setLidOpen(!1)},t.Trashcan.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&(t.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},t.Trashcan.prototype.hasContents_=function(){return!!this.contents_.length},t.Trashcan.prototype.contentsIsOpen=function(){return this.flyout.isVisible()},t.Trashcan.prototype.openFlyout=function(){if(!this.contentsIsOpen()){var e=this.contents_.map(t.Xml.textToDom);this.flyout.show(e),this.fireUiEvent_(!0)}},t.Trashcan.prototype.closeFlyout=function(){this.contentsIsOpen()&&(this.flyout.hide(),this.fireUiEvent_(!1))},t.Trashcan.prototype.autoHide=function(e){!e&&this.flyout&&this.closeFlyout()},t.Trashcan.prototype.emptyContents=function(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())},t.Trashcan.prototype.position=function(e,r){if(this.initialized_){var a=t.uiPosition.getCornerOppositeToolbox(this.workspace_,e);e=t.uiPosition.getStartPositionRect(a,new t.utils.Size(this.WIDTH_,this.BODY_HEIGHT_+this.LID_HEIGHT_),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,e,this.workspace_),r=t.uiPosition.bumpPositionRect(e,this.MARGIN_VERTICAL_,a.vertical===t.uiPosition.verticalPosition.TOP?t.uiPosition.bumpDirection.DOWN:t.uiPosition.bumpDirection.UP,r),this.top_=r.top,this.left_=r.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},t.Trashcan.prototype.getBoundingRectangle=function(){return new t.utils.Rect(this.top_,this.top_+this.BODY_HEIGHT_+this.LID_HEIGHT_,this.left_,this.left_+this.WIDTH_)},t.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect(),r=e.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_;return new t.utils.Rect(r,r+this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_,e=e.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,e+this.WIDTH_+2*this.MARGIN_HOTSPOT_)},t.Trashcan.prototype.onDragOver=function(e){this.setLidOpen(this.wouldDelete_)},t.Trashcan.prototype.onDragExit=function(e){this.setLidOpen(!1)},t.Trashcan.prototype.onDrop=function(e){setTimeout(this.setLidOpen.bind(this,!1),100)},t.Trashcan.prototype.setLidOpen=function(e){this.isLidOpen!=e&&(clearTimeout(this.lidTask_),this.isLidOpen=e,this.animateLid_())},t.Trashcan.prototype.animateLid_=function(){var e=t.Trashcan.ANIMATION_FRAMES_,r=1/(e+1);this.lidOpen_+=this.isLidOpen?r:-r,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*t.Trashcan.MAX_LID_ANGLE_),this.svgGroup_.style.opacity=(r=t.Trashcan.OPACITY_MIN_)+this.lidOpen_*(t.Trashcan.OPACITY_MAX_-r),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),t.Trashcan.ANIMATION_LENGTH_/e))},t.Trashcan.prototype.setLidAngle_=function(e){var r=this.workspace_.toolboxPosition==t.utils.toolbox.Position.RIGHT||this.workspace_.horizontalLayout&&this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(r?-e:e)+","+(r?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")")},t.Trashcan.prototype.setMinOpenness_=function(e){this.minOpenness_=e,this.isLidOpen||this.setLidAngle_(e*t.Trashcan.MAX_LID_ANGLE_)},t.Trashcan.prototype.closeLid=function(){this.setLidOpen(!1)},t.Trashcan.prototype.click=function(){this.hasContents_()&&this.openFlyout()},t.Trashcan.prototype.fireUiEvent_=function(e){e=new(t.Events.get(t.Events.TRASHCAN_OPEN))(e,this.workspace_.id),t.Events.fire(e)},t.Trashcan.prototype.blockMouseDownWhenOpenable_=function(e){!this.contentsIsOpen()&&this.hasContents_()&&e.stopPropagation()},t.Trashcan.prototype.mouseOver_=function(){this.hasContents_()&&this.setLidOpen(!0)},t.Trashcan.prototype.mouseOut_=function(){this.setLidOpen(!1)},t.Trashcan.prototype.onDelete_=function(e){if(!(0>=this.workspace_.options.maxTrashcanContents)&&e.type==t.Events.BLOCK_DELETE&&e.oldXml.tagName&&"shadow"!=e.oldXml.tagName.toLowerCase()&&(e=this.cleanBlockXML_(e.oldXml),-1==this.contents_.indexOf(e))){for(this.contents_.unshift(e);this.contents_.length>this.workspace_.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(this.HAS_BLOCKS_LID_ANGLE_)}},t.Trashcan.prototype.cleanBlockXML_=function(e){for(var r=e=e.cloneNode(!0);r;){r.removeAttribute&&(r.removeAttribute("x"),r.removeAttribute("y"),r.removeAttribute("id"),r.removeAttribute("disabled"),"comment"==r.nodeName&&(r.removeAttribute("h"),r.removeAttribute("w"),r.removeAttribute("pinned")));var a=r.firstChild||r.nextSibling;if(!a)for(a=r.parentNode;a;){if(a.nextSibling){a=a.nextSibling;break}a=a.parentNode}r=a}return t.Xml.domToText(e)},t.VariablesDynamic={},t.VariablesDynamic.onCreateVariableButtonClick_String=function(e){t.Variables.createVariableButtonHandler(e.getTargetWorkspace(),void 0,"String")},t.VariablesDynamic.onCreateVariableButtonClick_Number=function(e){t.Variables.createVariableButtonHandler(e.getTargetWorkspace(),void 0,"Number")},t.VariablesDynamic.onCreateVariableButtonClick_Colour=function(e){t.Variables.createVariableButtonHandler(e.getTargetWorkspace(),void 0,"Colour")},t.VariablesDynamic.flyoutCategory=function(e){var r=[],a=document.createElement("button");return a.setAttribute("text",t.Msg.NEW_STRING_VARIABLE),a.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),r.push(a),(a=document.createElement("button")).setAttribute("text",t.Msg.NEW_NUMBER_VARIABLE),a.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),r.push(a),(a=document.createElement("button")).setAttribute("text",t.Msg.NEW_COLOUR_VARIABLE),a.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),r.push(a),e.registerButtonCallback("CREATE_VARIABLE_STRING",t.VariablesDynamic.onCreateVariableButtonClick_String),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",t.VariablesDynamic.onCreateVariableButtonClick_Number),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",t.VariablesDynamic.onCreateVariableButtonClick_Colour),e=t.VariablesDynamic.flyoutCategoryBlocks(e),r.concat(e)},t.VariablesDynamic.flyoutCategoryBlocks=function(e){var r=[];if(0<(e=e.getAllVariables()).length){if(t.Blocks.variables_set_dynamic){var a=e[e.length-1],c=t.utils.xml.createElement("block");c.setAttribute("type","variables_set_dynamic"),c.setAttribute("gap",24),c.appendChild(t.Variables.generateVariableFieldDom(a)),r.push(c)}if(t.Blocks.variables_get_dynamic){e.sort(t.VariableModel.compareByName),a=0;for(var p;p=e[a];a++)(c=t.utils.xml.createElement("block")).setAttribute("type","variables_get_dynamic"),c.setAttribute("gap",8),c.appendChild(t.Variables.generateVariableFieldDom(p)),r.push(c)}}return r},t.ZoomControls=function(e){this.workspace_=e,this.id="zoomControls",this.zoomResetGroup_=this.zoomOutGroup_=this.zoomInGroup_=this.onZoomOutWrapper_=this.onZoomInWrapper_=this.onZoomResetWrapper_=null},t.ZoomControls.prototype.WIDTH_=32,t.ZoomControls.prototype.HEIGHT_=32,t.ZoomControls.prototype.SMALL_SPACING_=2,t.ZoomControls.prototype.LARGE_SPACING_=11,t.ZoomControls.prototype.MARGIN_VERTICAL_=20,t.ZoomControls.prototype.MARGIN_HORIZONTAL_=20,t.ZoomControls.prototype.svgGroup_=null,t.ZoomControls.prototype.left_=0,t.ZoomControls.prototype.top_=0,t.ZoomControls.prototype.initialized_=!1,t.ZoomControls.prototype.createDom=function(){this.svgGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{},null);var e=String(Math.random()).substring(2);return this.createZoomOutSvg_(e),this.createZoomInSvg_(e),this.workspace_.isMovable()&&this.createZoomResetSvg_(e),this.svgGroup_},t.ZoomControls.prototype.init=function(){this.workspace_.getComponentManager().addComponent({component:this,weight:2,capabilities:[t.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0},t.ZoomControls.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("zoomControls"),this.svgGroup_&&t.utils.dom.removeNode(this.svgGroup_),this.onZoomResetWrapper_&&t.browserEvents.unbind(this.onZoomResetWrapper_),this.onZoomInWrapper_&&t.browserEvents.unbind(this.onZoomInWrapper_),this.onZoomOutWrapper_&&t.browserEvents.unbind(this.onZoomOutWrapper_)},t.ZoomControls.prototype.getBoundingRectangle=function(){var e=this.SMALL_SPACING_+2*this.HEIGHT_;return this.zoomResetGroup_&&(e+=this.LARGE_SPACING_+this.HEIGHT_),new t.utils.Rect(this.top_,this.top_+e,this.left_,this.left_+this.WIDTH_)},t.ZoomControls.prototype.position=function(e,r){if(this.initialized_){var a=t.uiPosition.getCornerOppositeToolbox(this.workspace_,e),c=this.SMALL_SPACING_+2*this.HEIGHT_;this.zoomResetGroup_&&(c+=this.LARGE_SPACING_+this.HEIGHT_),e=t.uiPosition.getStartPositionRect(a,new t.utils.Size(this.WIDTH_,c),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,e,this.workspace_),r=t.uiPosition.bumpPositionRect(e,this.MARGIN_VERTICAL_,(a=a.vertical)===t.uiPosition.verticalPosition.TOP?t.uiPosition.bumpDirection.DOWN:t.uiPosition.bumpDirection.UP,r),a===t.uiPosition.verticalPosition.TOP?(this.zoomInGroup_.setAttribute("transform","translate(0, "+(a=this.SMALL_SPACING_+this.HEIGHT_)+")"),this.zoomResetGroup_&&this.zoomResetGroup_.setAttribute("transform","translate(0, "+(a+this.LARGE_SPACING_+this.HEIGHT_)+")")):(this.zoomInGroup_.setAttribute("transform","translate(0, "+(a=this.zoomResetGroup_?this.LARGE_SPACING_+this.HEIGHT_:0)+")"),this.zoomOutGroup_.setAttribute("transform","translate(0, "+(a+this.SMALL_SPACING_+this.HEIGHT_)+")")),this.top_=r.top,this.left_=r.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},t.ZoomControls.prototype.createZoomOutSvg_=function(e){this.zoomOutGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var r=t.utils.dom.createSvgElement(t.utils.Svg.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup_);t.utils.dom.createSvgElement(t.utils.Svg.RECT,{width:32,height:32},r),t.utils.dom.createSvgElement(t.utils.Svg.IMAGE,{width:t.SPRITE.width,height:t.SPRITE.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup_).setAttributeNS(t.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+t.SPRITE.url),this.onZoomOutWrapper_=t.browserEvents.conditionalBind(this.zoomOutGroup_,"mousedown",null,this.zoom_.bind(this,-1))},t.ZoomControls.prototype.createZoomInSvg_=function(e){this.zoomInGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var r=t.utils.dom.createSvgElement(t.utils.Svg.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup_);t.utils.dom.createSvgElement(t.utils.Svg.RECT,{width:32,height:32},r),t.utils.dom.createSvgElement(t.utils.Svg.IMAGE,{width:t.SPRITE.width,height:t.SPRITE.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup_).setAttributeNS(t.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+t.SPRITE.url),this.onZoomInWrapper_=t.browserEvents.conditionalBind(this.zoomInGroup_,"mousedown",null,this.zoom_.bind(this,1))},t.ZoomControls.prototype.zoom_=function(e,r){this.workspace_.markFocused(),this.workspace_.zoomCenter(e),this.fireZoomEvent_(),t.Touch.clearTouchIdentifier(),r.stopPropagation(),r.preventDefault()},t.ZoomControls.prototype.createZoomResetSvg_=function(e){this.zoomResetGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var r=t.utils.dom.createSvgElement(t.utils.Svg.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup_);t.utils.dom.createSvgElement(t.utils.Svg.RECT,{width:32,height:32},r),t.utils.dom.createSvgElement(t.utils.Svg.IMAGE,{width:t.SPRITE.width,height:t.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup_).setAttributeNS(t.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+t.SPRITE.url),this.onZoomResetWrapper_=t.browserEvents.conditionalBind(this.zoomResetGroup_,"mousedown",null,this.resetZoom_.bind(this))},t.ZoomControls.prototype.resetZoom_=function(e){this.workspace_.markFocused();var r=Math.log(this.workspace_.options.zoomOptions.startScale/this.workspace_.scale)/Math.log(this.workspace_.options.zoomOptions.scaleSpeed);this.workspace_.beginCanvasTransition(),this.workspace_.zoomCenter(r),this.workspace_.scrollCenter(),setTimeout(this.workspace_.endCanvasTransition.bind(this.workspace_),500),this.fireZoomEvent_(),t.Touch.clearTouchIdentifier(),e.stopPropagation(),e.preventDefault()},t.ZoomControls.prototype.fireZoomEvent_=function(){var e=new(t.Events.get(t.Events.CLICK))(null,this.workspace_.id,"zoom_controls");t.Events.fire(e)},t.Css.register([".blocklyZoom>image, .blocklyZoom>svg>image {","opacity: .4;","}",".blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {","opacity: .6;","}",".blocklyZoom>image:active, .blocklyZoom>svg>image:active {","opacity: .8;","}"]),t.ShortcutItems={},t.ShortcutItems.names={ESCAPE:"escape",DELETE:"delete",COPY:"copy",CUT:"cut",PASTE:"paste",UNDO:"undo",REDO:"redo"},t.ShortcutItems.registerEscape=function(){var e={name:t.ShortcutItems.names.ESCAPE,preconditionFn:function(r){return!r.options.readOnly},callback:function(){return t.hideChaff(),!0}};t.ShortcutRegistry.registry.register(e),t.ShortcutRegistry.registry.addKeyMapping(t.utils.KeyCodes.ESC,e.name)},t.ShortcutItems.registerDelete=function(){var e={name:t.ShortcutItems.names.DELETE,preconditionFn:function(r){return!r.options.readOnly&&t.selected&&t.selected.isDeletable()},callback:function(r,a){return a.preventDefault(),!t.Gesture.inProgress()&&(t.deleteBlock(t.selected),!0)}};t.ShortcutRegistry.registry.register(e),t.ShortcutRegistry.registry.addKeyMapping(t.utils.KeyCodes.DELETE,e.name),t.ShortcutRegistry.registry.addKeyMapping(t.utils.KeyCodes.BACKSPACE,e.name)},t.ShortcutItems.registerCopy=function(){var e={name:t.ShortcutItems.names.COPY,preconditionFn:function(a){return!a.options.readOnly&&!t.Gesture.inProgress()&&t.selected&&t.selected.isDeletable()&&t.selected.isMovable()},callback:function(a,c){return c.preventDefault(),t.hideChaff(),t.copy(t.selected),!0}};t.ShortcutRegistry.registry.register(e);var r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.C,[t.utils.KeyCodes.CTRL]);t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.C,[t.utils.KeyCodes.ALT]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.C,[t.utils.KeyCodes.META]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name)},t.ShortcutItems.registerCut=function(){var e={name:t.ShortcutItems.names.CUT,preconditionFn:function(a){return!a.options.readOnly&&!t.Gesture.inProgress()&&t.selected&&t.selected.isDeletable()&&t.selected.isMovable()&&!t.selected.workspace.isFlyout},callback:function(){return t.copy(t.selected),t.deleteBlock(t.selected),!0}};t.ShortcutRegistry.registry.register(e);var r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.X,[t.utils.KeyCodes.CTRL]);t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.X,[t.utils.KeyCodes.ALT]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.X,[t.utils.KeyCodes.META]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name)},t.ShortcutItems.registerPaste=function(){var e={name:t.ShortcutItems.names.PASTE,preconditionFn:function(a){return!a.options.readOnly&&!t.Gesture.inProgress()},callback:function(){return t.paste()}};t.ShortcutRegistry.registry.register(e);var r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.V,[t.utils.KeyCodes.CTRL]);t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.V,[t.utils.KeyCodes.ALT]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.V,[t.utils.KeyCodes.META]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name)},t.ShortcutItems.registerUndo=function(){var e={name:t.ShortcutItems.names.UNDO,preconditionFn:function(a){return!a.options.readOnly&&!t.Gesture.inProgress()},callback:function(a){return t.hideChaff(),a.undo(!1),!0}};t.ShortcutRegistry.registry.register(e);var r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.Z,[t.utils.KeyCodes.CTRL]);t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.Z,[t.utils.KeyCodes.ALT]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.Z,[t.utils.KeyCodes.META]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name)},t.ShortcutItems.registerRedo=function(){var e={name:t.ShortcutItems.names.REDO,preconditionFn:function(a){return!t.Gesture.inProgress()&&!a.options.readOnly},callback:function(a){return t.hideChaff(),a.undo(!0),!0}};t.ShortcutRegistry.registry.register(e);var r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.Z,[t.utils.KeyCodes.SHIFT,t.utils.KeyCodes.CTRL]);t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.Z,[t.utils.KeyCodes.SHIFT,t.utils.KeyCodes.ALT]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.Z,[t.utils.KeyCodes.SHIFT,t.utils.KeyCodes.META]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=t.ShortcutRegistry.registry.createSerializedKey(t.utils.KeyCodes.Y,[t.utils.KeyCodes.CTRL]),t.ShortcutRegistry.registry.addKeyMapping(r,e.name)},t.ShortcutItems.registerDefaultShortcuts=function(){t.ShortcutItems.registerEscape(),t.ShortcutItems.registerDelete(),t.ShortcutItems.registerCopy(),t.ShortcutItems.registerCut(),t.ShortcutItems.registerPaste(),t.ShortcutItems.registerUndo(),t.ShortcutItems.registerRedo()},t.ShortcutItems.registerDefaultShortcuts(),t.ContextMenuItems={},t.ContextMenuItems.registerUndo=function(){t.ContextMenuRegistry.registry.register({displayText:function(){return t.Msg.UNDO},preconditionFn:function(e){return 0<e.workspace.getUndoStack().length?"enabled":"disabled"},callback:function(e){e.workspace.undo(!1)},scopeType:t.ContextMenuRegistry.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},t.ContextMenuItems.registerRedo=function(){t.ContextMenuRegistry.registry.register({displayText:function(){return t.Msg.REDO},preconditionFn:function(e){return 0<e.workspace.getRedoStack().length?"enabled":"disabled"},callback:function(e){e.workspace.undo(!0)},scopeType:t.ContextMenuRegistry.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},t.ContextMenuItems.registerCleanup=function(){t.ContextMenuRegistry.registry.register({displayText:function(){return t.Msg.CLEAN_UP},preconditionFn:function(e){return e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback:function(e){e.workspace.cleanUp()},scopeType:t.ContextMenuRegistry.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},t.ContextMenuItems.toggleOption_=function(e,r){for(var a=0,c=0;c<r.length;c++)for(var p=r[c];p;)setTimeout(p.setCollapsed.bind(p,e),a),p=p.getNextBlock(),a+=10},t.ContextMenuItems.registerCollapse=function(){t.ContextMenuRegistry.registry.register({displayText:function(){return t.Msg.COLLAPSE_ALL},preconditionFn:function(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(var r=0;r<e.length;r++)for(var a=e[r];a;){if(!a.isCollapsed())return"enabled";a=a.getNextBlock()}return"disabled"}return"hidden"},callback:function(e){t.ContextMenuItems.toggleOption_(!0,e.workspace.getTopBlocks(!0))},scopeType:t.ContextMenuRegistry.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},t.ContextMenuItems.registerExpand=function(){t.ContextMenuRegistry.registry.register({displayText:function(){return t.Msg.EXPAND_ALL},preconditionFn:function(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(var r=0;r<e.length;r++)for(var a=e[r];a;){if(a.isCollapsed())return"enabled";a=a.getNextBlock()}return"disabled"}return"hidden"},callback:function(e){t.ContextMenuItems.toggleOption_(!1,e.workspace.getTopBlocks(!0))},scopeType:t.ContextMenuRegistry.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},t.ContextMenuItems.addDeletableBlocks_=function(e,r){if(e.isDeletable())Array.prototype.push.apply(r,e.getDescendants(!1));else{e=e.getChildren(!1);for(var a=0;a<e.length;a++)t.ContextMenuItems.addDeletableBlocks_(e[a],r)}},t.ContextMenuItems.getDeletableBlocks_=function(e){var r=[];e=e.getTopBlocks(!0);for(var a=0;a<e.length;a++)t.ContextMenuItems.addDeletableBlocks_(e[a],r);return r},t.ContextMenuItems.deleteNext_=function(e,r){t.Events.setGroup(r);var a=e.shift();a&&(a.workspace?(a.dispose(!1,!0),setTimeout(t.ContextMenuItems.deleteNext_,10,e,r)):t.ContextMenuItems.deleteNext_(e,r)),t.Events.setGroup(!1)},t.ContextMenuItems.registerDeleteAll=function(){t.ContextMenuRegistry.registry.register({displayText:function(e){if(e.workspace)return 1==(e=t.ContextMenuItems.getDeletableBlocks_(e.workspace).length)?t.Msg.DELETE_BLOCK:t.Msg.DELETE_X_BLOCKS.replace("%1",String(e))},preconditionFn:function(e){if(e.workspace)return 0<t.ContextMenuItems.getDeletableBlocks_(e.workspace).length?"enabled":"disabled"},callback:function(e){if(e.workspace){e.workspace.cancelCurrentGesture();var r=t.ContextMenuItems.getDeletableBlocks_(e.workspace),a=t.utils.genUid();2>r.length?t.ContextMenuItems.deleteNext_(r,a):t.confirm(t.Msg.DELETE_ALL_BLOCKS.replace("%1",r.length),function(c){c&&t.ContextMenuItems.deleteNext_(r,a)})}},scopeType:t.ContextMenuRegistry.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},t.ContextMenuItems.registerWorkspaceOptions_=function(){t.ContextMenuItems.registerUndo(),t.ContextMenuItems.registerRedo(),t.ContextMenuItems.registerCleanup(),t.ContextMenuItems.registerCollapse(),t.ContextMenuItems.registerExpand(),t.ContextMenuItems.registerDeleteAll()},t.ContextMenuItems.registerDuplicate=function(){t.ContextMenuRegistry.registry.register({displayText:function(){return t.Msg.DUPLICATE_BLOCK},preconditionFn:function(e){return!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback:function(e){e.block&&t.duplicate(e.block)},scopeType:t.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},t.ContextMenuItems.registerComment=function(){t.ContextMenuRegistry.registry.register({displayText:function(e){return e.block.getCommentIcon()?t.Msg.REMOVE_COMMENT:t.Msg.ADD_COMMENT},preconditionFn:function(e){return e=e.block,t.utils.userAgent.IE||e.isInFlyout||!e.workspace.options.comments||e.isCollapsed()||!e.isEditable()?"hidden":"enabled"},callback:function(e){(e=e.block).getCommentIcon()?e.setCommentText(null):e.setCommentText("")},scopeType:t.ContextMenuRegistry.ScopeType.BLOCK,id:"blockComment",weight:2})},t.ContextMenuItems.registerInline=function(){t.ContextMenuRegistry.registry.register({displayText:function(e){return e.block.getInputsInline()?t.Msg.EXTERNAL_INPUTS:t.Msg.INLINE_INPUTS},preconditionFn:function(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed())for(var r=1;r<e.inputList.length;r++)if(e.inputList[r-1].type!=t.inputTypes.STATEMENT&&e.inputList[r].type!=t.inputTypes.STATEMENT)return"enabled";return"hidden"},callback:function(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:t.ContextMenuRegistry.ScopeType.BLOCK,id:"blockInline",weight:3})},t.ContextMenuItems.registerCollapseExpandBlock=function(){t.ContextMenuRegistry.registry.register({displayText:function(e){return e.block.isCollapsed()?t.Msg.EXPAND_BLOCK:t.Msg.COLLAPSE_BLOCK},preconditionFn:function(e){return!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback:function(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:t.ContextMenuRegistry.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},t.ContextMenuItems.registerDisable=function(){t.ContextMenuRegistry.registry.register({displayText:function(e){return e.block.isEnabled()?t.Msg.DISABLE_BLOCK:t.Msg.ENABLE_BLOCK},preconditionFn:function(e){return!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()?e.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback:function(e){e=e.block;var r=t.Events.getGroup();r||t.Events.setGroup(!0),e.setEnabled(!e.isEnabled()),r||t.Events.setGroup(!1)},scopeType:t.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDisable",weight:5})},t.ContextMenuItems.registerDelete=function(){t.ContextMenuRegistry.registry.register({displayText:function(e){var r=e.block;return e=r.getDescendants(!1).length,(r=r.getNextBlock())&&(e-=r.getDescendants(!1).length),1==e?t.Msg.DELETE_BLOCK:t.Msg.DELETE_X_BLOCKS.replace("%1",String(e))},preconditionFn:function(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback:function(e){t.Events.setGroup(!0),e.block&&t.deleteBlock(e.block),t.Events.setGroup(!1)},scopeType:t.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDelete",weight:6})},t.ContextMenuItems.registerHelp=function(){t.ContextMenuRegistry.registry.register({displayText:function(){return t.Msg.HELP},preconditionFn:function(e){return("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback:function(e){e.block.showHelp()},scopeType:t.ContextMenuRegistry.ScopeType.BLOCK,id:"blockHelp",weight:7})},t.ContextMenuItems.registerBlockOptions_=function(){t.ContextMenuItems.registerDuplicate(),t.ContextMenuItems.registerComment(),t.ContextMenuItems.registerInline(),t.ContextMenuItems.registerCollapseExpandBlock(),t.ContextMenuItems.registerDisable(),t.ContextMenuItems.registerDelete(),t.ContextMenuItems.registerHelp()},t.ContextMenuItems.registerDefaultOptions=function(){t.ContextMenuItems.registerWorkspaceOptions_(),t.ContextMenuItems.registerBlockOptions_()},t.ContextMenuItems.registerDefaultOptions(),t.Mutator=function(e){t.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=e},t.utils.object.inherits(t.Mutator,t.Icon),t.Mutator.prototype.workspace_=null,t.Mutator.prototype.workspaceWidth_=0,t.Mutator.prototype.workspaceHeight_=0,t.Mutator.prototype.setBlock=function(e){this.block_=e},t.Mutator.prototype.getWorkspace=function(){return this.workspace_},t.Mutator.prototype.drawIcon_=function(e){t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},e),t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},e),t.utils.dom.createSvgElement(t.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},e)},t.Mutator.prototype.iconClick_=function(e){this.block_.isEditable()&&t.Icon.prototype.iconClick_.call(this,e)},t.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=t.utils.dom.createSvgElement(t.utils.Svg.SVG,{x:t.Bubble.BORDER_WIDTH,y:t.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var a,e=t.utils.xml.createElement("xml"),r=0;a=this.quarkNames_[r];r++){var c=t.utils.xml.createElement("block");c.setAttribute("type",a),e.appendChild(c)}else e=null;return(r=new t.Options({disable:!1,parentWorkspace:this.block_.workspace,media:this.block_.workspace.options.pathToMedia,rtl:this.block_.RTL,horizontalLayout:!1,renderer:this.block_.workspace.options.renderer,rendererOverrides:this.block_.workspace.options.rendererOverrides})).toolboxPosition=this.block_.RTL?t.utils.toolbox.Position.RIGHT:t.utils.toolbox.Position.LEFT,(a=!!e)&&(r.languageTree=t.utils.toolbox.convertToolboxDefToJson(e)),this.workspace_=new t.WorkspaceSvg(r),this.workspace_.isMutator=!0,this.workspace_.addChangeListener(t.Events.disableOrphans),e=a?this.workspace_.addFlyout(t.utils.Svg.G):null,r=this.workspace_.createDom("blocklyMutatorBackground"),e&&r.insertBefore(e,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(r),this.svgDialog_},t.Mutator.prototype.updateEditable=function(){t.Mutator.superClass_.updateEditable.call(this),this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&t.utils.dom.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&t.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly")))},t.Mutator.prototype.resizeBubble_=function(){var e=2*t.Bubble.BORDER_WIDTH,r=this.workspace_.getCanvas().getBBox(),a=r.width+r.x,c=r.height+3*e,p=this.workspace_.getFlyout();if(p){var f=p.getWorkspace().getMetricsManager().getScrollMetrics();c=Math.max(c,f.height+20),a+=p.getWidth()}this.block_.RTL&&(a=-r.x),a+=3*e,(Math.abs(this.workspaceWidth_-a)>e||Math.abs(this.workspaceHeight_-c)>e)&&(this.workspaceWidth_=a,this.workspaceHeight_=c,this.bubble_.setBubbleSize(a+e,c+e),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_),this.workspace_.setCachedParentSvgSize(this.workspaceWidth_,this.workspaceHeight_)),this.block_.RTL&&(e="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",e)),this.workspace_.resize()},t.Mutator.prototype.onBubbleMove_=function(){this.workspace_&&this.workspace_.recordDragTargets()},t.Mutator.prototype.setVisible=function(e){if(e!=this.isVisible())if(t.Events.fire(new(t.Events.get(t.Events.BUBBLE_OPEN))(this.block_,e,"mutator")),e){this.bubble_=new t.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerMoveEvent(this.onBubbleMove_.bind(this));var r=this.workspace_.options.languageTree;e=this.workspace_.getFlyout(),r&&(e.init(this.workspace_),e.show(r)),this.rootBlock_=this.block_.decompose(this.workspace_),r=this.rootBlock_.getDescendants(!1);for(var c,a=0;c=r[a];a++)c.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),e?(r=2*e.CORNER_RADIUS,e=this.rootBlock_.RTL?e.getWidth()+r:r):e=r=16,this.block_.RTL&&(e=-e),this.rootBlock_.moveBy(e,r),this.block_.saveConnections){var p=this,f=this.block_;f.saveConnections(this.rootBlock_),this.sourceListener_=function(){f.saveConnections(p.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.applyColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},t.Mutator.prototype.workspaceChanged_=function(e){if(!(e.isUiEvent||e.type==t.Events.CHANGE&&"disabled"==e.element)){if(!this.workspace_.isDragging()){e=this.workspace_.getTopBlocks(!1);for(var a,r=0;a=e[r];r++){var c=a.getRelativeToSurfaceXY();if(20>c.y&&a.moveBy(0,20-c.y),a.RTL){var p=-20,f=this.workspace_.getFlyout();f&&(p-=f.getWidth()),c.x>p&&a.moveBy(p-c.x,0)}else 20>c.x&&a.moveBy(20-c.x,0)}}if(this.rootBlock_.workspace==this.workspace_){if(t.Events.setGroup(!0),e=(e=(a=this.block_).mutationToDom())&&t.Xml.domToText(e),r=a.rendered,a.rendered=!1,a.compose(this.rootBlock_),a.rendered=r,a.initSvg(),a.rendered&&a.render(),e!=(r=(r=a.mutationToDom())&&t.Xml.domToText(r))){t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(a,"mutation",null,e,r));var T=t.Events.getGroup();setTimeout(function(){t.Events.setGroup(T),a.bumpNeighbours(),t.Events.setGroup(!1)},t.BUMP_DELAY)}this.workspace_.isDragging()||this.resizeBubble_(),t.Events.setGroup(!1)}}},t.Mutator.prototype.dispose=function(){this.block_.mutator=null,t.Icon.prototype.dispose.call(this)},t.Mutator.prototype.updateBlockStyle=function(){var e=this.workspace_;if(e&&e.getAllBlocks(!1)){for(var c,r=e.getAllBlocks(!1),a=0;c=r[a];a++)c.setStyle(c.getStyleName());if(a=e.getFlyout())for(e=a.workspace_.getAllBlocks(!1),a=0;c=e[a];a++)c.setStyle(c.getStyleName())}},t.Mutator.reconnect=function(e,r,a){if(!e||!e.getSourceBlock().workspace)return!1;a=r.getInput(a).connection;var c=e.targetBlock();return!(c&&c!=r||a.targetConnection==e||(a.isConnected()&&a.disconnect(),a.connect(e),0))},t.Mutator.findParentWs=function(e){var r=null;if(e&&e.options){var a=e.options.parentWorkspace;e.isFlyout?a&&a.options&&(r=a.options.parentWorkspace):a&&(r=a)}return r},t.FieldTextInput=function(e,r,a){this.spellcheck_=!0,t.FieldTextInput.superClass_.constructor.call(this,e,r,a),this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.htmlInput_=null,this.fullBlockClickTarget_=!1,this.workspace_=null},t.utils.object.inherits(t.FieldTextInput,t.Field),t.FieldTextInput.prototype.DEFAULT_VALUE="",t.FieldTextInput.fromJson=function(e){var r=t.utils.replaceMessageReferences(e.text);return new t.FieldTextInput(r,void 0,e)},t.FieldTextInput.prototype.SERIALIZABLE=!0,t.FieldTextInput.BORDERRADIUS=4,t.FieldTextInput.prototype.CURSOR="text",t.FieldTextInput.prototype.configure_=function(e){t.FieldTextInput.superClass_.configure_.call(this,e),"boolean"==typeof e.spellcheck&&(this.spellcheck_=e.spellcheck)},t.FieldTextInput.prototype.initView=function(){if(this.getConstants().FULL_BLOCK_FIELDS){for(var c,e=0,r=0,a=0;c=this.sourceBlock_.inputList[a];a++){for(var p=0;c.fieldRow[p];p++)e++;c.connection&&r++}this.fullBlockClickTarget_=1>=e&&this.sourceBlock_.outputConnection&&!r}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()},t.FieldTextInput.prototype.doClassValidation_=function(e){return null==e?null:String(e)},t.FieldTextInput.prototype.doValueInvalid_=function(e){this.isBeingEdited_&&(this.isTextValid_=!1,e=this.value_,this.value_=this.htmlInput_.untypedDefaultValue_,this.sourceBlock_&&t.Events.isEnabled()&&t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))},t.FieldTextInput.prototype.doValueUpdate_=function(e){this.isTextValid_=!0,this.value_=e,this.isBeingEdited_||(this.isDirty_=!0)},t.FieldTextInput.prototype.applyColour=function(){this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS&&(this.borderRect_?this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR))},t.FieldTextInput.prototype.render_=function(){if(t.FieldTextInput.superClass_.render_.call(this),this.isBeingEdited_){this.resizeEditor_();var e=this.htmlInput_;this.isTextValid_?(t.utils.dom.removeClass(e,"blocklyInvalidInput"),t.utils.aria.setState(e,t.utils.aria.State.INVALID,!1)):(t.utils.dom.addClass(e,"blocklyInvalidInput"),t.utils.aria.setState(e,t.utils.aria.State.INVALID,!0))}},t.FieldTextInput.prototype.setSpellcheck=function(e){e!=this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))},t.FieldTextInput.prototype.showEditor_=function(e,r){this.workspace_=this.sourceBlock_.workspace,!(e=r||!1)&&(t.utils.userAgent.MOBILE||t.utils.userAgent.ANDROID||t.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(e)},t.FieldTextInput.prototype.showPromptEditor_=function(){t.prompt(t.Msg.CHANGE_VALUE_TITLE,this.getText(),function(e){this.setValue(this.getValueFromEditorText_(e))}.bind(this))},t.FieldTextInput.prototype.showInlineEditor_=function(e){t.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())},t.FieldTextInput.prototype.widgetCreate_=function(){var e=t.WidgetDiv.DIV;t.utils.dom.addClass(this.getClickTarget_(),"editing");var r=document.createElement("input");r.className="blocklyHtmlInput",r.setAttribute("spellcheck",this.spellcheck_);var a=this.workspace_.getScale(),c=this.getConstants().FIELD_TEXT_FONTSIZE*a+"pt";if(e.style.fontSize=c,r.style.fontSize=c,c=t.FieldTextInput.BORDERRADIUS*a+"px",this.fullBlockClickTarget_){c=((c=this.getScaledBBox()).bottom-c.top)/2+"px";var p=this.sourceBlock_.getParent()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;r.style.border=1*a+"px solid "+p,e.style.borderRadius=c,e.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(e.style.boxShadow="rgba(255, 255, 255, 0.3) 0px 0px 0px "+4*a+"px")}return r.style.borderRadius=c,e.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.untypedDefaultValue_=this.value_,r.oldValue_=null,this.resizeEditor_(),this.bindInputEvents_(r),r},t.FieldTextInput.prototype.widgetDispose_=function(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_&&this.onFinishEditing_(this.value_),this.unbindInputEvents_();var e=t.WidgetDiv.DIV.style;e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,t.utils.dom.removeClass(this.getClickTarget_(),"editing")},t.FieldTextInput.prototype.bindInputEvents_=function(e){this.onKeyDownWrapper_=t.browserEvents.conditionalBind(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=t.browserEvents.conditionalBind(e,"input",this,this.onHtmlInputChange_)},t.FieldTextInput.prototype.unbindInputEvents_=function(){this.onKeyDownWrapper_&&(t.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(t.browserEvents.unbind(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)},t.FieldTextInput.prototype.onHtmlInputKeyDown_=function(e){e.keyCode==t.utils.KeyCodes.ENTER?(t.WidgetDiv.hide(),t.DropDownDiv.hideWithoutAnimation()):e.keyCode==t.utils.KeyCodes.ESC?(this.setValue(this.htmlInput_.untypedDefaultValue_),t.WidgetDiv.hide(),t.DropDownDiv.hideWithoutAnimation()):e.keyCode==t.utils.KeyCodes.TAB&&(t.WidgetDiv.hide(),t.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())},t.FieldTextInput.prototype.onHtmlInputChange_=function(e){(e=this.htmlInput_.value)!==this.htmlInput_.oldValue_&&(this.htmlInput_.oldValue_=e,t.Events.setGroup(!0),e=this.getValueFromEditorText_(e),this.setValue(e),this.forceRerender(),this.resizeEditor_(),t.Events.setGroup(!1))},t.FieldTextInput.prototype.setEditorValue_=function(e){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e)},t.FieldTextInput.prototype.resizeEditor_=function(){var e=t.WidgetDiv.DIV,r=this.getScaledBBox();e.style.width=r.right-r.left+"px",e.style.height=r.bottom-r.top+"px",r=new t.utils.Coordinate(this.sourceBlock_.RTL?r.right-e.offsetWidth:r.left,r.top),e.style.left=r.x+"px",e.style.top=r.y+"px"},t.FieldTextInput.prototype.isTabNavigable=function(){return!0},t.FieldTextInput.prototype.getText_=function(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null},t.FieldTextInput.prototype.getEditorText_=function(e){return String(e)},t.FieldTextInput.prototype.getValueFromEditorText_=function(e){return e},t.fieldRegistry.register("field_input",t.FieldTextInput),t.FieldAngle=function(e,r,a){this.clockwise_=t.FieldAngle.CLOCKWISE,this.offset_=t.FieldAngle.OFFSET,this.wrap_=t.FieldAngle.WRAP,this.round_=t.FieldAngle.ROUND,t.FieldAngle.superClass_.constructor.call(this,e,r,a),this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.line_=this.gauge_=this.editor_=null},t.utils.object.inherits(t.FieldAngle,t.FieldTextInput),t.FieldAngle.prototype.DEFAULT_VALUE=0,t.FieldAngle.fromJson=function(e){return new t.FieldAngle(e.angle,void 0,e)},t.FieldAngle.prototype.SERIALIZABLE=!0,t.FieldAngle.ROUND=15,t.FieldAngle.HALF=50,t.FieldAngle.CLOCKWISE=!1,t.FieldAngle.OFFSET=0,t.FieldAngle.WRAP=360,t.FieldAngle.RADIUS=t.FieldAngle.HALF-1,t.FieldAngle.prototype.configure_=function(e){switch(t.FieldAngle.superClass_.configure_.call(this,e),e.mode){case"compass":this.clockwise_=!0,this.offset_=90;break;case"protractor":this.clockwise_=!1,this.offset_=0}var r=e.clockwise;"boolean"==typeof r&&(this.clockwise_=r),null!=(r=e.offset)&&(r=Number(r),isNaN(r)||(this.offset_=r)),null!=(r=e.wrap)&&(r=Number(r),isNaN(r)||(this.wrap_=r)),null!=(e=e.round)&&(e=Number(e),isNaN(e)||(this.round_=e))},t.FieldAngle.prototype.initView=function(){t.FieldAngle.superClass_.initView.call(this),this.symbol_=t.utils.dom.createSvgElement(t.utils.Svg.TSPAN,{},null),this.symbol_.appendChild(document.createTextNode("\xb0")),this.textElement_.appendChild(this.symbol_)},t.FieldAngle.prototype.render_=function(){t.FieldAngle.superClass_.render_.call(this),this.updateGraph_()},t.FieldAngle.prototype.showEditor_=function(e){t.FieldAngle.superClass_.showEditor_.call(this,e,t.utils.userAgent.MOBILE||t.utils.userAgent.ANDROID||t.utils.userAgent.IPAD),this.dropdownCreate_(),t.DropDownDiv.getContentDiv().appendChild(this.editor_),t.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),t.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.updateGraph_()},t.FieldAngle.prototype.dropdownCreate_=function(){var e=t.utils.dom.createSvgElement(t.utils.Svg.SVG,{xmlns:t.utils.dom.SVG_NS,"xmlns:html":t.utils.dom.HTML_NS,"xmlns:xlink":t.utils.dom.XLINK_NS,version:"1.1",height:2*t.FieldAngle.HALF+"px",width:2*t.FieldAngle.HALF+"px",style:"touch-action: none"},null),r=t.utils.dom.createSvgElement(t.utils.Svg.CIRCLE,{cx:t.FieldAngle.HALF,cy:t.FieldAngle.HALF,r:t.FieldAngle.RADIUS,class:"blocklyAngleCircle"},e);this.gauge_=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyAngleGauge"},e),this.line_=t.utils.dom.createSvgElement(t.utils.Svg.LINE,{x1:t.FieldAngle.HALF,y1:t.FieldAngle.HALF,class:"blocklyAngleLine"},e);for(var a=0;360>a;a+=15)t.utils.dom.createSvgElement(t.utils.Svg.LINE,{x1:t.FieldAngle.HALF+t.FieldAngle.RADIUS,y1:t.FieldAngle.HALF,x2:t.FieldAngle.HALF+t.FieldAngle.RADIUS-(a%45==0?10:5),y2:t.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+a+","+t.FieldAngle.HALF+","+t.FieldAngle.HALF+")"},e);this.clickWrapper_=t.browserEvents.conditionalBind(e,"click",this,this.hide_),this.clickSurfaceWrapper_=t.browserEvents.conditionalBind(r,"click",this,this.onMouseMove_,!0,!0),this.moveSurfaceWrapper_=t.browserEvents.conditionalBind(r,"mousemove",this,this.onMouseMove_,!0,!0),this.editor_=e},t.FieldAngle.prototype.dropdownDispose_=function(){this.clickWrapper_&&(t.browserEvents.unbind(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(t.browserEvents.unbind(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(t.browserEvents.unbind(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null},t.FieldAngle.prototype.hide_=function(){t.DropDownDiv.hideIfOwner(this),t.WidgetDiv.hide()},t.FieldAngle.prototype.onMouseMove_=function(e){var r=this.gauge_.ownerSVGElement.getBoundingClientRect(),a=e.clientX-r.left-t.FieldAngle.HALF;e=e.clientY-r.top-t.FieldAngle.HALF,r=Math.atan(-e/a),isNaN(r)||(r=t.utils.math.toDegrees(r),0>a?r+=180:0<e&&(r+=360),this.displayMouseOrKeyboardValue_(r=this.clockwise_?this.offset_+360-r:360-(this.offset_-r)))},t.FieldAngle.prototype.displayMouseOrKeyboardValue_=function(e){this.round_&&(e=Math.round(e/this.round_)*this.round_),(e=this.wrapValue_(e))!=this.value_&&this.setEditorValue_(e)},t.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var e=Number(this.getText())+this.offset_,r=t.utils.math.toRadians(e%360);e=["M ",t.FieldAngle.HALF,",",t.FieldAngle.HALF];var a=t.FieldAngle.HALF,c=t.FieldAngle.HALF;if(!isNaN(r)){var p=Number(this.clockwise_),f=t.utils.math.toRadians(this.offset_),T=Math.cos(f)*t.FieldAngle.RADIUS,y=Math.sin(f)*-t.FieldAngle.RADIUS;p&&(r=2*f-r),a+=Math.cos(r)*t.FieldAngle.RADIUS,c-=Math.sin(r)*t.FieldAngle.RADIUS,r=Math.abs(Math.floor((r-f)/Math.PI)%2),p&&(r=1-r),e.push(" l ",T,",",y," A ",t.FieldAngle.RADIUS,",",t.FieldAngle.RADIUS," 0 ",r," ",p," ",a,",",c," z")}this.gauge_.setAttribute("d",e.join("")),this.line_.setAttribute("x2",a),this.line_.setAttribute("y2",c)}},t.FieldAngle.prototype.onHtmlInputKeyDown_=function(e){var r;if(t.FieldAngle.superClass_.onHtmlInputKeyDown_.call(this,e),e.keyCode===t.utils.KeyCodes.LEFT?r=this.sourceBlock_.RTL?1:-1:e.keyCode===t.utils.KeyCodes.RIGHT?r=this.sourceBlock_.RTL?-1:1:e.keyCode===t.utils.KeyCodes.DOWN?r=-1:e.keyCode===t.utils.KeyCodes.UP&&(r=1),r){var a=this.getValue();this.displayMouseOrKeyboardValue_(a+r*this.round_),e.preventDefault(),e.stopPropagation()}},t.FieldAngle.prototype.doClassValidation_=function(e){return e=Number(e),isNaN(e)||!isFinite(e)?null:this.wrapValue_(e)},t.FieldAngle.prototype.wrapValue_=function(e){return 0>(e%=360)&&(e+=360),e>this.wrap_&&(e-=360),e},t.Css.register(".blocklyAngleCircle {,stroke: #444;,stroke-width: 1;,fill: #ddd;,fill-opacity: .8;,},.blocklyAngleMarks {,stroke: #444;,stroke-width: 1;,},.blocklyAngleGauge {,fill: #f88;,fill-opacity: .8;,pointer-events: none;,},.blocklyAngleLine {,stroke: #f00;,stroke-width: 2;,stroke-linecap: round;,pointer-events: none;,}".split(",")),t.fieldRegistry.register("field_angle",t.FieldAngle),t.FieldCheckbox=function(e,r,a){this.checkChar_=null,t.FieldCheckbox.superClass_.constructor.call(this,e,r,a)},t.utils.object.inherits(t.FieldCheckbox,t.Field),t.FieldCheckbox.prototype.DEFAULT_VALUE=!1,t.FieldCheckbox.fromJson=function(e){return new t.FieldCheckbox(e.checked,void 0,e)},t.FieldCheckbox.CHECK_CHAR="\u2713",t.FieldCheckbox.prototype.SERIALIZABLE=!0,t.FieldCheckbox.prototype.CURSOR="default",t.FieldCheckbox.prototype.configure_=function(e){t.FieldCheckbox.superClass_.configure_.call(this,e),e.checkCharacter&&(this.checkChar_=e.checkCharacter)},t.FieldCheckbox.prototype.initView=function(){t.FieldCheckbox.superClass_.initView.call(this),t.utils.dom.addClass(this.textElement_,"blocklyCheckbox"),this.textElement_.style.display=this.value_?"block":"none"},t.FieldCheckbox.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)},t.FieldCheckbox.prototype.getDisplayText_=function(){return this.checkChar_||t.FieldCheckbox.CHECK_CHAR},t.FieldCheckbox.prototype.setCheckCharacter=function(e){this.checkChar_=e,this.forceRerender()},t.FieldCheckbox.prototype.showEditor_=function(){this.setValue(!this.value_)},t.FieldCheckbox.prototype.doClassValidation_=function(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null},t.FieldCheckbox.prototype.doValueUpdate_=function(e){this.value_=this.convertValueToBool_(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")},t.FieldCheckbox.prototype.getValue=function(){return this.value_?"TRUE":"FALSE"},t.FieldCheckbox.prototype.getValueBoolean=function(){return this.value_},t.FieldCheckbox.prototype.getText=function(){return String(this.convertValueToBool_(this.value_))},t.FieldCheckbox.prototype.convertValueToBool_=function(e){return"string"==typeof e?"TRUE"==e:!!e},t.fieldRegistry.register("field_checkbox",t.FieldCheckbox),t.FieldColour=function(e,r,a){t.FieldColour.superClass_.constructor.call(this,e,r,a),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null},t.utils.object.inherits(t.FieldColour,t.Field),t.FieldColour.fromJson=function(e){return new t.FieldColour(e.colour,void 0,e)},t.FieldColour.prototype.SERIALIZABLE=!0,t.FieldColour.prototype.CURSOR="default",t.FieldColour.prototype.isDirty_=!1,t.FieldColour.prototype.colours_=null,t.FieldColour.prototype.titles_=null,t.FieldColour.prototype.columns_=0,t.FieldColour.prototype.configure_=function(e){t.FieldColour.superClass_.configure_.call(this,e),e.colourOptions&&(this.colours_=e.colourOptions,this.titles_=e.colourTitles),e.columns&&(this.columns_=e.columns)},t.FieldColour.prototype.initView=function(){this.size_=new t.utils.Size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.clickTarget_=this.sourceBlock_.getSvgRoot():(this.createBorderRect_(),this.borderRect_.style.fillOpacity="1")},t.FieldColour.prototype.applyColour=function(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())},t.FieldColour.prototype.doClassValidation_=function(e){return"string"!=typeof e?null:t.utils.colour.parse(e)},t.FieldColour.prototype.doValueUpdate_=function(e){this.value_=e,this.borderRect_?this.borderRect_.style.fill=e:this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",e),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))},t.FieldColour.prototype.getText=function(){var e=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(e)&&(e="#"+e[1]+e[3]+e[5]),e},t.FieldColour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),t.FieldColour.prototype.DEFAULT_VALUE=t.FieldColour.COLOURS[0],t.FieldColour.TITLES=[],t.FieldColour.COLUMNS=7,t.FieldColour.prototype.setColours=function(e,r){return this.colours_=e,r&&(this.titles_=r),this},t.FieldColour.prototype.setColumns=function(e){return this.columns_=e,this},t.FieldColour.prototype.showEditor_=function(){this.dropdownCreate_(),t.DropDownDiv.getContentDiv().appendChild(this.picker_),t.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:!0})},t.FieldColour.prototype.onClick_=function(e){null!==(e=(e=e.target)&&e.label)&&(this.setValue(e),t.DropDownDiv.hideIfOwner(this))},t.FieldColour.prototype.onKeyDown_=function(e){var r=!1;e.keyCode===t.utils.KeyCodes.UP?(this.moveHighlightBy_(0,-1),r=!0):e.keyCode===t.utils.KeyCodes.DOWN?(this.moveHighlightBy_(0,1),r=!0):e.keyCode===t.utils.KeyCodes.LEFT?(this.moveHighlightBy_(-1,0),r=!0):e.keyCode===t.utils.KeyCodes.RIGHT?(this.moveHighlightBy_(1,0),r=!0):e.keyCode===t.utils.KeyCodes.ENTER&&((r=this.getHighlighted_())&&null!==(r=r&&r.label)&&this.setValue(r),t.DropDownDiv.hideWithoutAnimation(),r=!0),r&&e.stopPropagation()},t.FieldColour.prototype.moveHighlightBy_=function(e,r){var a=this.colours_||t.FieldColour.COLOURS,c=this.columns_||t.FieldColour.COLUMNS,p=this.highlightedIndex_%c,f=Math.floor(this.highlightedIndex_/c);p+=e,f+=r,0>e?0>p&&0<f?(p=c-1,f--):0>p&&(p=0):0<e?p>c-1&&f<Math.floor(a.length/c)-1?(p=0,f++):p>c-1&&p--:0>r?0>f&&(f=0):0<r&&f>Math.floor(a.length/c)-1&&(f=Math.floor(a.length/c)-1),this.setHighlightedCell_(this.picker_.childNodes[f].childNodes[p],f*c+p)},t.FieldColour.prototype.onMouseMove_=function(e){var r=(e=e.target)&&Number(e.getAttribute("data-index"));null!==r&&r!==this.highlightedIndex_&&this.setHighlightedCell_(e,r)},t.FieldColour.prototype.onMouseEnter_=function(){this.picker_.focus({preventScroll:!0})},t.FieldColour.prototype.onMouseLeave_=function(){this.picker_.blur();var e=this.getHighlighted_();e&&t.utils.dom.removeClass(e,"blocklyColourHighlighted")},t.FieldColour.prototype.getHighlighted_=function(){var e=this.columns_||t.FieldColour.COLUMNS,r=this.picker_.childNodes[Math.floor(this.highlightedIndex_/e)];return r?r.childNodes[this.highlightedIndex_%e]:null},t.FieldColour.prototype.setHighlightedCell_=function(e,r){var a=this.getHighlighted_();a&&t.utils.dom.removeClass(a,"blocklyColourHighlighted"),t.utils.dom.addClass(e,"blocklyColourHighlighted"),this.highlightedIndex_=r,t.utils.aria.setState(this.picker_,t.utils.aria.State.ACTIVEDESCENDANT,e.getAttribute("id"))},t.FieldColour.prototype.dropdownCreate_=function(){var e=this.columns_||t.FieldColour.COLUMNS,r=this.colours_||t.FieldColour.COLOURS,a=this.titles_||t.FieldColour.TITLES,c=this.getValue(),p=document.createElement("table");p.className="blocklyColourTable",p.tabIndex=0,p.dir="ltr",t.utils.aria.setRole(p,t.utils.aria.Role.GRID),t.utils.aria.setState(p,t.utils.aria.State.EXPANDED,!0),t.utils.aria.setState(p,t.utils.aria.State.ROWCOUNT,Math.floor(r.length/e)),t.utils.aria.setState(p,t.utils.aria.State.COLCOUNT,e);for(var f,T=0;T<r.length;T++){T%e==0&&(f=document.createElement("tr"),t.utils.aria.setRole(f,t.utils.aria.Role.ROW),p.appendChild(f));var y=document.createElement("td");f.appendChild(y),y.label=r[T],y.title=a[T]||r[T],y.id=t.utils.IdGenerator.getNextUniqueId(),y.setAttribute("data-index",T),t.utils.aria.setRole(y,t.utils.aria.Role.GRIDCELL),t.utils.aria.setState(y,t.utils.aria.State.LABEL,r[T]),t.utils.aria.setState(y,t.utils.aria.State.SELECTED,r[T]==c),y.style.backgroundColor=r[T],r[T]==c&&(y.className="blocklyColourSelected",this.highlightedIndex_=T)}this.onClickWrapper_=t.browserEvents.conditionalBind(p,"click",this,this.onClick_,!0),this.onMouseMoveWrapper_=t.browserEvents.conditionalBind(p,"mousemove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=t.browserEvents.conditionalBind(p,"mouseenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=t.browserEvents.conditionalBind(p,"mouseleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=t.browserEvents.conditionalBind(p,"keydown",this,this.onKeyDown_),this.picker_=p},t.FieldColour.prototype.dropdownDispose_=function(){this.onClickWrapper_&&(t.browserEvents.unbind(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(t.browserEvents.unbind(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(t.browserEvents.unbind(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(t.browserEvents.unbind(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(t.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null},t.Css.register([".blocklyColourTable {","border-collapse: collapse;","display: block;","outline: none;","padding: 1px;","}",".blocklyColourTable>tr>td {","border: .5px solid #888;","box-sizing: border-box;","cursor: pointer;","display: inline-block;","height: 20px;","padding: 0;","width: 20px;","}",".blocklyColourTable>tr>td.blocklyColourHighlighted {","border-color: #eee;","box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);","position: relative;","}",".blocklyColourSelected, .blocklyColourSelected:hover {","border-color: #eee !important;","outline: 1px solid #333;","position: relative;","}"]),t.fieldRegistry.register("field_colour",t.FieldColour),t.FieldDropdown=function(e,r,a){"function"!=typeof e&&t.FieldDropdown.validateOptions_(e),this.menuGenerator_=e,this.suffixField=this.prefixField=this.generatedOptions_=null,this.trimOptions_(),this.selectedOption_=this.getOptions(!1)[0],t.FieldDropdown.superClass_.constructor.call(this,this.selectedOption_[1],r,a),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null},t.utils.object.inherits(t.FieldDropdown,t.Field),t.FieldDropdown.fromJson=function(e){return new t.FieldDropdown(e.options,void 0,e)},t.FieldDropdown.prototype.fromXml=function(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)},t.FieldDropdown.prototype.SERIALIZABLE=!0,t.FieldDropdown.CHECKMARK_OVERHANG=25,t.FieldDropdown.MAX_MENU_HEIGHT_VH=.45,t.FieldDropdown.IMAGE_Y_OFFSET=5,t.FieldDropdown.IMAGE_Y_PADDING=2*t.FieldDropdown.IMAGE_Y_OFFSET,t.FieldDropdown.ARROW_CHAR=t.utils.userAgent.ANDROID?"\u25bc":"\u25be",t.FieldDropdown.prototype.CURSOR="default",t.FieldDropdown.prototype.initView=function(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=t.utils.dom.createSvgElement(t.utils.Svg.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&t.utils.dom.addClass(this.borderRect_,"blocklyDropdownRect")},t.FieldDropdown.prototype.shouldAddBorderRect_=function(){return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!this.sourceBlock_.isShadow()},t.FieldDropdown.prototype.createTextArrow_=function(){this.arrow_=t.utils.dom.createSvgElement(t.utils.Svg.TSPAN,{},this.textElement_),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?t.FieldDropdown.ARROW_CHAR+" ":" "+t.FieldDropdown.ARROW_CHAR)),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textContent_):this.textElement_.appendChild(this.arrow_)},t.FieldDropdown.prototype.createSVGArrow_=function(){this.svgArrow_=t.utils.dom.createSvgElement(t.utils.Svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(t.utils.dom.XLINK_NS,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)},t.FieldDropdown.prototype.showEditor_=function(e){if(this.dropdownCreate_(),this.menu_.openingCoords=e&&"number"==typeof e.clientX?new t.utils.Coordinate(e.clientX,e.clientY):null,this.menu_.render(t.DropDownDiv.getContentDiv()),e=this.menu_.getElement(),t.utils.dom.addClass(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){e=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().getColour():this.sourceBlock_.getColour();var r=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;t.DropDownDiv.setColour(e,r)}t.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()},t.FieldDropdown.prototype.dropdownCreate_=function(){var e=new t.Menu;e.setRole(t.utils.aria.Role.LISTBOX),this.menu_=e;var r=this.getOptions(!1);this.selectedMenuItem_=null;for(var a=0;a<r.length;a++){var c=r[a][0],p=r[a][1];if("object"==typeof c){var f=new Image(c.width,c.height);f.src=c.src,f.alt=c.alt||"",c=f}(c=new t.MenuItem(c,p)).setRole(t.utils.aria.Role.OPTION),c.setRightToLeft(this.sourceBlock_.RTL),c.setCheckable(!0),e.addChild(c),c.setChecked(p==this.value_),p==this.value_&&(this.selectedMenuItem_=c),c.onAction(this.handleMenuActionEvent_,this)}},t.FieldDropdown.prototype.dropdownDispose_=function(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()},t.FieldDropdown.prototype.handleMenuActionEvent_=function(e){t.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)},t.FieldDropdown.prototype.onItemSelected_=function(e,r){this.setValue(r.getValue())},t.FieldDropdown.prototype.trimOptions_=function(){var e=this.menuGenerator_;if(Array.isArray(e)){for(var r=!1,a=0;a<e.length;a++){var c=e[a][0];"string"==typeof c?e[a][0]=t.utils.replaceMessageReferences(c):(null!=c.alt&&(e[a][0].alt=t.utils.replaceMessageReferences(c.alt)),r=!0)}if(!(r||2>e.length)){for(r=[],a=0;a<e.length;a++)r.push(e[a][0]);a=t.utils.string.shortestStringLength(r),c=t.utils.string.commonWordPrefix(r,a);var p=t.utils.string.commonWordSuffix(r,a);!c&&!p||a<=c+p||(c&&(this.prefixField=r[0].substring(0,c-1)),p&&(this.suffixField=r[0].substr(1-p)),this.menuGenerator_=t.FieldDropdown.applyTrim_(e,c,p))}}},t.FieldDropdown.applyTrim_=function(e,r,a){for(var c=[],p=0;p<e.length;p++){var f=e[p][0],T=e[p][1];f=f.substring(r,f.length-a),c[p]=[f,T]}return c},t.FieldDropdown.prototype.isOptionListDynamic=function(){return"function"==typeof this.menuGenerator_},t.FieldDropdown.prototype.getOptions=function(e){return this.isOptionListDynamic()?(this.generatedOptions_&&e||(this.generatedOptions_=this.menuGenerator_.call(this),t.FieldDropdown.validateOptions_(this.generatedOptions_)),this.generatedOptions_):this.menuGenerator_},t.FieldDropdown.prototype.doClassValidation_=function(e){for(var p,r=!1,a=this.getOptions(!0),c=0;p=a[c];c++)if(p[1]==e){r=!0;break}return r?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)},t.FieldDropdown.prototype.doValueUpdate_=function(e){t.FieldDropdown.superClass_.doValueUpdate_.call(this,e),e=this.getOptions(!0);for(var a,r=0;a=e[r];r++)a[1]==this.value_&&(this.selectedOption_=a)},t.FieldDropdown.prototype.applyColour=function(){this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary),this.borderRect_.setAttribute("fill",this.menu_?this.sourceBlock_.style.colourTertiary:"transparent")),this.sourceBlock_&&this.arrow_&&(this.arrow_.style.fill=this.sourceBlock_.isShadow()?this.sourceBlock_.style.colourSecondary:this.sourceBlock_.style.colourPrimary)},t.FieldDropdown.prototype.render_=function(){this.textContent_.nodeValue="",this.imageElement_.style.display="none";var e=this.selectedOption_&&this.selectedOption_[0];e&&"object"==typeof e?this.renderSelectedImage_(e):this.renderSelectedText_(),this.positionBorderRect_()},t.FieldDropdown.prototype.renderSelectedImage_=function(e){this.imageElement_.style.display="",this.imageElement_.setAttributeNS(t.utils.dom.XLINK_NS,"xlink:href",e.src),this.imageElement_.setAttribute("height",e.height),this.imageElement_.setAttribute("width",e.width);var r=Number(e.height);e=Number(e.width);var a=!!this.borderRect_,c=Math.max(a?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,r+t.FieldDropdown.IMAGE_Y_PADDING);a=a?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var p=this.svgArrow_?this.positionSVGArrow_(e+a,c/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):t.utils.dom.getFastTextWidth(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=e+p+2*a,this.size_.height=c;var f=0;this.sourceBlock_.RTL?this.imageElement_.setAttribute("x",a+p):(f=e+p,this.textElement_.setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",a)),this.imageElement_.setAttribute("y",c/2-r/2),this.positionTextElement_(f+a,e+p)},t.FieldDropdown.prototype.renderSelectedText_=function(){this.textContent_.nodeValue=this.getDisplayText_(),t.utils.dom.addClass(this.textElement_,"blocklyDropdownText"),this.textElement_.setAttribute("text-anchor","start");var e=!!this.borderRect_,r=Math.max(e?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),a=t.utils.dom.getFastTextWidth(this.textElement_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);e=e?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var c=0;this.svgArrow_&&(c=this.positionSVGArrow_(a+e,r/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=a+c+2*e,this.size_.height=r,this.positionTextElement_(e,a)},t.FieldDropdown.prototype.positionSVGArrow_=function(e,r){if(!this.svgArrow_)return 0;var a=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,c=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,p=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(this.sourceBlock_.RTL?a:e+c)+","+r+")"),p+c},t.FieldDropdown.prototype.getText_=function(){if(!this.selectedOption_)return null;var e=this.selectedOption_[0];return"object"==typeof e?e.alt:e},t.FieldDropdown.validateOptions_=function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");for(var r=!1,a=0;a<e.length;++a){var c=e[a];Array.isArray(c)?"string"!=typeof c[1]?(r=!0,console.error("Invalid option["+a+"]: Each FieldDropdown option id must be a string. Found "+c[1]+" in: ",c)):c[0]&&"string"!=typeof c[0]&&"string"!=typeof c[0].src&&(r=!0,console.error("Invalid option["+a+"]: Each FieldDropdown option must have a string label or image description. Found"+c[0]+" in: ",c)):(r=!0,console.error("Invalid option["+a+"]: Each FieldDropdown option must be an array. Found: ",c))}if(r)throw TypeError("Found invalid FieldDropdown options.")},t.fieldRegistry.register("field_dropdown",t.FieldDropdown),t.FieldLabelSerializable=function(e,r,a){t.FieldLabelSerializable.superClass_.constructor.call(this,e,r,a)},t.utils.object.inherits(t.FieldLabelSerializable,t.FieldLabel),t.FieldLabelSerializable.fromJson=function(e){var r=t.utils.replaceMessageReferences(e.text);return new t.FieldLabelSerializable(r,void 0,e)},t.FieldLabelSerializable.prototype.EDITABLE=!1,t.FieldLabelSerializable.prototype.SERIALIZABLE=!0,t.fieldRegistry.register("field_label_serializable",t.FieldLabelSerializable),t.FieldImage=function(e,r,a,c,p,f,T){if(!e)throw Error("Src value of an image field is required");if(e=t.utils.replaceMessageReferences(e),a=Number(t.utils.replaceMessageReferences(a)),r=Number(t.utils.replaceMessageReferences(r)),isNaN(a)||isNaN(r))throw Error("Height and width values of an image field must cast to numbers.");if(0>=a||0>=r)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",t.FieldImage.superClass_.constructor.call(this,e,null,T),T||(this.flipRtl_=!!f,this.altText_=t.utils.replaceMessageReferences(c)||""),this.size_=new t.utils.Size(r,a+t.FieldImage.Y_PADDING),this.imageHeight_=a,this.clickHandler_=null,"function"==typeof p&&(this.clickHandler_=p),this.imageElement_=null},t.utils.object.inherits(t.FieldImage,t.Field),t.FieldImage.prototype.DEFAULT_VALUE="",t.FieldImage.fromJson=function(e){return new t.FieldImage(e.src,e.width,e.height,void 0,void 0,void 0,e)},t.FieldImage.Y_PADDING=1,t.FieldImage.prototype.EDITABLE=!1,t.FieldImage.prototype.isDirty_=!1,t.FieldImage.prototype.configure_=function(e){t.FieldImage.superClass_.configure_.call(this,e),this.flipRtl_=!!e.flipRtl,this.altText_=t.utils.replaceMessageReferences(e.alt)||""},t.FieldImage.prototype.initView=function(){this.imageElement_=t.utils.dom.createSvgElement(t.utils.Svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(t.utils.dom.XLINK_NS,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")},t.FieldImage.prototype.updateSize_=function(){},t.FieldImage.prototype.doClassValidation_=function(e){return"string"!=typeof e?null:e},t.FieldImage.prototype.doValueUpdate_=function(e){this.value_=e,this.imageElement_&&this.imageElement_.setAttributeNS(t.utils.dom.XLINK_NS,"xlink:href",String(this.value_))},t.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},t.FieldImage.prototype.setAlt=function(e){e!=this.altText_&&(this.altText_=e||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},t.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},t.FieldImage.prototype.setOnClickHandler=function(e){this.clickHandler_=e},t.FieldImage.prototype.getText_=function(){return this.altText_},t.fieldRegistry.register("field_image",t.FieldImage),t.FieldMultilineInput=function(e,r,a){t.FieldMultilineInput.superClass_.constructor.call(this,e,r,a),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=!1},t.utils.object.inherits(t.FieldMultilineInput,t.FieldTextInput),t.FieldMultilineInput.prototype.configure_=function(e){t.FieldMultilineInput.superClass_.configure_.call(this,e),e.maxLines&&this.setMaxLines(e.maxLines)},t.FieldMultilineInput.fromJson=function(e){var r=t.utils.replaceMessageReferences(e.text);return new t.FieldMultilineInput(r,void 0,e)},t.FieldMultilineInput.prototype.toXml=function(e){return e.textContent=this.getValue().replace(/\n/g,"&#10;"),e},t.FieldMultilineInput.prototype.fromXml=function(e){this.setValue(e.textContent.replace(/&#10;/g,"\n"))},t.FieldMultilineInput.prototype.initView=function(){this.createBorderRect_(),this.textGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)},t.FieldMultilineInput.prototype.getDisplayText_=function(){var e=this.getText();if(!e)return t.Field.NBSP;var r=e.split("\n");e="";for(var a=this.isOverflowedY_?this.maxLines_:r.length,c=0;c<a;c++){var p=r[c];p.length>this.maxDisplayLength?p=p.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&c===a-1&&(p=p.substring(0,p.length-3)+"..."),e+=p=p.replace(/\s/g,t.Field.NBSP),c!==a-1&&(e+="\n")}return this.sourceBlock_.RTL&&(e+="\u200f"),e},t.FieldMultilineInput.prototype.doValueUpdate_=function(e){t.FieldMultilineInput.superClass_.doValueUpdate_.call(this,e),this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_},t.FieldMultilineInput.prototype.render_=function(){for(var e;e=this.textGroup_.firstChild;)this.textGroup_.removeChild(e);e=this.getDisplayText_().split("\n");for(var r=0,a=0;a<e.length;a++){var c=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;t.utils.dom.createSvgElement(t.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:r+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(e[a])),r+=c}this.isBeingEdited_&&(e=this.htmlInput_,this.isOverflowedY_?t.utils.dom.addClass(e,"blocklyHtmlTextAreaInputOverflowedY"):t.utils.dom.removeClass(e,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),e=this.htmlInput_,this.isTextValid_?(t.utils.dom.removeClass(e,"blocklyInvalidInput"),t.utils.aria.setState(e,t.utils.aria.State.INVALID,!1)):(t.utils.dom.addClass(e,"blocklyInvalidInput"),t.utils.aria.setState(e,t.utils.aria.State.INVALID,!0)))},t.FieldMultilineInput.prototype.updateSize_=function(){for(var e=this.textGroup_.childNodes,r=0,a=0,c=0;c<e.length;c++){var p=t.utils.dom.getTextWidth(e[c]);p>r&&(r=p),a+=this.getConstants().FIELD_TEXT_HEIGHT+(0<c?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){e=this.value_.split("\n"),p=t.utils.dom.createSvgElement(t.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText"});var f=this.getConstants().FIELD_TEXT_FONTSIZE,T=this.getConstants().FIELD_TEXT_FONTWEIGHT,y=this.getConstants().FIELD_TEXT_FONTFAMILY;for(c=0;c<e.length;c++){e[c].length>this.maxDisplayLength&&(e[c]=e[c].substring(0,this.maxDisplayLength)),p.textContent=e[c];var D=t.utils.dom.getFastTextWidth(p,f,T,y);D>r&&(r=D)}r+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(a+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,r+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",r),this.borderRect_.setAttribute("height",a)),this.size_.width=r,this.size_.height=a,this.positionBorderRect_()},t.FieldMultilineInput.prototype.showEditor_=function(e,r){t.FieldMultilineInput.superClass_.showEditor_.call(this,e,r),this.forceRerender()},t.FieldMultilineInput.prototype.widgetCreate_=function(){var e=t.WidgetDiv.DIV,r=this.workspace_.getScale(),a=document.createElement("textarea");a.className="blocklyHtmlInput blocklyHtmlTextAreaInput",a.setAttribute("spellcheck",this.spellcheck_);var c=this.getConstants().FIELD_TEXT_FONTSIZE*r+"pt";e.style.fontSize=c,a.style.fontSize=c,a.style.borderRadius=t.FieldTextInput.BORDERRADIUS*r+"px",c=this.getConstants().FIELD_BORDER_RECT_X_PADDING*r;var p=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*r/2;return a.style.padding=p+"px "+c+"px "+p+"px "+c+"px",c=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,a.style.lineHeight=c*r+"px",e.appendChild(a),a.value=a.defaultValue=this.getEditorText_(this.value_),a.untypedDefaultValue_=this.value_,a.oldValue_=null,t.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(a),a},t.FieldMultilineInput.prototype.setMaxLines=function(e){"number"==typeof e&&0<e&&e!==this.maxLines_&&(this.maxLines_=e,this.forceRerender())},t.FieldMultilineInput.prototype.getMaxLines=function(){return this.maxLines_},t.FieldMultilineInput.prototype.onHtmlInputKeyDown_=function(e){e.keyCode!==t.utils.KeyCodes.ENTER&&t.FieldMultilineInput.superClass_.onHtmlInputKeyDown_.call(this,e)},t.Css.register(".blocklyHtmlTextAreaInput {,font-family: monospace;,resize: none;,overflow: hidden;,height: 100%;,text-align: left;,},.blocklyHtmlTextAreaInputOverflowedY {,overflow-y: scroll;,}".split(",")),t.fieldRegistry.register("field_multilinetext",t.FieldMultilineInput),t.FieldNumber=function(e,r,a,c,p,f){this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,t.FieldNumber.superClass_.constructor.call(this,e,p,f),f||this.setConstraints(r,a,c)},t.utils.object.inherits(t.FieldNumber,t.FieldTextInput),t.FieldNumber.prototype.DEFAULT_VALUE=0,t.FieldNumber.fromJson=function(e){return new t.FieldNumber(e.value,void 0,void 0,void 0,void 0,e)},t.FieldNumber.prototype.SERIALIZABLE=!0,t.FieldNumber.prototype.configure_=function(e){t.FieldNumber.superClass_.configure_.call(this,e),this.setMinInternal_(e.min),this.setMaxInternal_(e.max),this.setPrecisionInternal_(e.precision)},t.FieldNumber.prototype.setConstraints=function(e,r,a){this.setMinInternal_(e),this.setMaxInternal_(r),this.setPrecisionInternal_(a),this.setValue(this.getValue())},t.FieldNumber.prototype.setMin=function(e){this.setMinInternal_(e),this.setValue(this.getValue())},t.FieldNumber.prototype.setMinInternal_=function(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))},t.FieldNumber.prototype.getMin=function(){return this.min_},t.FieldNumber.prototype.setMax=function(e){this.setMaxInternal_(e),this.setValue(this.getValue())},t.FieldNumber.prototype.setMaxInternal_=function(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))},t.FieldNumber.prototype.getMax=function(){return this.max_},t.FieldNumber.prototype.setPrecision=function(e){this.setPrecisionInternal_(e),this.setValue(this.getValue())},t.FieldNumber.prototype.setPrecisionInternal_=function(e){this.precision_=Number(e)||0;var r=String(this.precision_);-1!=r.indexOf("e")&&(r=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));var a=r.indexOf(".");this.decimalPlaces_=-1==a?e?0:null:r.length-a-1},t.FieldNumber.prototype.getPrecision=function(){return this.precision_},t.FieldNumber.prototype.doClassValidation_=function(e){return null===e||(e=(e=(e=(e=String(e)).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!=this.decimalPlaces_&&(e=Number(e.toFixed(this.decimalPlaces_))),e)},t.FieldNumber.prototype.widgetCreate_=function(){var e=t.FieldNumber.superClass_.widgetCreate_.call(this);return-1/0<this.min_&&t.utils.aria.setState(e,t.utils.aria.State.VALUEMIN,this.min_),1/0>this.max_&&t.utils.aria.setState(e,t.utils.aria.State.VALUEMAX,this.max_),e},t.fieldRegistry.register("field_number",t.FieldNumber),t.FieldVariable=function(e,r,a,c,p){this.menuGenerator_=t.FieldVariable.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new t.utils.Size(0,0),p&&this.configure_(p),r&&this.setValidator(r),p||this.setTypes_(a,c)},t.utils.object.inherits(t.FieldVariable,t.FieldDropdown),t.FieldVariable.fromJson=function(e){var r=t.utils.replaceMessageReferences(e.variable);return new t.FieldVariable(r,void 0,void 0,void 0,e)},t.FieldVariable.prototype.SERIALIZABLE=!0,t.FieldVariable.prototype.configure_=function(e){t.FieldVariable.superClass_.configure_.call(this,e),this.setTypes_(e.variableTypes,e.defaultType)},t.FieldVariable.prototype.initModel=function(){if(!this.variable_){var e=t.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,null,this.defaultVariableName,this.defaultType_);this.doValueUpdate_(e.getId())}},t.FieldVariable.prototype.shouldAddBorderRect_=function(){return t.FieldVariable.superClass_.shouldAddBorderRect_.call(this)&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!=this.sourceBlock_.type)},t.FieldVariable.prototype.fromXml=function(e){var r=e.getAttribute("id"),a=e.textContent,c=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(r=t.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,r,a,c),null!=c&&c!==r.type)throw Error("Serialized variable type with id '"+r.getId()+"' had type "+r.type+", and does not match variable field that references it: "+t.Xml.domToText(e)+".");this.setValue(r.getId())},t.FieldVariable.prototype.toXml=function(e){return this.initModel(),e.id=this.variable_.getId(),e.textContent=this.variable_.name,this.variable_.type&&e.setAttribute("variabletype",this.variable_.type),e},t.FieldVariable.prototype.setSourceBlock=function(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");t.FieldVariable.superClass_.setSourceBlock.call(this,e)},t.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},t.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},t.FieldVariable.prototype.getVariable=function(){return this.variable_},t.FieldVariable.prototype.getValidator=function(){return this.variable_?this.validator_:null},t.FieldVariable.prototype.doClassValidation_=function(e){if(null===e)return null;var r=t.Variables.getVariable(this.sourceBlock_.workspace,e);return r?this.typeIsAllowed_(r=r.type)?e:(console.warn("Variable type doesn't match this field!  Type was "+r),null):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)},t.FieldVariable.prototype.doValueUpdate_=function(e){this.variable_=t.Variables.getVariable(this.sourceBlock_.workspace,e),t.FieldVariable.superClass_.doValueUpdate_.call(this,e)},t.FieldVariable.prototype.typeIsAllowed_=function(e){var r=this.getVariableTypes_();if(!r)return!0;for(var a=0;a<r.length;a++)if(e==r[a])return!0;return!1},t.FieldVariable.prototype.getVariableTypes_=function(){var e=this.variableTypes;if(null===e&&this.sourceBlock_&&this.sourceBlock_.workspace)return this.sourceBlock_.workspace.getVariableTypes();if(0==(e=e||[""]).length)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e},t.FieldVariable.prototype.setTypes_=function(e,r){if(r=r||"",null==e||null==e)e=null;else{if(!Array.isArray(e))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");for(var a=!1,c=0;c<e.length;c++)e[c]==r&&(a=!0);if(!a)throw Error("Invalid default type '"+r+"' in the definition of a FieldVariable")}this.defaultType_=r,this.variableTypes=e},t.FieldVariable.prototype.refreshVariableName=function(){this.forceRerender()},t.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var e=this.getText(),r=[];if(this.sourceBlock_&&this.sourceBlock_.workspace)for(var a=this.getVariableTypes_(),c=0;c<a.length;c++){var p=this.sourceBlock_.workspace.getVariablesOfType(a[c]);r=r.concat(p)}for(r.sort(t.VariableModel.compareByName),a=[],c=0;c<r.length;c++)a[c]=[r[c].name,r[c].getId()];return a.push([t.Msg.RENAME_VARIABLE,t.RENAME_VARIABLE_ID]),t.Msg.DELETE_VARIABLE&&a.push([t.Msg.DELETE_VARIABLE.replace("%1",e),t.DELETE_VARIABLE_ID]),a},t.FieldVariable.prototype.onItemSelected_=function(e,r){if(e=r.getValue(),this.sourceBlock_&&this.sourceBlock_.workspace){if(e==t.RENAME_VARIABLE_ID)return void t.Variables.renameVariable(this.sourceBlock_.workspace,this.variable_);if(e==t.DELETE_VARIABLE_ID)return void this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId())}this.setValue(e)},t.FieldVariable.prototype.referencesVariables=function(){return!0},t.fieldRegistry.register("field_variable",t.FieldVariable),t.utils.svgPaths={},t.utils.svgPaths.point=function(e,r){return" "+e+","+r+" "},t.utils.svgPaths.curve=function(e,r){return" "+e+r.join("")},t.utils.svgPaths.moveTo=function(e,r){return" M "+e+","+r+" "},t.utils.svgPaths.moveBy=function(e,r){return" m "+e+","+r+" "},t.utils.svgPaths.lineTo=function(e,r){return" l "+e+","+r+" "},t.utils.svgPaths.line=function(e){return" l"+e.join("")},t.utils.svgPaths.lineOnAxis=function(e,r){return" "+e+" "+r+" "},t.utils.svgPaths.arc=function(e,r,a,c){return e+" "+a+" "+a+" "+r+c},t.blockRendering.ConstantProvider=function(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.CORNER_RADIUS=8,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=t.utils.svgPaths.moveBy(0,0),this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_TEXT_BASELINE_CENTER=!t.utils.userAgent.IE&&!t.utils.userAgent.EDGE,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2),this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2}},t.blockRendering.ConstantProvider.prototype.init=function(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()},t.blockRendering.ConstantProvider.prototype.setTheme=function(e){this.blockStyles=Object.create(null);var a,r=e.blockStyles;for(a in r)this.blockStyles[a]=this.validatedBlockStyle_(r[a]);this.setDynamicProperties_(e)},t.blockRendering.ConstantProvider.prototype.setDynamicProperties_=function(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=null!=e.startHats?e.startHats:this.ADD_START_HATS},t.blockRendering.ConstantProvider.prototype.setFontConstants_=function(e){this.FIELD_TEXT_FONTFAMILY=e.fontStyle&&null!=e.fontStyle.family?e.fontStyle.family:this.FIELD_TEXT_FONTFAMILY,this.FIELD_TEXT_FONTWEIGHT=e.fontStyle&&null!=e.fontStyle.weight?e.fontStyle.weight:this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTSIZE=e.fontStyle&&null!=e.fontStyle.size?e.fontStyle.size:this.FIELD_TEXT_FONTSIZE,e=t.utils.dom.measureFontMetrics("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline},t.blockRendering.ConstantProvider.prototype.setComponentConstants_=function(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY},t.blockRendering.ConstantProvider.prototype.getBlockStyleForColour=function(e){var r="auto_"+e;return this.blockStyles[r]||(this.blockStyles[r]=this.createBlockStyle_(e)),{style:this.blockStyles[r],name:r}},t.blockRendering.ConstantProvider.prototype.getBlockStyle=function(e){return this.blockStyles[e||""]||(e&&0==e.indexOf("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))},t.blockRendering.ConstantProvider.prototype.createBlockStyle_=function(e){return this.validatedBlockStyle_({colourPrimary:e})},t.blockRendering.ConstantProvider.prototype.validatedBlockStyle_=function(e){var r={};return e&&t.utils.object.mixin(r,e),e=t.utils.parseBlockColour(r.colourPrimary||"#000"),r.colourPrimary=e.hex,r.colourSecondary=r.colourSecondary?t.utils.parseBlockColour(r.colourSecondary).hex:this.generateSecondaryColour_(r.colourPrimary),r.colourTertiary=r.colourTertiary?t.utils.parseBlockColour(r.colourTertiary).hex:this.generateTertiaryColour_(r.colourPrimary),r.hat=r.hat||"",r},t.blockRendering.ConstantProvider.prototype.generateSecondaryColour_=function(e){return t.utils.colour.blend("#fff",e,.6)||e},t.blockRendering.ConstantProvider.prototype.generateTertiaryColour_=function(e){return t.utils.colour.blend("#fff",e,.3)||e},t.blockRendering.ConstantProvider.prototype.dispose=function(){this.embossFilter_&&t.utils.dom.removeNode(this.embossFilter_),this.disabledPattern_&&t.utils.dom.removeNode(this.disabledPattern_),this.debugFilter_&&t.utils.dom.removeNode(this.debugFilter_),this.cssNode_=null},t.blockRendering.ConstantProvider.prototype.makeJaggedTeeth=function(){var e=this.JAGGED_TEETH_HEIGHT,r=this.JAGGED_TEETH_WIDTH;return{height:e,width:r,path:t.utils.svgPaths.line([t.utils.svgPaths.point(r,e/4),t.utils.svgPaths.point(2*-r,e/2),t.utils.svgPaths.point(r,e/4)])}},t.blockRendering.ConstantProvider.prototype.makeStartHat=function(){var e=this.START_HAT_HEIGHT,r=this.START_HAT_WIDTH;return{height:e,width:r,path:t.utils.svgPaths.curve("c",[t.utils.svgPaths.point(30,-e),t.utils.svgPaths.point(70,-e),t.utils.svgPaths.point(r,0)])}},t.blockRendering.ConstantProvider.prototype.makePuzzleTab=function(){function e(f){var T=-(f=f?-1:1),y=a/2,D=y+2.5,k=y+.5,G=t.utils.svgPaths.point(-r,f*y);return y=t.utils.svgPaths.point(r,f*y),t.utils.svgPaths.curve("c",[t.utils.svgPaths.point(0,f*D),t.utils.svgPaths.point(-r,T*k),G])+t.utils.svgPaths.curve("s",[t.utils.svgPaths.point(r,2.5*T),y])}var r=this.TAB_WIDTH,a=this.TAB_HEIGHT,c=e(!0),p=e(!1);return{type:this.SHAPES.PUZZLE,width:r,height:a,pathDown:p,pathUp:c}},t.blockRendering.ConstantProvider.prototype.makeNotch=function(){function e(T){return t.utils.svgPaths.line([t.utils.svgPaths.point(T*c,a),t.utils.svgPaths.point(3*T,0),t.utils.svgPaths.point(T*c,-a)])}var r=this.NOTCH_WIDTH,a=this.NOTCH_HEIGHT,c=(r-3)/2,p=e(1),f=e(-1);return{type:this.SHAPES.NOTCH,width:r,height:a,pathLeft:p,pathRight:f}},t.blockRendering.ConstantProvider.prototype.makeInsideCorners=function(){var e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:t.utils.svgPaths.arc("a","0 0,0",e,t.utils.svgPaths.point(-e,e)),pathBottom:t.utils.svgPaths.arc("a","0 0,0",e,t.utils.svgPaths.point(e,e))}},t.blockRendering.ConstantProvider.prototype.makeOutsideCorners=function(){var e=this.CORNER_RADIUS,r=t.utils.svgPaths.moveBy(0,e)+t.utils.svgPaths.arc("a","0 0,1",e,t.utils.svgPaths.point(e,-e)),a=t.utils.svgPaths.arc("a","0 0,1",e,t.utils.svgPaths.point(e,e)),c=t.utils.svgPaths.arc("a","0 0,1",e,t.utils.svgPaths.point(-e,-e));return{topLeft:r,topRight:a,bottomRight:t.utils.svgPaths.arc("a","0 0,1",e,t.utils.svgPaths.point(-e,e)),bottomLeft:c,rightHeight:e}},t.blockRendering.ConstantProvider.prototype.shapeFor=function(e){switch(e.type){case t.connectionTypes.INPUT_VALUE:case t.connectionTypes.OUTPUT_VALUE:return this.PUZZLE_TAB;case t.connectionTypes.PREVIOUS_STATEMENT:case t.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}},t.blockRendering.ConstantProvider.prototype.createDom=function(e,r,a){this.injectCSS_(r,a),e=t.utils.dom.createSvgElement(t.utils.Svg.DEFS,{},e),r=t.utils.dom.createSvgElement(t.utils.Svg.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},e),t.utils.dom.createSvgElement(t.utils.Svg.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},r),a=t.utils.dom.createSvgElement(t.utils.Svg.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},r),t.utils.dom.createSvgElement(t.utils.Svg.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},a),t.utils.dom.createSvgElement(t.utils.Svg.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},r),t.utils.dom.createSvgElement(t.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},r),this.embossFilterId=r.id,this.embossFilter_=r,r=t.utils.dom.createSvgElement(t.utils.Svg.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},e),t.utils.dom.createSvgElement(t.utils.Svg.RECT,{width:10,height:10,fill:"#aaa"},r),t.utils.dom.createSvgElement(t.utils.Svg.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},r),this.disabledPatternId=r.id,this.disabledPattern_=r,t.blockRendering.Debug&&(e=t.utils.dom.createSvgElement(t.utils.Svg.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),r=t.utils.dom.createSvgElement(t.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},e),t.utils.dom.createSvgElement(t.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),t.utils.dom.createSvgElement(t.utils.Svg.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),t.utils.dom.createSvgElement(t.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter_=e)},t.blockRendering.ConstantProvider.prototype.injectCSS_=function(e,r){r=this.getCSS_(r),e="blockly-renderer-style-"+e,this.cssNode_=document.getElementById(e);var a=r.join("\n");this.cssNode_?this.cssNode_.firstChild.textContent=a:((r=document.createElement("style")).id=e,e=document.createTextNode(a),r.appendChild(e),document.head.insertBefore(r,document.head.firstChild),this.cssNode_=r)},t.blockRendering.ConstantProvider.prototype.getCSS_=function(e){return[e+" .blocklyText, ",e+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",e+" .blocklyText {","fill: #fff;","}",e+" .blocklyNonEditableText>rect,",e+" .blocklyEditableText>rect {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","fill-opacity: .6;","stroke: none;","}",e+" .blocklyNonEditableText>text,",e+" .blocklyEditableText>text {","fill: #000;","}",e+" .blocklyFlyoutLabelText {","fill: #000;","}",e+" .blocklyText.blocklyBubbleText {","fill: #000;","}",e+" .blocklyEditableText:not(.editing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",e+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","}",e+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",e+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",e+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",e+" .blocklyReplaceable .blocklyPathLight,",e+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",e+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},t.blockRendering.Types={NONE:0,FIELD:1,HAT:2,ICON:4,SPACER:8,BETWEEN_ROW_SPACER:16,IN_ROW_SPACER:32,EXTERNAL_VALUE_INPUT:64,INPUT:128,INLINE_INPUT:256,STATEMENT_INPUT:512,CONNECTION:1024,PREVIOUS_CONNECTION:2048,NEXT_CONNECTION:4096,OUTPUT_CONNECTION:8192,CORNER:16384,LEFT_SQUARE_CORNER:32768,LEFT_ROUND_CORNER:65536,RIGHT_SQUARE_CORNER:131072,RIGHT_ROUND_CORNER:262144,JAGGED_EDGE:524288,ROW:1048576,TOP_ROW:2097152,BOTTOM_ROW:4194304,INPUT_ROW:8388608},t.blockRendering.Types.LEFT_CORNER=t.blockRendering.Types.LEFT_SQUARE_CORNER|t.blockRendering.Types.LEFT_ROUND_CORNER,t.blockRendering.Types.RIGHT_CORNER=t.blockRendering.Types.RIGHT_SQUARE_CORNER|t.blockRendering.Types.RIGHT_ROUND_CORNER,t.blockRendering.Types.nextTypeValue_=16777216,t.blockRendering.Types.getType=function(e){return Object.prototype.hasOwnProperty.call(t.blockRendering.Types,e)||(t.blockRendering.Types[e]=t.blockRendering.Types.nextTypeValue_,t.blockRendering.Types.nextTypeValue_<<=1),t.blockRendering.Types[e]},t.blockRendering.Types.isField=function(e){return e.type&t.blockRendering.Types.FIELD},t.blockRendering.Types.isHat=function(e){return e.type&t.blockRendering.Types.HAT},t.blockRendering.Types.isIcon=function(e){return e.type&t.blockRendering.Types.ICON},t.blockRendering.Types.isSpacer=function(e){return e.type&t.blockRendering.Types.SPACER},t.blockRendering.Types.isInRowSpacer=function(e){return e.type&t.blockRendering.Types.IN_ROW_SPACER},t.blockRendering.Types.isInput=function(e){return e.type&t.blockRendering.Types.INPUT},t.blockRendering.Types.isExternalInput=function(e){return e.type&t.blockRendering.Types.EXTERNAL_VALUE_INPUT},t.blockRendering.Types.isInlineInput=function(e){return e.type&t.blockRendering.Types.INLINE_INPUT},t.blockRendering.Types.isStatementInput=function(e){return e.type&t.blockRendering.Types.STATEMENT_INPUT},t.blockRendering.Types.isPreviousConnection=function(e){return e.type&t.blockRendering.Types.PREVIOUS_CONNECTION},t.blockRendering.Types.isNextConnection=function(e){return e.type&t.blockRendering.Types.NEXT_CONNECTION},t.blockRendering.Types.isPreviousOrNextConnection=function(e){return e.type&(t.blockRendering.Types.PREVIOUS_CONNECTION|t.blockRendering.Types.NEXT_CONNECTION)},t.blockRendering.Types.isLeftRoundedCorner=function(e){return e.type&t.blockRendering.Types.LEFT_ROUND_CORNER},t.blockRendering.Types.isRightRoundedCorner=function(e){return e.type&t.blockRendering.Types.RIGHT_ROUND_CORNER},t.blockRendering.Types.isLeftSquareCorner=function(e){return e.type&t.blockRendering.Types.LEFT_SQUARE_CORNER},t.blockRendering.Types.isRightSquareCorner=function(e){return e.type&t.blockRendering.Types.RIGHT_SQUARE_CORNER},t.blockRendering.Types.isCorner=function(e){return e.type&t.blockRendering.Types.CORNER},t.blockRendering.Types.isJaggedEdge=function(e){return e.type&t.blockRendering.Types.JAGGED_EDGE},t.blockRendering.Types.isRow=function(e){return e.type&t.blockRendering.Types.ROW},t.blockRendering.Types.isBetweenRowSpacer=function(e){return e.type&t.blockRendering.Types.BETWEEN_ROW_SPACER},t.blockRendering.Types.isTopRow=function(e){return e.type&t.blockRendering.Types.TOP_ROW},t.blockRendering.Types.isBottomRow=function(e){return e.type&t.blockRendering.Types.BOTTOM_ROW},t.blockRendering.Types.isTopOrBottomRow=function(e){return e.type&(t.blockRendering.Types.TOP_ROW|t.blockRendering.Types.BOTTOM_ROW)},t.blockRendering.Types.isInputRow=function(e){return e.type&t.blockRendering.Types.INPUT_ROW},t.blockRendering.Measurable=function(e){this.height=this.width=0,this.type=t.blockRendering.Types.NONE,this.centerline=this.xPos=0,this.constants_=e,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},t.blockRendering.Connection=function(e,r){t.blockRendering.Connection.superClass_.constructor.call(this,e),this.connectionModel=r,this.shape=this.constants_.shapeFor(r),this.isDynamicShape=!!this.shape.isDynamic,this.type|=t.blockRendering.Types.CONNECTION},t.utils.object.inherits(t.blockRendering.Connection,t.blockRendering.Measurable),t.blockRendering.OutputConnection=function(e,r){t.blockRendering.OutputConnection.superClass_.constructor.call(this,e,r),this.type|=t.blockRendering.Types.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=0},t.utils.object.inherits(t.blockRendering.OutputConnection,t.blockRendering.Connection),t.blockRendering.PreviousConnection=function(e,r){t.blockRendering.PreviousConnection.superClass_.constructor.call(this,e,r),this.type|=t.blockRendering.Types.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},t.utils.object.inherits(t.blockRendering.PreviousConnection,t.blockRendering.Connection),t.blockRendering.NextConnection=function(e,r){t.blockRendering.NextConnection.superClass_.constructor.call(this,e,r),this.type|=t.blockRendering.Types.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},t.utils.object.inherits(t.blockRendering.NextConnection,t.blockRendering.Connection),t.blockRendering.InputConnection=function(e,r){t.blockRendering.InputConnection.superClass_.constructor.call(this,e,r.connection),this.type|=t.blockRendering.Types.INPUT,this.input=r,this.align=r.align,(this.connectedBlock=r.connection&&r.connection.targetBlock()?r.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0,this.connectionOffsetY=this.connectionOffsetX=0},t.utils.object.inherits(t.blockRendering.InputConnection,t.blockRendering.Connection),t.blockRendering.InlineInput=function(e,r){t.blockRendering.InlineInput.superClass_.constructor.call(this,e,r),this.type|=t.blockRendering.Types.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY=this.isDynamicShape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=this.isDynamicShape?this.shape.connectionOffsetX(this.connectionWidth):0},t.utils.object.inherits(t.blockRendering.InlineInput,t.blockRendering.InputConnection),t.blockRendering.StatementInput=function(e,r){t.blockRendering.StatementInput.superClass_.constructor.call(this,e,r),this.type|=t.blockRendering.Types.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width},t.utils.object.inherits(t.blockRendering.StatementInput,t.blockRendering.InputConnection),t.blockRendering.ExternalValueInput=function(e,r){t.blockRendering.ExternalValueInput.superClass_.constructor.call(this,e,r),this.type|=t.blockRendering.Types.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width},t.utils.object.inherits(t.blockRendering.ExternalValueInput,t.blockRendering.InputConnection),t.blockRendering.Icon=function(e,r){t.blockRendering.Icon.superClass_.constructor.call(this,e),this.icon=r,this.isVisible=r.isVisible(),this.type|=t.blockRendering.Types.ICON,e=r.getCorrectedSize(),this.height=e.height,this.width=e.width},t.utils.object.inherits(t.blockRendering.Icon,t.blockRendering.Measurable),t.blockRendering.JaggedEdge=function(e){t.blockRendering.JaggedEdge.superClass_.constructor.call(this,e),this.type|=t.blockRendering.Types.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width},t.utils.object.inherits(t.blockRendering.JaggedEdge,t.blockRendering.Measurable),t.blockRendering.Field=function(e,r,a){t.blockRendering.Field.superClass_.constructor.call(this,e),this.field=r,this.isEditable=r.EDITABLE,this.flipRtl=r.getFlipRtl(),this.type|=t.blockRendering.Types.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width,this.parentInput=a},t.utils.object.inherits(t.blockRendering.Field,t.blockRendering.Measurable),t.blockRendering.Hat=function(e){t.blockRendering.Hat.superClass_.constructor.call(this,e),this.type|=t.blockRendering.Types.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height},t.utils.object.inherits(t.blockRendering.Hat,t.blockRendering.Measurable),t.blockRendering.SquareCorner=function(e,r){t.blockRendering.SquareCorner.superClass_.constructor.call(this,e),this.type=(r&&"left"!=r?t.blockRendering.Types.RIGHT_SQUARE_CORNER:t.blockRendering.Types.LEFT_SQUARE_CORNER)|t.blockRendering.Types.CORNER,this.width=this.height=this.constants_.NO_PADDING},t.utils.object.inherits(t.blockRendering.SquareCorner,t.blockRendering.Measurable),t.blockRendering.RoundCorner=function(e,r){t.blockRendering.RoundCorner.superClass_.constructor.call(this,e),this.type=(r&&"left"!=r?t.blockRendering.Types.RIGHT_ROUND_CORNER:t.blockRendering.Types.LEFT_ROUND_CORNER)|t.blockRendering.Types.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2},t.utils.object.inherits(t.blockRendering.RoundCorner,t.blockRendering.Measurable),t.blockRendering.InRowSpacer=function(e,r){t.blockRendering.InRowSpacer.superClass_.constructor.call(this,e),this.type=this.type|t.blockRendering.Types.SPACER|t.blockRendering.Types.IN_ROW_SPACER,this.width=r,this.height=this.constants_.SPACER_DEFAULT_HEIGHT},t.utils.object.inherits(t.blockRendering.InRowSpacer,t.blockRendering.Measurable),t.blockRendering.Row=function(e){this.type=t.blockRendering.Types.ROW,this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=this.hasStatement=this.hasExternalInput=!1,this.constants_=e,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT,this.align=null},t.blockRendering.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},t.blockRendering.Row.prototype.getLastInput=function(){for(var r,e=this.elements.length-1;r=this.elements[e];e--)if(t.blockRendering.Types.isInput(r))return r;return null},t.blockRendering.Row.prototype.startsWithElemSpacer=function(){return!0},t.blockRendering.Row.prototype.endsWithElemSpacer=function(){return!0},t.blockRendering.Row.prototype.getFirstSpacer=function(){for(var r,e=0;r=this.elements[e];e++)if(t.blockRendering.Types.isSpacer(r))return r;return null},t.blockRendering.Row.prototype.getLastSpacer=function(){for(var r,e=this.elements.length-1;r=this.elements[e];e--)if(t.blockRendering.Types.isSpacer(r))return r;return null},t.blockRendering.TopRow=function(e){t.blockRendering.TopRow.superClass_.constructor.call(this,e),this.type|=t.blockRendering.Types.TOP_ROW,this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null},t.utils.object.inherits(t.blockRendering.TopRow,t.blockRendering.Row),t.blockRendering.TopRow.prototype.hasLeftSquareCorner=function(e){var r=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,a=e.getPreviousBlock();return!!e.outputConnection||r||!!a&&a.getNextBlock()==e},t.blockRendering.TopRow.prototype.hasRightSquareCorner=function(e){return!0},t.blockRendering.TopRow.prototype.measure=function(){for(var p,e=0,r=0,a=0,c=0;p=this.elements[c];c++)r+=p.width,t.blockRendering.Types.isSpacer(p)||(t.blockRendering.Types.isHat(p)?a=Math.max(a,p.ascenderHeight):e=Math.max(e,p.height));this.width=Math.max(this.minWidth,r),this.height=Math.max(this.minHeight,e)+a,this.capline=this.ascenderHeight=a,this.widthWithConnectedBlocks=this.width},t.blockRendering.TopRow.prototype.startsWithElemSpacer=function(){return!1},t.blockRendering.TopRow.prototype.endsWithElemSpacer=function(){return!1},t.blockRendering.BottomRow=function(e){t.blockRendering.BottomRow.superClass_.constructor.call(this,e),this.type|=t.blockRendering.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0},t.utils.object.inherits(t.blockRendering.BottomRow,t.blockRendering.Row),t.blockRendering.BottomRow.prototype.hasLeftSquareCorner=function(e){return!!e.outputConnection||!!e.getNextBlock()},t.blockRendering.BottomRow.prototype.hasRightSquareCorner=function(e){return!0},t.blockRendering.BottomRow.prototype.measure=function(){for(var p,e=0,r=0,a=0,c=0;p=this.elements[c];c++)r+=p.width,t.blockRendering.Types.isSpacer(p)||(t.blockRendering.Types.isNextConnection(p)?a=Math.max(a,p.height):e=Math.max(e,p.height));this.width=Math.max(this.minWidth,r),this.height=Math.max(this.minHeight,e)+a,this.descenderHeight=a,this.widthWithConnectedBlocks=this.width},t.blockRendering.BottomRow.prototype.startsWithElemSpacer=function(){return!1},t.blockRendering.BottomRow.prototype.endsWithElemSpacer=function(){return!1},t.blockRendering.SpacerRow=function(e,r,a){t.blockRendering.SpacerRow.superClass_.constructor.call(this,e),this.type=this.type|t.blockRendering.Types.SPACER|t.blockRendering.Types.BETWEEN_ROW_SPACER,this.width=a,this.height=r,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new t.blockRendering.InRowSpacer(this.constants_,a)]},t.utils.object.inherits(t.blockRendering.SpacerRow,t.blockRendering.Row),t.blockRendering.SpacerRow.prototype.measure=function(){},t.blockRendering.InputRow=function(e){t.blockRendering.InputRow.superClass_.constructor.call(this,e),this.type|=t.blockRendering.Types.INPUT_ROW,this.connectedBlockWidths=0},t.utils.object.inherits(t.blockRendering.InputRow,t.blockRendering.Row),t.blockRendering.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var a,e=0,r=0;a=this.elements[r];r++)this.width+=a.width,t.blockRendering.Types.isInput(a)&&(t.blockRendering.Types.isStatementInput(a)?e+=a.connectedBlockWidth:t.blockRendering.Types.isExternalInput(a)&&0!=a.connectedBlockWidth&&(e+=a.connectedBlockWidth-a.connectionWidth)),t.blockRendering.Types.isSpacer(a)||(this.height=Math.max(this.height,a.height));this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e},t.blockRendering.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement},t.blockRendering.RenderInfo=function(e,r){this.block_=r,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.outputConnection=r.outputConnection?new t.blockRendering.OutputConnection(this.constants_,r.outputConnection):null,this.isInline=r.getInputsInline()&&!r.isCollapsed(),this.isCollapsed=r.isCollapsed(),this.isInsertionMarker=r.isInsertionMarker(),this.RTL=r.RTL,this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.topRow=new t.blockRendering.TopRow(this.constants_),this.bottomRow=new t.blockRendering.BottomRow(this.constants_),this.startY=this.startX=0},t.blockRendering.RenderInfo.prototype.getRenderer=function(){return this.renderer_},t.blockRendering.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},t.blockRendering.RenderInfo.prototype.createRows_=function(){this.populateTopRow_(),this.rows.push(this.topRow);var e=new t.blockRendering.InputRow(this.constants_);this.inputRows.push(e);for(var c,r=this.block_.getIcons(),a=0;c=r[a];a++){var p=new t.blockRendering.Icon(this.constants_,c);this.isCollapsed&&c.collapseHidden?this.hiddenIcons.push(p):e.elements.push(p)}for(c=null,a=0;r=this.block_.inputList[a];a++)if(r.isVisible()){for(this.shouldStartNewRow_(r,c)&&(this.rows.push(e),e=new t.blockRendering.InputRow(this.constants_),this.inputRows.push(e)),c=0;p=r.fieldRow[c];c++)e.elements.push(new t.blockRendering.Field(this.constants_,p,r));this.addInput_(r,e),c=r}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new t.blockRendering.JaggedEdge(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)},t.blockRendering.RenderInfo.prototype.populateTopRow_=function(){var e=!!this.block_.previousConnection,r=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e,a=this.topRow.hasLeftSquareCorner(this.block_)?t.blockRendering.SquareCorner:t.blockRendering.RoundCorner;this.topRow.elements.push(new a(this.constants_)),r?(e=new t.blockRendering.Hat(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new t.blockRendering.PreviousConnection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.topRow.minHeight=this.block_.inputList.length&&this.block_.inputList[0].type==t.inputTypes.STATEMENT&&!this.block_.isCollapsed()?this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.constants_.TOP_ROW_MIN_HEIGHT,a=this.topRow.hasRightSquareCorner(this.block_)?t.blockRendering.SquareCorner:t.blockRendering.RoundCorner,this.topRow.elements.push(new a(this.constants_,"right"))},t.blockRendering.RenderInfo.prototype.populateBottomRow_=function(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==t.inputTypes.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new t.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new t.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new t.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new t.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new t.blockRendering.RoundCorner(this.constants_,"right"))},t.blockRendering.RenderInfo.prototype.addInput_=function(e,r){this.isInline&&e.type==t.inputTypes.VALUE?(r.elements.push(new t.blockRendering.InlineInput(this.constants_,e)),r.hasInlineInput=!0):e.type==t.inputTypes.STATEMENT?(r.elements.push(new t.blockRendering.StatementInput(this.constants_,e)),r.hasStatement=!0):e.type==t.inputTypes.VALUE?(r.elements.push(new t.blockRendering.ExternalValueInput(this.constants_,e)),r.hasExternalInput=!0):e.type==t.inputTypes.DUMMY&&(r.minHeight=Math.max(r.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),r.hasDummyInput=!0),null==r.align&&(r.align=e.align)},t.blockRendering.RenderInfo.prototype.shouldStartNewRow_=function(e,r){return!(!r||e.type!=t.inputTypes.STATEMENT&&r.type!=t.inputTypes.STATEMENT&&(e.type!=t.inputTypes.VALUE&&e.type!=t.inputTypes.DUMMY||this.isInline))},t.blockRendering.RenderInfo.prototype.addElemSpacing_=function(){for(var r,e=0;r=this.rows[e];e++){var a=r.elements;if(r.elements=[],r.startsWithElemSpacer()&&r.elements.push(new t.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,a[0]))),a.length){for(var c=0;c<a.length-1;c++){r.elements.push(a[c]);var p=this.getInRowSpacing_(a[c],a[c+1]);r.elements.push(new t.blockRendering.InRowSpacer(this.constants_,p))}r.elements.push(a[a.length-1]),r.endsWithElemSpacer()&&r.elements.push(new t.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(a[a.length-1],null)))}}},t.blockRendering.RenderInfo.prototype.getInRowSpacing_=function(e,r){if(!e&&r&&t.blockRendering.Types.isStatementInput(r))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&t.blockRendering.Types.isInput(e)&&!r){if(t.blockRendering.Types.isExternalInput(e))return this.constants_.NO_PADDING;if(t.blockRendering.Types.isInlineInput(e))return this.constants_.LARGE_PADDING;if(t.blockRendering.Types.isStatementInput(e))return this.constants_.NO_PADDING}return e&&t.blockRendering.Types.isLeftSquareCorner(e)&&r&&(t.blockRendering.Types.isPreviousConnection(r)||t.blockRendering.Types.isNextConnection(r))?r.notchOffset:e&&t.blockRendering.Types.isLeftRoundedCorner(e)&&r&&(t.blockRendering.Types.isPreviousConnection(r)||t.blockRendering.Types.isNextConnection(r))?r.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},t.blockRendering.RenderInfo.prototype.computeBounds_=function(){for(var p,e=0,r=0,a=0,c=0;p=this.rows[c];c++){if(p.measure(),r=Math.max(r,p.width),p.hasStatement){var f=p.getLastInput();e=Math.max(e,p.width-f.width)}a=Math.max(a,p.widthWithConnectedBlocks)}for(this.statementEdge=e,this.width=r,c=0;p=this.rows[c];c++)p.hasStatement&&(p.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(r,a),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)},t.blockRendering.RenderInfo.prototype.alignRowElements_=function(){for(var r,e=0;r=this.rows[e];e++)if(r.hasStatement)this.alignStatementRow_(r);else{var a=r.width;0<(a=this.getDesiredRowWidth_(r)-a)&&this.addAlignmentPadding_(r,a),t.blockRendering.Types.isTopOrBottomRow(r)&&(r.widthWithConnectedBlocks=r.width)}},t.blockRendering.RenderInfo.prototype.getDesiredRowWidth_=function(e){return this.width-this.startX},t.blockRendering.RenderInfo.prototype.addAlignmentPadding_=function(e,r){var a=e.getFirstSpacer(),c=e.getLastSpacer();(e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=r),e.align==t.constants.ALIGN.LEFT?c.width+=r:e.align==t.constants.ALIGN.CENTRE?(a.width+=r/2,c.width+=r/2):e.align==t.constants.ALIGN.RIGHT?a.width+=r:c.width+=r,e.width+=r},t.blockRendering.RenderInfo.prototype.alignStatementRow_=function(e){var r=e.getLastInput(),a=e.width-r.width,c=this.statementEdge;0<(a=c-a)&&this.addAlignmentPadding_(e,a),a=e.width,c=this.getDesiredRowWidth_(e),r.width+=c-a,r.height=Math.max(r.height,e.height),e.width+=c-a,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)},t.blockRendering.RenderInfo.prototype.addRowSpacing_=function(){var e=this.rows;this.rows=[];for(var r=0;r<e.length;r++)this.rows.push(e[r]),r!=e.length-1&&this.rows.push(this.makeSpacerRow_(e[r],e[r+1]))},t.blockRendering.RenderInfo.prototype.makeSpacerRow_=function(e,r){var a=this.getSpacerRowHeight_(e,r),c=this.getSpacerRowWidth_(e,r);return a=new t.blockRendering.SpacerRow(this.constants_,a,c),e.hasStatement&&(a.followsStatement=!0),r.hasStatement&&(a.precedesStatement=!0),a},t.blockRendering.RenderInfo.prototype.getSpacerRowWidth_=function(e,r){return this.width-this.startX},t.blockRendering.RenderInfo.prototype.getSpacerRowHeight_=function(e,r){return this.constants_.MEDIUM_PADDING},t.blockRendering.RenderInfo.prototype.getElemCenterline_=function(e,r){return t.blockRendering.Types.isSpacer(r)?e.yPos+r.height/2:t.blockRendering.Types.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,t.blockRendering.Types.isNextConnection(r)?e+r.height/2:e-r.height/2):t.blockRendering.Types.isTopRow(e)?t.blockRendering.Types.isHat(r)?e.capline-r.height/2:e.capline+r.height/2:e.yPos+e.height/2},t.blockRendering.RenderInfo.prototype.recordElemPositions_=function(e){for(var c,r=e.xPos,a=0;c=e.elements[a];a++)t.blockRendering.Types.isSpacer(c)&&(c.height=e.height),c.xPos=r,c.centerline=this.getElemCenterline_(e,c),r+=c.width},t.blockRendering.RenderInfo.prototype.finalize_=function(){for(var c,e=0,r=0,a=0;c=this.rows[a];a++)c.yPos=r,c.xPos=this.startX,r+=c.height,e=Math.max(e,c.widthWithConnectedBlocks),this.recordElemPositions_(c);this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.widthWithChildren=e+this.startX,this.height=r,this.startY=this.topRow.capline,this.bottomRow.baseline=r-this.bottomRow.descenderHeight},t.blockRendering.Debug=function(e){this.debugElements_=[],this.svgRoot_=null,this.constants_=e},t.blockRendering.Debug.config={rowSpacers:!0,elemSpacers:!0,rows:!0,elems:!0,connections:!0,blockBounds:!0,connectedBlockBounds:!0,render:!0},t.blockRendering.Debug.prototype.clearElems=function(){for(var r,e=0;r=this.debugElements_[e];e++)t.utils.dom.removeNode(r);this.debugElements_=[]},t.blockRendering.Debug.prototype.drawSpacerRow=function(e,r,a){if(t.blockRendering.Debug.config.rowSpacers){var c=Math.abs(e.height),p=0>e.height;p&&(r-=c),this.debugElements_.push(t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"rowSpacerRect blockRenderDebug",x:a?-(e.xPos+e.width):e.xPos,y:r,width:e.width,height:c,stroke:p?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},t.blockRendering.Debug.prototype.drawSpacerElem=function(e,r,a){if(t.blockRendering.Debug.config.elemSpacers){r=Math.abs(e.width);var c=0>e.width,p=c?e.xPos-r:e.xPos;a&&(p=-(p+r)),this.debugElements_.push(t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"elemSpacerRect blockRenderDebug",x:p,y:e.centerline-e.height/2,width:r,height:e.height,stroke:"pink",fill:c?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},t.blockRendering.Debug.prototype.drawRenderedElem=function(e,r){if(t.blockRendering.Debug.config.elems){var a=e.xPos;r&&(a=-(a+e.width)),this.debugElements_.push(t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:a,y:r=e.centerline-e.height/2,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),t.blockRendering.Types.isField(e)&&e.field instanceof t.FieldLabel&&this.debugElements_.push(t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:a,y:r+this.constants_.FIELD_TEXT_BASELINE,width:e.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}t.blockRendering.Types.isInput(e)&&t.blockRendering.Debug.config.connections&&this.drawConnection(e.connectionModel)},t.blockRendering.Debug.prototype.drawConnection=function(e){if(t.blockRendering.Debug.config.connections){if(e.type==t.connectionTypes.INPUT_VALUE)var r=4,a="magenta",c="none";else e.type==t.connectionTypes.OUTPUT_VALUE?(r=2,c=a="magenta"):e.type==t.connectionTypes.NEXT_STATEMENT?(r=4,a="goldenrod",c="none"):e.type==t.connectionTypes.PREVIOUS_STATEMENT&&(r=2,c=a="goldenrod");this.debugElements_.push(t.utils.dom.createSvgElement(t.utils.Svg.CIRCLE,{class:"blockRenderDebug",cx:e.offsetInBlock_.x,cy:e.offsetInBlock_.y,r,fill:c,stroke:a},this.svgRoot_))}},t.blockRendering.Debug.prototype.drawRenderedRow=function(e,r,a){t.blockRendering.Debug.config.rows&&(this.debugElements_.push(t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"elemRenderingRect blockRenderDebug",x:a?-(e.xPos+e.width):e.xPos,y:e.yPos,width:e.width,height:e.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),t.blockRendering.Types.isTopOrBottomRow(e)||t.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"connectedBlockWidth blockRenderDebug",x:a?-(e.xPos+e.widthWithConnectedBlocks):e.xPos,y:e.yPos,width:e.widthWithConnectedBlocks,height:e.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))},t.blockRendering.Debug.prototype.drawRowWithElements=function(e,r,a){for(var c=0,p=e.elements.length;c<p;c++){var f=e.elements[c];f?t.blockRendering.Types.isSpacer(f)?this.drawSpacerElem(f,e.height,a):this.drawRenderedElem(f,a):console.warn("A row has an undefined or null element.",e,f)}this.drawRenderedRow(e,r,a)},t.blockRendering.Debug.prototype.drawBoundingBox=function(e){if(t.blockRendering.Debug.config.blockBounds){var r=e.RTL?-e.width:0;this.debugElements_.push(t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blockBoundingBox blockRenderDebug",x:r,y:0,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),t.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blockRenderDebug",x:r=e.RTL?-e.widthWithChildren:0,y:0,width:e.widthWithChildren,height:e.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_))}},t.blockRendering.Debug.prototype.drawDebug=function(e,r){this.clearElems(),this.svgRoot_=e.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);for(var p,a=0,c=0;p=r.rows[c];c++)t.blockRendering.Types.isBetweenRowSpacer(p)?this.drawSpacerRow(p,a,r.RTL):this.drawRowWithElements(p,a,r.RTL),a+=p.height;e.previousConnection&&this.drawConnection(e.previousConnection),e.nextConnection&&this.drawConnection(e.nextConnection),e.outputConnection&&this.drawConnection(e.outputConnection),r.rightSide&&this.drawRenderedElem(r.rightSide,r.RTL),this.drawBoundingBox(r),this.drawRender(e.pathObject.svgPath)},t.blockRendering.Debug.prototype.drawRender=function(e){t.blockRendering.Debug.config.render&&(e.setAttribute("filter","url(#"+this.constants_.debugFilterId+")"),setTimeout(function(){e.setAttribute("filter","")},100))},t.blockRendering.Drawer=function(e,r){this.block_=e,this.info_=r,this.topLeft_=e.getRelativeToSurfaceXY(),this.inlinePath_=this.outlinePath_="",this.constants_=r.getRenderer().getConstants()},t.blockRendering.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),t.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},t.blockRendering.Drawer.prototype.recordSizeOnBlock_=function(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren},t.blockRendering.Drawer.prototype.hideHiddenIcons_=function(){for(var r,e=0;r=this.info_.hiddenIcons[e];e++)r.icon.iconGroup_.setAttribute("display","none")},t.blockRendering.Drawer.prototype.drawOutline_=function(){this.drawTop_();for(var e=1;e<this.info_.rows.length-1;e++){var r=this.info_.rows[e];r.hasJaggedEdge?this.drawJaggedEdge_(r):r.hasStatement?this.drawStatementInput_(r):r.hasExternalInput?this.drawValueInput_(r):this.drawRightSideRow_(r)}this.drawBottom_(),this.drawLeft_()},t.blockRendering.Drawer.prototype.drawTop_=function(){var e=this.info_.topRow,r=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=t.utils.svgPaths.moveBy(e.xPos,this.info_.startY);for(var c,a=0;c=r[a];a++)t.blockRendering.Types.isLeftRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:t.blockRendering.Types.isRightRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:t.blockRendering.Types.isPreviousConnection(c)?this.outlinePath_+=c.shape.pathLeft:t.blockRendering.Types.isHat(c)?this.outlinePath_+=this.constants_.START_HAT.path:t.blockRendering.Types.isSpacer(c)&&(this.outlinePath_+=t.utils.svgPaths.lineOnAxis("h",c.width));this.outlinePath_+=t.utils.svgPaths.lineOnAxis("v",e.height)},t.blockRendering.Drawer.prototype.drawJaggedEdge_=function(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+t.utils.svgPaths.lineOnAxis("v",e.height-this.constants_.JAGGED_TEETH.height)},t.blockRendering.Drawer.prototype.drawValueInput_=function(e){var r=e.getLastInput();this.positionExternalValueConnection_(e);var a="function"==typeof r.shape.pathDown?r.shape.pathDown(r.height):r.shape.pathDown;this.outlinePath_+=t.utils.svgPaths.lineOnAxis("H",r.xPos+r.width)+a+t.utils.svgPaths.lineOnAxis("v",e.height-r.connectionHeight)},t.blockRendering.Drawer.prototype.drawStatementInput_=function(e){var r=e.getLastInput(),a=r.xPos+r.notchOffset+r.shape.width;r=r.shape.pathRight+t.utils.svgPaths.lineOnAxis("h",-(r.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var c=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=t.utils.svgPaths.lineOnAxis("H",a)+r+t.utils.svgPaths.lineOnAxis("v",c)+this.constants_.INSIDE_CORNERS.pathBottom+t.utils.svgPaths.lineOnAxis("H",e.xPos+e.width),this.positionStatementInputConnection_(e)},t.blockRendering.Drawer.prototype.drawRightSideRow_=function(e){this.outlinePath_+=t.utils.svgPaths.lineOnAxis("V",e.yPos+e.height)},t.blockRendering.Drawer.prototype.drawBottom_=function(){var e=this.info_.bottomRow,r=e.elements;this.positionNextConnection_();for(var f,a=0,c="",p=r.length-1;f=r[p];p--)t.blockRendering.Types.isNextConnection(f)?c+=f.shape.pathRight:t.blockRendering.Types.isLeftSquareCorner(f)?c+=t.utils.svgPaths.lineOnAxis("H",e.xPos):t.blockRendering.Types.isLeftRoundedCorner(f)?c+=this.constants_.OUTSIDE_CORNERS.bottomLeft:t.blockRendering.Types.isRightRoundedCorner(f)?(c+=this.constants_.OUTSIDE_CORNERS.bottomRight,a=this.constants_.OUTSIDE_CORNERS.rightHeight):t.blockRendering.Types.isSpacer(f)&&(c+=t.utils.svgPaths.lineOnAxis("h",-1*f.width));this.outlinePath_+=t.utils.svgPaths.lineOnAxis("V",e.baseline-a),this.outlinePath_+=c},t.blockRendering.Drawer.prototype.drawLeft_=function(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){var r=e.connectionOffsetY+e.height;e="function"==typeof e.shape.pathUp?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=t.utils.svgPaths.lineOnAxis("V",r)+e}this.outlinePath_+="z"},t.blockRendering.Drawer.prototype.drawInternals_=function(){for(var r,e=0;r=this.info_.rows[e];e++)for(var c,a=0;c=r.elements[a];a++)t.blockRendering.Types.isInlineInput(c)?this.drawInlineInput_(c):(t.blockRendering.Types.isIcon(c)||t.blockRendering.Types.isField(c))&&this.layoutField_(c)},t.blockRendering.Drawer.prototype.layoutField_=function(e){if(t.blockRendering.Types.isField(e))var r=e.field.getSvgRoot();else t.blockRendering.Types.isIcon(e)&&(r=e.icon.iconGroup_);var a=e.centerline-e.height/2,c=e.xPos,p="";this.info_.RTL&&(c=-(c+e.width),e.flipRtl&&(c+=e.width,p="scale(-1 1)")),t.blockRendering.Types.isIcon(e)?(r.setAttribute("display","block"),r.setAttribute("transform","translate("+c+","+a+")"),e.icon.computeIconLocation()):r.setAttribute("transform","translate("+c+","+a+")"+p),this.info_.isInsertionMarker&&r.setAttribute("display","none")},t.blockRendering.Drawer.prototype.drawInlineInput_=function(e){var r=e.width,a=e.height,c=e.connectionOffsetY,p=e.connectionHeight+c;this.inlinePath_+=t.utils.svgPaths.moveTo(e.xPos+e.connectionWidth,e.centerline-a/2)+t.utils.svgPaths.lineOnAxis("v",c)+e.shape.pathDown+t.utils.svgPaths.lineOnAxis("v",a-p)+t.utils.svgPaths.lineOnAxis("h",r-e.connectionWidth)+t.utils.svgPaths.lineOnAxis("v",-a)+"z",this.positionInlineInputConnection_(e)},t.blockRendering.Drawer.prototype.positionInlineInputConnection_=function(e){if(e.connectionModel){var a=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(a*=-1),e.connectionModel.setOffsetInBlock(a,e.centerline-e.height/2+e.connectionOffsetY)}},t.blockRendering.Drawer.prototype.positionStatementInputConnection_=function(e){var r=e.getLastInput();if(r.connectionModel){var a=e.xPos+e.statementEdge+r.notchOffset;this.info_.RTL&&(a*=-1),r.connectionModel.setOffsetInBlock(a,e.yPos)}},t.blockRendering.Drawer.prototype.positionExternalValueConnection_=function(e){var r=e.getLastInput();if(r.connectionModel){var a=e.xPos+e.width;this.info_.RTL&&(a*=-1),r.connectionModel.setOffsetInBlock(a,e.yPos)}},t.blockRendering.Drawer.prototype.positionPreviousConnection_=function(){var e=this.info_.topRow;if(e.connection){var r=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-r:r,0)}},t.blockRendering.Drawer.prototype.positionNextConnection_=function(){var e=this.info_.bottomRow;if(e.connection){var r=e.connection,a=r.xPos;r.connectionModel.setOffsetInBlock(this.info_.RTL?-a:a,e.baseline)}},t.blockRendering.Drawer.prototype.positionOutputConnection_=function(){if(this.info_.outputConnection){var e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}},t.Events.MarkerMove=function(e,r,a,c){var p=e?e.workspace.id:void 0;c&&c.getType()==t.ASTNode.types.WORKSPACE&&(p=c.getLocation().id),t.Events.MarkerMove.superClass_.constructor.call(this,p),this.blockId=e?e.id:null,this.oldNode=a,this.newNode=c,this.isCursor=r},t.utils.object.inherits(t.Events.MarkerMove,t.Events.UiBase),t.Events.MarkerMove.prototype.type=t.Events.MARKER_MOVE,t.Events.MarkerMove.prototype.toJson=function(){var e=t.Events.MarkerMove.superClass_.toJson.call(this);return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e},t.Events.MarkerMove.prototype.fromJson=function(e){t.Events.MarkerMove.superClass_.fromJson.call(this,e),this.isCursor=e.isCursor,this.blockId=e.blockId,this.oldNode=e.oldNode,this.newNode=e.newNode},t.registry.register(t.registry.Type.EVENT,t.Events.MARKER_MOVE,t.Events.MarkerMove),t.blockRendering.MarkerSvg=function(e,r,a){this.workspace_=e,this.marker_=a,this.parent_=null,this.constants_=r,this.currentMarkerSvg=null,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=a.colour||e},t.blockRendering.MarkerSvg.CURSOR_CLASS="blocklyCursor",t.blockRendering.MarkerSvg.MARKER_CLASS="blocklyMarker",t.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER=.75,t.blockRendering.MarkerSvg.prototype.getSvgRoot=function(){return this.svgGroup_},t.blockRendering.MarkerSvg.prototype.getMarker=function(){return this.marker_},t.blockRendering.MarkerSvg.prototype.isCursor=function(){return"cursor"==this.marker_.type},t.blockRendering.MarkerSvg.prototype.createDom=function(){var e=this.isCursor()?t.blockRendering.MarkerSvg.CURSOR_CLASS:t.blockRendering.MarkerSvg.MARKER_CLASS;return this.svgGroup_=t.utils.dom.createSvgElement(t.utils.Svg.G,{class:e},null),this.createDomInternal_(),this.svgGroup_},t.blockRendering.MarkerSvg.prototype.setParent_=function(e){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent_=e},t.blockRendering.MarkerSvg.prototype.draw=function(e,r){if(r){this.constants_=this.workspace_.getRenderer().getConstants();var a=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker_.colour||a,this.applyColour_(r),this.showAtLocation_(r),this.fireMarkerEvent_(e,r),void 0!==(e=this.currentMarkerSvg.childNodes[0])&&e.beginElement&&e.beginElement()}else this.hide()},t.blockRendering.MarkerSvg.prototype.showAtLocation_=function(e){var r=e.getLocation().type;e.getType()==t.ASTNode.types.BLOCK?this.showWithBlock_(e):e.getType()==t.ASTNode.types.OUTPUT?this.showWithOutput_(e):r==t.connectionTypes.INPUT_VALUE?this.showWithInput_(e):r==t.connectionTypes.NEXT_STATEMENT?this.showWithNext_(e):e.getType()==t.ASTNode.types.PREVIOUS?this.showWithPrevious_(e):e.getType()==t.ASTNode.types.FIELD?this.showWithField_(e):e.getType()==t.ASTNode.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()==t.ASTNode.types.STACK&&this.showWithStack_(e)},t.blockRendering.MarkerSvg.prototype.showWithBlockPrevOutput_=function(e){var r=(e=e.getSourceBlock()).width,a=e.height,c=a*t.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER,p=this.constants_.CURSOR_BLOCK_PADDING;if(e.previousConnection){var f=this.constants_.shapeFor(e.previousConnection);this.positionPrevious_(r,p,c,f)}else e.outputConnection?(f=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(r,a,f)):this.positionBlock_(r,p,c);this.setParent_(e),this.showCurrent_()},t.blockRendering.MarkerSvg.prototype.showWithBlock_=function(e){this.showWithBlockPrevOutput_(e)},t.blockRendering.MarkerSvg.prototype.showWithPrevious_=function(e){this.showWithBlockPrevOutput_(e)},t.blockRendering.MarkerSvg.prototype.showWithOutput_=function(e){this.showWithBlockPrevOutput_(e)},t.blockRendering.MarkerSvg.prototype.showWithCoordinates_=function(e){var r=e.getWsCoordinate();e=r.x,this.workspace_.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,r=r.y,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace_),this.showCurrent_()},t.blockRendering.MarkerSvg.prototype.showWithField_=function(e){var r=(e=e.getLocation()).getSize().width,a=e.getSize().height;this.positionRect_(0,0,r,a),this.setParent_(e),this.showCurrent_()},t.blockRendering.MarkerSvg.prototype.showWithInput_=function(e){var r=(e=e.getLocation()).getSourceBlock();this.positionInput_(e),this.setParent_(r),this.showCurrent_()},t.blockRendering.MarkerSvg.prototype.showWithNext_=function(e){var r=e.getLocation();e=r.getSourceBlock();var a=0;r=r.getOffsetInBlock().y;var c=e.getHeightWidth().width;this.workspace_.RTL&&(a=-c),this.positionLine_(a,r,c),this.setParent_(e),this.showCurrent_()},t.blockRendering.MarkerSvg.prototype.showWithStack_=function(e){var r=(e=e.getLocation()).getHeightWidth(),a=r.width+this.constants_.CURSOR_STACK_PADDING,c=-this.constants_.CURSOR_STACK_PADDING/2,f=c;this.workspace_.RTL&&(f=-(a+c)),this.positionRect_(f,-this.constants_.CURSOR_STACK_PADDING/2,a,r=r.height+this.constants_.CURSOR_STACK_PADDING),this.setParent_(e),this.showCurrent_()},t.blockRendering.MarkerSvg.prototype.showCurrent_=function(){this.hide(),this.currentMarkerSvg.style.display=""},t.blockRendering.MarkerSvg.prototype.positionBlock_=function(e,r,a){e=t.utils.svgPaths.moveBy(-r,a)+t.utils.svgPaths.lineOnAxis("V",-r)+t.utils.svgPaths.lineOnAxis("H",e+2*r)+t.utils.svgPaths.lineOnAxis("V",a),this.markerBlock_.setAttribute("d",e),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},t.blockRendering.MarkerSvg.prototype.positionInput_=function(e){var r=e.getOffsetInBlock().x,a=e.getOffsetInBlock().y;e=t.utils.svgPaths.moveTo(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+r+","+a+")"+(this.workspace_.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_},t.blockRendering.MarkerSvg.prototype.positionLine_=function(e,r,a){this.markerSvgLine_.setAttribute("x",e),this.markerSvgLine_.setAttribute("y",r),this.markerSvgLine_.setAttribute("width",a),this.currentMarkerSvg=this.markerSvgLine_},t.blockRendering.MarkerSvg.prototype.positionOutput_=function(e,r,a){e=t.utils.svgPaths.moveBy(e,0)+t.utils.svgPaths.lineOnAxis("h",-(e-a.width))+t.utils.svgPaths.lineOnAxis("v",this.constants_.TAB_OFFSET_FROM_TOP)+a.pathDown+t.utils.svgPaths.lineOnAxis("V",r)+t.utils.svgPaths.lineOnAxis("H",e),this.markerBlock_.setAttribute("d",e),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},t.blockRendering.MarkerSvg.prototype.positionPrevious_=function(e,r,a,c){e=t.utils.svgPaths.moveBy(-r,a)+t.utils.svgPaths.lineOnAxis("V",-r)+t.utils.svgPaths.lineOnAxis("H",this.constants_.NOTCH_OFFSET_LEFT)+c.pathLeft+t.utils.svgPaths.lineOnAxis("H",e+2*r)+t.utils.svgPaths.lineOnAxis("V",a),this.markerBlock_.setAttribute("d",e),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},t.blockRendering.MarkerSvg.prototype.positionRect_=function(e,r,a,c){this.markerSvgRect_.setAttribute("x",e),this.markerSvgRect_.setAttribute("y",r),this.markerSvgRect_.setAttribute("width",a),this.markerSvgRect_.setAttribute("height",c),this.currentMarkerSvg=this.markerSvgRect_},t.blockRendering.MarkerSvg.prototype.flipRtl_=function(e){e.setAttribute("transform","scale(-1 1)")},t.blockRendering.MarkerSvg.prototype.hide=function(){this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"},t.blockRendering.MarkerSvg.prototype.fireMarkerEvent_=function(e,r){var a=r.getSourceBlock();e=new(t.Events.get(t.Events.MARKER_MOVE))(a,this.isCursor(),e,r),t.Events.fire(e)},t.blockRendering.MarkerSvg.prototype.getBlinkProperties_=function(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}},t.blockRendering.MarkerSvg.prototype.createDomInternal_=function(){if(this.markerSvg_=t.utils.dom.createSvgElement(t.utils.Svg.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=t.utils.dom.createSvgElement(t.utils.Svg.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var e=this.getBlinkProperties_();t.utils.dom.createSvgElement(t.utils.Svg.ANIMATE,e,this.markerSvgLine_),t.utils.dom.createSvgElement(t.utils.Svg.ANIMATE,e,this.markerInput_),e.attributeName="stroke",t.utils.dom.createSvgElement(t.utils.Svg.ANIMATE,e,this.markerBlock_)}return this.markerSvg_},t.blockRendering.MarkerSvg.prototype.applyColour_=function(e){this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(this.markerSvgLine_.firstChild.setAttribute("values",e=this.colour_+";transparent;transparent;"),this.markerInput_.firstChild.setAttribute("values",e),this.markerBlock_.firstChild.setAttribute("values",e))},t.blockRendering.MarkerSvg.prototype.dispose=function(){this.svgGroup_&&t.utils.dom.removeNode(this.svgGroup_)},t.blockRendering.PathObject=function(e,r,a){this.constants=a,this.svgRoot=e,this.svgPath=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.style=r,this.markerSvg=this.cursorSvg=null},t.blockRendering.PathObject.prototype.setPath=function(e){this.svgPath.setAttribute("d",e)},t.blockRendering.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)")},t.blockRendering.PathObject.prototype.setCursorSvg=function(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null},t.blockRendering.PathObject.prototype.setMarkerSvg=function(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null},t.blockRendering.PathObject.prototype.applyColour=function(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())},t.blockRendering.PathObject.prototype.setStyle=function(e){this.style=e},t.blockRendering.PathObject.prototype.setClass_=function(e,r){r?t.utils.dom.addClass(this.svgRoot,e):t.utils.dom.removeClass(this.svgRoot,e)},t.blockRendering.PathObject.prototype.updateHighlighted=function(e){this.svgPath.setAttribute("filter",e?"url(#"+this.constants.embossFilterId+")":"none")},t.blockRendering.PathObject.prototype.updateShadow_=function(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},t.blockRendering.PathObject.prototype.updateDisabled_=function(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")},t.blockRendering.PathObject.prototype.updateSelected=function(e){this.setClass_("blocklySelected",e)},t.blockRendering.PathObject.prototype.updateDraggingDelete=function(e){this.setClass_("blocklyDraggingDelete",e)},t.blockRendering.PathObject.prototype.updateInsertionMarker=function(e){this.setClass_("blocklyInsertionMarker",e)},t.blockRendering.PathObject.prototype.updateMovable=function(e){this.setClass_("blocklyDraggable",e)},t.blockRendering.PathObject.prototype.updateReplacementFade=function(e){this.setClass_("blocklyReplaceable",e)},t.blockRendering.PathObject.prototype.updateShapeForInputHighlight=function(e,r){},t.blockRendering.Renderer=function(e){this.name=e,this.overrides=this.constants_=null},t.blockRendering.Renderer.prototype.getClassName=function(){return this.name+"-renderer"},t.blockRendering.Renderer.prototype.init=function(e,r){this.constants_=this.makeConstants_(),r&&(this.overrides=r,t.utils.object.mixin(this.constants_,r)),this.constants_.setTheme(e),this.constants_.init()},t.blockRendering.Renderer.prototype.createDom=function(e,r){this.constants_.createDom(e,this.name+"-"+r.name,"."+this.getClassName()+"."+r.getClassName())},t.blockRendering.Renderer.prototype.refreshDom=function(e,r){var a=this.getConstants();a.dispose(),this.constants_=this.makeConstants_(),this.overrides&&t.utils.object.mixin(this.constants_,this.overrides),this.constants_.randomIdentifier=a.randomIdentifier,this.constants_.setTheme(r),this.constants_.init(),this.createDom(e,r)},t.blockRendering.Renderer.prototype.dispose=function(){this.constants_&&this.constants_.dispose()},t.blockRendering.Renderer.prototype.makeConstants_=function(){return new t.blockRendering.ConstantProvider},t.blockRendering.Renderer.prototype.makeRenderInfo_=function(e){return new t.blockRendering.RenderInfo(this,e)},t.blockRendering.Renderer.prototype.makeDrawer_=function(e,r){return new t.blockRendering.Drawer(e,r)},t.blockRendering.Renderer.prototype.makeDebugger_=function(){if(!t.blockRendering.Debug)throw Error("Missing require for Blockly.blockRendering.Debug");return new t.blockRendering.Debug(this.getConstants())},t.blockRendering.Renderer.prototype.makeMarkerDrawer=function(e,r){return new t.blockRendering.MarkerSvg(e,this.getConstants(),r)},t.blockRendering.Renderer.prototype.makePathObject=function(e,r){return new t.blockRendering.PathObject(e,r,this.constants_)},t.blockRendering.Renderer.prototype.getConstants=function(){return this.constants_},t.blockRendering.Renderer.prototype.shouldHighlightConnection=function(e){return!0},t.blockRendering.Renderer.prototype.orphanCanConnectAtEnd=function(e,r,a){return!!t.Connection.getConnectionForOrphanedConnection(e,a===t.connectionTypes.OUTPUT_VALUE?r.outputConnection:r.previousConnection)},t.blockRendering.Renderer.prototype.getConnectionPreviewMethod=function(e,r,a){return r.type==t.connectionTypes.OUTPUT_VALUE||r.type==t.connectionTypes.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(a,e.targetBlock(),r.type)?t.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:t.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:t.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER},t.blockRendering.Renderer.prototype.render=function(e){t.blockRendering.useDebugger&&!e.renderingDebugger&&(e.renderingDebugger=this.makeDebugger_());var r=this.makeRenderInfo_(e);r.measure(),this.makeDrawer_(e,r).draw()},t.geras={},t.geras.ConstantProvider=function(){t.geras.ConstantProvider.superClass_.constructor.call(this),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2},t.utils.object.inherits(t.geras.ConstantProvider,t.blockRendering.ConstantProvider),t.geras.ConstantProvider.prototype.getCSS_=function(e){return t.geras.ConstantProvider.superClass_.getCSS_.call(this,e).concat([e+" .blocklyInsertionMarker>.blocklyPathLight,",e+" .blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"])},t.geras.Highlighter=function(e){this.info_=e,this.inlineSteps_=this.steps_="",this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH},t.geras.Highlighter.prototype.getPath=function(){return this.steps_+"\n"+this.inlineSteps_},t.geras.Highlighter.prototype.drawTopCorner=function(e){this.steps_+=t.utils.svgPaths.moveBy(e.xPos,this.info_.startY);for(var a,r=0;a=e.elements[r];r++)t.blockRendering.Types.isLeftSquareCorner(a)?this.steps_+=this.highlightConstants_.START_POINT:t.blockRendering.Types.isLeftRoundedCorner(a)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):t.blockRendering.Types.isPreviousConnection(a)?this.steps_+=this.notchPaths_.pathLeft:t.blockRendering.Types.isHat(a)?this.steps_+=this.startPaths_.path(this.RTL_):t.blockRendering.Types.isSpacer(a)&&0!=a.width&&(this.steps_+=t.utils.svgPaths.lineOnAxis("H",a.xPos+a.width-this.highlightOffset_));this.steps_+=t.utils.svgPaths.lineOnAxis("H",e.xPos+e.width-this.highlightOffset_)},t.geras.Highlighter.prototype.drawJaggedEdge_=function(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+t.utils.svgPaths.lineOnAxis("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset_))},t.geras.Highlighter.prototype.drawValueInput=function(e){var r=e.getLastInput();if(this.RTL_){var a=e.height-r.connectionHeight;this.steps_+=t.utils.svgPaths.moveTo(r.xPos+r.width-this.highlightOffset_,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+t.utils.svgPaths.lineOnAxis("v",a)}else this.steps_+=t.utils.svgPaths.moveTo(r.xPos+r.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)},t.geras.Highlighter.prototype.drawStatementInput=function(e){var r=e.getLastInput();if(this.RTL_){var a=e.height-2*this.insideCornerPaths_.height;this.steps_+=t.utils.svgPaths.moveTo(r.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+t.utils.svgPaths.lineOnAxis("v",a)+this.insideCornerPaths_.pathBottom(this.RTL_)+t.utils.svgPaths.lineTo(e.width-r.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=t.utils.svgPaths.moveTo(r.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+t.utils.svgPaths.lineTo(e.width-r.xPos-this.insideCornerPaths_.width,0)},t.geras.Highlighter.prototype.drawRightSideRow=function(e){var r=e.xPos+e.width-this.highlightOffset_;e.followsStatement&&(this.steps_+=t.utils.svgPaths.lineOnAxis("H",r)),this.RTL_&&(this.steps_+=t.utils.svgPaths.lineOnAxis("H",r),e.height>this.highlightOffset_&&(this.steps_+=t.utils.svgPaths.lineOnAxis("V",e.yPos+e.height-this.highlightOffset_)))},t.geras.Highlighter.prototype.drawBottomRow=function(e){if(this.RTL_)this.steps_+=t.utils.svgPaths.lineOnAxis("V",e.baseline-this.highlightOffset_);else{var r=this.info_.bottomRow.elements[0];t.blockRendering.Types.isLeftSquareCorner(r)?this.steps_+=t.utils.svgPaths.moveTo(e.xPos+this.highlightOffset_,e.baseline-this.highlightOffset_):t.blockRendering.Types.isLeftRoundedCorner(r)&&(this.steps_+=t.utils.svgPaths.moveTo(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}},t.geras.Highlighter.prototype.drawLeft=function(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=t.utils.svgPaths.moveTo(this.info_.startX,e):(this.steps_+=t.utils.svgPaths.moveTo(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=t.utils.svgPaths.lineOnAxis("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(t.blockRendering.Types.isLeftRoundedCorner((e=this.info_.topRow).elements[0])?this.steps_+=t.utils.svgPaths.lineOnAxis("V",this.outsideCornerPaths_.height):this.steps_+=t.utils.svgPaths.lineOnAxis("V",e.capline+this.highlightOffset_))},t.geras.Highlighter.prototype.drawInlineInput=function(e){var r=this.highlightOffset_,a=e.xPos+e.connectionWidth,c=e.centerline-e.height/2,p=e.width-e.connectionWidth,f=c+r;this.RTL_?(c=e.connectionOffsetY-r,e=e.height-(e.connectionOffsetY+e.connectionHeight)+r,this.inlineSteps_+=t.utils.svgPaths.moveTo(a-r,f)+t.utils.svgPaths.lineOnAxis("v",c)+this.puzzleTabPaths_.pathDown(this.RTL_)+t.utils.svgPaths.lineOnAxis("v",e)+t.utils.svgPaths.lineOnAxis("h",p)):this.inlineSteps_+=t.utils.svgPaths.moveTo(e.xPos+e.width+r,f)+t.utils.svgPaths.lineOnAxis("v",e.height)+t.utils.svgPaths.lineOnAxis("h",-p)+t.utils.svgPaths.moveTo(a,c+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)},t.geras.InlineInput=function(e,r){t.geras.InlineInput.superClass_.constructor.call(this,e,r),this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)},t.utils.object.inherits(t.geras.InlineInput,t.blockRendering.InlineInput),t.geras.StatementInput=function(e,r){t.geras.StatementInput.superClass_.constructor.call(this,e,r),this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)},t.utils.object.inherits(t.geras.StatementInput,t.blockRendering.StatementInput),t.geras.RenderInfo=function(e,r){t.geras.RenderInfo.superClass_.constructor.call(this,e,r)},t.utils.object.inherits(t.geras.RenderInfo,t.blockRendering.RenderInfo),t.geras.RenderInfo.prototype.getRenderer=function(){return this.renderer_},t.geras.RenderInfo.prototype.populateBottomRow_=function(){t.geras.RenderInfo.superClass_.populateBottomRow_.call(this),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==t.inputTypes.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)},t.geras.RenderInfo.prototype.addInput_=function(e,r){this.isInline&&e.type==t.inputTypes.VALUE?(r.elements.push(new t.geras.InlineInput(this.constants_,e)),r.hasInlineInput=!0):e.type==t.inputTypes.STATEMENT?(r.elements.push(new t.geras.StatementInput(this.constants_,e)),r.hasStatement=!0):e.type==t.inputTypes.VALUE?(r.elements.push(new t.blockRendering.ExternalValueInput(this.constants_,e)),r.hasExternalInput=!0):e.type==t.inputTypes.DUMMY&&(r.minHeight=Math.max(r.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),r.hasDummyInput=!0),this.isInline||null!=r.align||(r.align=e.align)},t.geras.RenderInfo.prototype.addElemSpacing_=function(){for(var a,e=!1,r=0;a=this.rows[r];r++)a.hasExternalInput&&(e=!0);for(r=0;a=this.rows[r];r++){var c=a.elements;if(a.elements=[],a.startsWithElemSpacer()&&a.elements.push(new t.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,c[0]))),c.length){for(var p=0;p<c.length-1;p++){a.elements.push(c[p]);var f=this.getInRowSpacing_(c[p],c[p+1]);a.elements.push(new t.blockRendering.InRowSpacer(this.constants_,f))}a.elements.push(c[c.length-1]),a.endsWithElemSpacer()&&(f=this.getInRowSpacing_(c[c.length-1],null),e&&a.hasDummyInput&&(f+=this.constants_.TAB_WIDTH),a.elements.push(new t.blockRendering.InRowSpacer(this.constants_,f)))}}},t.geras.RenderInfo.prototype.getInRowSpacing_=function(e,r){if(!e)return r&&t.blockRendering.Types.isField(r)&&r.isEditable?this.constants_.MEDIUM_PADDING:r&&t.blockRendering.Types.isInlineInput(r)?this.constants_.MEDIUM_LARGE_PADDING:r&&t.blockRendering.Types.isStatementInput(r)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!t.blockRendering.Types.isInput(e)&&(!r||t.blockRendering.Types.isStatementInput(r)))return t.blockRendering.Types.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:t.blockRendering.Types.isIcon(e)?2*this.constants_.LARGE_PADDING+1:t.blockRendering.Types.isHat(e)?this.constants_.NO_PADDING:t.blockRendering.Types.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:t.blockRendering.Types.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:t.blockRendering.Types.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(t.blockRendering.Types.isInput(e)&&!r){if(t.blockRendering.Types.isExternalInput(e))return this.constants_.NO_PADDING;if(t.blockRendering.Types.isInlineInput(e))return this.constants_.LARGE_PADDING;if(t.blockRendering.Types.isStatementInput(e))return this.constants_.NO_PADDING}if(!t.blockRendering.Types.isInput(e)&&r&&t.blockRendering.Types.isInput(r)){if(t.blockRendering.Types.isField(e)&&e.isEditable){if(t.blockRendering.Types.isInlineInput(r)||t.blockRendering.Types.isExternalInput(r))return this.constants_.SMALL_PADDING}else{if(t.blockRendering.Types.isInlineInput(r)||t.blockRendering.Types.isExternalInput(r))return this.constants_.MEDIUM_LARGE_PADDING;if(t.blockRendering.Types.isStatementInput(r))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(t.blockRendering.Types.isIcon(e)&&r&&!t.blockRendering.Types.isInput(r))return this.constants_.LARGE_PADDING;if(t.blockRendering.Types.isInlineInput(e)&&r&&t.blockRendering.Types.isField(r))return r.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(t.blockRendering.Types.isLeftSquareCorner(e)&&r){if(t.blockRendering.Types.isHat(r))return this.constants_.NO_PADDING;if(t.blockRendering.Types.isPreviousConnection(r))return r.notchOffset;if(t.blockRendering.Types.isNextConnection(r))return r.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(t.blockRendering.Types.isLeftRoundedCorner(e)&&r){if(t.blockRendering.Types.isPreviousConnection(r))return r.notchOffset-this.constants_.CORNER_RADIUS;if(t.blockRendering.Types.isNextConnection(r))return r.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return t.blockRendering.Types.isField(e)&&r&&t.blockRendering.Types.isField(r)&&e.isEditable==r.isEditable||r&&t.blockRendering.Types.isJaggedEdge(r)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},t.geras.RenderInfo.prototype.getSpacerRowHeight_=function(e,r){return t.blockRendering.Types.isTopRow(e)&&t.blockRendering.Types.isBottomRow(r)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:t.blockRendering.Types.isTopRow(e)||t.blockRendering.Types.isBottomRow(r)?this.constants_.NO_PADDING:e.hasExternalInput&&r.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&r.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&r.hasStatement||!e.hasStatement&&r.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},t.geras.RenderInfo.prototype.getElemCenterline_=function(e,r){if(t.blockRendering.Types.isSpacer(r))return e.yPos+r.height/2;if(t.blockRendering.Types.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,t.blockRendering.Types.isNextConnection(r)?e+r.height/2:e-r.height/2;if(t.blockRendering.Types.isTopRow(e))return t.blockRendering.Types.isHat(r)?e.capline-r.height/2:e.capline+r.height/2;var a=e.yPos;return t.blockRendering.Types.isField(r)||t.blockRendering.Types.isIcon(r)?(a+=r.height/2,(e.hasInlineInput||e.hasStatement)&&r.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(a+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):a=t.blockRendering.Types.isInlineInput(r)?a+r.height/2:a+e.height/2,a},t.geras.RenderInfo.prototype.alignRowElements_=function(){if(this.isInline){for(var c,e=0,r=null,a=this.rows.length-1;c=this.rows[a];a--)c.nextRightEdge=e,t.blockRendering.Types.isInputRow(c)&&(c.hasStatement&&this.alignStatementRow_(c),r&&r.hasStatement&&c.width<r.width?c.nextRightEdge=r.width:e=c.width,r=c);for(a=e=0;c=this.rows[a];a++)c.hasStatement?e=this.getDesiredRowWidth_(c):t.blockRendering.Types.isSpacer(c)?c.width=Math.max(e,c.nextRightEdge):(0<(e=Math.max(e,c.nextRightEdge)-c.width)&&this.addAlignmentPadding_(c,e),e=c.width)}else t.geras.RenderInfo.superClass_.alignRowElements_.call(this)},t.geras.RenderInfo.prototype.getDesiredRowWidth_=function(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:t.geras.RenderInfo.superClass_.getDesiredRowWidth_.call(this,e)},t.geras.RenderInfo.prototype.finalize_=function(){for(var c,e=0,r=0,a=0;c=this.rows[a];a++){c.yPos=r,c.xPos=this.startX,r+=c.height,e=Math.max(e,c.widthWithConnectedBlocks);var p=r-this.topRow.ascenderHeight;c==this.bottomRow&&p<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=p=this.constants_.MIN_BLOCK_HEIGHT-p,r+=p),this.recordElemPositions_(c)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=r-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=r+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline},t.geras.Drawer=function(e,r){t.geras.Drawer.superClass_.constructor.call(this,e,r),this.highlighter_=new t.geras.Highlighter(r)},t.utils.object.inherits(t.geras.Drawer,t.blockRendering.Drawer),t.geras.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();var e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),t.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},t.geras.Drawer.prototype.drawTop_=function(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),t.geras.Drawer.superClass_.drawTop_.call(this)},t.geras.Drawer.prototype.drawJaggedEdge_=function(e){this.highlighter_.drawJaggedEdge_(e),t.geras.Drawer.superClass_.drawJaggedEdge_.call(this,e)},t.geras.Drawer.prototype.drawValueInput_=function(e){this.highlighter_.drawValueInput(e),t.geras.Drawer.superClass_.drawValueInput_.call(this,e)},t.geras.Drawer.prototype.drawStatementInput_=function(e){this.highlighter_.drawStatementInput(e),t.geras.Drawer.superClass_.drawStatementInput_.call(this,e)},t.geras.Drawer.prototype.drawRightSideRow_=function(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=t.utils.svgPaths.lineOnAxis("H",e.xPos+e.width)+t.utils.svgPaths.lineOnAxis("V",e.yPos+e.height)},t.geras.Drawer.prototype.drawBottom_=function(){this.highlighter_.drawBottomRow(this.info_.bottomRow),t.geras.Drawer.superClass_.drawBottom_.call(this)},t.geras.Drawer.prototype.drawLeft_=function(){this.highlighter_.drawLeft(),t.geras.Drawer.superClass_.drawLeft_.call(this)},t.geras.Drawer.prototype.drawInlineInput_=function(e){this.highlighter_.drawInlineInput(e),t.geras.Drawer.superClass_.drawInlineInput_.call(this,e)},t.geras.Drawer.prototype.positionInlineInputConnection_=function(e){if(e.connectionModel){var a=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(a*=-1),e.connectionModel.setOffsetInBlock(a,e.centerline-e.height/2+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}},t.geras.Drawer.prototype.positionStatementInputConnection_=function(e){var r=e.getLastInput();if(r.connectionModel){var a=e.xPos+e.statementEdge+r.notchOffset;r.connectionModel.setOffsetInBlock(a=this.info_.RTL?-1*a:a+this.constants_.DARK_PATH_OFFSET,e.yPos+this.constants_.DARK_PATH_OFFSET)}},t.geras.Drawer.prototype.positionExternalValueConnection_=function(e){var r=e.getLastInput();if(r.connectionModel){var a=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(a*=-1),r.connectionModel.setOffsetInBlock(a,e.yPos)}},t.geras.Drawer.prototype.positionNextConnection_=function(){var e=this.info_.bottomRow;if(e.connection){var r=e.connection,a=r.xPos;r.connectionModel.setOffsetInBlock((this.info_.RTL?-a:a)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}},t.geras.HighlightConstantProvider=function(e){this.constantProvider=e,this.OFFSET=.5,this.START_POINT=t.utils.svgPaths.moveBy(this.OFFSET,this.OFFSET)},t.geras.HighlightConstantProvider.prototype.init=function(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()},t.geras.HighlightConstantProvider.prototype.makeInsideCorner=function(){var e=this.constantProvider.CORNER_RADIUS,r=this.OFFSET,a=(1-Math.SQRT1_2)*(e+r)-r,c=t.utils.svgPaths.moveBy(a,a)+t.utils.svgPaths.arc("a","0 0,0",e,t.utils.svgPaths.point(-a-r,e-a)),p=t.utils.svgPaths.arc("a","0 0,0",e+r,t.utils.svgPaths.point(e+r,e+r)),f=t.utils.svgPaths.moveBy(a,-a)+t.utils.svgPaths.arc("a","0 0,0",e+r,t.utils.svgPaths.point(e-a,a+r));return{width:e+r,height:e,pathTop:function(T){return T?c:""},pathBottom:function(T){return T?p:f}}},t.geras.HighlightConstantProvider.prototype.makeOutsideCorner=function(){var e=this.constantProvider.CORNER_RADIUS,r=this.OFFSET,a=(1-Math.SQRT1_2)*(e-r)+r,c=t.utils.svgPaths.moveBy(a,a)+t.utils.svgPaths.arc("a","0 0,1",e-r,t.utils.svgPaths.point(e-a,-a+r)),p=t.utils.svgPaths.moveBy(r,e)+t.utils.svgPaths.arc("a","0 0,1",e-r,t.utils.svgPaths.point(e,-e+r)),f=-a,T=t.utils.svgPaths.moveBy(a,f)+t.utils.svgPaths.arc("a","0 0,1",e-r,t.utils.svgPaths.point(-a+r,-f-e));return{height:e,topLeft:function(y){return y?c:p},bottomLeft:function(){return T}}},t.geras.HighlightConstantProvider.prototype.makePuzzleTab=function(){var e=this.constantProvider.TAB_WIDTH,r=this.constantProvider.TAB_HEIGHT,a=t.utils.svgPaths.moveBy(-2,3.4-r)+t.utils.svgPaths.lineTo(-.45*e,-2.1),c=t.utils.svgPaths.lineOnAxis("v",2.5)+t.utils.svgPaths.moveBy(.97*-e,2.5)+t.utils.svgPaths.curve("q",[t.utils.svgPaths.point(.05*-e,10),t.utils.svgPaths.point(.3*e,9.5)])+t.utils.svgPaths.moveBy(.67*e,-1.9)+t.utils.svgPaths.lineOnAxis("v",2.5),p=t.utils.svgPaths.lineOnAxis("v",-1.5)+t.utils.svgPaths.moveBy(-.92*e,-.5)+t.utils.svgPaths.curve("q",[t.utils.svgPaths.point(-.19*e,-5.5),t.utils.svgPaths.point(0,-11)])+t.utils.svgPaths.moveBy(.92*e,1),f=t.utils.svgPaths.moveBy(-5,r-.7)+t.utils.svgPaths.lineTo(.46*e,-2.1);return{width:e,height:r,pathUp:function(T){return T?a:p},pathDown:function(T){return T?c:f}}},t.geras.HighlightConstantProvider.prototype.makeNotch=function(){return{pathLeft:t.utils.svgPaths.lineOnAxis("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}},t.geras.HighlightConstantProvider.prototype.makeJaggedTeeth=function(){return{pathLeft:t.utils.svgPaths.lineTo(5.1,2.6)+t.utils.svgPaths.moveBy(-10.2,6.8)+t.utils.svgPaths.lineTo(5.1,2.6),height:12,width:10.2}},t.geras.HighlightConstantProvider.prototype.makeStartHat=function(){var e=this.constantProvider.START_HAT.height,r=t.utils.svgPaths.moveBy(25,-8.7)+t.utils.svgPaths.curve("c",[t.utils.svgPaths.point(29.7,-6.2),t.utils.svgPaths.point(57.2,-.5),t.utils.svgPaths.point(75,8.7)]),a=t.utils.svgPaths.curve("c",[t.utils.svgPaths.point(17.8,-9.2),t.utils.svgPaths.point(45.3,-14.9),t.utils.svgPaths.point(75,-8.7)])+t.utils.svgPaths.moveTo(100.5,e+.5);return{path:function(c){return c?r:a}}},t.geras.PathObject=function(e,r,a){this.constants=a,this.svgRoot=e,this.svgPathDark=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot),this.svgPath=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.svgPathLight=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyPathLight"},this.svgRoot),this.colourDark="#000000",this.style=r},t.utils.object.inherits(t.geras.PathObject,t.blockRendering.PathObject),t.geras.PathObject.prototype.setPath=function(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)},t.geras.PathObject.prototype.setHighlightPath=function(e){this.svgPathLight.setAttribute("d",e)},t.geras.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")},t.geras.PathObject.prototype.applyColour=function(e){this.svgPathLight.style.display="",this.svgPathDark.style.display="",this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),t.geras.PathObject.superClass_.applyColour.call(this,e),this.svgPath.setAttribute("stroke","none")},t.geras.PathObject.prototype.setStyle=function(e){this.style=e,this.colourDark=t.utils.colour.blend("#000",this.style.colourPrimary,.2)||this.colourDark},t.geras.PathObject.prototype.updateHighlighted=function(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")},t.geras.PathObject.prototype.updateShadow_=function(e){e&&(this.svgPathLight.style.display="none",this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},t.geras.PathObject.prototype.updateDisabled_=function(e){t.geras.PathObject.superClass_.updateDisabled_.call(this,e),e&&this.svgPath.setAttribute("stroke","none")},t.geras.Renderer=function(e){t.geras.Renderer.superClass_.constructor.call(this,e),this.highlightConstants_=null},t.utils.object.inherits(t.geras.Renderer,t.blockRendering.Renderer),t.geras.Renderer.prototype.init=function(e,r){t.geras.Renderer.superClass_.init.call(this,e,r),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()},t.geras.Renderer.prototype.refreshDom=function(e,r){t.geras.Renderer.superClass_.refreshDom.call(this,e,r),this.getHighlightConstants().init()},t.geras.Renderer.prototype.makeConstants_=function(){return new t.geras.ConstantProvider},t.geras.Renderer.prototype.makeRenderInfo_=function(e){return new t.geras.RenderInfo(this,e)},t.geras.Renderer.prototype.makeDrawer_=function(e,r){return new t.geras.Drawer(e,r)},t.geras.Renderer.prototype.makePathObject=function(e,r){return new t.geras.PathObject(e,r,this.getConstants())},t.geras.Renderer.prototype.makeHighlightConstants_=function(){return new t.geras.HighlightConstantProvider(this.getConstants())},t.geras.Renderer.prototype.getHighlightConstants=function(){return this.highlightConstants_},t.blockRendering.register("geras",t.geras.Renderer),t.thrasos={},t.thrasos.RenderInfo=function(e,r){t.thrasos.RenderInfo.superClass_.constructor.call(this,e,r)},t.utils.object.inherits(t.thrasos.RenderInfo,t.blockRendering.RenderInfo),t.thrasos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},t.thrasos.RenderInfo.prototype.addElemSpacing_=function(){for(var a,e=!1,r=0;a=this.rows[r];r++)a.hasExternalInput&&(e=!0);for(r=0;a=this.rows[r];r++){var c=a.elements;a.elements=[],a.startsWithElemSpacer()&&a.elements.push(new t.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,c[0])));for(var p=0;p<c.length-1;p++){a.elements.push(c[p]);var f=this.getInRowSpacing_(c[p],c[p+1]);a.elements.push(new t.blockRendering.InRowSpacer(this.constants_,f))}a.elements.push(c[c.length-1]),a.endsWithElemSpacer()&&(f=this.getInRowSpacing_(c[c.length-1],null),e&&a.hasDummyInput&&(f+=this.constants_.TAB_WIDTH),a.elements.push(new t.blockRendering.InRowSpacer(this.constants_,f)))}},t.thrasos.RenderInfo.prototype.getInRowSpacing_=function(e,r){if(!e)return r&&t.blockRendering.Types.isField(r)&&r.isEditable?this.constants_.MEDIUM_PADDING:r&&t.blockRendering.Types.isInlineInput(r)?this.constants_.MEDIUM_LARGE_PADDING:r&&t.blockRendering.Types.isStatementInput(r)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!t.blockRendering.Types.isInput(e)&&!r)return t.blockRendering.Types.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:t.blockRendering.Types.isIcon(e)?2*this.constants_.LARGE_PADDING+1:t.blockRendering.Types.isHat(e)?this.constants_.NO_PADDING:t.blockRendering.Types.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:t.blockRendering.Types.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:t.blockRendering.Types.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(t.blockRendering.Types.isInput(e)&&!r){if(t.blockRendering.Types.isExternalInput(e))return this.constants_.NO_PADDING;if(t.blockRendering.Types.isInlineInput(e))return this.constants_.LARGE_PADDING;if(t.blockRendering.Types.isStatementInput(e))return this.constants_.NO_PADDING}if(!t.blockRendering.Types.isInput(e)&&r&&t.blockRendering.Types.isInput(r)){if(t.blockRendering.Types.isField(e)&&e.isEditable){if(t.blockRendering.Types.isInlineInput(r)||t.blockRendering.Types.isExternalInput(r))return this.constants_.SMALL_PADDING}else{if(t.blockRendering.Types.isInlineInput(r)||t.blockRendering.Types.isExternalInput(r))return this.constants_.MEDIUM_LARGE_PADDING;if(t.blockRendering.Types.isStatementInput(r))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(t.blockRendering.Types.isIcon(e)&&r&&!t.blockRendering.Types.isInput(r))return this.constants_.LARGE_PADDING;if(t.blockRendering.Types.isInlineInput(e)&&r&&t.blockRendering.Types.isField(r))return r.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(t.blockRendering.Types.isLeftSquareCorner(e)&&r){if(t.blockRendering.Types.isHat(r))return this.constants_.NO_PADDING;if(t.blockRendering.Types.isPreviousConnection(r)||t.blockRendering.Types.isNextConnection(r))return r.notchOffset}return t.blockRendering.Types.isLeftRoundedCorner(e)&&r?r.notchOffset-this.constants_.CORNER_RADIUS:t.blockRendering.Types.isField(e)&&r&&t.blockRendering.Types.isField(r)&&e.isEditable==r.isEditable||r&&t.blockRendering.Types.isJaggedEdge(r)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},t.thrasos.RenderInfo.prototype.getSpacerRowHeight_=function(e,r){return t.blockRendering.Types.isTopRow(e)&&t.blockRendering.Types.isBottomRow(r)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:t.blockRendering.Types.isTopRow(e)||t.blockRendering.Types.isBottomRow(r)?this.constants_.NO_PADDING:e.hasExternalInput&&r.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&r.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&r.hasStatement||e.hasDummyInput||r.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},t.thrasos.RenderInfo.prototype.getElemCenterline_=function(e,r){if(t.blockRendering.Types.isSpacer(r))return e.yPos+r.height/2;if(t.blockRendering.Types.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,t.blockRendering.Types.isNextConnection(r)?e+r.height/2:e-r.height/2;if(t.blockRendering.Types.isTopRow(e))return t.blockRendering.Types.isHat(r)?e.capline-r.height/2:e.capline+r.height/2;var a=e.yPos;return t.blockRendering.Types.isField(r)&&e.hasStatement?a+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+r.height/2):a+e.height/2},t.thrasos.RenderInfo.prototype.finalize_=function(){for(var c,e=0,r=0,a=0;c=this.rows[a];a++){c.yPos=r,c.xPos=this.startX,r+=c.height,e=Math.max(e,c.widthWithConnectedBlocks);var p=r-this.topRow.ascenderHeight;c==this.bottomRow&&p<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=p=this.constants_.MIN_BLOCK_HEIGHT-p,r+=p),this.recordElemPositions_(c)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.bottomRow.baseline=r-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=r,this.startY=this.topRow.capline},t.thrasos.Renderer=function(e){t.thrasos.Renderer.superClass_.constructor.call(this,e)},t.utils.object.inherits(t.thrasos.Renderer,t.blockRendering.Renderer),t.thrasos.Renderer.prototype.makeRenderInfo_=function(e){return new t.thrasos.RenderInfo(this,e)},t.blockRendering.register("thrasos",t.thrasos.Renderer),t.zelos={},t.zelos.ConstantProvider=function(){t.zelos.ConstantProvider.superClass_.constructor.call(this),this.SMALL_PADDING=this.GRID_UNIT=4,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TAB_OFFSET_FROM_TOP=0,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.replacementGlowFilter_=null},t.utils.object.inherits(t.zelos.ConstantProvider,t.blockRendering.ConstantProvider),t.zelos.ConstantProvider.prototype.setFontConstants_=function(e){t.zelos.ConstantProvider.superClass_.setFontConstants_.call(this,e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING},t.zelos.ConstantProvider.prototype.init=function(){t.zelos.ConstantProvider.superClass_.init.call(this),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth},t.zelos.ConstantProvider.prototype.setDynamicProperties_=function(e){t.zelos.ConstantProvider.superClass_.setDynamicProperties_.call(this,e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var r=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=r&&!isNaN(r)?r:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE},t.zelos.ConstantProvider.prototype.dispose=function(){t.zelos.ConstantProvider.superClass_.dispose.call(this),this.selectedGlowFilter_&&t.utils.dom.removeNode(this.selectedGlowFilter_),this.replacementGlowFilter_&&t.utils.dom.removeNode(this.replacementGlowFilter_)},t.zelos.ConstantProvider.prototype.makeStartHat=function(){var e=this.START_HAT_HEIGHT,r=this.START_HAT_WIDTH;return{height:e,width:r,path:t.utils.svgPaths.curve("c",[t.utils.svgPaths.point(25,-e),t.utils.svgPaths.point(71,-e),t.utils.svgPaths.point(r,0)])}},t.zelos.ConstantProvider.prototype.makeHexagonal=function(){function e(a,c,p){var f=a/2;return t.utils.svgPaths.lineTo(-(p=p?-1:1)*(f=f>r?r:f),a=(c?-1:1)*a/2)+t.utils.svgPaths.lineTo(p*f,a)}var r=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function(a){return(a/=2)>r?r:a},height:function(a){return a},connectionOffsetY:function(a){return a/2},connectionOffsetX:function(a){return-a},pathDown:function(a){return e(a,!1,!1)},pathUp:function(a){return e(a,!0,!1)},pathRightDown:function(a){return e(a,!1,!0)},pathRightUp:function(a){return e(a,!1,!0)}}},t.zelos.ConstantProvider.prototype.makeRounded=function(){function e(c,p,f){var T=c>a?c-a:0;return t.utils.svgPaths.arc("a","0 0,1",c=(c>a?a:c)/2,t.utils.svgPaths.point((p?-1:1)*c,(p?-1:1)*c))+t.utils.svgPaths.lineOnAxis("v",(f?1:-1)*T)+t.utils.svgPaths.arc("a","0 0,1",c,t.utils.svgPaths.point((p?1:-1)*c,(p?-1:1)*c))}var r=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,a=2*r;return{type:this.SHAPES.ROUND,isDynamic:!0,width:function(c){return(c/=2)>r?r:c},height:function(c){return c},connectionOffsetY:function(c){return c/2},connectionOffsetX:function(c){return-c},pathDown:function(c){return e(c,!1,!1)},pathUp:function(c){return e(c,!0,!1)},pathRightDown:function(c){return e(c,!1,!0)},pathRightUp:function(c){return e(c,!1,!0)}}},t.zelos.ConstantProvider.prototype.makeSquared=function(){function e(a,c,p){return a-=2*r,t.utils.svgPaths.arc("a","0 0,1",r,t.utils.svgPaths.point((c?-1:1)*r,(c?-1:1)*r))+t.utils.svgPaths.lineOnAxis("v",(p?1:-1)*a)+t.utils.svgPaths.arc("a","0 0,1",r,t.utils.svgPaths.point((c?1:-1)*r,(c?-1:1)*r))}var r=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function(a){return r},height:function(a){return a},connectionOffsetY:function(a){return a/2},connectionOffsetX:function(a){return-a},pathDown:function(a){return e(a,!1,!1)},pathUp:function(a){return e(a,!0,!1)},pathRightDown:function(a){return e(a,!1,!0)},pathRightUp:function(a){return e(a,!1,!0)}}},t.zelos.ConstantProvider.prototype.shapeFor=function(e){var r=e.getCheck();switch(!r&&e.targetConnection&&(r=e.targetConnection.getCheck()),e.type){case t.connectionTypes.INPUT_VALUE:case t.connectionTypes.OUTPUT_VALUE:if(null!=(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return r&&-1!=r.indexOf("Boolean")?this.HEXAGONAL:(r&&-1!=r.indexOf("Number")||r&&r.indexOf("String"),this.ROUNDED);case t.connectionTypes.PREVIOUS_STATEMENT:case t.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}},t.zelos.ConstantProvider.prototype.makeNotch=function(){function e(k){return t.utils.svgPaths.curve("c",[t.utils.svgPaths.point(k*p/2,0),t.utils.svgPaths.point(k*p*3/4,T/2),t.utils.svgPaths.point(k*p,T)])+t.utils.svgPaths.line([t.utils.svgPaths.point(k*p,f)])+t.utils.svgPaths.curve("c",[t.utils.svgPaths.point(k*p/4,T/2),t.utils.svgPaths.point(k*p/2,T),t.utils.svgPaths.point(k*p,T)])+t.utils.svgPaths.lineOnAxis("h",k*c)+t.utils.svgPaths.curve("c",[t.utils.svgPaths.point(k*p/2,0),t.utils.svgPaths.point(k*p*3/4,-T/2),t.utils.svgPaths.point(k*p,-T)])+t.utils.svgPaths.line([t.utils.svgPaths.point(k*p,-f)])+t.utils.svgPaths.curve("c",[t.utils.svgPaths.point(k*p/4,-T/2),t.utils.svgPaths.point(k*p/2,-T),t.utils.svgPaths.point(k*p,-T)])}var r=this.NOTCH_WIDTH,a=this.NOTCH_HEIGHT,c=r/3,p=c/3,f=a/2,T=f/2,y=e(1),D=e(-1);return{type:this.SHAPES.NOTCH,width:r,height:a,pathLeft:y,pathRight:D}},t.zelos.ConstantProvider.prototype.makeInsideCorners=function(){var e=this.CORNER_RADIUS,r=t.utils.svgPaths.arc("a","0 0,0",e,t.utils.svgPaths.point(-e,e)),a=t.utils.svgPaths.arc("a","0 0,1",e,t.utils.svgPaths.point(-e,e));return{width:e,height:e,pathTop:r,pathBottom:t.utils.svgPaths.arc("a","0 0,0",e,t.utils.svgPaths.point(e,e)),rightWidth:e,rightHeight:e,pathTopRight:a,pathBottomRight:t.utils.svgPaths.arc("a","0 0,1",e,t.utils.svgPaths.point(e,e))}},t.zelos.ConstantProvider.prototype.generateSecondaryColour_=function(e){return t.utils.colour.blend("#000",e,.15)||e},t.zelos.ConstantProvider.prototype.generateTertiaryColour_=function(e){return t.utils.colour.blend("#000",e,.25)||e},t.zelos.ConstantProvider.prototype.createDom=function(e,r,a){t.zelos.ConstantProvider.superClass_.createDom.call(this,e,r,a),e=t.utils.dom.createSvgElement(t.utils.Svg.DEFS,{},e),r=t.utils.dom.createSvgElement(t.utils.Svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),t.utils.dom.createSvgElement(t.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},r),a=t.utils.dom.createSvgElement(t.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},r),t.utils.dom.createSvgElement(t.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},a),t.utils.dom.createSvgElement(t.utils.Svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},r),t.utils.dom.createSvgElement(t.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},r),this.selectedGlowFilterId=r.id,this.selectedGlowFilter_=r,e=t.utils.dom.createSvgElement(t.utils.Svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),t.utils.dom.createSvgElement(t.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),r=t.utils.dom.createSvgElement(t.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},e),t.utils.dom.createSvgElement(t.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),t.utils.dom.createSvgElement(t.utils.Svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),t.utils.dom.createSvgElement(t.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),t.utils.dom.createSvgElement(t.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter_=e},t.zelos.ConstantProvider.prototype.getCSS_=function(e){return[e+" .blocklyText,",e+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",e+" .blocklyText {","fill: #fff;","}",e+" .blocklyNonEditableText>rect:not(.blocklyDropdownRect),",e+" .blocklyEditableText>rect:not(.blocklyDropdownRect) {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","}",e+" .blocklyNonEditableText>text,",e+" .blocklyEditableText>text,",e+" .blocklyNonEditableText>g>text,",e+" .blocklyEditableText>g>text {","fill: #575E75;","}",e+" .blocklyFlyoutLabelText {","fill: #575E75;","}",e+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",e+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>rect,",e+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",e+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","color: #575E75;","}",e+" .blocklyDropdownText {","fill: #fff !important;","}",e+".blocklyWidgetDiv .goog-menuitem,",e+".blocklyDropDownDiv .goog-menuitem {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","}",e+".blocklyDropDownDiv .goog-menuitem-content {","color: #fff;","}",e+" .blocklyHighlightedConnectionPath {","stroke: "+this.SELECTED_GLOW_COLOUR+";","}",e+" .blocklyDisabled > .blocklyOutlinePath {","fill: url(#blocklyDisabledPattern"+this.randomIdentifier+")","}",e+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},t.zelos.TopRow=function(e){t.zelos.TopRow.superClass_.constructor.call(this,e)},t.utils.object.inherits(t.zelos.TopRow,t.blockRendering.TopRow),t.zelos.TopRow.prototype.endsWithElemSpacer=function(){return!1},t.zelos.TopRow.prototype.hasLeftSquareCorner=function(e){return!!e.outputConnection||(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection},t.zelos.TopRow.prototype.hasRightSquareCorner=function(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection},t.zelos.BottomRow=function(e){t.zelos.BottomRow.superClass_.constructor.call(this,e)},t.utils.object.inherits(t.zelos.BottomRow,t.blockRendering.BottomRow),t.zelos.BottomRow.prototype.endsWithElemSpacer=function(){return!1},t.zelos.BottomRow.prototype.hasLeftSquareCorner=function(e){return!!e.outputConnection},t.zelos.BottomRow.prototype.hasRightSquareCorner=function(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection},t.zelos.RightConnectionShape=function(e){t.zelos.RightConnectionShape.superClass_.constructor.call(this,e),this.type|=t.blockRendering.Types.getType("RIGHT_CONNECTION"),this.width=this.height=0},t.utils.object.inherits(t.zelos.RightConnectionShape,t.blockRendering.Measurable),t.zelos.RenderInfo=function(e,r){t.zelos.RenderInfo.superClass_.constructor.call(this,e,r),this.topRow=new t.zelos.TopRow(this.constants_),this.bottomRow=new t.zelos.BottomRow(this.constants_),this.isInline=!0,this.isMultiRow=!r.getInputsInline()||r.isCollapsed(),this.hasStatementInput=0<r.statementInputCount,this.rightSide=this.outputConnection?new t.zelos.RightConnectionShape(this.constants_):null},t.utils.object.inherits(t.zelos.RenderInfo,t.blockRendering.RenderInfo),t.zelos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},t.zelos.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},t.zelos.RenderInfo.prototype.shouldStartNewRow_=function(e,r){return!!r&&(e.type==t.inputTypes.STATEMENT||r.type==t.inputTypes.STATEMENT||(e.type==t.inputTypes.VALUE||e.type==t.inputTypes.DUMMY)&&(!this.isInline||this.isMultiRow))},t.zelos.RenderInfo.prototype.getDesiredRowWidth_=function(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):t.zelos.RenderInfo.superClass_.getDesiredRowWidth_.call(this,e)},t.zelos.RenderInfo.prototype.getInRowSpacing_=function(e,r){return e&&r||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&r&&t.blockRendering.Types.isStatementInput(r)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&t.blockRendering.Types.isLeftRoundedCorner(e)&&r&&(t.blockRendering.Types.isPreviousConnection(r)||t.blockRendering.Types.isNextConnection(r))?r.notchOffset-this.constants_.CORNER_RADIUS:e&&t.blockRendering.Types.isLeftSquareCorner(e)&&r&&t.blockRendering.Types.isHat(r)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING},t.zelos.RenderInfo.prototype.getSpacerRowHeight_=function(e,r){if(t.blockRendering.Types.isTopRow(e)&&t.blockRendering.Types.isBottomRow(r))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;var a=t.blockRendering.Types.isInputRow(e)&&e.hasStatement,c=t.blockRendering.Types.isInputRow(r)&&r.hasStatement;return c||a?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),c&&a?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):t.blockRendering.Types.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):t.blockRendering.Types.isBottomRow(r)?this.outputConnection?!r.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},t.zelos.RenderInfo.prototype.getSpacerRowWidth_=function(e,r){var a=this.width-this.startX;return t.blockRendering.Types.isInputRow(e)&&e.hasStatement||t.blockRendering.Types.isInputRow(r)&&r.hasStatement?Math.max(a,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):a},t.zelos.RenderInfo.prototype.getElemCenterline_=function(e,r){if(e.hasStatement&&!t.blockRendering.Types.isSpacer(r)&&!t.blockRendering.Types.isStatementInput(r))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(t.blockRendering.Types.isInlineInput(r)){var a=r.connectedBlock;if(a&&a.outputConnection&&a.nextConnection)return e.yPos+a.height/2}return t.zelos.RenderInfo.superClass_.getElemCenterline_.call(this,e,r)},t.zelos.RenderInfo.prototype.addInput_=function(e,r){e.type==t.inputTypes.DUMMY&&r.hasDummyInput&&r.align==t.constants.ALIGN.LEFT&&e.align==t.constants.ALIGN.RIGHT&&(r.rightAlignedDummyInput=e),t.zelos.RenderInfo.superClass_.addInput_.call(this,e,r)},t.zelos.RenderInfo.prototype.addAlignmentPadding_=function(e,r){if(e.rightAlignedDummyInput){for(var a,p,c=0;(p=e.elements[c])&&(t.blockRendering.Types.isSpacer(p)&&(a=p),!t.blockRendering.Types.isField(p)||p.parentInput!=e.rightAlignedDummyInput);c++);if(a)return a.width+=r,void(e.width+=r)}t.zelos.RenderInfo.superClass_.addAlignmentPadding_.call(this,e,r)},t.zelos.RenderInfo.prototype.adjustXPosition_=function(){for(var e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,r=e,a=2;a<this.rows.length-1;a+=2){var c=this.rows[a-1],p=this.rows[a],f=this.rows[a+1];if(c=2==a?!!this.topRow.hasPreviousConnection:!!c.followsStatement,f=a+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!f.precedesStatement,t.blockRendering.Types.isInputRow(p)&&p.hasStatement)p.measure(),r=p.width-p.getLastInput().width+e;else if(c&&(2==a||f)&&t.blockRendering.Types.isInputRow(p)&&!p.hasStatement){f=p.xPos,c=null;for(var y,T=0;y=p.elements[T];T++)t.blockRendering.Types.isSpacer(y)&&(c=y),!(c&&(t.blockRendering.Types.isField(y)||t.blockRendering.Types.isInput(y))&&f<r)||t.blockRendering.Types.isField(y)&&(y.field instanceof t.FieldLabel||y.field instanceof t.FieldImage)||(c.width+=r-f),f+=y.width}}},t.zelos.RenderInfo.prototype.finalizeOutputConnection_=function(){if(this.outputConnection&&this.outputConnection.isDynamicShape){for(var a,e=0,r=0;a=this.rows[r];r++)a.yPos=e,e+=a.height;this.height=e,e=this.outputConnection.shape.height(r=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height),r=this.outputConnection.shape.width(r),this.outputConnection.height=e,this.outputConnection.width=r,this.outputConnection.startX=r,this.outputConnection.connectionOffsetY=this.outputConnection.shape.connectionOffsetY(e),this.outputConnection.connectionOffsetX=this.outputConnection.shape.connectionOffsetX(r),a=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(a=r,this.rightSide.height=e,this.rightSide.width=a,this.rightSide.centerline=e/2,this.rightSide.xPos=this.width+a),this.startX=r,this.width+=r+a,this.widthWithChildren+=r+a}},t.zelos.RenderInfo.prototype.finalizeHorizontalAlignment_=function(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var a,e=0,r=0;a=this.rows[r];r++)if(t.blockRendering.Types.isInputRow(a)){e=a.elements[a.elements.length-2];var c=this.getNegativeSpacing_(a.elements[1]),p=this.getNegativeSpacing_(e),f=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-(e=c+p)<f&&(c=(e=this.width-f)/2,p=e/2),a.elements.unshift(new t.blockRendering.InRowSpacer(this.constants_,-c)),a.elements.push(new t.blockRendering.InRowSpacer(this.constants_,-p))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,r=0;a=this.rows[r];r++)t.blockRendering.Types.isTopOrBottomRow(a)&&(a.elements[1].width-=e,a.elements[1].widthWithConnectedBlocks-=e),a.width-=e,a.widthWithConnectedBlocks-=e}},t.zelos.RenderInfo.prototype.getNegativeSpacing_=function(e){if(!e)return 0;var r=this.outputConnection.width,a=this.outputConnection.shape.type,c=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)return a===c.SHAPES.ROUND?r-(a=this.height/2>(a=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH)?a:this.height/2)*(1-Math.sin(Math.acos((a-this.constants_.SMALL_PADDING)/a))):0;if(t.blockRendering.Types.isInlineInput(e)){var p=e.connectedBlock;return e=p?p.pathObject.outputShapeType:e.shape.type,p&&p.outputConnection&&(p.statementInputCount||p.nextConnection)||a==c.SHAPES.HEXAGONAL&&a!=e?0:r-this.constants_.SHAPE_IN_SHAPE_PADDING[a][e]}return t.blockRendering.Types.isField(e)?a==c.SHAPES.ROUND&&e.field instanceof t.FieldTextInput?r-2.75*c.GRID_UNIT:r-this.constants_.SHAPE_IN_SHAPE_PADDING[a][0]:t.blockRendering.Types.isIcon(e)?this.constants_.SMALL_PADDING:0},t.zelos.RenderInfo.prototype.finalizeVerticalAlignment_=function(){if(!this.outputConnection)for(var e=2;e<this.rows.length-1;e+=2){var r=this.rows[e-1],a=this.rows[e],c=this.rows[e+1],p=2==e,f=e+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!c.precedesStatement;if(p?this.topRow.hasPreviousConnection:r.followsStatement){var T=3==a.elements.length&&(a.elements[1].field instanceof t.FieldLabel||a.elements[1].field instanceof t.FieldImage);if(!p&&T)r.height-=this.constants_.SMALL_PADDING,c.height-=this.constants_.SMALL_PADDING,a.height-=this.constants_.MEDIUM_PADDING;else if(p||f){if(f){for(p=!1,f=0;T=a.elements[f];f++)if(t.blockRendering.Types.isInlineInput(T)&&T.connectedBlock&&!T.connectedBlock.isShadow()&&40<=T.connectedBlock.getHeightWidth().height){p=!0;break}p&&(r.height-=this.constants_.SMALL_PADDING,c.height-=this.constants_.SMALL_PADDING)}}else r.height+=this.constants_.SMALL_PADDING}}},t.zelos.RenderInfo.prototype.finalize_=function(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),t.zelos.RenderInfo.superClass_.finalize_.call(this),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)},t.zelos.Drawer=function(e,r){t.zelos.Drawer.superClass_.constructor.call(this,e,r)},t.utils.object.inherits(t.zelos.Drawer,t.blockRendering.Drawer),t.zelos.Drawer.prototype.draw=function(){var e=this.block_.pathObject;e.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),t.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()},t.zelos.Drawer.prototype.drawOutline_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):t.zelos.Drawer.superClass_.drawOutline_.call(this)},t.zelos.Drawer.prototype.drawLeft_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():t.zelos.Drawer.superClass_.drawLeft_.call(this)},t.zelos.Drawer.prototype.drawRightSideRow_=function(e){if(!(0>=e.height))if(e.precedesStatement||e.followsStatement){var r=this.constants_.INSIDE_CORNERS.rightHeight;this.outlinePath_+=(e.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<(r=e.height-(e.precedesStatement?r:0))?t.utils.svgPaths.lineOnAxis("V",e.yPos+r):"")+(e.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=t.utils.svgPaths.lineOnAxis("V",e.yPos+e.height)},t.zelos.Drawer.prototype.drawRightDynamicConnection_=function(){this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)},t.zelos.Drawer.prototype.drawLeftDynamicConnection_=function(){this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"},t.zelos.Drawer.prototype.drawFlatTop_=function(){var e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=t.utils.svgPaths.moveBy(e.xPos,this.info_.startY),this.outlinePath_+=t.utils.svgPaths.lineOnAxis("h",e.width)},t.zelos.Drawer.prototype.drawFlatBottom_=function(){var e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=t.utils.svgPaths.lineOnAxis("V",e.baseline),this.outlinePath_+=t.utils.svgPaths.lineOnAxis("h",-e.width)},t.zelos.Drawer.prototype.drawInlineInput_=function(e){this.positionInlineInputConnection_(e);var r=e.input.name;if(!e.connectedBlock&&!this.info_.isInsertionMarker){var a=e.width-2*e.connectionWidth;e=t.utils.svgPaths.moveTo(e.xPos+e.connectionWidth,e.centerline-e.height/2)+t.utils.svgPaths.lineOnAxis("h",a)+e.shape.pathRightDown(e.height)+t.utils.svgPaths.lineOnAxis("h",-a)+e.shape.pathUp(e.height)+"z",this.block_.pathObject.setOutlinePath(r,e)}},t.zelos.Drawer.prototype.drawStatementInput_=function(e){var r=e.getLastInput(),a=r.xPos+r.notchOffset+r.shape.width,c=r.shape.pathRight+t.utils.svgPaths.lineOnAxis("h",-(r.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,p=e.height-2*this.constants_.INSIDE_CORNERS.height;r=this.constants_.INSIDE_CORNERS.pathBottom+t.utils.svgPaths.lineOnAxis("h",r.notchOffset-this.constants_.INSIDE_CORNERS.width)+(r.connectedBottomNextConnection?"":r.shape.pathLeft),this.outlinePath_+=t.utils.svgPaths.lineOnAxis("H",a)+c+t.utils.svgPaths.lineOnAxis("v",p)+r+t.utils.svgPaths.lineOnAxis("H",e.xPos+e.width),this.positionStatementInputConnection_(e)},t.zelos.MarkerSvg=function(e,r,a){t.zelos.MarkerSvg.superClass_.constructor.call(this,e,r,a)},t.utils.object.inherits(t.zelos.MarkerSvg,t.blockRendering.MarkerSvg),t.zelos.MarkerSvg.prototype.showWithInputOutput_=function(e){var r=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle_(e.x,e.y),this.setParent_(r),this.showCurrent_()},t.zelos.MarkerSvg.prototype.showWithOutput_=function(e){this.showWithInputOutput_(e)},t.zelos.MarkerSvg.prototype.showWithInput_=function(e){this.showWithInputOutput_(e)},t.zelos.MarkerSvg.prototype.showWithBlock_=function(e){var r=(e=e.getLocation()).getHeightWidth();this.positionRect_(0,0,r.width,r.height),this.setParent_(e),this.showCurrent_()},t.zelos.MarkerSvg.prototype.positionCircle_=function(e,r){this.markerCircle_.setAttribute("cx",e),this.markerCircle_.setAttribute("cy",r),this.currentMarkerSvg=this.markerCircle_},t.zelos.MarkerSvg.prototype.hide=function(){t.zelos.MarkerSvg.superClass_.hide.call(this),this.markerCircle_.style.display="none"},t.zelos.MarkerSvg.prototype.createDomInternal_=function(){if(t.zelos.MarkerSvg.superClass_.createDomInternal_.call(this),this.markerCircle_=t.utils.dom.createSvgElement(t.utils.Svg.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var e=this.getBlinkProperties_();t.utils.dom.createSvgElement(t.utils.Svg.ANIMATE,e,this.markerCircle_)}return this.markerSvg_},t.zelos.MarkerSvg.prototype.applyColour_=function(e){t.zelos.MarkerSvg.superClass_.applyColour_.call(this,e),this.markerCircle_.setAttribute("fill",this.colour_),this.markerCircle_.setAttribute("stroke",this.colour_),this.isCursor()&&this.markerCircle_.firstChild.setAttribute("values",this.colour_+";transparent;transparent;")},t.zelos.PathObject=function(e,r,a){t.zelos.PathObject.superClass_.constructor.call(this,e,r,a),this.constants=a,this.svgPathSelected_=null,this.outlines_=Object.create(null),this.outputShapeType=this.remainingOutlines_=null},t.utils.object.inherits(t.zelos.PathObject,t.blockRendering.PathObject),t.zelos.PathObject.prototype.setPath=function(e){t.zelos.PathObject.superClass_.setPath.call(this,e),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",e)},t.zelos.PathObject.prototype.applyColour=function(e){for(var r in t.zelos.PathObject.superClass_.applyColour.call(this,e),e.isShadow()&&e.getParent()&&this.svgPath.setAttribute("stroke",e.getParent().style.colourTertiary),this.outlines_)this.outlines_[r].setAttribute("fill",this.style.colourTertiary)},t.zelos.PathObject.prototype.flipRTL=function(){for(var e in t.zelos.PathObject.superClass_.flipRTL.call(this),this.outlines_)this.outlines_[e].setAttribute("transform","scale(-1 1)")},t.zelos.PathObject.prototype.updateSelected=function(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)},t.zelos.PathObject.prototype.updateReplacementFade=function(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")},t.zelos.PathObject.prototype.updateShapeForInputHighlight=function(e,r){e=e.getParentInput().name,(e=this.getOutlinePath_(e))&&(r?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))},t.zelos.PathObject.prototype.beginDrawing=function(){for(var e in this.remainingOutlines_=Object.create(null),this.outlines_)this.remainingOutlines_[e]=1},t.zelos.PathObject.prototype.endDrawing=function(){if(this.remainingOutlines_)for(var e in this.remainingOutlines_)this.removeOutlinePath_(e);this.remainingOutlines_=null},t.zelos.PathObject.prototype.setOutlinePath=function(e,r){(e=this.getOutlinePath_(e)).setAttribute("d",r),e.setAttribute("fill",this.style.colourTertiary)},t.zelos.PathObject.prototype.getOutlinePath_=function(e){return this.outlines_[e]||(this.outlines_[e]=t.utils.dom.createSvgElement(t.utils.Svg.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines_&&delete this.remainingOutlines_[e],this.outlines_[e]},t.zelos.PathObject.prototype.removeOutlinePath_=function(e){this.outlines_[e].parentNode.removeChild(this.outlines_[e]),delete this.outlines_[e]},t.zelos.Renderer=function(e){t.zelos.Renderer.superClass_.constructor.call(this,e)},t.utils.object.inherits(t.zelos.Renderer,t.blockRendering.Renderer),t.zelos.Renderer.prototype.makeConstants_=function(){return new t.zelos.ConstantProvider},t.zelos.Renderer.prototype.makeRenderInfo_=function(e){return new t.zelos.RenderInfo(this,e)},t.zelos.Renderer.prototype.makeDrawer_=function(e,r){return new t.zelos.Drawer(e,r)},t.zelos.Renderer.prototype.makeMarkerDrawer=function(e,r){return new t.zelos.MarkerSvg(e,this.getConstants(),r)},t.zelos.Renderer.prototype.makePathObject=function(e,r){return new t.zelos.PathObject(e,r,this.getConstants())},t.zelos.Renderer.prototype.shouldHighlightConnection=function(e){return e.type!=t.connectionTypes.INPUT_VALUE&&e.type!==t.connectionTypes.OUTPUT_VALUE},t.zelos.Renderer.prototype.getConnectionPreviewMethod=function(e,r,a){return r.type==t.connectionTypes.OUTPUT_VALUE?e.isConnected()?t.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:t.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:t.zelos.Renderer.superClass_.getConnectionPreviewMethod(e,r,a)},t.blockRendering.register("zelos",t.zelos.Renderer),t.Themes.Dark=t.Theme.defineTheme("dark",{base:t.Themes.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"blackBackground",toolboxForegroundColour:"#fff",flyoutBackgroundColour:"#252526",flyoutForegroundColour:"#ccc",flyoutOpacity:1,scrollbarColour:"#797979",insertionMarkerColour:"#fff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0",blackBackground:"#333"}}),t.Themes.Deuteranopia={},t.Themes.Deuteranopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#f2a72c",colourSecondary:"#f1c172",colourTertiary:"#da921c"},list_blocks:{colourPrimary:"#7d65ab",colourSecondary:"#a88be0",colourTertiary:"#66518e"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#795a07",colourSecondary:"#ac8726",colourTertiary:"#c4a03f"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"},variable_dynamic_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"}},t.Themes.Deuteranopia.categoryStyles={colour_category:{colour:"#f2a72c"},list_category:{colour:"#7d65ab"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#795a07"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#47025a"},variable_dynamic_category:{colour:"#47025a"}},t.Themes.Deuteranopia=new t.Theme("deuteranopia",t.Themes.Deuteranopia.defaultBlockStyles,t.Themes.Deuteranopia.categoryStyles),t.Themes.HighContrast={},t.Themes.HighContrast.defaultBlockStyles={colour_blocks:{colourPrimary:"#a52714",colourSecondary:"#FB9B8C",colourTertiary:"#FBE1DD"},list_blocks:{colourPrimary:"#4a148c",colourSecondary:"#AD7BE9",colourTertiary:"#CDB6E9"},logic_blocks:{colourPrimary:"#01579b",colourSecondary:"#64C7FF",colourTertiary:"#C5EAFF"},loop_blocks:{colourPrimary:"#33691e",colourSecondary:"#9AFF78",colourTertiary:"#E1FFD7"},math_blocks:{colourPrimary:"#1a237e",colourSecondary:"#8A9EFF",colourTertiary:"#DCE2FF"},procedure_blocks:{colourPrimary:"#006064",colourSecondary:"#77E6EE",colourTertiary:"#CFECEE"},text_blocks:{colourPrimary:"#004d40",colourSecondary:"#5ae27c",colourTertiary:"#D2FFDD"},variable_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},variable_dynamic_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},hat_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB",hat:"cap"}},t.Themes.HighContrast.categoryStyles={colour_category:{colour:"#a52714"},list_category:{colour:"#4a148c"},logic_category:{colour:"#01579b"},loop_category:{colour:"#33691e"},math_category:{colour:"#1a237e"},procedure_category:{colour:"#006064"},text_category:{colour:"#004d40"},variable_category:{colour:"#880e4f"},variable_dynamic_category:{colour:"#880e4f"}},t.Themes.HighContrast=new t.Theme("highcontrast",t.Themes.HighContrast.defaultBlockStyles,t.Themes.HighContrast.categoryStyles),t.Themes.HighContrast.setComponentStyle("selectedGlowColour","#000000"),t.Themes.HighContrast.setComponentStyle("selectedGlowSize",1),t.Themes.HighContrast.setComponentStyle("replacementGlowColour","#000000"),t.Themes.HighContrast.setFontStyle({family:null,weight:null,size:16}),t.Themes.Tritanopia={},t.Themes.Tritanopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#05427f",colourSecondary:"#2974c0",colourTertiary:"#2d74bb"},list_blocks:{colourPrimary:"#b69ce8",colourSecondary:"#ccbaef",colourTertiary:"#9176c5"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#aa1846",colourSecondary:"#d36185",colourTertiary:"#7c1636"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"},variable_dynamic_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"}},t.Themes.Tritanopia.categoryStyles={colour_category:{colour:"#05427f"},list_category:{colour:"#b69ce8"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#aa1846"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#4b2d84"},variable_dynamic_category:{colour:"#4b2d84"}},t.Themes.Tritanopia=new t.Theme("tritanopia",t.Themes.Tritanopia.defaultBlockStyles,t.Themes.Tritanopia.categoryStyles),t.requires={},t}.apply(K,[]))&&(ie.exports=N)},874:function(ie,K,F){var N,t;N=[F(486)],void 0!==(t=function(e){"use strict";return e.Blocks={},e.Blocks}.apply(K,N))&&(ie.exports=t)},486:function(ie,K,F){var N,t;N=[F(794)],void 0!==(t=function(e){"use strict";return e.Blocks.colour={},e.Constants={},e.Constants.Colour={},e.Constants.Colour.HUE=20,e.defineBlocksWithJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),e.Constants.Lists={},e.Constants.Lists.HUE=260,e.defineBlocksWithJsonArray([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),e.Blocks.lists_create_with={init:function(){this.setHelpUrl(e.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new e.Mutator(["lists_create_with_item"])),this.setTooltip(e.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("items",this.itemCount_),r},domToMutation:function(r){this.itemCount_=parseInt(r.getAttribute("items"),10),this.updateShape_()},decompose:function(r){var a=r.newBlock("lists_create_with_container");a.initSvg();for(var c=a.getInput("STACK").connection,p=0;p<this.itemCount_;p++){var f=r.newBlock("lists_create_with_item");f.initSvg(),c.connect(f.previousConnection),c=f.nextConnection}return a},compose:function(r){var a=r.getInputTargetBlock("STACK");for(r=[];a&&!a.isInsertionMarker();)r.push(a.valueConnection_),a=a.nextConnection&&a.nextConnection.targetBlock();for(a=0;a<this.itemCount_;a++){var c=this.getInput("ADD"+a).connection.targetConnection;c&&-1==r.indexOf(c)&&c.disconnect()}for(this.itemCount_=r.length,this.updateShape_(),a=0;a<this.itemCount_;a++)e.Mutator.reconnect(r[a],this,"ADD"+a)},saveConnections:function(r){r=r.getInputTargetBlock("STACK");for(var a=0;r;){var c=this.getInput("ADD"+a);r.valueConnection_=c&&c.connection.targetConnection,a++,r=r.nextConnection&&r.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(e.Msg.LISTS_CREATE_EMPTY_TITLE);for(var r=0;r<this.itemCount_;r++)if(!this.getInput("ADD"+r)){var a=this.appendValueInput("ADD"+r).setAlign(e.ALIGN_RIGHT);0==r&&a.appendField(e.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(;this.getInput("ADD"+r);)this.removeInput("ADD"+r),r++}},e.Blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},e.Blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(e.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},e.Blocks.lists_indexOf={init:function(){var r=[[e.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[e.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(e.Msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new e.FieldDropdown(r),"END"),this.setInputsInline(!0);var a=this;this.setTooltip(function(){return e.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",a.workspace.options.oneBasedIndex?"0":"-1")})}},e.Blocks.lists_getIndex={init:function(){var r=[[e.Msg.LISTS_GET_INDEX_GET,"GET"],[e.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[e.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[e.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[e.Msg.LISTS_GET_INDEX_LAST,"LAST"],[e.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(e.Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),r=new e.FieldDropdown(r,function(c){c="REMOVE"==c,this.getSourceBlock().updateStatement_(c)}),this.appendValueInput("VALUE").setCheck("Array").appendField(e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(r,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),e.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var a=this;this.setTooltip(function(){var c=a.getFieldValue("MODE"),p=a.getFieldValue("WHERE"),f="";switch(c+" "+p){case"GET FROM_START":case"GET FROM_END":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":f=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"==p||"FROM_END"==p)&&(f+="  "+("FROM_START"==p?e.Msg.LISTS_INDEX_FROM_START_TOOLTIP:e.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",a.workspace.options.oneBasedIndex?"#1":"#0")),f})},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");r.setAttribute("statement",!this.outputConnection);var a=this.getInput("AT").type==e.INPUT_VALUE;return r.setAttribute("at",a),r},domToMutation:function(r){var a="true"==r.getAttribute("statement");this.updateStatement_(a),r="false"!=r.getAttribute("at"),this.updateAt_(r)},updateStatement_:function(r){r!=!this.outputConnection&&(this.unplug(!0,!0),r?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(r){this.removeInput("AT"),this.removeInput("ORDINAL",!0),r?(this.appendValueInput("AT").setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var a=new e.FieldDropdown(this.WHERE_OPTIONS,function(c){var p="FROM_START"==c||"FROM_END"==c;if(p!=r){var f=this.getSourceBlock();return f.updateAt_(p),f.setFieldValue(c,"WHERE"),null}});this.getInput("AT").appendField(a,"WHERE"),e.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},e.Blocks.lists_setIndex={init:function(){var r=[[e.Msg.LISTS_SET_INDEX_SET,"SET"],[e.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[e.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[e.Msg.LISTS_GET_INDEX_LAST,"LAST"],[e.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(e.Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new e.FieldDropdown(r),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(e.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(e.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var a=this;this.setTooltip(function(){var c=a.getFieldValue("MODE"),p=a.getFieldValue("WHERE"),f="";switch(c+" "+p){case"SET FROM_START":case"SET FROM_END":f=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":f=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":f=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":f=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":f=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":f=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":f=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":f=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"==p||"FROM_END"==p)&&(f+="  "+e.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",a.workspace.options.oneBasedIndex?"#1":"#0")),f})},mutationToDom:function(){var r=e.utils.xml.createElement("mutation"),a=this.getInput("AT").type==e.INPUT_VALUE;return r.setAttribute("at",a),r},domToMutation:function(r){r="false"!=r.getAttribute("at"),this.updateAt_(r)},updateAt_:function(r){this.removeInput("AT"),this.removeInput("ORDINAL",!0),r?(this.appendValueInput("AT").setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var a=new e.FieldDropdown(this.WHERE_OPTIONS,function(c){var p="FROM_START"==c||"FROM_END"==c;if(p!=r){var f=this.getSourceBlock();return f.updateAt_(p),f.setFieldValue(c,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(a,"WHERE")}},e.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[e.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[e.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(e.Msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),e.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(e.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var r=e.utils.xml.createElement("mutation"),a=this.getInput("AT1").type==e.INPUT_VALUE;return r.setAttribute("at1",a),a=this.getInput("AT2").type==e.INPUT_VALUE,r.setAttribute("at2",a),r},domToMutation:function(r){var a="true"==r.getAttribute("at1");r="true"==r.getAttribute("at2"),this.updateAt_(1,a),this.updateAt_(2,r)},updateAt_:function(r,a){this.removeInput("AT"+r),this.removeInput("ORDINAL"+r,!0),a?(this.appendValueInput("AT"+r).setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+r).appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+r);var c=new e.FieldDropdown(this["WHERE_OPTIONS_"+r],function(p){var f="FROM_START"==p||"FROM_END"==p;if(f!=a){var T=this.getSourceBlock();return T.updateAt_(r,f),T.setFieldValue(p,"WHERE"+r),null}});this.getInput("AT"+r).appendField(c,"WHERE"+r),1==r&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),e.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},e.Blocks.lists_sort={init:function(){this.jsonInit({message0:e.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[e.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[e.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[e.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[e.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[e.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:e.Msg.LISTS_SORT_TOOLTIP,helpUrl:e.Msg.LISTS_SORT_HELPURL})}},e.Blocks.lists_split={init:function(){var r=this,a=new e.FieldDropdown([[e.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[e.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(c){r.updateType_(c)});this.setHelpUrl(e.Msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(a,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(e.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(function(){var c=r.getFieldValue("MODE");if("SPLIT"==c)return e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"==c)return e.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+c)})},updateType_:function(r){if(this.getFieldValue("MODE")!=r){var a=this.getInput("INPUT").connection;a.setShadowDom(null);var c=a.targetBlock();c&&(a.disconnect(),c.isShadow()?c.dispose():this.bumpNeighbours())}"SPLIT"==r?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("mode",this.getFieldValue("MODE")),r},domToMutation:function(r){this.updateType_(r.getAttribute("mode"))}},e.Blocks.logic={},e.Constants.Logic={},e.Constants.Logic.HUE=210,e.defineBlocksWithJsonArray([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]}]),e.defineBlocksWithJsonArray([{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),e.Constants.Logic.TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"},e.Extensions.register("logic_op_tooltip",e.Extensions.buildTooltipForDropdown("OP",e.Constants.Logic.TOOLTIPS_BY_OP)),e.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var r=e.utils.xml.createElement("mutation");return this.elseifCount_&&r.setAttribute("elseif",this.elseifCount_),this.elseCount_&&r.setAttribute("else",1),r},domToMutation:function(r){this.elseifCount_=parseInt(r.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(r.getAttribute("else"),10)||0,this.rebuildShape_()},decompose:function(r){var a=r.newBlock("controls_if_if");a.initSvg();for(var c=a.nextConnection,p=1;p<=this.elseifCount_;p++){var f=r.newBlock("controls_if_elseif");f.initSvg(),c.connect(f.previousConnection),c=f.nextConnection}return this.elseCount_&&((r=r.newBlock("controls_if_else")).initSvg(),c.connect(r.previousConnection)),a},compose:function(r){r=r.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;for(var a=[null],c=[null],p=null;r&&!r.isInsertionMarker();){switch(r.type){case"controls_if_elseif":this.elseifCount_++,a.push(r.valueConnection_),c.push(r.statementConnection_);break;case"controls_if_else":this.elseCount_++,p=r.statementConnection_;break;default:throw TypeError("Unknown block type: "+r.type)}r=r.nextConnection&&r.nextConnection.targetBlock()}this.updateShape_(),this.reconnectChildBlocks_(a,c,p)},saveConnections:function(r){r=r.nextConnection.targetBlock();for(var a=1;r;){switch(r.type){case"controls_if_elseif":var c=this.getInput("IF"+a),p=this.getInput("DO"+a);r.valueConnection_=c&&c.connection.targetConnection,r.statementConnection_=p&&p.connection.targetConnection,a++;break;case"controls_if_else":p=this.getInput("ELSE"),r.statementConnection_=p&&p.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+r.type)}r=r.nextConnection&&r.nextConnection.targetBlock()}},rebuildShape_:function(){var r=[null],a=[null],c=null;this.getInput("ELSE")&&(c=this.getInput("ELSE").connection.targetConnection);for(var p=1;this.getInput("IF"+p);){var f=this.getInput("IF"+p),T=this.getInput("DO"+p);r.push(f.connection.targetConnection),a.push(T.connection.targetConnection),p++}this.updateShape_(),this.reconnectChildBlocks_(r,a,c)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var r=1;this.getInput("IF"+r);)this.removeInput("IF"+r),this.removeInput("DO"+r),r++;for(r=1;r<=this.elseifCount_;r++)this.appendValueInput("IF"+r).setCheck("Boolean").appendField(e.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+r).appendField(e.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(e.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(r,a,c){for(var p=1;p<=this.elseifCount_;p++)e.Mutator.reconnect(r[p],this,"IF"+p),e.Mutator.reconnect(a[p],this,"DO"+p);e.Mutator.reconnect(c,this,"ELSE")}},e.Extensions.registerMutator("controls_if_mutator",e.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]),e.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?e.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?e.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?e.Msg.CONTROLS_IF_TOOLTIP_4:"":e.Msg.CONTROLS_IF_TOOLTIP_1}.bind(this))},e.Extensions.register("controls_if_tooltip",e.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION),e.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN={onchange:function(r){this.prevBlocks_||(this.prevBlocks_=[null,null]);var a=this.getInputTargetBlock("A"),c=this.getInputTargetBlock("B");a&&c&&!this.workspace.connectionChecker.doTypeChecks(a.outputConnection,c.outputConnection)&&(e.Events.setGroup(r.group),(r=this.prevBlocks_[0])!==a&&(a.unplug(),!r||r.isDisposed()||r.isShadow()||this.getInput("A").connection.connect(r.outputConnection)),(a=this.prevBlocks_[1])!==c&&(c.unplug(),!a||a.isDisposed()||a.isShadow()||this.getInput("B").connection.connect(a.outputConnection)),this.bumpNeighbours(),e.Events.setGroup(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},e.Constants.Logic.LOGIC_COMPARE_EXTENSION=function(){this.mixin(e.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN)},e.Extensions.register("logic_compare",e.Constants.Logic.LOGIC_COMPARE_EXTENSION),e.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(r){var a=this.getInputTargetBlock("THEN"),c=this.getInputTargetBlock("ELSE"),p=this.outputConnection.targetConnection;if((a||c)&&p)for(var f=0;2>f;f++){var T=1==f?a:c;T&&!T.workspace.connectionChecker.doTypeChecks(T.outputConnection,p)&&(e.Events.setGroup(r.group),p===this.prevParentConnection_?(this.unplug(),p.getSourceBlock().bumpNeighbours()):(T.unplug(),T.bumpNeighbours()),e.Events.setGroup(!1))}this.prevParentConnection_=p}},e.Extensions.registerMixin("logic_ternary",e.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN),e.Blocks.loops={},e.Constants.Loops={},e.Constants.Loops.HUE=120,e.defineBlocksWithJsonArray([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),e.Constants.Loops.WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"},e.Extensions.register("controls_whileUntil_tooltip",e.Extensions.buildTooltipForDropdown("MODE",e.Constants.Loops.WHILE_UNTIL_TOOLTIPS)),e.Constants.Loops.BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"},e.Extensions.register("controls_flow_tooltip",e.Extensions.buildTooltipForDropdown("FLOW",e.Constants.Loops.BREAK_CONTINUE_TOOLTIPS)),e.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(r){if(!this.isInFlyout){var a=this.getField("VAR").getVariable(),c=a.name;if(!this.isCollapsed()&&null!=c){var p={enabled:!0};p.text=e.Msg.VARIABLES_SET_CREATE_GET.replace("%1",c),a=e.Variables.generateVariableFieldDom(a),(c=e.utils.xml.createElement("block")).setAttribute("type","variables_get"),c.appendChild(a),p.callback=e.ContextMenu.callbackFactory(this,c),r.push(p)}}}},e.Extensions.registerMixin("contextMenu_newGetVariableBlock",e.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),e.Extensions.register("controls_for_tooltip",e.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),e.Extensions.register("controls_forEach_tooltip",e.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"],suppressPrefixSuffix:!0,getSurroundLoop:function(r){do{if(-1!=e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.indexOf(r.type))return r;r=r.getSurroundParent()}while(r);return null},onchange:function(r){if(this.workspace.isDragging&&!this.workspace.isDragging()&&r.type==e.Events.BLOCK_MOVE){var a=e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(this);if(this.setWarningText(a?null:e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){var c=e.Events.getGroup();e.Events.setGroup(r.group),this.setEnabled(a),e.Events.setGroup(c)}}}},e.Extensions.registerMixin("controls_flow_in_loop_check",e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),e.Blocks.math={},e.Constants.Math={},e.Constants.Math.HUE=230,e.defineBlocksWithJsonArray([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),e.Constants.Math.TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"},e.Extensions.register("math_op_tooltip",e.Extensions.buildTooltipForDropdown("OP",e.Constants.Math.TOOLTIPS_BY_OP)),e.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var r=e.utils.xml.createElement("mutation"),a="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");return r.setAttribute("divisor_input",a),r},domToMutation:function(r){r="true"==r.getAttribute("divisor_input"),this.updateShape_(r)},updateShape_:function(r){var a=this.getInput("DIVISOR");r?a||this.appendValueInput("DIVISOR").setCheck("Number"):a&&this.removeInput("DIVISOR")}},e.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator(function(r){r="DIVISIBLE_BY"==r,this.getSourceBlock().updateShape_(r)})},e.Extensions.registerMutator("math_is_divisibleby_mutator",e.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN,e.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION),e.Extensions.register("math_change_tooltip",e.Extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),e.Constants.Math.LIST_MODES_MUTATOR_MIXIN={updateType_:function(r){this.outputConnection.setCheck("MODE"==r?"Array":"Number")},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("op",this.getFieldValue("OP")),r},domToMutation:function(r){this.updateType_(r.getAttribute("op"))}},e.Constants.Math.LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator(function(r){this.updateType_(r)}.bind(this))},e.Extensions.registerMutator("math_modes_of_list_mutator",e.Constants.Math.LIST_MODES_MUTATOR_MIXIN,e.Constants.Math.LIST_MODES_MUTATOR_EXTENSION),e.Blocks.procedures={},e.Blocks.procedures_defnoreturn={init:function(){var r=e.Procedures.findLegalName("",this);(r=new e.FieldTextInput(r,e.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(e.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(r,"NAME").appendField("","PARAMS"),this.setMutator(new e.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&e.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(e.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(e.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:function(r){this.hasStatements_!==r&&(r?(this.appendStatementInput("STACK").appendField(e.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=r)},updateParams_:function(){var r="";this.arguments_.length&&(r=e.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),e.Events.disable();try{this.setFieldValue(r,"PARAMS")}finally{e.Events.enable()}},mutationToDom:function(r){var a=e.utils.xml.createElement("mutation");r&&a.setAttribute("name",this.getFieldValue("NAME"));for(var c=0;c<this.argumentVarModels_.length;c++){var p=e.utils.xml.createElement("arg"),f=this.argumentVarModels_[c];p.setAttribute("name",f.name),p.setAttribute("varid",f.getId()),r&&this.paramIds_&&p.setAttribute("paramId",this.paramIds_[c]),a.appendChild(p)}return this.hasStatements_||a.setAttribute("statements","false"),a},domToMutation:function(r){this.arguments_=[],this.argumentVarModels_=[];for(var c,a=0;c=r.childNodes[a];a++)if("arg"==c.nodeName.toLowerCase()){var p=c.getAttribute("name");c=c.getAttribute("varid")||c.getAttribute("varId"),this.arguments_.push(p),null!=(c=e.Variables.getOrCreateVariablePackage(this.workspace,c,p,""))?this.argumentVarModels_.push(c):console.log("Failed to create a variable with name "+p+", ignoring.")}this.updateParams_(),e.Procedures.mutateCallers(this),this.setStatements_("false"!==r.getAttribute("statements"))},decompose:function(r){var a=e.utils.xml.createElement("block");a.setAttribute("type","procedures_mutatorcontainer");var c=e.utils.xml.createElement("statement");c.setAttribute("name","STACK"),a.appendChild(c);for(var p=0;p<this.arguments_.length;p++){var f=e.utils.xml.createElement("block");f.setAttribute("type","procedures_mutatorarg");var T=e.utils.xml.createElement("field");T.setAttribute("name","NAME");var y=e.utils.xml.createTextNode(this.arguments_[p]);T.appendChild(y),f.appendChild(T),T=e.utils.xml.createElement("next"),f.appendChild(T),c.appendChild(f),c=T}return r=e.Xml.domToBlock(a,r),"procedures_defreturn"==this.type?r.setFieldValue(this.hasStatements_,"STATEMENTS"):r.removeInput("STATEMENT_INPUT"),e.Procedures.mutateCallers(this),r},compose:function(r){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var a=r.getInputTargetBlock("STACK");a&&!a.isInsertionMarker();){var c=a.getFieldValue("NAME");this.arguments_.push(c),c=this.workspace.getVariable(c,""),this.argumentVarModels_.push(c),this.paramIds_.push(a.id),a=a.nextConnection&&a.nextConnection.targetBlock()}this.updateParams_(),e.Procedures.mutateCallers(this),null!==(r=r.getFieldValue("STATEMENTS"))&&this.hasStatements_!=(r="TRUE"==r)&&(r?(this.setStatements_(!0),e.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(r=this.getInput("STACK").connection,(this.statementConnection_=r.targetConnection)&&((r=r.targetBlock()).unplug(),r.bumpNeighbours()),this.setStatements_(!1)))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(r,a){var c=this.workspace.getVariableById(r);if(""==c.type){c=c.name,a=this.workspace.getVariableById(a);for(var p=!1,f=0;f<this.argumentVarModels_.length;f++)this.argumentVarModels_[f].getId()==r&&(this.arguments_[f]=a.name,this.argumentVarModels_[f]=a,p=!0);p&&(this.displayRenamedVar_(c,a.name),e.Procedures.mutateCallers(this))}},updateVarName:function(r){for(var a=r.name,c=!1,p=0;p<this.argumentVarModels_.length;p++)if(this.argumentVarModels_[p].getId()==r.getId()){var f=this.arguments_[p];this.arguments_[p]=a,c=!0}c&&(this.displayRenamedVar_(f,a),e.Procedures.mutateCallers(this))},displayRenamedVar_:function(r,a){if(this.updateParams_(),this.mutator&&this.mutator.isVisible())for(var f,c=this.mutator.workspace_.getAllBlocks(!1),p=0;f=c[p];p++)"procedures_mutatorarg"==f.type&&e.Names.equals(r,f.getFieldValue("NAME"))&&f.setFieldValue(a,"NAME")},customContextMenu:function(r){if(!this.isInFlyout){var a={enabled:!0},c=this.getFieldValue("NAME");a.text=e.Msg.PROCEDURES_CREATE_DO.replace("%1",c);var p=e.utils.xml.createElement("mutation");for(p.setAttribute("name",c),c=0;c<this.arguments_.length;c++){var f=e.utils.xml.createElement("arg");f.setAttribute("name",this.arguments_[c]),p.appendChild(f)}if((c=e.utils.xml.createElement("block")).setAttribute("type",this.callType_),c.appendChild(p),a.callback=e.ContextMenu.callbackFactory(this,c),r.push(a),!this.isCollapsed())for(c=0;c<this.argumentVarModels_.length;c++)(a={enabled:!0}).text=e.Msg.VARIABLES_SET_CREATE_GET.replace("%1",(p=this.argumentVarModels_[c]).name),p=e.Variables.generateVariableFieldDom(p),(f=e.utils.xml.createElement("block")).setAttribute("type","variables_get"),f.appendChild(p),a.callback=e.ContextMenu.callbackFactory(this,f),r.push(a)}},callType_:"procedures_callnoreturn"},e.Blocks.procedures_defreturn={init:function(){var r=e.Procedures.findLegalName("",this);(r=new e.FieldTextInput(r,e.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(e.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(r,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(e.ALIGN_RIGHT).appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new e.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&e.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(e.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(e.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:e.Blocks.procedures_defnoreturn.setStatements_,updateParams_:e.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:e.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:e.Blocks.procedures_defnoreturn.domToMutation,decompose:e.Blocks.procedures_defnoreturn.decompose,compose:e.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:e.Blocks.procedures_defnoreturn.getVars,getVarModels:e.Blocks.procedures_defnoreturn.getVarModels,renameVarById:e.Blocks.procedures_defnoreturn.renameVarById,updateVarName:e.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:e.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:e.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"},e.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(e.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new e.FieldCheckbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},e.Blocks.procedures_mutatorarg={init:function(){var r=new e.FieldTextInput(e.Procedures.DEFAULT_ARG,this.validator_);r.oldShowEditorFn_=r.showEditor_,r.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(e.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(r,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,r.onFinishEditing_=this.deleteIntermediateVars_,r.createdVariables_=[],r.onFinishEditing_("x")},validator_:function(r){var a=this.getSourceBlock(),c=e.Mutator.findParentWs(a.workspace);if(!(r=r.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;for(var p=(a.workspace.targetWorkspace||a.workspace).getAllBlocks(!1),f=r.toLowerCase(),T=0;T<p.length;T++)if(p[T].id!=this.getSourceBlock().id){var y=p[T].getFieldValue("NAME");if(y&&y.toLowerCase()==f)return null}return a.isInFlyout||((a=c.getVariable(r,""))&&a.name!=r&&c.renameVariableById(a.getId(),r),a||(a=c.createVariable(r,""))&&this.createdVariables_&&this.createdVariables_.push(a)),r},deleteIntermediateVars_:function(r){var a=e.Mutator.findParentWs(this.getSourceBlock().workspace);if(a)for(var c=0;c<this.createdVariables_.length;c++){var p=this.createdVariables_[c];p.name!=r&&a.deleteVariableById(p.getId())}}},e.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(e.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(r,a){e.Names.equals(r,this.getProcedureCall())&&(this.setFieldValue(a,"NAME"),this.setTooltip((this.outputConnection?e.Msg.PROCEDURES_CALLRETURN_TOOLTIP:e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",a)))},setProcedureParameters_:function(r,a){var c=e.Procedures.getDefinition(this.getProcedureCall(),this.workspace),p=c&&c.mutator&&c.mutator.isVisible();if(p||(this.quarkConnections_={},this.quarkIds_=null),a)if(r.join("\n")==this.arguments_.join("\n"))this.quarkIds_=a;else{if(a.length!=r.length)throw RangeError("paramNames and paramIds must be the same length.");this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),c=this.rendered,this.rendered=!1;for(var f=0;f<this.arguments_.length;f++){var T=this.getInput("ARG"+f);T&&(this.quarkConnections_[this.quarkIds_[f]]=T=T.connection.targetConnection,p&&T&&-1==a.indexOf(this.quarkIds_[f])&&(T.disconnect(),T.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(r),this.argumentVarModels_=[],f=0;f<this.arguments_.length;f++)r=e.Variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[f],""),this.argumentVarModels_.push(r);if(this.updateShape_(),this.quarkIds_=a)for(f=0;f<this.arguments_.length;f++)(a=this.quarkIds_[f])in this.quarkConnections_&&(e.Mutator.reconnect(T=this.quarkConnections_[a],this,"ARG"+f)||delete this.quarkConnections_[a]);(this.rendered=c)&&this.render()}},updateShape_:function(){for(var r=0;r<this.arguments_.length;r++){var a=this.getField("ARGNAME"+r);if(a){e.Events.disable();try{a.setValue(this.arguments_[r])}finally{e.Events.enable()}}else a=new e.FieldLabel(this.arguments_[r]),this.appendValueInput("ARG"+r).setAlign(e.ALIGN_RIGHT).appendField(a,"ARGNAME"+r).init()}for(;this.getInput("ARG"+r);)this.removeInput("ARG"+r),r++;(r=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(r.appendField(e.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),r.init()):this.getField("WITH")&&r.removeField("WITH"))},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");r.setAttribute("name",this.getProcedureCall());for(var a=0;a<this.arguments_.length;a++){var c=e.utils.xml.createElement("arg");c.setAttribute("name",this.arguments_[a]),r.appendChild(c)}return r},domToMutation:function(r){var a=r.getAttribute("name");this.renameProcedure(this.getProcedureCall(),a),a=[];for(var f,c=[],p=0;f=r.childNodes[p];p++)"arg"==f.nodeName.toLowerCase()&&(a.push(f.getAttribute("name")),c.push(f.getAttribute("paramId")));this.setProcedureParameters_(a,c)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(r){if(this.workspace&&!this.workspace.isFlyout&&r.recordUndo)if(r.type==e.Events.BLOCK_CREATE&&-1!=r.ids.indexOf(this.id)){var a=this.getProcedureCall();if(!(a=e.Procedures.getDefinition(a,this.workspace))||a.type==this.defType_&&JSON.stringify(a.getVars())==JSON.stringify(this.arguments_)||(a=null),!a){e.Events.setGroup(r.group),r=e.utils.xml.createElement("xml"),(a=e.utils.xml.createElement("block")).setAttribute("type",this.defType_);var c=this.getRelativeToSurfaceXY(),p=c.y+2*e.SNAP_RADIUS;a.setAttribute("x",c.x+e.SNAP_RADIUS*(this.RTL?-1:1)),a.setAttribute("y",p),c=this.mutationToDom(),a.appendChild(c),(c=e.utils.xml.createElement("field")).setAttribute("name","NAME"),(p=this.getProcedureCall())||(p=e.Procedures.findLegalName("",this),this.renameProcedure("",p)),c.appendChild(e.utils.xml.createTextNode(p)),a.appendChild(c),r.appendChild(a),e.Xml.domToWorkspace(r,this.workspace),e.Events.setGroup(!1)}}else r.type==e.Events.BLOCK_DELETE?(a=this.getProcedureCall(),(a=e.Procedures.getDefinition(a,this.workspace))||(e.Events.setGroup(r.group),this.dispose(!0),e.Events.setGroup(!1))):r.type==e.Events.CHANGE&&"disabled"==r.element&&(a=this.getProcedureCall(),(a=e.Procedures.getDefinition(a,this.workspace))&&a.id==r.blockId&&((a=e.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),e.Events.setGroup(r.group),r.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),e.Events.setGroup(a)))},customContextMenu:function(r){if(this.workspace.isMovable()){var a={enabled:!0};a.text=e.Msg.PROCEDURES_HIGHLIGHT_DEF;var c=this.getProcedureCall(),p=this.workspace;a.callback=function(){var f=e.Procedures.getDefinition(c,p);f&&(p.centerOnBlock(f.id),f.select())},r.push(a)}},defType_:"procedures_defnoreturn"},e.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(e.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:e.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:e.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:e.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:e.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:e.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:e.Blocks.procedures_callnoreturn.domToMutation,getVars:e.Blocks.procedures_callnoreturn.getVars,getVarModels:e.Blocks.procedures_callnoreturn.getVarModels,onchange:e.Blocks.procedures_callnoreturn.onchange,customContextMenu:e.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"},e.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(e.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(e.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("value",Number(this.hasReturnValue_)),r},domToMutation:function(r){this.hasReturnValue_=1==r.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(r){if(this.workspace.isDragging&&!this.workspace.isDragging()){r=!1;var a=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(a.type)){r=!0;break}a=a.getSurroundParent()}while(a);r?("procedures_defnoreturn"==a.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=a.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText(e.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},e.Blocks.texts={},e.Constants.Text={},e.Constants.Text.HUE=160,e.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"\xb6"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),e.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[e.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[e.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[e.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[e.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[e.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[e.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(e.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),e.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(e.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var r=e.utils.xml.createElement("mutation"),a=this.getInput("AT1").type==e.INPUT_VALUE;return r.setAttribute("at1",a),a=this.getInput("AT2").type==e.INPUT_VALUE,r.setAttribute("at2",a),r},domToMutation:function(r){var a="true"==r.getAttribute("at1");r="true"==r.getAttribute("at2"),this.updateAt_(1,a),this.updateAt_(2,r)},updateAt_:function(r,a){this.removeInput("AT"+r),this.removeInput("ORDINAL"+r,!0),a?(this.appendValueInput("AT"+r).setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+r).appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+r),2==r&&e.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(e.Msg.TEXT_GET_SUBSTRING_TAIL));var c=new e.FieldDropdown(this["WHERE_OPTIONS_"+r],function(p){var f="FROM_START"==p||"FROM_END"==p;if(f!=a){var T=this.getSourceBlock();return T.updateAt_(r,f),T.setFieldValue(p,"WHERE"+r),null}});this.getInput("AT"+r).appendField(c,"WHERE"+r),1==r&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},e.Blocks.text_changeCase={init:function(){var r=[[e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(e.Msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new e.FieldDropdown(r),"CASE"),this.setOutput(!0,"String"),this.setTooltip(e.Msg.TEXT_CHANGECASE_TOOLTIP)}},e.Blocks.text_trim={init:function(){var r=[[e.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[e.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[e.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(e.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new e.FieldDropdown(r),"MODE"),this.setOutput(!0,"String"),this.setTooltip(e.Msg.TEXT_TRIM_TOOLTIP)}},e.Blocks.text_print={init:function(){this.jsonInit({message0:e.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:e.Msg.TEXT_PRINT_TOOLTIP,helpUrl:e.Msg.TEXT_PRINT_HELPURL})}},e.Blocks.text_prompt_ext={init:function(){var r=[[e.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[e.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(e.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");var a=this;r=new e.FieldDropdown(r,function(c){a.updateType_(c)}),this.appendValueInput("TEXT").appendField(r,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==a.getFieldValue("TYPE")?e.Msg.TEXT_PROMPT_TOOLTIP_TEXT:e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:function(r){this.outputConnection.setCheck("NUMBER"==r?"Number":"String")},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("type",this.getFieldValue("TYPE")),r},domToMutation:function(r){this.updateType_(r.getAttribute("type"))}},e.Blocks.text_prompt={init:function(){this.mixin(e.Constants.Text.QUOTE_IMAGE_MIXIN);var r=[[e.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[e.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],a=this;this.setHelpUrl(e.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),r=new e.FieldDropdown(r,function(c){a.updateType_(c)}),this.appendDummyInput().appendField(r,"TYPE").appendField(this.newQuote_(!0)).appendField(new e.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==a.getFieldValue("TYPE")?e.Msg.TEXT_PROMPT_TOOLTIP_TEXT:e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:e.Blocks.text_prompt_ext.updateType_,mutationToDom:e.Blocks.text_prompt_ext.mutationToDom,domToMutation:e.Blocks.text_prompt_ext.domToMutation},e.Blocks.text_count={init:function(){this.jsonInit({message0:e.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:e.Msg.TEXT_COUNT_TOOLTIP,helpUrl:e.Msg.TEXT_COUNT_HELPURL})}},e.Blocks.text_replace={init:function(){this.jsonInit({message0:e.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:e.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:e.Msg.TEXT_REPLACE_HELPURL})}},e.Blocks.text_reverse={init:function(){this.jsonInit({message0:e.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:e.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:e.Msg.TEXT_REVERSE_HELPURL})}},e.Constants.Text.QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(r){for(var c,a=0;c=this.inputList[a];a++)for(var f,p=0;f=c.fieldRow[p];p++)if(r==f.name)return c.insertFieldAt(p,this.newQuote_(!0)),void c.insertFieldAt(p+2,this.newQuote_(!1));console.warn('field named "'+r+'" not found in '+this.toDevString())},newQuote_:function(r){return new e.FieldImage((r=this.RTL?!r:r)?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,r?"\u201c":"\u201d")}},e.Constants.Text.TEXT_QUOTES_EXTENSION=function(){this.mixin(e.Constants.Text.QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},e.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("items",this.itemCount_),r},domToMutation:function(r){this.itemCount_=parseInt(r.getAttribute("items"),10),this.updateShape_()},decompose:function(r){var a=r.newBlock("text_create_join_container");a.initSvg();for(var c=a.getInput("STACK").connection,p=0;p<this.itemCount_;p++){var f=r.newBlock("text_create_join_item");f.initSvg(),c.connect(f.previousConnection),c=f.nextConnection}return a},compose:function(r){var a=r.getInputTargetBlock("STACK");for(r=[];a&&!a.isInsertionMarker();)r.push(a.valueConnection_),a=a.nextConnection&&a.nextConnection.targetBlock();for(a=0;a<this.itemCount_;a++){var c=this.getInput("ADD"+a).connection.targetConnection;c&&-1==r.indexOf(c)&&c.disconnect()}for(this.itemCount_=r.length,this.updateShape_(),a=0;a<this.itemCount_;a++)e.Mutator.reconnect(r[a],this,"ADD"+a)},saveConnections:function(r){r=r.getInputTargetBlock("STACK");for(var a=0;r;){var c=this.getInput("ADD"+a);r.valueConnection_=c&&c.connection.targetConnection,a++,r=r.nextConnection&&r.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var r=0;r<this.itemCount_;r++)if(!this.getInput("ADD"+r)){var a=this.appendValueInput("ADD"+r).setAlign(e.ALIGN_RIGHT);0==r&&a.appendField(e.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(;this.getInput("ADD"+r);)this.removeInput("ADD"+r),r++}},e.Constants.Text.TEXT_JOIN_EXTENSION=function(){this.mixin(e.Constants.Text.QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new e.Mutator(["text_create_join_item"]))},e.Extensions.register("text_append_tooltip",e.Extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),e.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var r=this;this.setTooltip(function(){return e.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",r.workspace.options.oneBasedIndex?"0":"-1")})},e.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("at",!!this.isAt_),r},domToMutation:function(r){r="false"!=r.getAttribute("at"),this.updateAt_(r)},updateAt_:function(r){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),r&&(this.appendValueInput("AT").setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)),e.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(e.Msg.TEXT_CHARAT_TAIL)),this.isAt_=r}},e.Constants.Text.TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator(function(a){(a="FROM_START"==a||"FROM_END"==a)!=this.isAt_&&this.getSourceBlock().updateAt_(a)}),this.updateAt_(!0);var r=this;this.setTooltip(function(){var a=r.getFieldValue("WHERE"),c=e.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"==a||"FROM_END"==a)&&(a="FROM_START"==a?e.Msg.LISTS_INDEX_FROM_START_TOOLTIP:e.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(c+="  "+a.replace("%1",r.workspace.options.oneBasedIndex?"#1":"#0")),c})},e.Extensions.register("text_indexOf_tooltip",e.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION),e.Extensions.register("text_quotes",e.Constants.Text.TEXT_QUOTES_EXTENSION),e.Extensions.registerMutator("text_join_mutator",e.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN,e.Constants.Text.TEXT_JOIN_EXTENSION),e.Extensions.registerMutator("text_charAt_mutator",e.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN,e.Constants.Text.TEXT_CHARAT_EXTENSION),e.Blocks.variables={},e.Constants.Variables={},e.Constants.Variables.HUE=330,e.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),e.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(r){if(this.isInFlyout)("variables_get"==this.type||"variables_get_reporter"==this.type)&&(a={text:e.Msg.RENAME_VARIABLE,enabled:!0,callback:e.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},f=this.getField("VAR").getText(),p={text:e.Msg.DELETE_VARIABLE.replace("%1",f),enabled:!0,callback:e.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},r.unshift(a),r.unshift(p));else{if("variables_get"==this.type)var a="variables_set",c=e.Msg.VARIABLES_GET_CREATE_SET;else a="variables_get",c=e.Msg.VARIABLES_SET_CREATE_GET;var p={enabled:0<this.workspace.remainingCapacity()},f=this.getField("VAR").getText();p.text=c.replace("%1",f),(c=e.utils.xml.createElement("field")).setAttribute("name","VAR"),c.appendChild(e.utils.xml.createTextNode(f)),(f=e.utils.xml.createElement("block")).setAttribute("type",a),f.appendChild(c),p.callback=e.ContextMenu.callbackFactory(this,f),r.push(p)}}},e.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY=function(r){return function(){var a=r.workspace,c=r.getField("VAR").getVariable();e.Variables.renameVariable(a,c)}},e.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY=function(r){return function(){var a=r.workspace,c=r.getField("VAR").getVariable();a.deleteVariableById(c.getId()),a.refreshToolboxSelection()}},e.Extensions.registerMixin("contextMenu_variableSetterGetter",e.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),e.Constants.VariablesDynamic={},e.Constants.VariablesDynamic.HUE=310,e.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),e.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(r){if(this.isInFlyout)("variables_get_dynamic"==this.type||"variables_get_reporter_dynamic"==this.type)&&(a={text:e.Msg.RENAME_VARIABLE,enabled:!0,callback:e.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},T=this.getField("VAR").getText(),f={text:e.Msg.DELETE_VARIABLE.replace("%1",T),enabled:!0,callback:e.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},r.unshift(a),r.unshift(f));else{var a=this.getFieldValue("VAR"),c=this.workspace.getVariableById(a).type;if("variables_get_dynamic"==this.type){a="variables_set_dynamic";var p=e.Msg.VARIABLES_GET_CREATE_SET}else a="variables_get_dynamic",p=e.Msg.VARIABLES_SET_CREATE_GET;var f={enabled:0<this.workspace.remainingCapacity()},T=this.getField("VAR").getText();f.text=p.replace("%1",T),(p=e.utils.xml.createElement("field")).setAttribute("name","VAR"),p.setAttribute("variabletype",c),p.appendChild(e.utils.xml.createTextNode(T)),(T=e.utils.xml.createElement("block")).setAttribute("type",a),T.appendChild(p),f.callback=e.ContextMenu.callbackFactory(this,T),r.push(f)}},onchange:function(r){r=this.getFieldValue("VAR"),r=e.Variables.getVariable(this.workspace,r),"variables_get_dynamic"==this.type?this.outputConnection.setCheck(r.type):this.getInput("VALUE").connection.setCheck(r.type)}},e.Constants.VariablesDynamic.RENAME_OPTION_CALLBACK_FACTORY=function(r){return function(){var a=r.workspace,c=r.getField("VAR").getVariable();e.Variables.renameVariable(a,c)}},e.Constants.VariablesDynamic.DELETE_OPTION_CALLBACK_FACTORY=function(r){return function(){var a=r.workspace,c=r.getField("VAR").getVariable();a.deleteVariableById(c.getId()),a.refreshToolboxSelection()}},e.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",e.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),e.Blocks}.apply(K,N))&&(ie.exports=t)},393:function(ie,K,F){var N,t;N=[F(426),F(265),F(874),F(298)],void 0!==(t=function(e,r,a,c){"use strict";return e.setLocale(r),e.Blocks=e.Blocks||{},Object.keys(a).forEach(function(p){e.Blocks[p]=a[p]}),e.JavaScript=c,e}.apply(K,N))&&(ie.exports=t)},426:function(ie,K,F){var N,t;N=[F(818)],void 0!==(t=function(e){"use strict";return e.setLocale=function(r){e.Msg=e.Msg||{},Object.keys(r).forEach(function(a){e.Msg[a]=r[a]})},e}.apply(K,N))&&(ie.exports=t)},447:function(ie,K,F){var N,t;N=[F(393)],void 0!==(t=function(e){"use strict";return e}.apply(K,N))&&(ie.exports=t)},298:function(ie,K,F){var N,t;N=[F(426),F(961)],void 0!==(t=function(e,r){"use strict";return e.JavaScript=r,r}.apply(K,N))&&(ie.exports=t)},961:function(ie,K,F){var N,t;N=[F(794)],void 0!==(t=function(e){"use strict";return e.JavaScript=new e.Generator("JavaScript"),e.JavaScript.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(e.utils.global).join(",")),e.JavaScript.ORDER_ATOMIC=0,e.JavaScript.ORDER_NEW=1.1,e.JavaScript.ORDER_MEMBER=1.2,e.JavaScript.ORDER_FUNCTION_CALL=2,e.JavaScript.ORDER_INCREMENT=3,e.JavaScript.ORDER_DECREMENT=3,e.JavaScript.ORDER_BITWISE_NOT=4.1,e.JavaScript.ORDER_UNARY_PLUS=4.2,e.JavaScript.ORDER_UNARY_NEGATION=4.3,e.JavaScript.ORDER_LOGICAL_NOT=4.4,e.JavaScript.ORDER_TYPEOF=4.5,e.JavaScript.ORDER_VOID=4.6,e.JavaScript.ORDER_DELETE=4.7,e.JavaScript.ORDER_AWAIT=4.8,e.JavaScript.ORDER_EXPONENTIATION=5,e.JavaScript.ORDER_MULTIPLICATION=5.1,e.JavaScript.ORDER_DIVISION=5.2,e.JavaScript.ORDER_MODULUS=5.3,e.JavaScript.ORDER_SUBTRACTION=6.1,e.JavaScript.ORDER_ADDITION=6.2,e.JavaScript.ORDER_BITWISE_SHIFT=7,e.JavaScript.ORDER_RELATIONAL=8,e.JavaScript.ORDER_IN=8,e.JavaScript.ORDER_INSTANCEOF=8,e.JavaScript.ORDER_EQUALITY=9,e.JavaScript.ORDER_BITWISE_AND=10,e.JavaScript.ORDER_BITWISE_XOR=11,e.JavaScript.ORDER_BITWISE_OR=12,e.JavaScript.ORDER_LOGICAL_AND=13,e.JavaScript.ORDER_LOGICAL_OR=14,e.JavaScript.ORDER_CONDITIONAL=15,e.JavaScript.ORDER_ASSIGNMENT=16,e.JavaScript.ORDER_YIELD=17,e.JavaScript.ORDER_COMMA=18,e.JavaScript.ORDER_NONE=99,e.JavaScript.ORDER_OVERRIDES=[[e.JavaScript.ORDER_FUNCTION_CALL,e.JavaScript.ORDER_MEMBER],[e.JavaScript.ORDER_FUNCTION_CALL,e.JavaScript.ORDER_FUNCTION_CALL],[e.JavaScript.ORDER_MEMBER,e.JavaScript.ORDER_MEMBER],[e.JavaScript.ORDER_MEMBER,e.JavaScript.ORDER_FUNCTION_CALL],[e.JavaScript.ORDER_LOGICAL_NOT,e.JavaScript.ORDER_LOGICAL_NOT],[e.JavaScript.ORDER_MULTIPLICATION,e.JavaScript.ORDER_MULTIPLICATION],[e.JavaScript.ORDER_ADDITION,e.JavaScript.ORDER_ADDITION],[e.JavaScript.ORDER_LOGICAL_AND,e.JavaScript.ORDER_LOGICAL_AND],[e.JavaScript.ORDER_LOGICAL_OR,e.JavaScript.ORDER_LOGICAL_OR]],e.JavaScript.isInitialized=!1,e.JavaScript.init=function(r){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new e.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(r.getVariableMap()),this.nameDB_.populateVariables(r),this.nameDB_.populateProcedures(r);for(var a=[],c=e.Variables.allDeveloperVariables(r),p=0;p<c.length;p++)a.push(this.nameDB_.getName(c[p],e.Names.DEVELOPER_VARIABLE_TYPE));for(r=e.Variables.allUsedVarModels(r),p=0;p<r.length;p++)a.push(this.nameDB_.getName(r[p].getId(),e.VARIABLE_CATEGORY_NAME));a.length&&(this.definitions_.variables="var "+a.join(", ")+";"),this.isInitialized=!0},e.JavaScript.finish=function(r){var a=e.utils.object.values(this.definitions_);return r=Object.getPrototypeOf(this).finish.call(this,r),this.isInitialized=!1,this.nameDB_.reset(),a.join("\n\n")+"\n\n\n"+r},e.JavaScript.scrubNakedValue=function(r){return r+";\n"},e.JavaScript.quote_=function(r){return"'"+(r=r.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},e.JavaScript.multiline_quote_=function(r){return r.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")},e.JavaScript.scrub_=function(r,a,c){var p="";if(!r.outputConnection||!r.outputConnection.targetConnection){var f=r.getCommentText();f&&(f=e.utils.string.wrap(f,this.COMMENT_WRAP-3),p+=this.prefixLines(f+"\n","// "));for(var T=0;T<r.inputList.length;T++)r.inputList[T].type==e.inputTypes.VALUE&&(f=r.inputList[T].connection.targetBlock())&&(f=this.allNestedComments(f))&&(p+=this.prefixLines(f,"// "))}return r=r.nextConnection&&r.nextConnection.targetBlock(),p+a+(c?"":this.blockToCode(r))},e.JavaScript.getAdjusted=function(r,a,c,p,f){c=c||0,f=f||this.ORDER_NONE,r.workspace.options.oneBasedIndex&&c--;var T=r.workspace.options.oneBasedIndex?"1":"0";if(r=0<c?this.valueToCode(r,a,this.ORDER_ADDITION)||T:0>c?this.valueToCode(r,a,this.ORDER_SUBTRACTION)||T:p?this.valueToCode(r,a,this.ORDER_UNARY_NEGATION)||T:this.valueToCode(r,a,f)||T,e.isNumber(r))r=Number(r)+c,p&&(r=-r);else{if(0<c){r=r+" + "+c;var y=this.ORDER_ADDITION}else 0>c&&(r=r+" - "+-c,y=this.ORDER_SUBTRACTION);p&&(r=c?"-("+r+")":"-"+r,y=this.ORDER_UNARY_NEGATION),y=Math.floor(y),f=Math.floor(f),y&&f>=y&&(r="("+r+")")}return r},e.JavaScript.colour={},e.JavaScript.colour_picker=function(r){return[e.JavaScript.quote_(r.getFieldValue("COLOUR")),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.colour_random=function(r){return[e.JavaScript.provideFunction_("colourRandom",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.colour_rgb=function(r){var a=e.JavaScript.valueToCode(r,"RED",e.JavaScript.ORDER_NONE)||0,c=e.JavaScript.valueToCode(r,"GREEN",e.JavaScript.ORDER_NONE)||0;return r=e.JavaScript.valueToCode(r,"BLUE",e.JavaScript.ORDER_NONE)||0,[e.JavaScript.provideFunction_("colourRgb",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+a+", "+c+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.colour_blend=function(r){var a=e.JavaScript.valueToCode(r,"COLOUR1",e.JavaScript.ORDER_NONE)||"'#000000'",c=e.JavaScript.valueToCode(r,"COLOUR2",e.JavaScript.ORDER_NONE)||"'#000000'";return r=e.JavaScript.valueToCode(r,"RATIO",e.JavaScript.ORDER_NONE)||.5,[e.JavaScript.provideFunction_("colourBlend",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+a+", "+c+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists={},e.JavaScript.lists_create_empty=function(r){return["[]",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.lists_create_with=function(r){for(var a=Array(r.itemCount_),c=0;c<r.itemCount_;c++)a[c]=e.JavaScript.valueToCode(r,"ADD"+c,e.JavaScript.ORDER_NONE)||"null";return["["+a.join(", ")+"]",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.lists_repeat=function(r){return[e.JavaScript.provideFunction_("listsRepeat",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+(e.JavaScript.valueToCode(r,"ITEM",e.JavaScript.ORDER_NONE)||"null")+", "+(r=e.JavaScript.valueToCode(r,"NUM",e.JavaScript.ORDER_NONE)||"0")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_length=function(r){return[(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+".length",e.JavaScript.ORDER_MEMBER]},e.JavaScript.lists_isEmpty=function(r){return["!"+(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+".length",e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.lists_indexOf=function(r){var a="FIRST"==r.getFieldValue("END")?"indexOf":"lastIndexOf",c=e.JavaScript.valueToCode(r,"FIND",e.JavaScript.ORDER_NONE)||"''";return a=(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+"."+a+"("+c+")",r.workspace.options.oneBasedIndex?[a+" + 1",e.JavaScript.ORDER_ADDITION]:[a,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_getIndex=function(r){var a=r.getFieldValue("MODE")||"GET",c=r.getFieldValue("WHERE")||"FROM_START",p=e.JavaScript.valueToCode(r,"VALUE","RANDOM"==c?e.JavaScript.ORDER_NONE:e.JavaScript.ORDER_MEMBER)||"[]";switch(c){case"FIRST":if("GET"==a)return[p+"[0]",e.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==a)return[p+".shift()",e.JavaScript.ORDER_MEMBER];if("REMOVE"==a)return p+".shift();\n";break;case"LAST":if("GET"==a)return[p+".slice(-1)[0]",e.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==a)return[p+".pop()",e.JavaScript.ORDER_MEMBER];if("REMOVE"==a)return p+".pop();\n";break;case"FROM_START":if(r=e.JavaScript.getAdjusted(r,"AT"),"GET"==a)return[p+"["+r+"]",e.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==a)return[p+".splice("+r+", 1)[0]",e.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==a)return p+".splice("+r+", 1);\n";break;case"FROM_END":if(r=e.JavaScript.getAdjusted(r,"AT",1,!0),"GET"==a)return[p+".slice("+r+")[0]",e.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==a)return[p+".splice("+r+", 1)[0]",e.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==a)return p+".splice("+r+", 1);";break;case"RANDOM":if(p=e.JavaScript.provideFunction_("listsGetRandomItem",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+p+", "+("GET"!=a)+")","GET"==a||"GET_REMOVE"==a)return[p,e.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==a)return p+";\n"}throw Error("Unhandled combination (lists_getIndex).")},e.JavaScript.lists_setIndex=function(r){function a(){if(c.match(/^\w+$/))return"";var y=e.JavaScript.nameDB_.getDistinctName("tmpList",e.VARIABLE_CATEGORY_NAME),D="var "+y+" = "+c+";\n";return c=y,D}var c=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",p=r.getFieldValue("MODE")||"GET",f=r.getFieldValue("WHERE")||"FROM_START",T=e.JavaScript.valueToCode(r,"TO",e.JavaScript.ORDER_ASSIGNMENT)||"null";switch(f){case"FIRST":if("SET"==p)return c+"[0] = "+T+";\n";if("INSERT"==p)return c+".unshift("+T+");\n";break;case"LAST":if("SET"==p)return(r=a())+(c+"[")+c+".length - 1] = "+T+";\n";if("INSERT"==p)return c+".push("+T+");\n";break;case"FROM_START":if(f=e.JavaScript.getAdjusted(r,"AT"),"SET"==p)return c+"["+f+"] = "+T+";\n";if("INSERT"==p)return c+".splice("+f+", 0, "+T+");\n";break;case"FROM_END":if(f=e.JavaScript.getAdjusted(r,"AT",1,!1,e.JavaScript.ORDER_SUBTRACTION),r=a(),"SET"==p)return r+(c+"[")+c+".length - "+f+"] = "+T+";\n";if("INSERT"==p)return r+(c+".splice(")+c+".length - "+f+", 0, "+T+");\n";break;case"RANDOM":if(r=a(),r+="var "+(f=e.JavaScript.nameDB_.getDistinctName("tmpX",e.VARIABLE_CATEGORY_NAME))+" = Math.floor(Math.random() * "+c+".length);\n","SET"==p)return r+(c+"[")+f+"] = "+T+";\n";if("INSERT"==p)return r+(c+".splice(")+f+", 0, "+T+");\n"}throw Error("Unhandled combination (lists_setIndex).")},e.JavaScript.lists.getIndex_=function(r,a,c){return"FIRST"==a?"0":"FROM_END"==a?r+".length - 1 - "+c:"LAST"==a?r+".length - 1":c},e.JavaScript.lists_getSublist=function(r){var a=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",c=r.getFieldValue("WHERE1"),p=r.getFieldValue("WHERE2");if("FIRST"==c&&"LAST"==p)a+=".slice(0)";else if(a.match(/^\w+$/)||"FROM_END"!=c&&"FROM_START"==p){switch(c){case"FROM_START":var f=e.JavaScript.getAdjusted(r,"AT1");break;case"FROM_END":f=a+".length - "+(f=e.JavaScript.getAdjusted(r,"AT1",1,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":f="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(p){case"FROM_START":r=e.JavaScript.getAdjusted(r,"AT2",1);break;case"FROM_END":r=a+".length - "+(r=e.JavaScript.getAdjusted(r,"AT2",0,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"LAST":r=a+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}a=a+".slice("+f+", "+r+")"}else{f=e.JavaScript.getAdjusted(r,"AT1"),r=e.JavaScript.getAdjusted(r,"AT2");var T=e.JavaScript.lists.getIndex_,y={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};a=e.JavaScript.provideFunction_("subsequence"+y[c]+y[p],["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==c||"FROM_START"==c?", at1":"")+("FROM_END"==p||"FROM_START"==p?", at2":"")+") {","  var start = "+T("sequence",c,"at1")+";","  var end = "+T("sequence",p,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+a+("FROM_END"==c||"FROM_START"==c?", "+f:"")+("FROM_END"==p||"FROM_START"==p?", "+r:"")+")"}return[a,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_sort=function(r){var a=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_FUNCTION_CALL)||"[]",c="1"===r.getFieldValue("DIRECTION")?1:-1;return r=r.getFieldValue("TYPE"),[a+".slice().sort("+e.JavaScript.provideFunction_("listsGetSortCompare",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+r+'", '+c+"))",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_split=function(r){var a=e.JavaScript.valueToCode(r,"INPUT",e.JavaScript.ORDER_MEMBER),c=e.JavaScript.valueToCode(r,"DELIM",e.JavaScript.ORDER_NONE)||"''";if("SPLIT"==(r=r.getFieldValue("MODE")))a||(a="''"),r="split";else{if("JOIN"!=r)throw Error("Unknown mode: "+r);a||(a="[]"),r="join"}return[a+"."+r+"("+c+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_reverse=function(r){return[(e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.logic={},e.JavaScript.controls_if=function(r){var a=0,c="";e.JavaScript.STATEMENT_PREFIX&&(c+=e.JavaScript.injectId(e.JavaScript.STATEMENT_PREFIX,r));do{var p=e.JavaScript.valueToCode(r,"IF"+a,e.JavaScript.ORDER_NONE)||"false",f=e.JavaScript.statementToCode(r,"DO"+a);e.JavaScript.STATEMENT_SUFFIX&&(f=e.JavaScript.prefixLines(e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r),e.JavaScript.INDENT)+f),c+=(0<a?" else ":"")+"if ("+p+") {\n"+f+"}",++a}while(r.getInput("IF"+a));return(r.getInput("ELSE")||e.JavaScript.STATEMENT_SUFFIX)&&(f=e.JavaScript.statementToCode(r,"ELSE"),e.JavaScript.STATEMENT_SUFFIX&&(f=e.JavaScript.prefixLines(e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r),e.JavaScript.INDENT)+f),c+=" else {\n"+f+"}"),c+"\n"},e.JavaScript.controls_ifelse=e.JavaScript.controls_if,e.JavaScript.logic_compare=function(r){var a={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[r.getFieldValue("OP")],c="=="==a||"!="==a?e.JavaScript.ORDER_EQUALITY:e.JavaScript.ORDER_RELATIONAL;return[(e.JavaScript.valueToCode(r,"A",c)||"0")+" "+a+" "+(r=e.JavaScript.valueToCode(r,"B",c)||"0"),c]},e.JavaScript.logic_operation=function(r){var a="AND"==r.getFieldValue("OP")?"&&":"||",c="&&"==a?e.JavaScript.ORDER_LOGICAL_AND:e.JavaScript.ORDER_LOGICAL_OR,p=e.JavaScript.valueToCode(r,"A",c);if(r=e.JavaScript.valueToCode(r,"B",c),p||r){var f="&&"==a?"true":"false";p||(p=f),r||(r=f)}else r=p="false";return[p+" "+a+" "+r,c]},e.JavaScript.logic_negate=function(r){var a=e.JavaScript.ORDER_LOGICAL_NOT;return["!"+(e.JavaScript.valueToCode(r,"BOOL",a)||"true"),a]},e.JavaScript.logic_boolean=function(r){return["TRUE"==r.getFieldValue("BOOL")?"true":"false",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.logic_null=function(r){return["null",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.logic_ternary=function(r){return[(e.JavaScript.valueToCode(r,"IF",e.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+(e.JavaScript.valueToCode(r,"THEN",e.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(r=e.JavaScript.valueToCode(r,"ELSE",e.JavaScript.ORDER_CONDITIONAL)||"null"),e.JavaScript.ORDER_CONDITIONAL]},e.JavaScript.loops={},e.JavaScript.controls_repeat_ext=function(r){var a=r.getField("TIMES")?String(Number(r.getFieldValue("TIMES"))):e.JavaScript.valueToCode(r,"TIMES",e.JavaScript.ORDER_ASSIGNMENT)||"0",c=e.JavaScript.statementToCode(r,"DO");c=e.JavaScript.addLoopTrap(c,r),r="";var p=e.JavaScript.nameDB_.getDistinctName("count",e.VARIABLE_CATEGORY_NAME),f=a;return a.match(/^\w+$/)||e.isNumber(a)||(r+="var "+(f=e.JavaScript.nameDB_.getDistinctName("repeat_end",e.VARIABLE_CATEGORY_NAME))+" = "+a+";\n"),r+"for (var "+p+" = 0; "+p+" < "+f+"; "+p+"++) {\n"+c+"}\n"},e.JavaScript.controls_repeat=e.JavaScript.controls_repeat_ext,e.JavaScript.controls_whileUntil=function(r){var a="UNTIL"==r.getFieldValue("MODE"),c=e.JavaScript.valueToCode(r,"BOOL",a?e.JavaScript.ORDER_LOGICAL_NOT:e.JavaScript.ORDER_NONE)||"false",p=e.JavaScript.statementToCode(r,"DO");return a&&(c="!"+c),"while ("+c+") {\n"+(p=e.JavaScript.addLoopTrap(p,r))+"}\n"},e.JavaScript.controls_for=function(r){var a=e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME),c=e.JavaScript.valueToCode(r,"FROM",e.JavaScript.ORDER_ASSIGNMENT)||"0",p=e.JavaScript.valueToCode(r,"TO",e.JavaScript.ORDER_ASSIGNMENT)||"0",f=e.JavaScript.valueToCode(r,"BY",e.JavaScript.ORDER_ASSIGNMENT)||"1",T=e.JavaScript.statementToCode(r,"DO");if(T=e.JavaScript.addLoopTrap(T,r),e.isNumber(c)&&e.isNumber(p)&&e.isNumber(f)){var y=Number(c)<=Number(p);r="for ("+a+" = "+c+"; "+a+(y?" <= ":" >= ")+p+"; "+a,r=(1==(a=Math.abs(Number(f)))?r+(y?"++":"--"):r+(y?" += ":" -= ")+a)+") {\n"+T+"}\n"}else r="",y=c,c.match(/^\w+$/)||e.isNumber(c)||(r+="var "+(y=e.JavaScript.nameDB_.getDistinctName(a+"_start",e.VARIABLE_CATEGORY_NAME))+" = "+c+";\n"),c=p,p.match(/^\w+$/)||e.isNumber(p)||(r+="var "+(c=e.JavaScript.nameDB_.getDistinctName(a+"_end",e.VARIABLE_CATEGORY_NAME))+" = "+p+";\n"),r+="var "+(p=e.JavaScript.nameDB_.getDistinctName(a+"_inc",e.VARIABLE_CATEGORY_NAME))+" = ",r=(r=e.isNumber(f)?r+(Math.abs(f)+";\n"):r+"Math.abs("+f+");\n")+"if ("+y+" > "+c+") {\n"+(e.JavaScript.INDENT+p)+" = -"+p+";\n",r+="}\n",r+="for ("+a+" = "+y+"; "+p+" >= 0 ? "+a+" <= "+c+" : "+a+" >= "+c+"; "+a+" += "+p+") {\n"+T+"}\n";return r},e.JavaScript.controls_forEach=function(r){var a=e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME),c=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_ASSIGNMENT)||"[]",p=e.JavaScript.statementToCode(r,"DO");p=e.JavaScript.addLoopTrap(p,r),r="";var f=c;return c.match(/^\w+$/)||(r+="var "+(f=e.JavaScript.nameDB_.getDistinctName(a+"_list",e.VARIABLE_CATEGORY_NAME))+" = "+c+";\n"),r+"for (var "+(c=e.JavaScript.nameDB_.getDistinctName(a+"_index",e.VARIABLE_CATEGORY_NAME))+" in "+f+") {\n"+(p=e.JavaScript.INDENT+a+" = "+f+"["+c+"];\n"+p)+"}\n"},e.JavaScript.controls_flow_statements=function(r){var a="";if(e.JavaScript.STATEMENT_PREFIX&&(a+=e.JavaScript.injectId(e.JavaScript.STATEMENT_PREFIX,r)),e.JavaScript.STATEMENT_SUFFIX&&(a+=e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r)),e.JavaScript.STATEMENT_PREFIX){var c=e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(r);c&&!c.suppressPrefixSuffix&&(a+=e.JavaScript.injectId(e.JavaScript.STATEMENT_PREFIX,c))}switch(r.getFieldValue("FLOW")){case"BREAK":return a+"break;\n";case"CONTINUE":return a+"continue;\n"}throw Error("Unknown flow statement.")},e.JavaScript.math={},e.JavaScript.math_number=function(r){return[r=Number(r.getFieldValue("NUM")),0<=r?e.JavaScript.ORDER_ATOMIC:e.JavaScript.ORDER_UNARY_NEGATION]},e.JavaScript.math_arithmetic=function(r){var a={ADD:[" + ",e.JavaScript.ORDER_ADDITION],MINUS:[" - ",e.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",e.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",e.JavaScript.ORDER_DIVISION],POWER:[null,e.JavaScript.ORDER_NONE]}[r.getFieldValue("OP")],c=a[0],p=e.JavaScript.valueToCode(r,"A",a=a[1])||"0";return r=e.JavaScript.valueToCode(r,"B",a)||"0",c?[p+c+r,a]:["Math.pow("+p+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_single=function(r){var a=r.getFieldValue("OP");if("NEG"==a)return"-"==(r=e.JavaScript.valueToCode(r,"NUM",e.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(r=" "+r),["-"+r,e.JavaScript.ORDER_UNARY_NEGATION];switch(r="SIN"==a||"COS"==a||"TAN"==a?e.JavaScript.valueToCode(r,"NUM",e.JavaScript.ORDER_DIVISION)||"0":e.JavaScript.valueToCode(r,"NUM",e.JavaScript.ORDER_NONE)||"0",a){case"ABS":var c="Math.abs("+r+")";break;case"ROOT":c="Math.sqrt("+r+")";break;case"LN":c="Math.log("+r+")";break;case"EXP":c="Math.exp("+r+")";break;case"POW10":c="Math.pow(10,"+r+")";break;case"ROUND":c="Math.round("+r+")";break;case"ROUNDUP":c="Math.ceil("+r+")";break;case"ROUNDDOWN":c="Math.floor("+r+")";break;case"SIN":c="Math.sin("+r+" / 180 * Math.PI)";break;case"COS":c="Math.cos("+r+" / 180 * Math.PI)";break;case"TAN":c="Math.tan("+r+" / 180 * Math.PI)"}if(c)return[c,e.JavaScript.ORDER_FUNCTION_CALL];switch(a){case"LOG10":c="Math.log("+r+") / Math.log(10)";break;case"ASIN":c="Math.asin("+r+") / Math.PI * 180";break;case"ACOS":c="Math.acos("+r+") / Math.PI * 180";break;case"ATAN":c="Math.atan("+r+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+a)}return[c,e.JavaScript.ORDER_DIVISION]},e.JavaScript.math_constant=function(r){return{PI:["Math.PI",e.JavaScript.ORDER_MEMBER],E:["Math.E",e.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",e.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",e.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",e.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",e.JavaScript.ORDER_ATOMIC]}[r.getFieldValue("CONSTANT")]},e.JavaScript.math_number_property=function(r){var a=e.JavaScript.valueToCode(r,"NUMBER_TO_CHECK",e.JavaScript.ORDER_MODULUS)||"0",c=r.getFieldValue("PROPERTY");if("PRIME"==c)return[e.JavaScript.provideFunction_("mathIsPrime",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+a+")",e.JavaScript.ORDER_FUNCTION_CALL];switch(c){case"EVEN":var p=a+" % 2 == 0";break;case"ODD":p=a+" % 2 == 1";break;case"WHOLE":p=a+" % 1 == 0";break;case"POSITIVE":p=a+" > 0";break;case"NEGATIVE":p=a+" < 0";break;case"DIVISIBLE_BY":p=a+" % "+(r=e.JavaScript.valueToCode(r,"DIVISOR",e.JavaScript.ORDER_MODULUS)||"0")+" == 0"}return[p,e.JavaScript.ORDER_EQUALITY]},e.JavaScript.math_change=function(r){var a=e.JavaScript.valueToCode(r,"DELTA",e.JavaScript.ORDER_ADDITION)||"0";return(r=e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME))+" = (typeof "+r+" == 'number' ? "+r+" : 0) + "+a+";\n"},e.JavaScript.math_round=e.JavaScript.math_single,e.JavaScript.math_trig=e.JavaScript.math_single,e.JavaScript.math_on_list=function(r){var a=r.getFieldValue("OP");switch(a){case"SUM":r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",r+=".reduce(function(x, y) {return x + y;})";break;case"MIN":r="Math.min.apply(null, "+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"MAX":r="Math.max.apply(null, "+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"AVERAGE":r=(a=e.JavaScript.provideFunction_("mathMean",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":r=(a=e.JavaScript.provideFunction_("mathMedian",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":r=(a=e.JavaScript.provideFunction_("mathModes",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":r=(a=e.JavaScript.provideFunction_("mathStandardDeviation",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":r=(a=e.JavaScript.provideFunction_("mathRandomList",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+a)}return[r,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_modulo=function(r){return[(e.JavaScript.valueToCode(r,"DIVIDEND",e.JavaScript.ORDER_MODULUS)||"0")+" % "+(r=e.JavaScript.valueToCode(r,"DIVISOR",e.JavaScript.ORDER_MODULUS)||"0"),e.JavaScript.ORDER_MODULUS]},e.JavaScript.math_constrain=function(r){return["Math.min(Math.max("+(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_NONE)||"0")+", "+(e.JavaScript.valueToCode(r,"LOW",e.JavaScript.ORDER_NONE)||"0")+"), "+(r=e.JavaScript.valueToCode(r,"HIGH",e.JavaScript.ORDER_NONE)||"Infinity")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_random_int=function(r){var a=e.JavaScript.valueToCode(r,"FROM",e.JavaScript.ORDER_NONE)||"0";return r=e.JavaScript.valueToCode(r,"TO",e.JavaScript.ORDER_NONE)||"0",[e.JavaScript.provideFunction_("mathRandomInt",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+a+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_random_float=function(r){return["Math.random()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_atan2=function(r){var a=e.JavaScript.valueToCode(r,"X",e.JavaScript.ORDER_NONE)||"0";return["Math.atan2("+(e.JavaScript.valueToCode(r,"Y",e.JavaScript.ORDER_NONE)||"0")+", "+a+") / Math.PI * 180",e.JavaScript.ORDER_DIVISION]},e.JavaScript.procedures={},e.JavaScript.procedures_defreturn=function(r){var a=e.JavaScript.nameDB_.getName(r.getFieldValue("NAME"),e.PROCEDURE_CATEGORY_NAME),c="";e.JavaScript.STATEMENT_PREFIX&&(c+=e.JavaScript.injectId(e.JavaScript.STATEMENT_PREFIX,r)),e.JavaScript.STATEMENT_SUFFIX&&(c+=e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r)),c&&(c=e.JavaScript.prefixLines(c,e.JavaScript.INDENT));var p="";e.JavaScript.INFINITE_LOOP_TRAP&&(p=e.JavaScript.prefixLines(e.JavaScript.injectId(e.JavaScript.INFINITE_LOOP_TRAP,r),e.JavaScript.INDENT));var f=e.JavaScript.statementToCode(r,"STACK"),T=e.JavaScript.valueToCode(r,"RETURN",e.JavaScript.ORDER_NONE)||"",y="";f&&T&&(y=c),T&&(T=e.JavaScript.INDENT+"return "+T+";\n");for(var D=[],k=r.getVars(),G=0;G<k.length;G++)D[G]=e.JavaScript.nameDB_.getName(k[G],e.VARIABLE_CATEGORY_NAME);return c="function "+a+"("+D.join(", ")+") {\n"+c+p+f+y+T+"}",c=e.JavaScript.scrub_(r,c),e.JavaScript.definitions_["%"+a]=c,null},e.JavaScript.procedures_defnoreturn=e.JavaScript.procedures_defreturn,e.JavaScript.procedures_callreturn=function(r){for(var a=e.JavaScript.nameDB_.getName(r.getFieldValue("NAME"),e.PROCEDURE_CATEGORY_NAME),c=[],p=r.getVars(),f=0;f<p.length;f++)c[f]=e.JavaScript.valueToCode(r,"ARG"+f,e.JavaScript.ORDER_NONE)||"null";return[a+"("+c.join(", ")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.procedures_callnoreturn=function(r){return e.JavaScript.procedures_callreturn(r)[0]+";\n"},e.JavaScript.procedures_ifreturn=function(r){var a="if ("+(e.JavaScript.valueToCode(r,"CONDITION",e.JavaScript.ORDER_NONE)||"false")+") {\n";return e.JavaScript.STATEMENT_SUFFIX&&(a+=e.JavaScript.prefixLines(e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r),e.JavaScript.INDENT)),r.hasReturnValue_?(r=e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_NONE)||"null",a+=e.JavaScript.INDENT+"return "+r+";\n"):a+=e.JavaScript.INDENT+"return;\n",a+"}\n"},e.JavaScript.texts={},e.JavaScript.text=function(r){return[e.JavaScript.quote_(r.getFieldValue("TEXT")),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.text_multiline=function(r){var a=-1!=(r=e.JavaScript.multiline_quote_(r.getFieldValue("TEXT"))).indexOf("+")?e.JavaScript.ORDER_ADDITION:e.JavaScript.ORDER_ATOMIC;return[r,a]},e.JavaScript.text.forceString_=function(r){return e.JavaScript.text.forceString_.strRegExp.test(r)?[r,e.JavaScript.ORDER_ATOMIC]:["String("+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,e.JavaScript.text_join=function(r){switch(r.itemCount_){case 0:return["''",e.JavaScript.ORDER_ATOMIC];case 1:return r=e.JavaScript.valueToCode(r,"ADD0",e.JavaScript.ORDER_NONE)||"''",e.JavaScript.text.forceString_(r);case 2:var a=e.JavaScript.valueToCode(r,"ADD0",e.JavaScript.ORDER_NONE)||"''";return r=e.JavaScript.valueToCode(r,"ADD1",e.JavaScript.ORDER_NONE)||"''",[r=e.JavaScript.text.forceString_(a)[0]+" + "+e.JavaScript.text.forceString_(r)[0],e.JavaScript.ORDER_ADDITION];default:a=Array(r.itemCount_);for(var c=0;c<r.itemCount_;c++)a[c]=e.JavaScript.valueToCode(r,"ADD"+c,e.JavaScript.ORDER_NONE)||"''";return[r="["+a.join(",")+"].join('')",e.JavaScript.ORDER_FUNCTION_CALL]}},e.JavaScript.text_append=function(r){var a=e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME);return r=e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''",a+" += "+e.JavaScript.text.forceString_(r)[0]+";\n"},e.JavaScript.text_length=function(r){return[(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+".length",e.JavaScript.ORDER_MEMBER]},e.JavaScript.text_isEmpty=function(r){return["!"+(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+".length",e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.text_indexOf=function(r){var a="FIRST"==r.getFieldValue("END")?"indexOf":"lastIndexOf",c=e.JavaScript.valueToCode(r,"FIND",e.JavaScript.ORDER_NONE)||"''";return a=(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+"."+a+"("+c+")",r.workspace.options.oneBasedIndex?[a+" + 1",e.JavaScript.ORDER_ADDITION]:[a,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_charAt=function(r){var a=r.getFieldValue("WHERE")||"FROM_START",c=e.JavaScript.valueToCode(r,"VALUE","RANDOM"==a?e.JavaScript.ORDER_NONE:e.JavaScript.ORDER_MEMBER)||"''";switch(a){case"FIRST":return[c+".charAt(0)",e.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[c+".slice(-1)",e.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[c+".charAt("+(r=e.JavaScript.getAdjusted(r,"AT"))+")",e.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[c+".slice("+(r=e.JavaScript.getAdjusted(r,"AT",1,!0))+").charAt(0)",e.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[e.JavaScript.provideFunction_("textRandomLetter",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+c+")",e.JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},e.JavaScript.text.getIndex_=function(r,a,c){return"FIRST"==a?"0":"FROM_END"==a?r+".length - 1 - "+c:"LAST"==a?r+".length - 1":c},e.JavaScript.text_getSubstring=function(r){var a=r.getFieldValue("WHERE1"),c=r.getFieldValue("WHERE2"),p="FROM_END"!=a&&"LAST"!=a&&"FROM_END"!=c&&"LAST"!=c,f=e.JavaScript.valueToCode(r,"STRING",p?e.JavaScript.ORDER_MEMBER:e.JavaScript.ORDER_NONE)||"''";if("FIRST"==a&&"LAST"==c)return[f,e.JavaScript.ORDER_NONE];if(f.match(/^'?\w+'?$/)||p){switch(a){case"FROM_START":p=e.JavaScript.getAdjusted(r,"AT1");break;case"FROM_END":p=f+".length - "+(p=e.JavaScript.getAdjusted(r,"AT1",1,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":p="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(c){case"FROM_START":r=e.JavaScript.getAdjusted(r,"AT2",1);break;case"FROM_END":r=f+".length - "+(r=e.JavaScript.getAdjusted(r,"AT2",0,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"LAST":r=f+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}a=f+".slice("+p+", "+r+")"}else{p=e.JavaScript.getAdjusted(r,"AT1"),r=e.JavaScript.getAdjusted(r,"AT2");var T=e.JavaScript.text.getIndex_,y={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};a=e.JavaScript.provideFunction_("subsequence"+y[a]+y[c],["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==a||"FROM_START"==a?", at1":"")+("FROM_END"==c||"FROM_START"==c?", at2":"")+") {","  var start = "+T("sequence",a,"at1")+";","  var end = "+T("sequence",c,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+f+("FROM_END"==a||"FROM_START"==a?", "+p:"")+("FROM_END"==c||"FROM_START"==c?", "+r:"")+")"}return[a,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_changeCase=function(r){var a={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[r.getFieldValue("CASE")];return r=e.JavaScript.valueToCode(r,"TEXT",a?e.JavaScript.ORDER_MEMBER:e.JavaScript.ORDER_NONE)||"''",[a?r+a:e.JavaScript.provideFunction_("textToTitleCase",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_trim=function(r){var a={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[r.getFieldValue("MODE")];return[(e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_MEMBER)||"''")+a,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_print=function(r){return"window.alert("+(e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''")+");\n"},e.JavaScript.text_prompt_ext=function(r){var a="window.prompt("+(r.getField("TEXT")?e.JavaScript.quote_(r.getFieldValue("TEXT")):e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"==r.getFieldValue("TYPE")&&(a="Number("+a+")"),[a,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_prompt=e.JavaScript.text_prompt_ext,e.JavaScript.text_count=function(r){var a=e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''";return r=e.JavaScript.valueToCode(r,"SUB",e.JavaScript.ORDER_NONE)||"''",[e.JavaScript.provideFunction_("textCount",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+a+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_replace=function(r){var a=e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''",c=e.JavaScript.valueToCode(r,"FROM",e.JavaScript.ORDER_NONE)||"''";return r=e.JavaScript.valueToCode(r,"TO",e.JavaScript.ORDER_NONE)||"''",[e.JavaScript.provideFunction_("textReplace",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+a+", "+c+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_reverse=function(r){return[(e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.variables={},e.JavaScript.variables_get=function(r){return[e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.variables_set=function(r){var a=e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_ASSIGNMENT)||"0";return e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME)+" = "+a+";\n"},e.JavaScript.variablesDynamic={},e.JavaScript.variables_get_dynamic=e.JavaScript.variables_get,e.JavaScript.variables_set_dynamic=e.JavaScript.variables_set,e.JavaScript}.apply(K,N))&&(ie.exports=t)},265:function(ie,K,F){var N,t;N=[F(426)],void 0!==(t=function(e){return(e={Msg:{}}).Msg.ADD_COMMENT="Add Comment",e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_VARIABLE="Delete the '%1' variable",e.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.DUPLICATE_COMMENT="Duplicate Comment",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.HELP="Help",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.IOS_CANCEL="Cancel",e.Msg.IOS_ERROR="Error",e.Msg.IOS_OK="OK",e.Msg.IOS_PROCEDURES_ADD_INPUT="+ Add Input",e.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Allow statements",e.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="This function has duplicate inputs.",e.Msg.IOS_PROCEDURES_INPUTS="INPUTS",e.Msg.IOS_VARIABLES_ADD_BUTTON="Add",e.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Add Variable",e.Msg.IOS_VARIABLES_DELETE_BUTTON="Delete",e.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="You can't use an empty variable name.",e.Msg.IOS_VARIABLES_RENAME_BUTTON="Rename",e.Msg.IOS_VARIABLES_VARIABLE_NAME="Variable name",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",e.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",e.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_DIVISION_SYMBOL="\xf7",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",e.Msg.NEW_NUMBER_VARIABLE="Create number variable...",e.Msg.NEW_STRING_VARIABLE="Create string variable...",e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CREATE_DO="Create '%1'",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.REDO="Redo",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TITLE="to %1 append text %2",e.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TITLE="in text %1 %2",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TODAY="Today",e.Msg.UNDO="Undo",e.Msg.UNNAMED_KEY="unnamed",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",e.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_HUE="230",e.Msg.LOOPS_HUE="120",e.Msg.LISTS_HUE="260",e.Msg.LOGIC_HUE="210",e.Msg.VARIABLES_HUE="330",e.Msg.TEXTS_HUE="160",e.Msg.PROCEDURES_HUE="290",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_DYNAMIC_HUE="310",e.Msg}.apply(K,N))&&(ie.exports=t)}},ie=>{ie(ie.s=369)}]);
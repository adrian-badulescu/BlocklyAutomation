var j2=Object.defineProperty,X2=Object.defineProperties,z2=Object.getOwnPropertyDescriptors,NR=Object.getOwnPropertySymbols,K2=Object.prototype.hasOwnProperty,Y2=Object.prototype.propertyIsEnumerable,kR=(ce,J,G)=>J in ce?j2(ce,J,{enumerable:!0,configurable:!0,writable:!0,value:G}):ce[J]=G,U=(ce,J)=>{for(var G in J||(J={}))K2.call(J,G)&&kR(ce,G,J[G]);if(NR)for(var G of NR(J))Y2.call(J,G)&&kR(ce,G,J[G]);return ce},dt=(ce,J)=>X2(ce,z2(J));(self.webpackChunkAutoBlocklyApp=self.webpackChunkAutoBlocklyApp||[]).push([[179],{588:function(ce,J,G){var L,o;L=[G(761)],void 0!==(o=function(e){"use strict";return e}.apply(J,L))&&(ce.exports=o)},761:function(ce,J){var L;void 0!==(L=function(){"use strict";var o={connectionTypes:{INPUT_VALUE:1,OUTPUT_VALUE:2,NEXT_STATEMENT:3,PREVIOUS_STATEMENT:4},constants:{},LINE_MODE_MULTIPLIER:40,PAGE_MODE_MULTIPLIER:125,DRAG_RADIUS:5,FLYOUT_DRAG_RADIUS:10,SNAP_RADIUS:28};return o.CONNECTING_SNAP_RADIUS=o.SNAP_RADIUS,o.CURRENT_CONNECTION_PREFERENCE=8,o.BUMP_DELAY=250,o.BUMP_RANDOMNESS=10,o.COLLAPSE_CHARS=30,o.LONGPRESS=750,o.SOUND_LIMIT=100,o.DRAG_STACK=!0,o.HSV_SATURATION=.45,o.HSV_VALUE=.65,o.SPRITE={width:96,height:124,url:"sprites.png"},o.constants.ALIGN={LEFT:-1,CENTRE:0,RIGHT:1},o.DRAG_NONE=0,o.DRAG_STICKY=1,o.DRAG_BEGIN=1,o.DRAG_FREE=2,o.OPPOSITE_TYPE=[],o.OPPOSITE_TYPE[o.connectionTypes.INPUT_VALUE]=o.connectionTypes.OUTPUT_VALUE,o.OPPOSITE_TYPE[o.connectionTypes.OUTPUT_VALUE]=o.connectionTypes.INPUT_VALUE,o.OPPOSITE_TYPE[o.connectionTypes.NEXT_STATEMENT]=o.connectionTypes.PREVIOUS_STATEMENT,o.OPPOSITE_TYPE[o.connectionTypes.PREVIOUS_STATEMENT]=o.connectionTypes.NEXT_STATEMENT,o.VARIABLE_CATEGORY_NAME="VARIABLE",o.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",o.PROCEDURE_CATEGORY_NAME="PROCEDURE",o.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",o.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",o.constants.COLLAPSED_INPUT_NAME="_TEMP_COLLAPSED_INPUT",o.constants.COLLAPSED_FIELD_NAME="_TEMP_COLLAPSED_FIELD",o.utils={},o.utils.global=function(){return"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:this}(),o.Msg={},o.utils.global.Blockly||(o.utils.global.Blockly={}),o.utils.global.Blockly.Msg||(o.utils.global.Blockly.Msg=o.Msg),o.utils.colour={},o.utils.colour.parse=function(e){e=String(e).toLowerCase().trim();var r=o.utils.colour.names[e];if(r||(r="0x"==e.substring(0,2)?"#"+e.substring(2):e,/^#[0-9a-f]{6}$/.test(r="#"==r[0]?r:"#"+r)))return r;if(/^#[0-9a-f]{3}$/.test(r))return["#",r[1],r[1],r[2],r[2],r[3],r[3]].join("");var l=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return l&&(e=Number(l[1]),r=Number(l[2]),l=Number(l[3]),0<=e&&256>e&&0<=r&&256>r&&0<=l&&256>l)?o.utils.colour.rgbToHex(e,r,l):null},o.utils.colour.rgbToHex=function(e,r,l){return r=e<<16|r<<8|l,16>e?"#"+(16777216|r).toString(16).substr(1):"#"+r.toString(16)},o.utils.colour.hexToRgb=function(e){return(e=o.utils.colour.parse(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},o.utils.colour.hsvToHex=function(e,r,l){var c=0,p=0,_=0;if(0==r)_=p=c=l;else{var v=Math.floor(e/60),b=e/60-v;e=l*(1-r);var w=l*(1-r*b);switch(r=l*(1-r*(1-b)),v){case 1:c=w,p=l,_=e;break;case 2:c=e,p=l,_=r;break;case 3:c=e,p=w,_=l;break;case 4:c=r,p=e,_=l;break;case 5:c=l,p=e,_=w;break;case 6:case 0:c=l,p=r,_=e}}return o.utils.colour.rgbToHex(Math.floor(c),Math.floor(p),Math.floor(_))},o.utils.colour.blend=function(e,r,l){return(e=o.utils.colour.parse(e))&&(r=o.utils.colour.parse(r))?(e=o.utils.colour.hexToRgb(e),r=o.utils.colour.hexToRgb(r),o.utils.colour.rgbToHex(Math.round(r[0]+l*(e[0]-r[0])),Math.round(r[1]+l*(e[1]-r[1])),Math.round(r[2]+l*(e[2]-r[2])))):null},o.utils.colour.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},o.utils.Coordinate=function(e,r){this.x=e,this.y=r},o.utils.Coordinate.equals=function(e,r){return e==r||!(!e||!r)&&e.x==r.x&&e.y==r.y},o.utils.Coordinate.distance=function(e,r){var l=e.x-r.x;return e=e.y-r.y,Math.sqrt(l*l+e*e)},o.utils.Coordinate.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},o.utils.Coordinate.difference=function(e,r){return new o.utils.Coordinate(e.x-r.x,e.y-r.y)},o.utils.Coordinate.sum=function(e,r){return new o.utils.Coordinate(e.x+r.x,e.y+r.y)},o.utils.Coordinate.prototype.clone=function(){return new o.utils.Coordinate(this.x,this.y)},o.utils.Coordinate.prototype.scale=function(e){return this.x*=e,this.y*=e,this},o.utils.Coordinate.prototype.translate=function(e,r){return this.x+=e,this.y+=r,this},o.utils.Rect=function(e,r,l,c){this.top=e,this.bottom=r,this.left=l,this.right=c},o.utils.Rect.prototype.contains=function(e,r){return e>=this.left&&e<=this.right&&r>=this.top&&r<=this.bottom},o.utils.Rect.prototype.intersects=function(e){return!(this.left>e.right||this.right<e.left||this.top>e.bottom||this.bottom<e.top)},o.utils.string={},o.utils.string.startsWith=function(e,r){return 0==e.lastIndexOf(r,0)},o.utils.string.shortestStringLength=function(e){return e.length?e.reduce(function(r,l){return r.length<l.length?r:l}).length:0},o.utils.string.commonWordPrefix=function(e,r){if(!e.length)return 0;if(1==e.length)return e[0].length;var l=0;r=r||o.utils.string.shortestStringLength(e);for(var c=0;c<r;c++){for(var p=e[0][c],_=1;_<e.length;_++)if(p!=e[_][c])return l;" "==p&&(l=c+1)}for(_=1;_<e.length;_++)if((p=e[_][c])&&" "!=p)return l;return r},o.utils.string.commonWordSuffix=function(e,r){if(!e.length)return 0;if(1==e.length)return e[0].length;var l=0;r=r||o.utils.string.shortestStringLength(e);for(var c=0;c<r;c++){for(var p=e[0].substr(-c-1,1),_=1;_<e.length;_++)if(p!=e[_].substr(-c-1,1))return l;" "==p&&(l=c+1)}for(_=1;_<e.length;_++)if((p=e[_].charAt(e[_].length-c-1))&&" "!=p)return l;return r},o.utils.string.wrap=function(e,r){e=e.split("\n");for(var l=0;l<e.length;l++)e[l]=o.utils.string.wrapLine_(e[l],r);return e.join("\n")},o.utils.string.wrapLine_=function(e,r){if(e.length<=r)return e;for(var l=e.trim().split(/\s+/),c=0;c<l.length;c++)l[c].length>r&&(r=l[c].length);c=-1/0;var p=1;do{var _=c,v=e;e=[];var b=l.length/p,w=1;for(c=0;c<l.length-1;c++)w<(c+1.5)/b?(w++,e[c]=!0):e[c]=!1;e=o.utils.string.wrapMutate_(l,e,r),c=o.utils.string.wrapScore_(l,e,r),e=o.utils.string.wrapToText_(l,e),p++}while(c>_);return v},o.utils.string.wrapScore_=function(e,r,l){for(var c=[0],p=[],_=0;_<e.length;_++)c[c.length-1]+=e[_].length,!0===r[_]?(c.push(0),p.push(e[_].charAt(e[_].length-1))):!1===r[_]&&c[c.length-1]++;for(e=Math.max.apply(Math,c),_=r=0;_<c.length;_++)r-=2*Math.pow(Math.abs(l-c[_]),1.5),r-=Math.pow(e-c[_],1.5),-1!=".?!".indexOf(p[_])?r+=l/3:-1!=",;)]}".indexOf(p[_])&&(r+=l/4);return 1<c.length&&c[c.length-1]<=c[c.length-2]&&(r+=.5),r},o.utils.string.wrapMutate_=function(e,r,l){for(var p,c=o.utils.string.wrapScore_(e,r,l),_=0;_<r.length-1;_++)if(r[_]!=r[_+1]){var v=[].concat(r);v[_]=!v[_],v[_+1]=!v[_+1];var b=o.utils.string.wrapScore_(e,v,l);b>c&&(c=b,p=v)}return p?o.utils.string.wrapMutate_(e,p,l):r},o.utils.string.wrapToText_=function(e,r){for(var l=[],c=0;c<e.length;c++)l.push(e[c]),void 0!==r[c]&&l.push(r[c]?"\n":" ");return l.join("")},o.utils.Size=function(e,r){this.width=e,this.height=r},o.utils.Size.equals=function(e,r){return e==r||!(!e||!r)&&e.width==r.width&&e.height==r.height},o.utils.style={},o.utils.style.getSize=function(e){if("none"!=o.utils.style.getStyle_(e,"display"))return o.utils.style.getSizeWithDisplay_(e);var r=e.style,l=r.display,c=r.visibility,p=r.position;r.visibility="hidden",r.position="absolute",r.display="inline";var _=e.offsetWidth;return e=e.offsetHeight,r.display=l,r.position=p,r.visibility=c,new o.utils.Size(_,e)},o.utils.style.getSizeWithDisplay_=function(e){return new o.utils.Size(e.offsetWidth,e.offsetHeight)},o.utils.style.getStyle_=function(e,r){return o.utils.style.getComputedStyle(e,r)||o.utils.style.getCascadedStyle(e,r)||e.style&&e.style[r]},o.utils.style.getComputedStyle=function(e,r){return document.defaultView&&document.defaultView.getComputedStyle&&(e=document.defaultView.getComputedStyle(e,null))&&(e[r]||e.getPropertyValue(r))||""},o.utils.style.getCascadedStyle=function(e,r){return e.currentStyle?e.currentStyle[r]:null},o.utils.style.getPageOffset=function(e){var r=new o.utils.Coordinate(0,0);e=e.getBoundingClientRect();var l=document.documentElement;return l=new o.utils.Coordinate(window.pageXOffset||l.scrollLeft,window.pageYOffset||l.scrollTop),r.x=e.left+l.x,r.y=e.top+l.y,r},o.utils.style.getViewportPageOffset=function(){var e=document.body,r=document.documentElement;return new o.utils.Coordinate(e.scrollLeft||r.scrollLeft,e.scrollTop||r.scrollTop)},o.utils.style.setElementShown=function(e,r){e.style.display=r?"":"none"},o.utils.style.isRightToLeft=function(e){return"rtl"==o.utils.style.getStyle_(e,"direction")},o.utils.style.getBorderBox=function(e){var r=o.utils.style.getComputedStyle(e,"borderLeftWidth"),l=o.utils.style.getComputedStyle(e,"borderRightWidth"),c=o.utils.style.getComputedStyle(e,"borderTopWidth");return e=o.utils.style.getComputedStyle(e,"borderBottomWidth"),{top:parseFloat(c),right:parseFloat(l),bottom:parseFloat(e),left:parseFloat(r)}},o.utils.style.scrollIntoContainerView=function(e,r,l){e=o.utils.style.getContainerOffsetToScrollInto(e,r,l),r.scrollLeft=e.x,r.scrollTop=e.y},o.utils.style.getContainerOffsetToScrollInto=function(e,r,l){var c=o.utils.style.getPageOffset(e),p=o.utils.style.getPageOffset(r),_=o.utils.style.getBorderBox(r),v=c.x-p.x-_.left;return c=c.y-p.y-_.top,p=o.utils.style.getSizeWithDisplay_(e),e=r.clientWidth-p.width,p=r.clientHeight-p.height,_=r.scrollLeft,r=r.scrollTop,l?(_+=v-e/2,r+=c-p/2):(_+=Math.min(v,Math.max(v-e,0)),r+=Math.min(c,Math.max(c-p,0))),new o.utils.Coordinate(_,r)},o.utils.userAgent={},function(e){function r(c){return-1!=l.indexOf(c.toUpperCase())}o.utils.userAgent.raw=e;var l=o.utils.userAgent.raw.toUpperCase();o.utils.userAgent.IE=r("Trident")||r("MSIE"),o.utils.userAgent.EDGE=r("Edge"),o.utils.userAgent.JAVA_FX=r("JavaFX"),o.utils.userAgent.CHROME=(r("Chrome")||r("CriOS"))&&!o.utils.userAgent.EDGE,o.utils.userAgent.WEBKIT=r("WebKit")&&!o.utils.userAgent.EDGE,o.utils.userAgent.GECKO=r("Gecko")&&!o.utils.userAgent.WEBKIT&&!o.utils.userAgent.IE&&!o.utils.userAgent.EDGE,o.utils.userAgent.ANDROID=r("Android"),e=o.utils.global.navigator&&o.utils.global.navigator.maxTouchPoints,o.utils.userAgent.IPAD=r("iPad")||r("Macintosh")&&0<e,o.utils.userAgent.IPOD=r("iPod"),o.utils.userAgent.IPHONE=r("iPhone")&&!o.utils.userAgent.IPAD&&!o.utils.userAgent.IPOD,o.utils.userAgent.MAC=r("Macintosh"),o.utils.userAgent.TABLET=o.utils.userAgent.IPAD||o.utils.userAgent.ANDROID&&!r("Mobile")||r("Silk"),o.utils.userAgent.MOBILE=!o.utils.userAgent.TABLET&&(o.utils.userAgent.IPOD||o.utils.userAgent.IPHONE||o.utils.userAgent.ANDROID||r("IEMobile"))}(o.utils.global.navigator&&o.utils.global.navigator.userAgent||""),o.utils.noEvent=function(e){e.preventDefault(),e.stopPropagation()},o.utils.isTargetInput=function(e){return"textarea"==e.target.type||"text"==e.target.type||"number"==e.target.type||"email"==e.target.type||"password"==e.target.type||"search"==e.target.type||"tel"==e.target.type||"url"==e.target.type||e.target.isContentEditable||e.target.dataset&&"true"==e.target.dataset.isTextInput},o.utils.getRelativeXY=function(e){var r=new o.utils.Coordinate(0,0),l=e.getAttribute("x");return l&&(r.x=parseInt(l,10)),(l=e.getAttribute("y"))&&(r.y=parseInt(l,10)),(l=(l=e.getAttribute("transform"))&&l.match(o.utils.getRelativeXY.XY_REGEX_))&&(r.x+=Number(l[1]),l[3]&&(r.y+=Number(l[3]))),(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&(e=e.match(o.utils.getRelativeXY.XY_STYLE_REGEX_))&&(r.x+=Number(e[1]),e[3]&&(r.y+=Number(e[3]))),r},o.utils.getInjectionDivXY_=function(e){for(var r=0,l=0;e;){var c=o.utils.getRelativeXY(e);if(r+=c.x,l+=c.y,-1!=(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;e=e.parentNode}return new o.utils.Coordinate(r,l)},o.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,o.utils.getRelativeXY.XY_STYLE_REGEX_=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,o.utils.isRightButton=function(e){return!(!e.ctrlKey||!o.utils.userAgent.MAC)||2==e.button},o.utils.mouseToSvg=function(e,r,l){var c=r.createSVGPoint();return c.x=e.clientX,c.y=e.clientY,l||(l=r.getScreenCTM().inverse()),c.matrixTransform(l)},o.utils.getScrollDeltaPixels=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*o.LINE_MODE_MULTIPLIER,y:e.deltaY*o.LINE_MODE_MULTIPLIER};case 2:return{x:e.deltaX*o.PAGE_MODE_MULTIPLIER,y:e.deltaY*o.PAGE_MODE_MULTIPLIER}}},o.utils.tokenizeInterpolation=function(e){return o.utils.tokenizeInterpolation_(e,!0)},o.utils.replaceMessageReferences=function(e){return"string"!=typeof e?e:(e=o.utils.tokenizeInterpolation_(e,!1)).length?String(e[0]):""},o.utils.checkMessageReferences=function(e){for(var r=!0,l=o.Msg,c=e.match(/%{BKY_[A-Z]\w*}/gi),p=0;p<c.length;p++)null==l[c[p].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+c[p]+" in "+e),r=!1);return r},o.utils.tokenizeInterpolation_=function(e,r){var l=[],c=e.split("");c.push("");var p=0;e=[];for(var _=null,v=0;v<c.length;v++){var b=c[v];0==p?"%"==b?((b=e.join(""))&&l.push(b),e.length=0,p=1):e.push(b):1==p?"%"==b?(e.push(b),p=0):r&&"0"<=b&&"9">=b?(p=2,_=b,(b=e.join(""))&&l.push(b),e.length=0):"{"==b?p=3:(e.push("%",b),p=0):2==p?"0"<=b&&"9">=b?_+=b:(l.push(parseInt(_,10)),v--,p=0):3==p&&(""==b?(e.splice(0,0,"%{"),v--,p=0):"}"!=b?e.push(b):(p=e.join(""),/[A-Z]\w*/i.test(p)?(b=p.toUpperCase(),(b=o.utils.string.startsWith(b,"BKY_")?b.substring(4):null)&&b in o.Msg?"string"==typeof(p=o.Msg[b])?Array.prototype.push.apply(l,o.utils.tokenizeInterpolation_(p,r)):l.push(r?String(p):p):l.push("%{"+p+"}")):l.push("%{"+p+"}"),p=e.length=0))}for((b=e.join(""))&&l.push(b),r=[],v=e.length=0;v<l.length;++v)"string"==typeof l[v]?e.push(l[v]):((b=e.join(""))&&r.push(b),e.length=0,r.push(l[v]));return(b=e.join(""))&&r.push(b),e.length=0,r},o.utils.genUid=function(){for(var e=o.utils.genUid.soup_.length,r=[],l=0;20>l;l++)r[l]=o.utils.genUid.soup_.charAt(Math.random()*e);return r.join("")},o.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o.utils.is3dSupported=function(){if(void 0!==o.utils.is3dSupported.cached_)return o.utils.is3dSupported.cached_;if(!o.utils.global.getComputedStyle)return!1;var e=document.createElement("p"),r="none",l={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var c in document.body.insertBefore(e,null),l)if(void 0!==e.style[c]){if(e.style[c]="translate3d(1px,1px,1px)",!(r=o.utils.global.getComputedStyle(e)))return document.body.removeChild(e),!1;r=r.getPropertyValue(l[c])}return document.body.removeChild(e),o.utils.is3dSupported.cached_="none"!==r,o.utils.is3dSupported.cached_},o.utils.runAfterPageLoad=function(e){if("object"!=typeof document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"==document.readyState)e();else var r=setInterval(function(){"complete"==document.readyState&&(clearInterval(r),e())},10)},o.utils.getViewportBBox=function(){var e=o.utils.style.getViewportPageOffset();return new o.utils.Rect(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},o.utils.arrayRemove=function(e,r){return-1!=(r=e.indexOf(r))&&(e.splice(r,1),!0)},o.utils.getDocumentScroll=function(){var e=document.documentElement,r=window;return o.utils.userAgent.IE&&r.pageYOffset!=e.scrollTop?new o.utils.Coordinate(e.scrollLeft,e.scrollTop):new o.utils.Coordinate(r.pageXOffset||e.scrollLeft,r.pageYOffset||e.scrollTop)},o.utils.getBlockTypeCounts=function(e,r){var l=Object.create(null),c=e.getDescendants(!0);for(r&&(e=e.getNextBlock())&&(e=c.indexOf(e),c.splice(e,c.length-e)),e=0;r=c[e];e++)l[r.type]?l[r.type]++:l[r.type]=1;return l},o.utils.screenToWsCoordinates=function(e,r){var l=r.x;r=r.y;var c=e.getInjectionDiv().getBoundingClientRect();return l=new o.utils.Coordinate(l-c.left,r-c.top),r=e.getOriginOffsetInPixels(),o.utils.Coordinate.difference(l,r).scale(1/e.scale)},o.utils.parseBlockColour=function(e){var r="string"==typeof e?o.utils.replaceMessageReferences(e):e,l=Number(r);if(!isNaN(l)&&0<=l&&360>=l)return{hue:l,hex:o.utils.colour.hsvToHex(l,o.HSV_SATURATION,255*o.HSV_VALUE)};if(l=o.utils.colour.parse(r))return{hue:null,hex:l};throw l='Invalid colour: "'+r+'"',e!=r&&(l+=' (from "'+e+'")'),Error(l)},o.Touch={},o.Touch.TOUCH_ENABLED="ontouchstart"in o.utils.global||!!(o.utils.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!o.utils.global.navigator||!o.utils.global.navigator.maxTouchPoints&&!o.utils.global.navigator.msMaxTouchPoints),o.Touch.touchIdentifier_=null,o.Touch.TOUCH_MAP={},o.utils.global.PointerEvent?o.Touch.TOUCH_MAP={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:o.Touch.TOUCH_ENABLED&&(o.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),o.longPid_=0,o.longStart=function(e,r){o.longStop_(),e.changedTouches&&1!=e.changedTouches.length||(o.longPid_=setTimeout(function(){e.changedTouches&&(e.button=2,e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),r&&r.handleRightClick(e)},o.LONGPRESS))},o.longStop_=function(){o.longPid_&&(clearTimeout(o.longPid_),o.longPid_=0)},o.Touch.clearTouchIdentifier=function(){o.Touch.touchIdentifier_=null},o.Touch.shouldHandleEvent=function(e){return!o.Touch.isMouseOrTouchEvent(e)||o.Touch.checkTouchIdentifier(e)},o.Touch.getTouchIdentifierFromEvent=function(e){return null!=e.pointerId?e.pointerId:e.changedTouches&&e.changedTouches[0]&&null!=e.changedTouches[0].identifier?e.changedTouches[0].identifier:"mouse"},o.Touch.checkTouchIdentifier=function(e){var r=o.Touch.getTouchIdentifierFromEvent(e);return null!=o.Touch.touchIdentifier_?o.Touch.touchIdentifier_==r:("mousedown"==e.type||"touchstart"==e.type||"pointerdown"==e.type)&&(o.Touch.touchIdentifier_=r,!0)},o.Touch.setClientFromTouch=function(e){if(o.utils.string.startsWith(e.type,"touch")){var r=e.changedTouches[0];e.clientX=r.clientX,e.clientY=r.clientY}},o.Touch.isMouseOrTouchEvent=function(e){return o.utils.string.startsWith(e.type,"touch")||o.utils.string.startsWith(e.type,"mouse")||o.utils.string.startsWith(e.type,"pointer")},o.Touch.isTouchEvent=function(e){return o.utils.string.startsWith(e.type,"touch")||o.utils.string.startsWith(e.type,"pointer")},o.Touch.splitEventByTouches=function(e){var r=[];if(e.changedTouches)for(var l=0;l<e.changedTouches.length;l++)r[l]={type:e.type,changedTouches:[e.changedTouches[l]],target:e.target,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()}};else r.push(e);return r},o.browserEvents={},o.browserEvents.conditionalBind=function(e,r,l,c,p,_){var v=!1,b=function(Ve){var It=!p;Ve=o.Touch.splitEventByTouches(Ve);for(var ui,vn=0;ui=Ve[vn];vn++)(!It||o.Touch.shouldHandleEvent(ui))&&(o.Touch.setClientFromTouch(ui),l?c.call(l,ui):c(ui),v=!0)},w=[];if(o.utils.global.PointerEvent&&r in o.Touch.TOUCH_MAP)for(var X,F=0;X=o.Touch.TOUCH_MAP[r][F];F++)e.addEventListener(X,b,!1),w.push([e,X,b]);else if(e.addEventListener(r,b,!1),w.push([e,r,b]),r in o.Touch.TOUCH_MAP){var xe=function(Ve){b(Ve),v&&!_&&Ve.preventDefault()};for(F=0;X=o.Touch.TOUCH_MAP[r][F];F++)e.addEventListener(X,xe,!1),w.push([e,X,xe])}return w},o.browserEvents.bind=function(e,r,l,c){var p=function(F){l?c.call(l,F):c(F)},_=[];if(o.utils.global.PointerEvent&&r in o.Touch.TOUCH_MAP)for(var b,v=0;b=o.Touch.TOUCH_MAP[r][v];v++)e.addEventListener(b,p,!1),_.push([e,b,p]);else if(e.addEventListener(r,p,!1),_.push([e,r,p]),r in o.Touch.TOUCH_MAP){var w=function(F){if(F.changedTouches&&1==F.changedTouches.length){var X=F.changedTouches[0];F.clientX=X.clientX,F.clientY=X.clientY}p(F),F.preventDefault()};for(v=0;b=o.Touch.TOUCH_MAP[r][v];v++)e.addEventListener(b,w,!1),_.push([e,b,w])}return _},o.browserEvents.unbind=function(e){for(;e.length;){var r=e.pop(),l=r[2];r[0].removeEventListener(r[1],l,!1)}return l},o.ComponentManager=function(){this.componentData_=Object.create(null),this.capabilityToComponentIds_=Object.create(null)},o.ComponentManager.prototype.addComponent=function(e,r){var l=e.component.id;if(!r&&this.componentData_[l])throw Error('Plugin "'+l+'" with capabilities "'+this.componentData_[l].capabilities+'" already added.');this.componentData_[l]=e,r=[];for(var c=0;c<e.capabilities.length;c++){var p=String(e.capabilities[c]).toLowerCase();r.push(p),void 0===this.capabilityToComponentIds_[p]?this.capabilityToComponentIds_[p]=[l]:this.capabilityToComponentIds_[p].push(l)}this.componentData_[l].capabilities=r},o.ComponentManager.prototype.removeComponent=function(e){var r=this.componentData_[e];if(r){for(var l=0;l<r.capabilities.length;l++){var c=String(r.capabilities[l]).toLowerCase();this.capabilityToComponentIds_[c].splice(this.capabilityToComponentIds_[c].indexOf(e),1)}delete this.componentData_[e]}},o.ComponentManager.prototype.addCapability=function(e,r){if(!this.getComponent(e))throw Error('Cannot add capability, "'+r+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,r)?console.warn('Plugin "'+e+'already has capability "'+r+'"'):(r=String(r).toLowerCase(),this.componentData_[e].capabilities.push(r),this.capabilityToComponentIds_[r].push(e))},o.ComponentManager.prototype.removeCapability=function(e,r){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+r+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,r)?(r=String(r).toLowerCase(),this.componentData_[e].capabilities.splice(this.componentData_[e].capabilities.indexOf(r),1),this.capabilityToComponentIds_[r].splice(this.capabilityToComponentIds_[r].indexOf(e),1)):console.warn('Plugin "'+e+"doesn't have capability \""+r+'" to remove')},o.ComponentManager.prototype.hasCapability=function(e,r){return r=String(r).toLowerCase(),-1!==this.componentData_[e].capabilities.indexOf(r)},o.ComponentManager.prototype.getComponent=function(e){return this.componentData_[e]&&this.componentData_[e].component},o.ComponentManager.prototype.getComponents=function(e,r){if(e=String(e).toLowerCase(),!(e=this.capabilityToComponentIds_[e]))return[];var l=[];if(r){var c=[],p=this.componentData_;e.forEach(function(_){c.push(p[_])}),c.sort(function(_,v){return _.weight-v.weight}),c.forEach(function(_){l.push(_.component)})}else p=this.componentData_,e.forEach(function(_){l.push(p[_].component)});return l},o.ComponentManager.Capability=function(e){this.name_=e},o.ComponentManager.Capability.prototype.toString=function(){return this.name_},o.ComponentManager.Capability.POSITIONABLE=new o.ComponentManager.Capability("positionable"),o.ComponentManager.Capability.DRAG_TARGET=new o.ComponentManager.Capability("drag_target"),o.ComponentManager.Capability.DELETE_AREA=new o.ComponentManager.Capability("delete_area"),o.ComponentManager.Capability.AUTOHIDEABLE=new o.ComponentManager.Capability("autohideable"),o.utils.Svg=function(e){this.tagName_=e},o.utils.Svg.prototype.toString=function(){return this.tagName_},o.utils.Svg.ANIMATE=new o.utils.Svg("animate"),o.utils.Svg.CIRCLE=new o.utils.Svg("circle"),o.utils.Svg.CLIPPATH=new o.utils.Svg("clipPath"),o.utils.Svg.DEFS=new o.utils.Svg("defs"),o.utils.Svg.FECOMPOSITE=new o.utils.Svg("feComposite"),o.utils.Svg.FECOMPONENTTRANSFER=new o.utils.Svg("feComponentTransfer"),o.utils.Svg.FEFLOOD=new o.utils.Svg("feFlood"),o.utils.Svg.FEFUNCA=new o.utils.Svg("feFuncA"),o.utils.Svg.FEGAUSSIANBLUR=new o.utils.Svg("feGaussianBlur"),o.utils.Svg.FEPOINTLIGHT=new o.utils.Svg("fePointLight"),o.utils.Svg.FESPECULARLIGHTING=new o.utils.Svg("feSpecularLighting"),o.utils.Svg.FILTER=new o.utils.Svg("filter"),o.utils.Svg.FOREIGNOBJECT=new o.utils.Svg("foreignObject"),o.utils.Svg.G=new o.utils.Svg("g"),o.utils.Svg.IMAGE=new o.utils.Svg("image"),o.utils.Svg.LINE=new o.utils.Svg("line"),o.utils.Svg.PATH=new o.utils.Svg("path"),o.utils.Svg.PATTERN=new o.utils.Svg("pattern"),o.utils.Svg.POLYGON=new o.utils.Svg("polygon"),o.utils.Svg.RECT=new o.utils.Svg("rect"),o.utils.Svg.SVG=new o.utils.Svg("svg"),o.utils.Svg.TEXT=new o.utils.Svg("text"),o.utils.Svg.TSPAN=new o.utils.Svg("tspan"),o.utils.dom={},o.utils.dom.SVG_NS="http://www.w3.org/2000/svg",o.utils.dom.HTML_NS="http://www.w3.org/1999/xhtml",o.utils.dom.XLINK_NS="http://www.w3.org/1999/xlink",o.utils.dom.NodeType={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_POSITION_CONTAINED_BY:16},o.utils.dom.cacheWidths_=null,o.utils.dom.cacheReference_=0,o.utils.dom.canvasContext_=null,o.utils.dom.createSvgElement=function(e,r,l){for(var c in e=document.createElementNS(o.utils.dom.SVG_NS,String(e)),r)e.setAttribute(c,r[c]);return document.body.runtimeStyle&&(e.runtimeStyle=e.currentStyle=e.style),l&&l.appendChild(e),e},o.utils.dom.addClass=function(e,r){var l=e.getAttribute("class")||"";return-1==(" "+l+" ").indexOf(" "+r+" ")&&(l&&(l+=" "),e.setAttribute("class",l+r),!0)},o.utils.dom.removeClasses=function(e,r){r=r.split(" ");for(var l=0;l<r.length;l++)o.utils.dom.removeClass(e,r[l])},o.utils.dom.removeClass=function(e,r){var l=e.getAttribute("class");if(-1==(" "+l+" ").indexOf(" "+r+" "))return!1;l=l.split(/\s+/);for(var c=0;c<l.length;c++)l[c]&&l[c]!=r||(l.splice(c,1),c--);return l.length?e.setAttribute("class",l.join(" ")):e.removeAttribute("class"),!0},o.utils.dom.hasClass=function(e,r){return-1!=(" "+e.getAttribute("class")+" ").indexOf(" "+r+" ")},o.utils.dom.removeNode=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},o.utils.dom.insertAfter=function(e,r){var l=r.nextSibling;if(!(r=r.parentNode))throw Error("Reference node has no parent.");l?r.insertBefore(e,l):r.appendChild(e)},o.utils.dom.containsNode=function(e,r){return!!(e.compareDocumentPosition(r)&o.utils.dom.NodeType.DOCUMENT_POSITION_CONTAINED_BY)},o.utils.dom.setCssTransform=function(e,r){e.style.transform=r,e.style["-webkit-transform"]=r},o.utils.dom.startTextWidthCache=function(){o.utils.dom.cacheReference_++,o.utils.dom.cacheWidths_||(o.utils.dom.cacheWidths_=Object.create(null))},o.utils.dom.stopTextWidthCache=function(){o.utils.dom.cacheReference_--,o.utils.dom.cacheReference_||(o.utils.dom.cacheWidths_=null)},o.utils.dom.getTextWidth=function(e){var l,r=e.textContent+"\n"+e.className.baseVal;if(o.utils.dom.cacheWidths_&&(l=o.utils.dom.cacheWidths_[r]))return l;try{l=o.utils.userAgent.IE||o.utils.userAgent.EDGE?e.getBBox().width:e.getComputedTextLength()}catch(c){return 8*e.textContent.length}return o.utils.dom.cacheWidths_&&(o.utils.dom.cacheWidths_[r]=l),l},o.utils.dom.getFastTextWidth=function(e,r,l,c){return o.utils.dom.getFastTextWidthWithSizeString(e,r+"pt",l,c)},o.utils.dom.getFastTextWidthWithSizeString=function(e,r,l,c){var _,p=e.textContent;return e=p+"\n"+e.className.baseVal,o.utils.dom.cacheWidths_&&(_=o.utils.dom.cacheWidths_[e])||(o.utils.dom.canvasContext_||((_=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(_),o.utils.dom.canvasContext_=_.getContext("2d")),o.utils.dom.canvasContext_.font=l+" "+r+" "+c,_=o.utils.dom.canvasContext_.measureText(p).width,o.utils.dom.cacheWidths_&&(o.utils.dom.cacheWidths_[e]=_)),_},o.utils.dom.measureFontMetrics=function(e,r,l,c){var p=document.createElement("span");p.style.font=l+" "+r+" "+c,p.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0px",(r=document.createElement("div")).setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),r.appendChild(p),r.appendChild(e),document.body.appendChild(r);try{l={},r.style.alignItems="baseline",l.baseline=e.offsetTop-p.offsetTop,r.style.alignItems="flex-end",l.height=e.offsetTop-p.offsetTop}finally{document.body.removeChild(r)}return l},o.utils.math={},o.utils.math.toRadians=function(e){return e*Math.PI/180},o.utils.math.toDegrees=function(e){return 180*e/Math.PI},o.utils.math.clamp=function(e,r,l){if(l<e){var c=l;l=e,e=c}return Math.max(e,Math.min(r,l))},o.DropDownDiv=function(){},o.DropDownDiv.boundsElement_=null,o.DropDownDiv.owner_=null,o.DropDownDiv.positionToField_=null,o.DropDownDiv.ARROW_SIZE=16,o.DropDownDiv.BORDER_SIZE=1,o.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,o.DropDownDiv.PADDING_Y=16,o.DropDownDiv.ANIMATION_TIME=.25,o.DropDownDiv.animateOutTimer_=null,o.DropDownDiv.onHide_=null,o.DropDownDiv.rendererClassName_="",o.DropDownDiv.themeClassName_="",o.DropDownDiv.createDom=function(){if(!o.DropDownDiv.DIV_){var e=document.createElement("div");e.className="blocklyDropDownDiv",(o.parentContainer||document.body).appendChild(e),o.DropDownDiv.DIV_=e;var r=document.createElement("div");r.className="blocklyDropDownContent",e.appendChild(r),o.DropDownDiv.content_=r,(r=document.createElement("div")).className="blocklyDropDownArrow",e.appendChild(r),o.DropDownDiv.arrow_=r,o.DropDownDiv.DIV_.style.opacity=0,o.DropDownDiv.DIV_.style.transition="transform "+o.DropDownDiv.ANIMATION_TIME+"s, opacity "+o.DropDownDiv.ANIMATION_TIME+"s",e.addEventListener("focusin",function(){o.utils.dom.addClass(e,"blocklyFocused")}),e.addEventListener("focusout",function(){o.utils.dom.removeClass(e,"blocklyFocused")})}},o.DropDownDiv.setBoundsElement=function(e){o.DropDownDiv.boundsElement_=e},o.DropDownDiv.getContentDiv=function(){return o.DropDownDiv.content_},o.DropDownDiv.clearContent=function(){o.DropDownDiv.content_.textContent="",o.DropDownDiv.content_.style.width=""},o.DropDownDiv.setColour=function(e,r){o.DropDownDiv.DIV_.style.backgroundColor=e,o.DropDownDiv.DIV_.style.borderColor=r},o.DropDownDiv.showPositionedByBlock=function(e,r,l,c){return o.DropDownDiv.showPositionedByRect_(o.DropDownDiv.getScaledBboxOfBlock_(r),e,l,c)},o.DropDownDiv.showPositionedByField=function(e,r,l){return o.DropDownDiv.positionToField_=!0,o.DropDownDiv.showPositionedByRect_(o.DropDownDiv.getScaledBboxOfField_(e),e,r,l)},o.DropDownDiv.getScaledBboxOfBlock_=function(e){var r=e.getSvgRoot(),l=r.getBBox(),c=e.workspace.scale;return e=l.height*c,l=l.width*c,r=o.utils.style.getPageOffset(r),new o.utils.Rect(r.y,r.y+e,r.x,r.x+l)},o.DropDownDiv.getScaledBboxOfField_=function(e){return e=e.getScaledBBox(),new o.utils.Rect(e.top,e.bottom,e.left,e.right)},o.DropDownDiv.showPositionedByRect_=function(e,r,l,c){var p=e.left+(e.right-e.left)/2,_=e.bottom;e=e.top,c&&(e+=c);for(var v=(c=r.getSourceBlock()).workspace;v.options.parentWorkspace;)v=v.options.parentWorkspace;return o.DropDownDiv.setBoundsElement(v.getParentSvg().parentNode),o.DropDownDiv.show(r,c.RTL,p,_,p,e,l)},o.DropDownDiv.show=function(e,r,l,c,p,_,v){return o.DropDownDiv.owner_=e,o.DropDownDiv.onHide_=v||null,(e=o.DropDownDiv.DIV_).style.direction=r?"rtl":"ltr",r=o.getMainWorkspace(),o.DropDownDiv.rendererClassName_=r.getRenderer().getClassName(),o.DropDownDiv.themeClassName_=r.getTheme().getClassName(),o.utils.dom.addClass(e,o.DropDownDiv.rendererClassName_),o.utils.dom.addClass(e,o.DropDownDiv.themeClassName_),o.DropDownDiv.positionInternal_(l,c,p,_)},o.DropDownDiv.getBoundsInfo_=function(){var e=o.utils.style.getPageOffset(o.DropDownDiv.boundsElement_),r=o.utils.style.getSize(o.DropDownDiv.boundsElement_);return{left:e.x,right:e.x+r.width,top:e.y,bottom:e.y+r.height,width:r.width,height:r.height}},o.DropDownDiv.getPositionMetrics_=function(e,r,l,c){var p=o.DropDownDiv.getBoundsInfo_(),_=o.utils.style.getSize(o.DropDownDiv.DIV_);return r+_.height<p.bottom?o.DropDownDiv.getPositionBelowMetrics_(e,r,p,_):c-_.height>p.top?o.DropDownDiv.getPositionAboveMetrics_(l,c,p,_):r+_.height<document.documentElement.clientHeight?o.DropDownDiv.getPositionBelowMetrics_(e,r,p,_):c-_.height>document.documentElement.clientTop?o.DropDownDiv.getPositionAboveMetrics_(l,c,p,_):o.DropDownDiv.getPositionTopOfPageMetrics_(e,p,_)},o.DropDownDiv.getPositionBelowMetrics_=function(e,r,l,c){return{initialX:(e=o.DropDownDiv.getPositionX(e,l.left,l.right,c.width)).divX,initialY:r,finalX:e.divX,finalY:r+o.DropDownDiv.PADDING_Y,arrowX:e.arrowX,arrowY:-(o.DropDownDiv.ARROW_SIZE/2+o.DropDownDiv.BORDER_SIZE),arrowAtTop:!0,arrowVisible:!0}},o.DropDownDiv.getPositionAboveMetrics_=function(e,r,l,c){return{initialX:(e=o.DropDownDiv.getPositionX(e,l.left,l.right,c.width)).divX,initialY:r-c.height,finalX:e.divX,finalY:r-c.height-o.DropDownDiv.PADDING_Y,arrowX:e.arrowX,arrowY:c.height-2*o.DropDownDiv.BORDER_SIZE-o.DropDownDiv.ARROW_SIZE/2,arrowAtTop:!1,arrowVisible:!0}},o.DropDownDiv.getPositionTopOfPageMetrics_=function(e,r,l){return{initialX:(e=o.DropDownDiv.getPositionX(e,r.left,r.right,l.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},o.DropDownDiv.getPositionX=function(e,r,l,c){var p=e;return e=o.utils.math.clamp(r,e-c/2,l-c),{arrowX:c=o.utils.math.clamp(r=o.DropDownDiv.ARROW_HORIZONTAL_PADDING,(p-=o.DropDownDiv.ARROW_SIZE/2)-e,c-r-o.DropDownDiv.ARROW_SIZE),divX:e}},o.DropDownDiv.isVisible=function(){return!!o.DropDownDiv.owner_},o.DropDownDiv.hideIfOwner=function(e,r){return o.DropDownDiv.owner_===e&&(r?o.DropDownDiv.hideWithoutAnimation():o.DropDownDiv.hide(),!0)},o.DropDownDiv.hide=function(){var e=o.DropDownDiv.DIV_;e.style.transform="translate(0, 0)",e.style.opacity=0,o.DropDownDiv.animateOutTimer_=setTimeout(function(){o.DropDownDiv.hideWithoutAnimation()},1e3*o.DropDownDiv.ANIMATION_TIME),o.DropDownDiv.onHide_&&(o.DropDownDiv.onHide_(),o.DropDownDiv.onHide_=null)},o.DropDownDiv.hideWithoutAnimation=function(){if(o.DropDownDiv.isVisible()){o.DropDownDiv.animateOutTimer_&&clearTimeout(o.DropDownDiv.animateOutTimer_);var e=o.DropDownDiv.DIV_;e.style.transform="",e.style.left="",e.style.top="",e.style.opacity=0,e.style.display="none",e.style.backgroundColor="",e.style.borderColor="",o.DropDownDiv.onHide_&&(o.DropDownDiv.onHide_(),o.DropDownDiv.onHide_=null),o.DropDownDiv.clearContent(),o.DropDownDiv.owner_=null,o.DropDownDiv.rendererClassName_&&(o.utils.dom.removeClass(e,o.DropDownDiv.rendererClassName_),o.DropDownDiv.rendererClassName_=""),o.DropDownDiv.themeClassName_&&(o.utils.dom.removeClass(e,o.DropDownDiv.themeClassName_),o.DropDownDiv.themeClassName_=""),o.getMainWorkspace().markFocused()}},o.DropDownDiv.positionInternal_=function(e,r,l,c){(e=o.DropDownDiv.getPositionMetrics_(e,r,l,c)).arrowVisible?(o.DropDownDiv.arrow_.style.display="",o.DropDownDiv.arrow_.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",o.DropDownDiv.arrow_.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):o.DropDownDiv.arrow_.style.display="none",r=Math.floor(e.initialX),l=Math.floor(e.initialY),c=Math.floor(e.finalX);var p=Math.floor(e.finalY),_=o.DropDownDiv.DIV_;return _.style.left=r+"px",_.style.top=l+"px",_.style.display="block",_.style.opacity=1,_.style.transform="translate("+(c-r)+"px,"+(p-l)+"px)",!!e.arrowAtTop},o.DropDownDiv.repositionForWindowResize=function(){if(o.DropDownDiv.owner_){var e=o.DropDownDiv.owner_,r=e.getSourceBlock();e=o.DropDownDiv.positionToField_?o.DropDownDiv.getScaledBboxOfField_(e):o.DropDownDiv.getScaledBboxOfBlock_(r),o.DropDownDiv.positionInternal_(r=e.left+(e.right-e.left)/2,e.bottom,r,e.top)}else o.DropDownDiv.hide()},o.registry={},o.registry.typeMap_=Object.create(null),o.registry.DEFAULT="default",o.registry.Type=function(e){this.name_=e},o.registry.Type.prototype.toString=function(){return this.name_},o.registry.Type.CONNECTION_CHECKER=new o.registry.Type("connectionChecker"),o.registry.Type.CURSOR=new o.registry.Type("cursor"),o.registry.Type.EVENT=new o.registry.Type("event"),o.registry.Type.FIELD=new o.registry.Type("field"),o.registry.Type.RENDERER=new o.registry.Type("renderer"),o.registry.Type.TOOLBOX=new o.registry.Type("toolbox"),o.registry.Type.THEME=new o.registry.Type("theme"),o.registry.Type.TOOLBOX_ITEM=new o.registry.Type("toolboxItem"),o.registry.Type.FLYOUTS_VERTICAL_TOOLBOX=new o.registry.Type("flyoutsVerticalToolbox"),o.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX=new o.registry.Type("flyoutsHorizontalToolbox"),o.registry.Type.METRICS_MANAGER=new o.registry.Type("metricsManager"),o.registry.Type.BLOCK_DRAGGER=new o.registry.Type("blockDragger"),o.registry.register=function(e,r,l,c){if(!(e instanceof o.registry.Type)&&"string"!=typeof e||""==String(e).trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=String(e).toLowerCase(),"string"!=typeof r||""==r.trim())throw Error('Invalid name "'+r+'". The name must be a non-empty string.');if(r=r.toLowerCase(),!l)throw Error("Can not register a null value");var p=o.registry.typeMap_[e];if(p||(p=o.registry.typeMap_[e]=Object.create(null)),o.registry.validate_(e,l),!c&&p[r])throw Error('Name "'+r+'" with type "'+e+'" already registered.');p[r]=l},o.registry.validate_=function(e,r){if(e===String(o.registry.Type.FIELD)&&"function"!=typeof r.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},o.registry.unregister=function(e,r){e=String(e).toLowerCase(),r=r.toLowerCase();var l=o.registry.typeMap_[e];l&&l[r]?delete o.registry.typeMap_[e][r]:console.warn("Unable to unregister ["+r+"]["+e+"] from the registry.")},o.registry.getItem_=function(e,r,l){e=String(e).toLowerCase(),r=r.toLowerCase();var c=o.registry.typeMap_[e];if(!c||!c[r]){if(r="Unable to find ["+r+"]["+e+"] in the registry.",l)throw Error(r+" You must require or register a "+e+" plugin.");return console.warn(r),null}return c[r]},o.registry.hasItem=function(e,r){return e=String(e).toLowerCase(),r=r.toLowerCase(),!!(e=o.registry.typeMap_[e])&&!!e[r]},o.registry.getClass=function(e,r,l){return o.registry.getItem_(e,r,l)},o.registry.getObject=function(e,r,l){return o.registry.getItem_(e,r,l)},o.registry.getClassFromOptions=function(e,r,l){return"function"==typeof(r=r.plugins[e.toString()]||o.registry.DEFAULT)?r:o.registry.getClass(e,r,l)},o.Events={},o.Events.group_="",o.Events.recordUndo=!0,o.Events.disabled_=0,o.Events.CREATE="create",o.Events.BLOCK_CREATE=o.Events.CREATE,o.Events.DELETE="delete",o.Events.BLOCK_DELETE=o.Events.DELETE,o.Events.CHANGE="change",o.Events.BLOCK_CHANGE=o.Events.CHANGE,o.Events.MOVE="move",o.Events.BLOCK_MOVE=o.Events.MOVE,o.Events.VAR_CREATE="var_create",o.Events.VAR_DELETE="var_delete",o.Events.VAR_RENAME="var_rename",o.Events.UI="ui",o.Events.BLOCK_DRAG="drag",o.Events.SELECTED="selected",o.Events.CLICK="click",o.Events.MARKER_MOVE="marker_move",o.Events.BUBBLE_OPEN="bubble_open",o.Events.TRASHCAN_OPEN="trashcan_open",o.Events.TOOLBOX_ITEM_SELECT="toolbox_item_select",o.Events.THEME_CHANGE="theme_change",o.Events.VIEWPORT_CHANGE="viewport_change",o.Events.COMMENT_CREATE="comment_create",o.Events.COMMENT_DELETE="comment_delete",o.Events.COMMENT_CHANGE="comment_change",o.Events.COMMENT_MOVE="comment_move",o.Events.FINISHED_LOADING="finished_loading",o.Events.BUMP_EVENTS=[o.Events.BLOCK_CREATE,o.Events.BLOCK_MOVE,o.Events.COMMENT_CREATE,o.Events.COMMENT_MOVE],o.Events.FIRE_QUEUE_=[],o.Events.fire=function(e){o.Events.isEnabled()&&(o.Events.FIRE_QUEUE_.length||setTimeout(o.Events.fireNow_,0),o.Events.FIRE_QUEUE_.push(e))},o.Events.fireNow_=function(){for(var l,e=o.Events.filter(o.Events.FIRE_QUEUE_,!0),r=o.Events.FIRE_QUEUE_.length=0;l=e[r];r++)if(l.workspaceId){var c=o.Workspace.getById(l.workspaceId);c&&c.fireChangeListener(l)}},o.Events.filter=function(e,r){e=e.slice(),r||e.reverse();for(var _,l=[],c=Object.create(null),p=0;_=e[p];p++)if(!_.isNull()){var v=[_.isUiEvent?o.Events.UI:_.type,_.blockId,_.workspaceId].join(" "),b=c[v],w=b?b.event:null;b?_.type==o.Events.MOVE&&b.index==p-1?(w.newParentId=_.newParentId,w.newInputName=_.newInputName,w.newCoordinate=_.newCoordinate,b.index=p):_.type==o.Events.CHANGE&&_.element==w.element&&_.name==w.name?w.newValue=_.newValue:_.type==o.Events.VIEWPORT_CHANGE?(w.viewTop=_.viewTop,w.viewLeft=_.viewLeft,w.scale=_.scale,w.oldScale=_.oldScale):(_.type!=o.Events.CLICK||w.type!=o.Events.BUBBLE_OPEN)&&(c[v]={event:_,index:p},l.push(_)):(c[v]={event:_,index:p},l.push(_))}for(e=l.filter(function(F){return!F.isNull()}),r||e.reverse(),p=1;_=e[p];p++)_.type==o.Events.CHANGE&&"mutation"==_.element&&e.unshift(e.splice(p,1)[0]);return e},o.Events.clearPendingUndo=function(){for(var r,e=0;r=o.Events.FIRE_QUEUE_[e];e++)r.recordUndo=!1},o.Events.disable=function(){o.Events.disabled_++},o.Events.enable=function(){o.Events.disabled_--},o.Events.isEnabled=function(){return 0==o.Events.disabled_},o.Events.getGroup=function(){return o.Events.group_},o.Events.setGroup=function(e){o.Events.group_="boolean"==typeof e?e?o.utils.genUid():"":e},o.Events.getDescendantIds=function(e){var r=[];e=e.getDescendants(!1);for(var c,l=0;c=e[l];l++)r[l]=c.id;return r},o.Events.fromJson=function(e,r){var l=o.Events.get(e.type);if(!l)throw Error("Unknown event type.");return(l=new l).fromJson(e),l.workspaceId=r.id,l},o.Events.get=function(e){return o.registry.getClass(o.registry.Type.EVENT,e)},o.Events.disableOrphans=function(e){if((e.type==o.Events.MOVE||e.type==o.Events.CREATE)&&e.workspaceId){var r=o.Workspace.getById(e.workspaceId),l=r.getBlockById(e.blockId);if(l){e=o.Events.recordUndo;try{o.Events.recordUndo=!1;var c=l.getParent();if(c&&c.isEnabled()){var _,p=l.getDescendants(!1);for(r=0;_=p[r];r++)_.setEnabled(!0)}else if((l.outputConnection||l.previousConnection)&&!r.isDragging())do{l.setEnabled(!1),l=l.getNextBlock()}while(l)}finally{o.Events.recordUndo=e}}}},o.Events.Abstract=function(){this.isBlank=null,this.workspaceId=void 0,this.group=o.Events.getGroup(),this.recordUndo=o.Events.recordUndo},o.Events.Abstract.prototype.isUiEvent=!1,o.Events.Abstract.prototype.toJson=function(){var e={type:this.type};return this.group&&(e.group=this.group),e},o.Events.Abstract.prototype.fromJson=function(e){this.isBlank=!1,this.group=e.group},o.Events.Abstract.prototype.isNull=function(){return!1},o.Events.Abstract.prototype.run=function(e){},o.Events.Abstract.prototype.getEventWorkspace_=function(){if(this.workspaceId)var e=o.Workspace.getById(this.workspaceId);if(!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e},o.utils.object={},o.utils.object.inherits=function(e,r){e.superClass_=r.prototype,e.prototype=Object.create(r.prototype),e.prototype.constructor=e},o.utils.object.mixin=function(e,r){for(var l in r)e[l]=r[l]},o.utils.object.deepMerge=function(e,r){for(var l in r)e[l]=null!=r[l]&&"object"==typeof r[l]?o.utils.object.deepMerge(e[l]||Object.create(null),r[l]):r[l];return e},o.utils.object.values=function(e){return Object.values?Object.values(e):Object.keys(e).map(function(r){return e[r]})},o.utils.xml={},o.utils.xml.NAME_SPACE="https://developers.google.com/blockly/xml",o.utils.xml.document=function(){return document},o.utils.xml.createElement=function(e){return o.utils.xml.document().createElementNS(o.utils.xml.NAME_SPACE,e)},o.utils.xml.createTextNode=function(e){return o.utils.xml.document().createTextNode(e)},o.utils.xml.textToDomDocument=function(e){return(new DOMParser).parseFromString(e,"text/xml")},o.utils.xml.domToText=function(e){return(new XMLSerializer).serializeToString(e)},o.inputTypes={VALUE:o.connectionTypes.INPUT_VALUE,STATEMENT:o.connectionTypes.NEXT_STATEMENT,DUMMY:5},o.Xml={},o.Xml.workspaceToDom=function(e,r){var l=o.utils.xml.createElement("xml"),c=o.Xml.variablesToDom(o.Variables.allUsedVarModels(e));c.hasChildNodes()&&l.appendChild(c);var _,p=e.getTopComments(!0);for(c=0;_=p[c];c++)l.appendChild(_.toXmlWithXY(r));for(e=e.getTopBlocks(!0),c=0;p=e[c];c++)l.appendChild(o.Xml.blockToDomWithXY(p,r));return l},o.Xml.variablesToDom=function(e){for(var c,r=o.utils.xml.createElement("variables"),l=0;c=e[l];l++){var p=o.utils.xml.createElement("variable");p.appendChild(o.utils.xml.createTextNode(c.name)),c.type&&p.setAttribute("type",c.type),p.id=c.getId(),r.appendChild(p)}return r},o.Xml.blockToDomWithXY=function(e,r){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;var l;e.workspace.RTL&&(l=e.workspace.getWidth()),r=o.Xml.blockToDom(e,r);var c=e.getRelativeToSurfaceXY();return r.setAttribute("x",Math.round(e.workspace.RTL?l-c.x:c.x)),r.setAttribute("y",Math.round(c.y)),r},o.Xml.fieldToDom_=function(e){if(e.isSerializable()){var r=o.utils.xml.createElement("field");return r.setAttribute("name",e.name||""),e.toXml(r)}return null},o.Xml.allFieldsToDom_=function(e,r){for(var c,l=0;c=e.inputList[l];l++)for(var _,p=0;_=c.fieldRow[p];p++)(_=o.Xml.fieldToDom_(_))&&r.appendChild(_)},o.Xml.blockToDom=function(e,r){if(e.isInsertionMarker())return(e=e.getChildren(!1)[0])?o.Xml.blockToDom(e):new DocumentFragment;var l=o.utils.xml.createElement(e.isShadow()?"shadow":"block");if(l.setAttribute("type",e.type),r||l.setAttribute("id",e.id),e.mutationToDom){var c=e.mutationToDom();c&&(c.hasChildNodes()||c.hasAttributes())&&l.appendChild(c)}if(o.Xml.allFieldsToDom_(e,l),c=e.getCommentText()){var p=e.commentModel.size,_=e.commentModel.pinned,v=o.utils.xml.createElement("comment");v.appendChild(o.utils.xml.createTextNode(c)),v.setAttribute("pinned",_),v.setAttribute("h",p.height),v.setAttribute("w",p.width),l.appendChild(v)}for(e.data&&((c=o.utils.xml.createElement("data")).appendChild(o.utils.xml.createTextNode(e.data)),l.appendChild(c)),c=0;p=e.inputList[c];c++){var b;if(_=!0,p.type!=o.inputTypes.DUMMY){var w=p.connection.targetBlock();p.type==o.inputTypes.VALUE?b=o.utils.xml.createElement("value"):p.type==o.inputTypes.STATEMENT&&(b=o.utils.xml.createElement("statement")),!(v=p.connection.getShadowDom())||w&&w.isShadow()||b.appendChild(o.Xml.cloneShadow_(v,r)),w&&(v=o.Xml.blockToDom(w,r)).nodeType==o.utils.dom.NodeType.ELEMENT_NODE&&(b.appendChild(v),_=!1),b.setAttribute("name",p.name),_||l.appendChild(b)}}return null!=e.inputsInline&&e.inputsInline!=e.inputsInlineDefault&&l.setAttribute("inline",e.inputsInline),e.isCollapsed()&&l.setAttribute("collapsed",!0),e.isEnabled()||l.setAttribute("disabled",!0),e.isDeletable()||e.isShadow()||l.setAttribute("deletable",!1),e.isMovable()||e.isShadow()||l.setAttribute("movable",!1),e.isEditable()||l.setAttribute("editable",!1),(c=e.getNextBlock())&&(v=o.Xml.blockToDom(c,r)).nodeType==o.utils.dom.NodeType.ELEMENT_NODE&&((b=o.utils.xml.createElement("next")).appendChild(v),l.appendChild(b)),!(v=e.nextConnection&&e.nextConnection.getShadowDom())||c&&c.isShadow()||b.appendChild(o.Xml.cloneShadow_(v,r)),l},o.Xml.cloneShadow_=function(e,r){for(var c,l=e=e.cloneNode(!0);l;)if(r&&"shadow"==l.nodeName&&l.removeAttribute("id"),l.firstChild)l=l.firstChild;else{for(;l&&!l.nextSibling;)c=l,l=l.parentNode,c.nodeType==o.utils.dom.NodeType.TEXT_NODE&&""==c.data.trim()&&l.firstChild!=c&&o.utils.dom.removeNode(c);l&&(c=l,l=l.nextSibling,c.nodeType==o.utils.dom.NodeType.TEXT_NODE&&""==c.data.trim()&&o.utils.dom.removeNode(c))}return e},o.Xml.domToText=function(e){return o.utils.xml.domToText(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},o.Xml.domToPrettyText=function(e){e=o.Xml.domToText(e).split("<");for(var r="",l=1;l<e.length;l++){var c=e[l];"/"==c[0]&&(r=r.substring(2)),e[l]=r+"<"+c,"/"!=c[0]&&"/>"!=c.slice(-2)&&(r+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},o.Xml.textToDom=function(e){var r=o.utils.xml.textToDomDocument(e);if(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+e);return r.documentElement},o.Xml.clearWorkspaceAndLoadFromXml=function(e,r){return r.setResizesEnabled(!1),r.clear(),e=o.Xml.domToWorkspace(e,r),r.setResizesEnabled(!0),e},o.Xml.domToWorkspace=function(e,r){if(e instanceof o.Workspace){var l=e;e=r,r=l,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var c;r.RTL&&(c=r.getWidth()),l=[],o.utils.dom.startTextWidthCache();var p=o.Events.getGroup();p||o.Events.setGroup(!0),r.setResizesEnabled&&r.setResizesEnabled(!1);var _=!0;try{for(var b,v=0;b=e.childNodes[v];v++){var w=b.nodeName.toLowerCase(),F=b;if("block"==w||"shadow"==w&&!o.Events.recordUndo){var X=o.Xml.domToBlock(F,r);l.push(X.id);var xe=F.hasAttribute("x")?parseInt(F.getAttribute("x"),10):10,Ve=F.hasAttribute("y")?parseInt(F.getAttribute("y"),10):10;isNaN(xe)||isNaN(Ve)||X.moveBy(r.RTL?c-xe:xe,Ve),_=!1}else{if("shadow"==w)throw TypeError("Shadow block cannot be a top-level block.");if("comment"==w)r.rendered?o.WorkspaceCommentSvg?o.WorkspaceCommentSvg.fromXml(F,r,c):console.warn("Missing require for Blockly.WorkspaceCommentSvg, ignoring workspace comment."):o.WorkspaceComment?o.WorkspaceComment.fromXml(F,r):console.warn("Missing require for Blockly.WorkspaceComment, ignoring workspace comment.");else if("variables"==w){if(!_)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");o.Xml.domToVariables(F,r),_=!1}}}}finally{p||o.Events.setGroup(!1),o.utils.dom.stopTextWidthCache()}return r.setResizesEnabled&&r.setResizesEnabled(!0),o.Events.fire(new(o.Events.get(o.Events.FINISHED_LOADING))(r)),l},o.Xml.appendDomToWorkspace=function(e,r){var l;if(Object.prototype.hasOwnProperty.call(r,"scale")&&(l=r.getBlocksBoundingBox()),e=o.Xml.domToWorkspace(e,r),l&&l.top!=l.bottom){var c=l.bottom,p=r.RTL?l.right:l.left,_=1/0,v=-1/0,b=1/0;for(l=0;l<e.length;l++){var w=r.getBlockById(e[l]).getRelativeToSurfaceXY();w.y<b&&(b=w.y),w.x<_&&(_=w.x),w.x>v&&(v=w.x)}for(c=c-b+10,p=r.RTL?p-v:p-_,l=0;l<e.length;l++)r.getBlockById(e[l]).moveBy(p,c)}return e},o.Xml.domToBlock=function(e,r){if(e instanceof o.Workspace){var l=e;e=r,r=l,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}o.Events.disable(),l=r.getAllVariables();try{var c=o.Xml.domToBlockHeadless_(e,r),p=c.getDescendants(!1);if(r.rendered){c.setConnectionTracking(!1);for(var _=p.length-1;0<=_;_--)p[_].initSvg();for(_=p.length-1;0<=_;_--)p[_].render(!1);setTimeout(function(){c.disposed||c.setConnectionTracking(!0)},1),c.updateDisabled(),r.resizeContents()}else for(_=p.length-1;0<=_;_--)p[_].initModel()}finally{o.Events.enable()}if(o.Events.isEnabled()){for(e=o.Variables.getAddedVariables(r,l),_=0;_<e.length;_++)r=e[_],o.Events.fire(new(o.Events.get(o.Events.VAR_CREATE))(r));o.Events.fire(new(o.Events.get(o.Events.CREATE))(c))}return c},o.Xml.domToVariables=function(e,r){for(var c,l=0;c=e.childNodes[l];l++)if(c.nodeType==o.utils.dom.NodeType.ELEMENT_NODE){var p=c.getAttribute("type"),_=c.getAttribute("id");r.createVariable(c.textContent,p,_)}},o.Xml.mapSupportedXmlTags_=function(e){for(var c,r={mutation:[],comment:[],data:[],field:[],input:[],next:[]},l=0;c=e.childNodes[l];l++)if(c.nodeType!=o.utils.dom.NodeType.TEXT_NODE)switch(c.nodeName.toLowerCase()){case"mutation":r.mutation.push(c);break;case"comment":if(!o.Comment){console.warn("Missing require for Blockly.Comment, ignoring block comment.");break}r.comment.push(c);break;case"data":r.data.push(c);break;case"title":case"field":r.field.push(c);break;case"value":case"statement":r.input.push(c);break;case"next":r.next.push(c);break;default:console.warn("Ignoring unknown tag: "+c.nodeName)}return r},o.Xml.applyMutationTagNodes_=function(e,r){for(var p,l=!1,c=0;p=e[c];c++)r.domToMutation&&(r.domToMutation(p),r.initSvg&&(l=!0));return l},o.Xml.applyCommentTagNodes_=function(e,r){for(var c,l=0;c=e[l];l++){var p=c.textContent,_="true"==c.getAttribute("pinned"),v=parseInt(c.getAttribute("w"),10);c=parseInt(c.getAttribute("h"),10),r.setCommentText(p),r.commentModel.pinned=_,isNaN(v)||isNaN(c)||(r.commentModel.size=new o.utils.Size(v,c)),_&&r.getCommentIcon&&!r.isInFlyout&&setTimeout(function(){r.getCommentIcon().setVisible(!0)},1)}},o.Xml.applyDataTagNodes_=function(e,r){for(var c,l=0;c=e[l];l++)r.data=c.textContent},o.Xml.applyFieldTagNodes_=function(e,r){for(var c,l=0;c=e[l];l++){var p=c.getAttribute("name");o.Xml.domToField_(r,p,c)}},o.Xml.findChildBlocks_=function(e){for(var c,r={childBlockElement:null,childShadowElement:null},l=0;c=e.childNodes[l];l++)c.nodeType==o.utils.dom.NodeType.ELEMENT_NODE&&("block"==c.nodeName.toLowerCase()?r.childBlockElement=c:"shadow"==c.nodeName.toLowerCase()&&(r.childShadowElement=c));return r},o.Xml.applyInputTagNodes_=function(e,r,l,c){for(var _,p=0;_=e[p];p++){var v=_.getAttribute("name"),b=l.getInput(v);if(!b){console.warn("Ignoring non-existent input "+v+" in block "+c);break}if((_=o.Xml.findChildBlocks_(_)).childBlockElement){if(!b.connection)throw TypeError("Input connection does not exist.");o.Xml.domToBlockHeadless_(_.childBlockElement,r,b.connection,!1)}_.childShadowElement&&b.connection.setShadowDom(_.childShadowElement)}},o.Xml.applyNextTagNodes_=function(e,r,l){for(var p,c=0;p=e[c];c++){if((p=o.Xml.findChildBlocks_(p)).childBlockElement){if(!l.nextConnection)throw TypeError("Next statement does not exist.");if(l.nextConnection.isConnected())throw TypeError("Next statement is already connected.");o.Xml.domToBlockHeadless_(p.childBlockElement,r,l.nextConnection,!0)}p.childShadowElement&&l.nextConnection&&l.nextConnection.setShadowDom(p.childShadowElement)}},o.Xml.domToBlockHeadless_=function(e,r,l,c){var p=e.getAttribute("type");if(!p)throw TypeError("Block type unspecified: "+e.outerHTML);var _=e.getAttribute("id");_=r.newBlock(p,_);var v=o.Xml.mapSupportedXmlTags_(e),b=o.Xml.applyMutationTagNodes_(v.mutation,_);if(o.Xml.applyCommentTagNodes_(v.comment,_),o.Xml.applyDataTagNodes_(v.data,_),l)if(c){if(!_.previousConnection)throw TypeError("Next block does not have previous statement.");l.connect(_.previousConnection)}else if(_.outputConnection)l.connect(_.outputConnection);else{if(!_.previousConnection)throw TypeError("Child block does not have output or previous statement.");l.connect(_.previousConnection)}if(o.Xml.applyFieldTagNodes_(v.field,_),o.Xml.applyInputTagNodes_(v.input,r,_,p),o.Xml.applyNextTagNodes_(v.next,r,_),b&&_.initSvg(),(r=e.getAttribute("inline"))&&_.setInputsInline("true"==r),(r=e.getAttribute("disabled"))&&_.setEnabled("true"!=r&&"disabled"!=r),(r=e.getAttribute("deletable"))&&_.setDeletable("true"==r),(r=e.getAttribute("movable"))&&_.setMovable("true"==r),(r=e.getAttribute("editable"))&&_.setEditable("true"==r),(r=e.getAttribute("collapsed"))&&_.setCollapsed("true"==r),"shadow"==e.nodeName.toLowerCase()){for(e=_.getChildren(!1),r=0;l=e[r];r++)if(!l.isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(_.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");_.setShadow(!0)}return _},o.Xml.domToField_=function(e,r,l){var c=e.getField(r);c?c.fromXml(l):console.warn("Ignoring non-existent field "+r+" in block "+e.type)},o.Xml.deleteNext=function(e){for(var l,r=0;l=e.childNodes[r];r++)if("next"==l.nodeName.toLowerCase()){e.removeChild(l);break}},o.Events.BlockBase=function(e){o.Events.BlockBase.superClass_.constructor.call(this),this.blockId=(this.isBlank=void 0===e)?"":e.id,this.workspaceId=this.isBlank?"":e.workspace.id},o.utils.object.inherits(o.Events.BlockBase,o.Events.Abstract),o.Events.BlockBase.prototype.toJson=function(){var e=o.Events.BlockBase.superClass_.toJson.call(this);return e.blockId=this.blockId,e},o.Events.BlockBase.prototype.fromJson=function(e){o.Events.BlockBase.superClass_.fromJson.call(this,e),this.blockId=e.blockId},o.Events.BlockChange=function(e,r,l,c,p){o.Events.Change.superClass_.constructor.call(this,e),e&&(this.element=void 0===r?"":r,this.name=void 0===l?"":l,this.oldValue=void 0===c?"":c,this.newValue=void 0===p?"":p)},o.utils.object.inherits(o.Events.BlockChange,o.Events.BlockBase),o.Events.Change=o.Events.BlockChange,o.Events.BlockChange.prototype.type=o.Events.CHANGE,o.Events.BlockChange.prototype.toJson=function(){var e=o.Events.BlockChange.superClass_.toJson.call(this);return e.element=this.element,this.name&&(e.name=this.name),e.oldValue=this.oldValue,e.newValue=this.newValue,e},o.Events.BlockChange.prototype.fromJson=function(e){o.Events.BlockChange.superClass_.fromJson.call(this,e),this.element=e.element,this.name=e.name,this.oldValue=e.oldValue,this.newValue=e.newValue},o.Events.BlockChange.prototype.isNull=function(){return this.oldValue==this.newValue},o.Events.BlockChange.prototype.run=function(e){var r=this.getEventWorkspace_().getBlockById(this.blockId);if(r)switch(r.mutator&&r.mutator.setVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(r=r.getField(this.name))?r.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":r.setCommentText(e||null);break;case"collapsed":r.setCollapsed(!!e);break;case"disabled":r.setEnabled(!e);break;case"inline":r.setInputsInline(!!e);break;case"mutation":var l="";if(r.mutationToDom&&(l=(l=r.mutationToDom())&&o.Xml.domToText(l)),r.domToMutation){var c=o.Xml.textToDom(e||"<mutation/>");r.domToMutation(c)}o.Events.fire(new o.Events.BlockChange(r,"mutation",null,l,e));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},o.Events.Create=function(e){o.Events.Create.superClass_.constructor.call(this,e),e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=e.workspace.rendered?o.Xml.blockToDomWithXY(e):o.Xml.blockToDom(e),this.ids=o.Events.getDescendantIds(e))},o.utils.object.inherits(o.Events.Create,o.Events.BlockBase),o.Events.BlockCreate=o.Events.Create,o.Events.Create.prototype.type=o.Events.CREATE,o.Events.Create.prototype.toJson=function(){var e=o.Events.Create.superClass_.toJson.call(this);return e.xml=o.Xml.domToText(this.xml),e.ids=this.ids,this.recordUndo||(e.recordUndo=this.recordUndo),e},o.Events.Create.prototype.fromJson=function(e){o.Events.Create.superClass_.fromJson.call(this,e),this.xml=o.Xml.textToDom(e.xml),this.ids=e.ids,void 0!==e.recordUndo&&(this.recordUndo=e.recordUndo)},o.Events.Create.prototype.run=function(e){var r=this.getEventWorkspace_();if(e)(e=o.utils.xml.createElement("xml")).appendChild(this.xml),o.Xml.domToWorkspace(e,r);else{e=0;for(var l;l=this.ids[e];e++){var c=r.getBlockById(l);c?c.dispose(!1):l==this.blockId&&console.warn("Can't uncreate non-existent block: "+l)}}},o.Events.Delete=function(e){if(o.Events.Delete.superClass_.constructor.call(this,e),e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=e.workspace.rendered?o.Xml.blockToDomWithXY(e):o.Xml.blockToDom(e),this.ids=o.Events.getDescendantIds(e)}},o.utils.object.inherits(o.Events.Delete,o.Events.BlockBase),o.Events.BlockDelete=o.Events.Delete,o.Events.Delete.prototype.type=o.Events.DELETE,o.Events.Delete.prototype.toJson=function(){var e=o.Events.Delete.superClass_.toJson.call(this);return e.oldXml=o.Xml.domToText(this.oldXml),e.ids=this.ids,this.recordUndo||(e.recordUndo=this.recordUndo),e},o.Events.Delete.prototype.fromJson=function(e){o.Events.Delete.superClass_.fromJson.call(this,e),this.oldXml=o.Xml.textToDom(e.oldXml),this.ids=e.ids,void 0!==e.recordUndo&&(this.recordUndo=e.recordUndo)},o.Events.Delete.prototype.run=function(e){var r=this.getEventWorkspace_();if(e){e=0;for(var l;l=this.ids[e];e++){var c=r.getBlockById(l);c?c.dispose(!1):l==this.blockId&&console.warn("Can't delete non-existent block: "+l)}}else(e=o.utils.xml.createElement("xml")).appendChild(this.oldXml),o.Xml.domToWorkspace(e,r)},o.Events.Move=function(e){o.Events.Move.superClass_.constructor.call(this,e),e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation_(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)},o.utils.object.inherits(o.Events.Move,o.Events.BlockBase),o.Events.BlockMove=o.Events.Move,o.Events.Move.prototype.type=o.Events.MOVE,o.Events.Move.prototype.toJson=function(){var e=o.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(e.newParentId=this.newParentId),this.newInputName&&(e.newInputName=this.newInputName),this.newCoordinate&&(e.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),this.recordUndo||(e.recordUndo=this.recordUndo),e},o.Events.Move.prototype.fromJson=function(e){if(o.Events.Move.superClass_.fromJson.call(this,e),this.newParentId=e.newParentId,this.newInputName=e.newInputName,e.newCoordinate){var r=e.newCoordinate.split(",");this.newCoordinate=new o.utils.Coordinate(Number(r[0]),Number(r[1]))}void 0!==e.recordUndo&&(this.recordUndo=e.recordUndo)},o.Events.Move.prototype.recordNew=function(){var e=this.currentLocation_();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate},o.Events.Move.prototype.currentLocation_=function(){var e=this.getEventWorkspace_().getBlockById(this.blockId),r={},l=e.getParent();return l?(r.parentId=l.id,(e=l.getInputWithBlock(e))&&(r.inputName=e.name)):r.coordinate=e.getRelativeToSurfaceXY(),r},o.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&o.utils.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},o.Events.Move.prototype.run=function(e){var r=this.getEventWorkspace_(),l=r.getBlockById(this.blockId);if(l){var c=e?this.newParentId:this.oldParentId,p=e?this.newInputName:this.oldInputName,_=e?this.newCoordinate:this.oldCoordinate;if(e=null,c&&!(e=r.getBlockById(c)))return void console.warn("Can't connect to non-existent block: "+c);if(l.getParent()&&l.unplug(),_)p=l.getRelativeToSurfaceXY(),l.moveBy(_.x-p.x,_.y-p.y);else{if(r=(l=l.outputConnection||l.previousConnection).type,p){if(e=e.getInput(p))var v=e.connection}else r==o.connectionTypes.PREVIOUS_STATEMENT&&(v=e.nextConnection);v?l.connect(v):console.warn("Can't connect to non-existent input: "+p)}}else console.warn("Can't move non-existent block: "+this.blockId)},o.registry.register(o.registry.Type.EVENT,o.Events.CREATE,o.Events.Create),o.registry.register(o.registry.Type.EVENT,o.Events.DELETE,o.Events.Delete),o.registry.register(o.registry.Type.EVENT,o.Events.CHANGE,o.Events.BlockChange),o.registry.register(o.registry.Type.EVENT,o.Events.MOVE,o.Events.Move),o.Events.FinishedLoading=function(e){this.isBlank=void 0===e,this.workspaceId=e?e.id:"",this.group=o.Events.getGroup(),this.recordUndo=!1},o.utils.object.inherits(o.Events.FinishedLoading,o.Events.Abstract),o.Events.FinishedLoading.prototype.type=o.Events.FINISHED_LOADING,o.Events.FinishedLoading.prototype.toJson=function(){var e={type:this.type};return this.group&&(e.group=this.group),this.workspaceId&&(e.workspaceId=this.workspaceId),e},o.Events.FinishedLoading.prototype.fromJson=function(e){this.isBlank=!1,this.workspaceId=e.workspaceId,this.group=e.group},o.registry.register(o.registry.Type.EVENT,o.Events.FINISHED_LOADING,o.Events.FinishedLoading),o.Events.UiBase=function(e){o.Events.UiBase.superClass_.constructor.call(this),this.isBlank=void 0===e,this.workspaceId=e||"",this.recordUndo=!1},o.utils.object.inherits(o.Events.UiBase,o.Events.Abstract),o.Events.UiBase.prototype.isUiEvent=!0,o.Events.Ui=function(e,r,l,c){o.Events.Ui.superClass_.constructor.call(this,e?e.workspace.id:void 0),this.blockId=e?e.id:null,this.element=void 0===r?"":r,this.oldValue=void 0===l?"":l,this.newValue=void 0===c?"":c},o.utils.object.inherits(o.Events.Ui,o.Events.UiBase),o.Events.Ui.prototype.type=o.Events.UI,o.Events.Ui.prototype.toJson=function(){var e=o.Events.Ui.superClass_.toJson.call(this);return e.element=this.element,void 0!==this.newValue&&(e.newValue=this.newValue),this.blockId&&(e.blockId=this.blockId),e},o.Events.Ui.prototype.fromJson=function(e){o.Events.Ui.superClass_.fromJson.call(this,e),this.element=e.element,this.newValue=e.newValue,this.blockId=e.blockId},o.registry.register(o.registry.Type.EVENT,o.Events.UI,o.Events.Ui),o.Events.VarBase=function(e){o.Events.VarBase.superClass_.constructor.call(this),this.varId=(this.isBlank=void 0===e)?"":e.getId(),this.workspaceId=this.isBlank?"":e.workspace.id},o.utils.object.inherits(o.Events.VarBase,o.Events.Abstract),o.Events.VarBase.prototype.toJson=function(){var e=o.Events.VarBase.superClass_.toJson.call(this);return e.varId=this.varId,e},o.Events.VarBase.prototype.fromJson=function(e){o.Events.VarBase.superClass_.toJson.call(this),this.varId=e.varId},o.Events.VarCreate=function(e){o.Events.VarCreate.superClass_.constructor.call(this,e),e&&(this.varType=e.type,this.varName=e.name)},o.utils.object.inherits(o.Events.VarCreate,o.Events.VarBase),o.Events.VarCreate.prototype.type=o.Events.VAR_CREATE,o.Events.VarCreate.prototype.toJson=function(){var e=o.Events.VarCreate.superClass_.toJson.call(this);return e.varType=this.varType,e.varName=this.varName,e},o.Events.VarCreate.prototype.fromJson=function(e){o.Events.VarCreate.superClass_.fromJson.call(this,e),this.varType=e.varType,this.varName=e.varName},o.Events.VarCreate.prototype.run=function(e){var r=this.getEventWorkspace_();e?r.createVariable(this.varName,this.varType,this.varId):r.deleteVariableById(this.varId)},o.Events.VarDelete=function(e){o.Events.VarDelete.superClass_.constructor.call(this,e),e&&(this.varType=e.type,this.varName=e.name)},o.utils.object.inherits(o.Events.VarDelete,o.Events.VarBase),o.Events.VarDelete.prototype.type=o.Events.VAR_DELETE,o.Events.VarDelete.prototype.toJson=function(){var e=o.Events.VarDelete.superClass_.toJson.call(this);return e.varType=this.varType,e.varName=this.varName,e},o.Events.VarDelete.prototype.fromJson=function(e){o.Events.VarDelete.superClass_.fromJson.call(this,e),this.varType=e.varType,this.varName=e.varName},o.Events.VarDelete.prototype.run=function(e){var r=this.getEventWorkspace_();e?r.deleteVariableById(this.varId):r.createVariable(this.varName,this.varType,this.varId)},o.Events.VarRename=function(e,r){o.Events.VarRename.superClass_.constructor.call(this,e),e&&(this.oldName=e.name,this.newName=void 0===r?"":r)},o.utils.object.inherits(o.Events.VarRename,o.Events.VarBase),o.Events.VarRename.prototype.type=o.Events.VAR_RENAME,o.Events.VarRename.prototype.toJson=function(){var e=o.Events.VarRename.superClass_.toJson.call(this);return e.oldName=this.oldName,e.newName=this.newName,e},o.Events.VarRename.prototype.fromJson=function(e){o.Events.VarRename.superClass_.fromJson.call(this,e),this.oldName=e.oldName,this.newName=e.newName},o.Events.VarRename.prototype.run=function(e){this.getEventWorkspace_().renameVariableById(this.varId,e?this.newName:this.oldName)},o.registry.register(o.registry.Type.EVENT,o.Events.VAR_CREATE,o.Events.VarCreate),o.registry.register(o.registry.Type.EVENT,o.Events.VAR_DELETE,o.Events.VarDelete),o.registry.register(o.registry.Type.EVENT,o.Events.VAR_RENAME,o.Events.VarRename),o.BlockDragSurfaceSvg=function(e){this.container_=e,this.createDom()},o.BlockDragSurfaceSvg.prototype.SVG_=null,o.BlockDragSurfaceSvg.prototype.dragGroup_=null,o.BlockDragSurfaceSvg.prototype.container_=null,o.BlockDragSurfaceSvg.prototype.scale_=1,o.BlockDragSurfaceSvg.prototype.surfaceXY_=null,o.BlockDragSurfaceSvg.prototype.childSurfaceXY_=new o.utils.Coordinate(0,0),o.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=o.utils.dom.createSvgElement(o.utils.Svg.SVG,{xmlns:o.utils.dom.SVG_NS,"xmlns:html":o.utils.dom.HTML_NS,"xmlns:xlink":o.utils.dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{},this.SVG_))},o.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(e){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(e),this.SVG_.style.display="block",this.surfaceXY_=new o.utils.Coordinate(0,0)},o.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(e,r,l){this.scale_=l,e=e.toFixed(0),r=r.toFixed(0),this.childSurfaceXY_.x=parseInt(e,10),this.childSurfaceXY_.y=parseInt(r,10),this.dragGroup_.setAttribute("transform","translate("+e+","+r+") scale("+l+")")},o.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var e=this.surfaceXY_.x,r=this.surfaceXY_.y;e=e.toFixed(0),r=r.toFixed(0),this.SVG_.style.display="block",o.utils.dom.setCssTransform(this.SVG_,"translate3d("+e+"px, "+r+"px, 0px)")},o.BlockDragSurfaceSvg.prototype.translateBy=function(e,r){this.surfaceXY_=new o.utils.Coordinate(this.surfaceXY_.x+e,this.surfaceXY_.y+r),this.translateSurfaceInternal_()},o.BlockDragSurfaceSvg.prototype.translateSurface=function(e,r){this.surfaceXY_=new o.utils.Coordinate(e*this.scale_,r*this.scale_),this.translateSurfaceInternal_()},o.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var e=o.utils.getRelativeXY(this.SVG_);return new o.utils.Coordinate(e.x/this.scale_,e.y/this.scale_)},o.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},o.BlockDragSurfaceSvg.prototype.getSvgRoot=function(){return this.SVG_},o.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},o.BlockDragSurfaceSvg.prototype.getWsTranslation=function(){return this.childSurfaceXY_.clone()},o.BlockDragSurfaceSvg.prototype.clearAndHide=function(e){if(e?e.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null},o.Css={},o.Css.injected_=!1,o.Css.register=function(e){if(o.Css.injected_)throw Error("CSS already injected");Array.prototype.push.apply(o.Css.CONTENT,e),e.length=0},o.Css.inject=function(e,r){if(!o.Css.injected_){o.Css.injected_=!0;var l=o.Css.CONTENT.join("\n");o.Css.CONTENT.length=0,e&&(e=r.replace(/[\\/]$/,""),l=l.replace(/<<<PATH>>>/g,e),(e=document.createElement("style")).id="blockly-common-style",l=document.createTextNode(l),e.appendChild(l),document.head.insertBefore(e,document.head.firstChild))}},o.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none;","}",".blocklyNonSelectable {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyBlockCanvas.blocklyCanvasTransitioning,",".blocklyBubbleCanvas.blocklyCanvasTransitioning {","transition: transform .5s;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font: 9pt sans-serif;","opacity: .9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: absolute;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-color: #dadce0;","background-color: #fff;","border-radius: 2px;","padding: 4px;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","overflow-x: hidden;","position: relative;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyArrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".blocklyArrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #515A5A;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyInsertionMarker>.blocklyPath,",".blocklyInsertionMarker>.blocklyPathLight,",".blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: .2;","stroke: none;","}",".blocklyMultilineText {","font-family: monospace;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyText text {","cursor: default;","}",".blocklySvg text,",".blocklyBlockDragSurface text {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","height: 100%;","margin: 0;","outline: none;","padding: 0;","width: 100%;","text-align: center;","display: block;","box-sizing: border-box;","}",".blocklyHtmlInput::-ms-clear {","display: none;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal,",".blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyVerticalMarker {","stroke-width: 3px;","fill: rgba(255,255,255,.5);","pointer-events: none;","}",".blocklyComputeCanvas {","position: absolute;","width: 0;","height: 0;","}",".blocklyNoPointerEvents {","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","border-radius: 2px;","padding: 0 !important;","}",".blocklyDropdownMenu .blocklyMenuItem {","padding-left: 28px;","}",".blocklyDropdownMenu .blocklyMenuItemRtl {","padding-left: 5px;","padding-right: 28px;","}",".blocklyWidgetDiv .blocklyMenu {","background: #fff;","border: 1px solid transparent;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","}",".blocklyWidgetDiv .blocklyMenu.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv .blocklyMenu {","background: inherit;","border: inherit;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","position: relative;","z-index: 20000;","}",".blocklyMenuItem {","border: none;","color: #000;","cursor: pointer;","list-style: none;","margin: 0;","min-width: 7em;","padding: 6px 15px;","white-space: nowrap;","}",".blocklyMenuItemDisabled {","color: #ccc;","cursor: inherit;","}",".blocklyMenuItemHighlight {","background-color: rgba(0,0,0,.1);","}",".blocklyMenuItemCheckbox {","height: 16px;","position: absolute;","width: 16px;","}",".blocklyMenuItemSelected .blocklyMenuItemCheckbox {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;","float: left;","margin-left: -24px;","position: static;","}",".blocklyMenuItemRtl .blocklyMenuItemCheckbox {","float: right;","margin-right: -24px;","}"],o.Grid=function(e,r){this.gridPattern_=e,this.spacing_=r.spacing,this.length_=r.length,this.line2_=(this.line1_=e.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=r.snap},o.Grid.prototype.scale_=1,o.Grid.prototype.dispose=function(){this.gridPattern_=null},o.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},o.Grid.prototype.getSpacing=function(){return this.spacing_},o.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},o.Grid.prototype.update=function(e){this.scale_=e;var r=this.spacing_*e||100;this.gridPattern_.setAttribute("width",r),this.gridPattern_.setAttribute("height",r);var l=(r=Math.floor(this.spacing_/2)+.5)-this.length_/2,c=r+this.length_/2;this.setLineAttributes_(this.line1_,e,l*=e,c*=e,r*=e,r),this.setLineAttributes_(this.line2_,e,r,r,l,c)},o.Grid.prototype.setLineAttributes_=function(e,r,l,c,p,_){e&&(e.setAttribute("stroke-width",r),e.setAttribute("x1",l),e.setAttribute("y1",p),e.setAttribute("x2",c),e.setAttribute("y2",_))},o.Grid.prototype.moveTo=function(e,r){this.gridPattern_.setAttribute("x",e),this.gridPattern_.setAttribute("y",r),(o.utils.userAgent.IE||o.utils.userAgent.EDGE)&&this.update(this.scale_)},o.Grid.createDom=function(e,r,l){return e=o.utils.dom.createSvgElement(o.utils.Svg.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},l),0<r.length&&0<r.spacing?(o.utils.dom.createSvgElement(o.utils.Svg.LINE,{stroke:r.colour},e),1<r.length&&o.utils.dom.createSvgElement(o.utils.Svg.LINE,{stroke:r.colour},e)):o.utils.dom.createSvgElement(o.utils.Svg.LINE,{},e),e},o.Theme=function(e,r,l,c){this.name=e,this.blockStyles=r||Object.create(null),this.categoryStyles=l||Object.create(null),this.componentStyles=c||Object.create(null),this.fontStyle=Object.create(null),this.startHats=null,o.registry.register(o.registry.Type.THEME,e,this)},o.Theme.prototype.getClassName=function(){return this.name+"-theme"},o.Theme.prototype.setBlockStyle=function(e,r){this.blockStyles[e]=r},o.Theme.prototype.setCategoryStyle=function(e,r){this.categoryStyles[e]=r},o.Theme.prototype.getComponentStyle=function(e){return(e=this.componentStyles[e])&&"string"==typeof e&&this.getComponentStyle(e)?this.getComponentStyle(e):e?String(e):null},o.Theme.prototype.setComponentStyle=function(e,r){this.componentStyles[e]=r},o.Theme.prototype.setFontStyle=function(e){this.fontStyle=e},o.Theme.prototype.setStartHats=function(e){this.startHats=e},o.Theme.defineTheme=function(e,r){var l=new o.Theme(e),c=r.base;return c&&("string"==typeof c&&(c=o.registry.getObject(o.registry.Type.THEME,c)),c instanceof o.Theme&&(o.utils.object.deepMerge(l,c),l.name=e)),o.utils.object.deepMerge(l.blockStyles,r.blockStyles),o.utils.object.deepMerge(l.categoryStyles,r.categoryStyles),o.utils.object.deepMerge(l.componentStyles,r.componentStyles),o.utils.object.deepMerge(l.fontStyle,r.fontStyle),null!=r.startHats&&(l.startHats=r.startHats),l},o.Themes={},o.Themes.Classic={},o.Themes.Classic.defaultBlockStyles={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},o.Themes.Classic.categoryStyles={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},o.Themes.Classic=new o.Theme("classic",o.Themes.Classic.defaultBlockStyles,o.Themes.Classic.categoryStyles),o.utils.IdGenerator={},o.utils.IdGenerator.nextId_=0,o.utils.IdGenerator.getNextUniqueId=function(){return"blockly-"+(o.utils.IdGenerator.nextId_++).toString(36)},o.utils.Metrics=function(){},o.utils.toolbox={},o.utils.toolbox.CATEGORY_TOOLBOX_KIND="categoryToolbox",o.utils.toolbox.FLYOUT_TOOLBOX_KIND="flyoutToolbox",o.utils.toolbox.Position={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3},o.utils.toolbox.convertToolboxDefToJson=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=o.utils.toolbox.parseToolboxTree(e),e=o.utils.toolbox.convertToToolboxJson_(e)),o.utils.toolbox.validateToolbox_(e),e):null},o.utils.toolbox.validateToolbox_=function(e){var r=e.kind;if(e=e.contents,r&&r!=o.utils.toolbox.FLYOUT_TOOLBOX_KIND&&r!=o.utils.toolbox.CATEGORY_TOOLBOX_KIND)throw Error("Invalid toolbox kind "+r+". Please supply either "+o.utils.toolbox.FLYOUT_TOOLBOX_KIND+" or "+o.utils.toolbox.CATEGORY_TOOLBOX_KIND);if(!e)throw Error("Toolbox must have a contents attribute.")},o.utils.toolbox.convertFlyoutDefToJsonArray=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:o.utils.toolbox.xmlToJsonArray_(e):[]},o.utils.toolbox.hasCategories=function(e){if(!e)return!1;var r=e.kind;return r?r==o.utils.toolbox.CATEGORY_TOOLBOX_KIND:!!e.contents.filter(function(l){return"CATEGORY"==l.kind.toUpperCase()}).length},o.utils.toolbox.isCategoryCollapsible=function(e){return!(!e||!e.contents||!e.contents.filter(function(r){return"CATEGORY"==r.kind.toUpperCase()}).length)},o.utils.toolbox.convertToToolboxJson_=function(e){var r={contents:o.utils.toolbox.xmlToJsonArray_(e)};return e instanceof Node&&o.utils.toolbox.addAttributes_(e,r),r},o.utils.toolbox.xmlToJsonArray_=function(e){var c,r=[],l=e.childNodes;for(l||(l=e),e=0;c=l[e];e++)if(c.tagName){var p={},_=c.tagName.toUpperCase();p.kind=_,"BLOCK"==_?p.blockxml=c:c.childNodes&&0<c.childNodes.length&&(p.contents=o.utils.toolbox.xmlToJsonArray_(c)),o.utils.toolbox.addAttributes_(c,p),r.push(p)}return r},o.utils.toolbox.addAttributes_=function(e,r){for(var l=0;l<e.attributes.length;l++){var c=e.attributes[l];-1<c.nodeName.indexOf("css-")?(r.cssconfig=r.cssconfig||{},r.cssconfig[c.nodeName.replace("css-","")]=c.value):r[c.nodeName]=c.value}},o.utils.toolbox.parseToolboxTree=function(e){if(e){if("string"!=typeof e&&(o.utils.userAgent.IE&&e.outerHTML?e=e.outerHTML:e instanceof Element||(e=null)),"string"==typeof e&&"xml"!=(e=o.Xml.textToDom(e)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e=null;return e},o.Options=function(e){var r=!!e.readOnly;if(r)var l=null,c=!1,p=!1,_=!1,v=!1,b=!1,w=!1;else{l=o.utils.toolbox.convertToolboxDefToJson(e.toolbox),c=o.utils.toolbox.hasCategories(l),void 0===(p=e.trashcan)&&(p=c);var F=e.maxTrashcanContents;p?void 0===F&&(F=32):F=0,void 0===(_=e.collapse)&&(_=c),void 0===(v=e.comments)&&(v=c),void 0===(b=e.disable)&&(b=c),void 0===(w=e.sounds)&&(w=!0)}var X=!!e.rtl,xe=e.horizontalLayout;void 0===xe&&(xe=!1);var Ve=e.toolboxPosition;Ve="end"!==Ve,Ve=xe?Ve?o.utils.toolbox.Position.TOP:o.utils.toolbox.Position.BOTTOM:Ve==X?o.utils.toolbox.Position.RIGHT:o.utils.toolbox.Position.LEFT;var It=e.css;void 0===It&&(It=!0);var vn="https://blockly-demo.appspot.com/static/media/";e.media?vn=e.media:e.path&&(vn=e.path+"media/");var ui=void 0===e.oneBasedIndex||!!e.oneBasedIndex,is=e.renderer||"geras",os=e.plugins||{};this.RTL=X,this.oneBasedIndex=ui,this.collapse=_,this.comments=v,this.disable=b,this.readOnly=r,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=e.maxInstances,this.pathToMedia=vn,this.hasCategories=c,this.moveOptions=o.Options.parseMoveOptions_(e,c),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=p,this.maxTrashcanContents=F,this.hasSounds=w,this.hasCss=It,this.horizontalLayout=xe,this.languageTree=l,this.gridOptions=o.Options.parseGridOptions_(e),this.zoomOptions=o.Options.parseZoomOptions_(e),this.toolboxPosition=Ve,this.theme=o.Options.parseThemeOptions_(e),this.renderer=is,this.rendererOverrides=e.rendererOverrides,this.gridPattern=null,this.parentWorkspace=e.parentWorkspace,this.plugins=os},o.BlocklyOptions=function(){},o.Options.parseMoveOptions_=function(e,r){var l=e.move||{},c={};return void 0===l.scrollbars&&void 0===e.scrollbars?c.scrollbars=r:"object"==typeof l.scrollbars?(c.scrollbars={},c.scrollbars.horizontal=!!l.scrollbars.horizontal,c.scrollbars.vertical=!!l.scrollbars.vertical,c.scrollbars.horizontal&&c.scrollbars.vertical?c.scrollbars=!0:c.scrollbars.horizontal||c.scrollbars.vertical||(c.scrollbars=!1)):c.scrollbars=!!l.scrollbars||!!e.scrollbars,c.wheel=c.scrollbars&&void 0!==l.wheel?!!l.wheel:"object"==typeof c.scrollbars,c.drag=!(!c.scrollbars||void 0!==l.drag&&!l.drag),c},o.Options.parseZoomOptions_=function(e){var r={};return r.controls=void 0!==(e=e.zoom||{}).controls&&!!e.controls,r.wheel=void 0!==e.wheel&&!!e.wheel,r.startScale=void 0===e.startScale?1:Number(e.startScale),r.maxScale=void 0===e.maxScale?3:Number(e.maxScale),r.minScale=void 0===e.minScale?.3:Number(e.minScale),r.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),r.pinch=void 0===e.pinch?r.wheel||r.controls:!!e.pinch,r},o.Options.parseGridOptions_=function(e){e=e.grid||{};var r={};return r.spacing=Number(e.spacing)||0,r.colour=e.colour||"#888",r.length=void 0===e.length?1:Number(e.length),r.snap=0<r.spacing&&!!e.snap,r},o.Options.parseThemeOptions_=function(e){return"string"==typeof(e=e.theme||o.Themes.Classic)?o.registry.getObject(o.registry.Type.THEME,e):e instanceof o.Theme?e:o.Theme.defineTheme(e.name||"builtin"+o.utils.IdGenerator.getNextUniqueId(),e)},o.Options.parseToolboxTree=function(e){return o.utils.deprecation.warn("Blockly.Options.parseToolboxTree","September 2020","September 2021","Blockly.utils.toolbox.parseToolboxTree"),o.utils.toolbox.parseToolboxTree(e)},o.ScrollbarPair=function(e,r,l,c,p){this.workspace_=e,l=void 0===l||l;var _=(r=void 0===r||r)&&l;r&&(this.hScroll=new o.Scrollbar(e,!0,_,c,p)),l&&(this.vScroll=new o.Scrollbar(e,!1,_,c,p)),_&&(this.corner_=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{height:o.Scrollbar.scrollbarThickness,width:o.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),o.utils.dom.insertAfter(this.corner_,e.getBubbleCanvas())),this.oldHostMetrics_=null},o.ScrollbarPair.prototype.dispose=function(){o.utils.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)},o.ScrollbarPair.prototype.resize=function(){var e=this.workspace_.getMetrics();if(e){var r=!1,l=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==e.viewWidth&&this.oldHostMetrics_.viewHeight==e.viewHeight&&this.oldHostMetrics_.absoluteTop==e.absoluteTop&&this.oldHostMetrics_.absoluteLeft==e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth==e.scrollWidth&&this.oldHostMetrics_.viewLeft==e.viewLeft&&this.oldHostMetrics_.scrollLeft==e.scrollLeft||(r=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight==e.scrollHeight&&this.oldHostMetrics_.viewTop==e.viewTop&&this.oldHostMetrics_.scrollTop==e.scrollTop||(l=!0)):l=r=!0,r||l){try{o.Events.disable(),this.hScroll&&r&&this.hScroll.resize(e),this.vScroll&&l&&this.vScroll.resize(e)}finally{o.Events.enable()}this.workspace_.maybeFireViewportChangeEvent()}this.hScroll&&this.vScroll&&(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==e.viewWidth&&this.oldHostMetrics_.absoluteLeft==e.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==e.viewHeight&&this.oldHostMetrics_.absoluteTop==e.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position.y)),this.oldHostMetrics_=e}},o.ScrollbarPair.prototype.canScrollHorizontally=function(){return!!this.hScroll},o.ScrollbarPair.prototype.canScrollVertically=function(){return!!this.vScroll},o.ScrollbarPair.prototype.setOrigin=function(e,r){this.hScroll&&this.hScroll.setOrigin(e,r),this.vScroll&&this.vScroll.setOrigin(e,r)},o.ScrollbarPair.prototype.set=function(e,r,l){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(r,!1),(l||void 0===l)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace_.setMetrics(e))},o.ScrollbarPair.prototype.setX=function(e){this.hScroll&&this.hScroll.set(e,!0)},o.ScrollbarPair.prototype.setY=function(e){this.vScroll&&this.vScroll.set(e,!0)},o.ScrollbarPair.prototype.setContainerVisible=function(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)},o.ScrollbarPair.prototype.isVisible=function(){var e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e},o.ScrollbarPair.prototype.resizeContent=function(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)},o.ScrollbarPair.prototype.resizeView=function(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)},o.Scrollbar=function(e,r,l,c,p){this.workspace_=e,this.pair_=l||!1,this.horizontal_=r,this.margin_=void 0!==p?p:o.Scrollbar.DEFAULT_SCROLLBAR_MARGIN,this.ratio=this.oldHostMetrics_=null,this.createDom_(c),this.position=new o.utils.Coordinate(0,0),e=o.Scrollbar.scrollbarThickness,r?(this.svgBackground_.setAttribute("height",e),this.outerSvg_.setAttribute("height",e),this.svgHandle_.setAttribute("height",e-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",e),this.outerSvg_.setAttribute("width",e),this.svgHandle_.setAttribute("width",e-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=o.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=o.browserEvents.conditionalBind(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},o.Scrollbar.prototype.origin_=new o.utils.Coordinate(0,0),o.Scrollbar.prototype.startDragMouse_=0,o.Scrollbar.prototype.scrollbarLength_=0,o.Scrollbar.prototype.handleLength_=0,o.Scrollbar.prototype.handlePosition_=0,o.Scrollbar.prototype.isVisible_=!0,o.Scrollbar.prototype.containerVisible_=!0,o.Scrollbar.scrollbarThickness=15,o.Touch.TOUCH_ENABLED&&(o.Scrollbar.scrollbarThickness=25),o.Scrollbar.DEFAULT_SCROLLBAR_MARGIN=.5,o.Scrollbar.metricsAreEquivalent_=function(e,r){return e.viewWidth==r.viewWidth&&e.viewHeight==r.viewHeight&&e.viewLeft==r.viewLeft&&e.viewTop==r.viewTop&&e.absoluteTop==r.absoluteTop&&e.absoluteLeft==r.absoluteLeft&&e.scrollWidth==r.scrollWidth&&e.scrollHeight==r.scrollHeight&&e.scrollLeft==r.scrollLeft&&e.scrollTop==r.scrollTop},o.Scrollbar.prototype.dispose=function(){this.cleanUp_(),o.browserEvents.unbind(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,o.browserEvents.unbind(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,o.utils.dom.removeNode(this.outerSvg_),this.svgBackground_=this.svgGroup_=this.outerSvg_=null,this.svgHandle_&&(this.workspace_.getThemeManager().unsubscribe(this.svgHandle_),this.svgHandle_=null),this.workspace_=null},o.Scrollbar.prototype.constrainHandleLength_=function(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength_)},o.Scrollbar.prototype.setHandleLength_=function(e){this.handleLength_=e,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},o.Scrollbar.prototype.constrainHandlePosition_=function(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength_-this.handleLength_)},o.Scrollbar.prototype.setHandlePosition=function(e){this.handlePosition_=e,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},o.Scrollbar.prototype.setScrollbarLength_=function(e){this.scrollbarLength_=e,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollbarLength_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollbarLength_)},o.Scrollbar.prototype.setPosition=function(e,r){this.position.x=e,this.position.y=r,o.utils.dom.setCssTransform(this.outerSvg_,"translate("+(this.position.x+this.origin_.x)+"px,"+(this.position.y+this.origin_.y)+"px)")},o.Scrollbar.prototype.resize=function(e){!e&&!(e=this.workspace_.getMetrics())||this.oldHostMetrics_&&o.Scrollbar.metricsAreEquivalent_(e,this.oldHostMetrics_)||(this.horizontal_?this.resizeHorizontal_(e):this.resizeVertical_(e),this.oldHostMetrics_=e,this.updateMetrics_())},o.Scrollbar.prototype.requiresViewResize_=function(e){return!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==e.viewWidth||this.oldHostMetrics_.viewHeight!==e.viewHeight||this.oldHostMetrics_.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics_.absoluteTop!==e.absoluteTop},o.Scrollbar.prototype.resizeHorizontal_=function(e){this.requiresViewResize_(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)},o.Scrollbar.prototype.resizeViewHorizontal=function(e){var r=e.viewWidth-2*this.margin_;this.pair_&&(r-=o.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,r)),r=e.absoluteLeft+this.margin_,this.pair_&&this.workspace_.RTL&&(r+=o.Scrollbar.scrollbarThickness),this.setPosition(r,e.absoluteTop+e.viewHeight-o.Scrollbar.scrollbarThickness-this.margin_),this.resizeContentHorizontal(e)},o.Scrollbar.prototype.resizeContentHorizontal=function(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var r=this.scrollbarLength_*e.viewWidth/e.scrollWidth;r=this.constrainHandleLength_(r),this.setHandleLength_(r);var l=this.scrollbarLength_-this.handleLength_;e=this.constrainHandlePosition_(e=(e.viewLeft-e.scrollLeft)/(r=e.scrollWidth-e.viewWidth)*l),this.setHandlePosition(e),this.ratio=l/r}},o.Scrollbar.prototype.resizeVertical_=function(e){this.requiresViewResize_(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)},o.Scrollbar.prototype.resizeViewVertical=function(e){var r=e.viewHeight-2*this.margin_;this.pair_&&(r-=o.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,r)),this.setPosition(this.workspace_.RTL?e.absoluteLeft+this.margin_:e.absoluteLeft+e.viewWidth-o.Scrollbar.scrollbarThickness-this.margin_,e.absoluteTop+this.margin_),this.resizeContentVertical(e)},o.Scrollbar.prototype.resizeContentVertical=function(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var r=this.scrollbarLength_*e.viewHeight/e.scrollHeight;r=this.constrainHandleLength_(r),this.setHandleLength_(r);var l=this.scrollbarLength_-this.handleLength_;e=this.constrainHandlePosition_(e=(e.viewTop-e.scrollTop)/(r=e.scrollHeight-e.viewHeight)*l),this.setHandlePosition(e),this.ratio=l/r}},o.Scrollbar.prototype.createDom_=function(e){var r="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");e&&(r+=" "+e),this.outerSvg_=o.utils.dom.createSvgElement(o.utils.Svg.SVG,{class:r},null),this.svgGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{},this.outerSvg_),this.svgBackground_=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blocklyScrollbarBackground"},this.svgGroup_),e=Math.floor((o.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},this.svgGroup_),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarOpacity","fill-opacity"),o.utils.dom.insertAfter(this.outerSvg_,this.workspace_.getParentSvg())},o.Scrollbar.prototype.isVisible=function(){return this.isVisible_},o.Scrollbar.prototype.setContainerVisible=function(e){var r=e!=this.containerVisible_;this.containerVisible_=e,r&&this.updateDisplay_()},o.Scrollbar.prototype.setVisible=function(e){var r=e!=this.isVisible();if(this.pair_)throw Error("Unable to toggle visibility of paired scrollbars.");this.isVisible_=e,r&&this.updateDisplay_()},o.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},o.Scrollbar.prototype.onMouseDownBar_=function(e){if(this.workspace_.markFocused(),o.Touch.clearTouchIdentifier(),this.cleanUp_(),o.utils.isRightButton(e))e.stopPropagation();else{var r=o.utils.mouseToSvg(e,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());r=this.horizontal_?r.x:r.y;var l=o.utils.getInjectionDivXY_(this.svgHandle_),c=this.handlePosition_,p=.95*this.handleLength_;r<=(l=this.horizontal_?l.x:l.y)?c-=p:r>=l+this.handleLength_&&(c+=p),this.setHandlePosition(this.constrainHandlePosition_(c)),this.updateMetrics_(),e.stopPropagation(),e.preventDefault()}},o.Scrollbar.prototype.onMouseDownHandle_=function(e){this.workspace_.markFocused(),this.cleanUp_(),o.utils.isRightButton(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?e.clientX:e.clientY,o.Scrollbar.onMouseUpWrapper_=o.browserEvents.conditionalBind(document,"mouseup",this,this.onMouseUpHandle_),o.Scrollbar.onMouseMoveWrapper_=o.browserEvents.conditionalBind(document,"mousemove",this,this.onMouseMoveHandle_),e.stopPropagation(),e.preventDefault())},o.Scrollbar.prototype.onMouseMoveHandle_=function(e){this.setHandlePosition(this.constrainHandlePosition_(this.startDragHandle+((this.horizontal_?e.clientX:e.clientY)-this.startDragMouse_))),this.updateMetrics_()},o.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),o.Touch.clearTouchIdentifier(),this.cleanUp_()},o.Scrollbar.prototype.cleanUp_=function(){o.hideChaff(!0),o.Scrollbar.onMouseUpWrapper_&&(o.browserEvents.unbind(o.Scrollbar.onMouseUpWrapper_),o.Scrollbar.onMouseUpWrapper_=null),o.Scrollbar.onMouseMoveWrapper_&&(o.browserEvents.unbind(o.Scrollbar.onMouseMoveWrapper_),o.Scrollbar.onMouseMoveWrapper_=null)},o.Scrollbar.prototype.getRatio_=function(){var e=this.handlePosition_/(this.scrollbarLength_-this.handleLength_);return isNaN(e)&&(e=0),e},o.Scrollbar.prototype.updateMetrics_=function(){var e=this.getRatio_(),r={};this.horizontal_?r.x=e:r.y=e,this.workspace_.setMetrics(r)},o.Scrollbar.prototype.set=function(e,r){this.setHandlePosition(this.constrainHandlePosition_(e*this.ratio)),(r||void 0===r)&&this.updateMetrics_()},o.Scrollbar.prototype.setOrigin=function(e,r){this.origin_=new o.utils.Coordinate(e,r)},o.Tooltip={},o.Tooltip.visible=!1,o.Tooltip.blocked_=!1,o.Tooltip.LIMIT=50,o.Tooltip.mouseOutPid_=0,o.Tooltip.showPid_=0,o.Tooltip.lastX_=0,o.Tooltip.lastY_=0,o.Tooltip.element_=null,o.Tooltip.poisonedElement_=null,o.Tooltip.OFFSET_X=0,o.Tooltip.OFFSET_Y=10,o.Tooltip.RADIUS_OK=10,o.Tooltip.HOVER_MS=750,o.Tooltip.MARGINS=5,o.Tooltip.DIV=null,o.Tooltip.getTooltipOfObject=function(e){if(e=o.Tooltip.getTargetObject_(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},o.Tooltip.getTargetObject_=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},o.Tooltip.createDom=function(){o.Tooltip.DIV||(o.Tooltip.DIV=document.createElement("div"),o.Tooltip.DIV.className="blocklyTooltipDiv",(o.parentContainer||document.body).appendChild(o.Tooltip.DIV))},o.Tooltip.bindMouseEvents=function(e){e.mouseOverWrapper_=o.browserEvents.bind(e,"mouseover",null,o.Tooltip.onMouseOver_),e.mouseOutWrapper_=o.browserEvents.bind(e,"mouseout",null,o.Tooltip.onMouseOut_),e.addEventListener("mousemove",o.Tooltip.onMouseMove_,!1)},o.Tooltip.unbindMouseEvents=function(e){e&&(o.browserEvents.unbind(e.mouseOverWrapper_),o.browserEvents.unbind(e.mouseOutWrapper_),e.removeEventListener("mousemove",o.Tooltip.onMouseMove_))},o.Tooltip.onMouseOver_=function(e){o.Tooltip.blocked_||(e=o.Tooltip.getTargetObject_(e.currentTarget),o.Tooltip.element_!=e&&(o.Tooltip.hide(),o.Tooltip.poisonedElement_=null,o.Tooltip.element_=e),clearTimeout(o.Tooltip.mouseOutPid_))},o.Tooltip.onMouseOut_=function(e){o.Tooltip.blocked_||(o.Tooltip.mouseOutPid_=setTimeout(function(){o.Tooltip.element_=null,o.Tooltip.poisonedElement_=null,o.Tooltip.hide()},1),clearTimeout(o.Tooltip.showPid_))},o.Tooltip.onMouseMove_=function(e){if(o.Tooltip.element_&&o.Tooltip.element_.tooltip&&!o.Tooltip.blocked_)if(o.Tooltip.visible){var r=o.Tooltip.lastX_-e.pageX;e=o.Tooltip.lastY_-e.pageY,Math.sqrt(r*r+e*e)>o.Tooltip.RADIUS_OK&&o.Tooltip.hide()}else o.Tooltip.poisonedElement_!=o.Tooltip.element_&&(clearTimeout(o.Tooltip.showPid_),o.Tooltip.lastX_=e.pageX,o.Tooltip.lastY_=e.pageY,o.Tooltip.showPid_=setTimeout(o.Tooltip.show_,o.Tooltip.HOVER_MS))},o.Tooltip.dispose=function(){o.Tooltip.element_=null,o.Tooltip.poisonedElement_=null,o.Tooltip.hide()},o.Tooltip.hide=function(){o.Tooltip.visible&&(o.Tooltip.visible=!1,o.Tooltip.DIV&&(o.Tooltip.DIV.style.display="none")),o.Tooltip.showPid_&&clearTimeout(o.Tooltip.showPid_)},o.Tooltip.block=function(){o.Tooltip.hide(),o.Tooltip.blocked_=!0},o.Tooltip.unblock=function(){o.Tooltip.blocked_=!1},o.Tooltip.show_=function(){if(!o.Tooltip.blocked_&&(o.Tooltip.poisonedElement_=o.Tooltip.element_,o.Tooltip.DIV)){o.Tooltip.DIV.textContent="";var e=o.Tooltip.getTooltipOfObject(o.Tooltip.element_);e=(e=o.utils.string.wrap(e,o.Tooltip.LIMIT)).split("\n");for(var r=0;r<e.length;r++){var l=document.createElement("div");l.appendChild(document.createTextNode(e[r])),o.Tooltip.DIV.appendChild(l)}e=o.Tooltip.element_.RTL,r=document.documentElement.clientWidth,l=document.documentElement.clientHeight,o.Tooltip.DIV.style.direction=e?"rtl":"ltr",o.Tooltip.DIV.style.display="block",o.Tooltip.visible=!0;var c=o.Tooltip.lastX_;c=e?c-(o.Tooltip.OFFSET_X+o.Tooltip.DIV.offsetWidth):c+o.Tooltip.OFFSET_X;var p=o.Tooltip.lastY_+o.Tooltip.OFFSET_Y;p+o.Tooltip.DIV.offsetHeight>l+window.scrollY&&(p-=o.Tooltip.DIV.offsetHeight+2*o.Tooltip.OFFSET_Y),e?c=Math.max(o.Tooltip.MARGINS-window.scrollX,c):c+o.Tooltip.DIV.offsetWidth>r+window.scrollX-2*o.Tooltip.MARGINS&&(c=r-o.Tooltip.DIV.offsetWidth-2*o.Tooltip.MARGINS),o.Tooltip.DIV.style.top=p+"px",o.Tooltip.DIV.style.left=c+"px"}},o.utils.aria={},o.utils.aria.ARIA_PREFIX_="aria-",o.utils.aria.ROLE_ATTRIBUTE_="role",o.utils.aria.Role={GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",LISTBOX:"listbox",MENU:"menu",MENUITEM:"menuitem",MENUITEMCHECKBOX:"menuitemcheckbox",OPTION:"option",PRESENTATION:"presentation",ROW:"row",TREE:"tree",TREEITEM:"treeitem"},o.utils.aria.State={ACTIVEDESCENDANT:"activedescendant",COLCOUNT:"colcount",DISABLED:"disabled",EXPANDED:"expanded",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",ORIENTATION:"orientation",POSINSET:"posinset",ROWCOUNT:"rowcount",SELECTED:"selected",SETSIZE:"setsize",VALUEMAX:"valuemax",VALUEMIN:"valuemin"},o.utils.aria.setRole=function(e,r){e.setAttribute(o.utils.aria.ROLE_ATTRIBUTE_,r)},o.utils.aria.setState=function(e,r,l){Array.isArray(l)&&(l=l.join(" ")),e.setAttribute(o.utils.aria.ARIA_PREFIX_+r,l)},o.IASTNodeLocation=function(){},o.IASTNodeLocationSvg=function(){},o.IASTNodeLocationWithBlock=function(){},o.IKeyboardAccessible=function(){},o.utils.deprecation={},o.utils.deprecation.warn=function(e,r,l,c){e=e+" was deprecated on "+r+" and will be deleted on "+l+".",c&&(e+="\nUse "+c+" instead."),console.warn(e)},o.Connection=function(e,r){this.sourceBlock_=e,this.type=r},o.Connection.CAN_CONNECT=0,o.Connection.REASON_SELF_CONNECTION=1,o.Connection.REASON_WRONG_TYPE=2,o.Connection.REASON_TARGET_NULL=3,o.Connection.REASON_CHECKS_FAILED=4,o.Connection.REASON_DIFFERENT_WORKSPACES=5,o.Connection.REASON_SHADOW_PARENT=6,o.Connection.REASON_DRAG_CHECKS_FAILED=7,o.Connection.prototype.targetConnection=null,o.Connection.prototype.disposed=!1,o.Connection.prototype.check_=null,o.Connection.prototype.shadowDom_=null,o.Connection.prototype.x=0,o.Connection.prototype.y=0,o.Connection.prototype.connect_=function(e){var b,r=o.connectionTypes.INPUT_VALUE,l=this.getSourceBlock(),c=e.getSourceBlock();if(e.isConnected()&&e.disconnect(),this.isConnected()){var p=this.getShadowDom(!0);this.shadowDom_=null;var _=this.targetBlock();if(_.isShadow())_.dispose(!1);else{this.disconnect();var v=_}this.shadowDom_=p}o.Events.isEnabled()&&(b=new(o.Events.get(o.Events.BLOCK_MOVE))(c)),o.Connection.connectReciprocally_(this,e),c.setParent(l),b&&(b.recordNew(),o.Events.fire(b)),v&&((c=o.Connection.getConnectionForOrphanedConnection(c,e=this.type===r?v.outputConnection:v.previousConnection))?e.connect(c):e.onFailedConnect(this))},o.Connection.prototype.dispose=function(){if(this.isConnected()){this.setShadowDom(null);var e=this.targetBlock();e&&e.unplug()}this.disposed=!0},o.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},o.Connection.prototype.isSuperior=function(){return this.type==o.connectionTypes.INPUT_VALUE||this.type==o.connectionTypes.NEXT_STATEMENT},o.Connection.prototype.isConnected=function(){return!!this.targetConnection},o.Connection.prototype.canConnectWithReason=function(e){return o.utils.deprecation.warn("Connection.prototype.canConnectWithReason","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnectWithReason(this,e,!1)},o.Connection.prototype.checkConnection=function(e){o.utils.deprecation.warn("Connection.prototype.checkConnection","July 2020","July 2021","the workspace's connection checker");var r=this.getConnectionChecker(),l=r.canConnectWithReason(this,e,!1);if(l!=o.Connection.CAN_CONNECT)throw Error(r.getErrorMessage(l,this,e))},o.Connection.prototype.getConnectionChecker=function(){return this.sourceBlock_.workspace.connectionChecker},o.Connection.prototype.isConnectionAllowed=function(e){return o.utils.deprecation.warn("Connection.prototype.isConnectionAllowed","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,e,!0)},o.Connection.prototype.onFailedConnect=function(e){},o.Connection.prototype.connect=function(e){if(this.targetConnection!=e&&this.getConnectionChecker().canConnect(this,e,!1)){var r=o.Events.getGroup();r||o.Events.setGroup(!0),this.isSuperior()?this.connect_(e):e.connect_(this),r||o.Events.setGroup(!1)}},o.Connection.connectReciprocally_=function(e,r){if(!e||!r)throw Error("Cannot connect null connections.");e.targetConnection=r,r.targetConnection=e},o.Connection.getSingleConnection_=function(e,r){for(var _,l=null,c=(r=r.outputConnection).getConnectionChecker(),p=0;_=e.inputList[p];p++)if((_=_.connection)&&c.canConnect(r,_,!1)){if(l)return null;l=_}return l},o.Connection.getConnectionForOrphanedOutput_=function(e,r){for(var l;l=o.Connection.getSingleConnection_(e,r);)if(!(e=l.targetBlock())||e.isShadow())return l;return null},o.Connection.getConnectionForOrphanedConnection=function(e,r){if(r.type===o.connectionTypes.OUTPUT_VALUE)return o.Connection.getConnectionForOrphanedOutput_(e,r.getSourceBlock());e=e.lastConnectionInStack(!0);var l=r.getConnectionChecker();return e&&l.canConnect(r,e,!1)?e:null},o.Connection.prototype.disconnect=function(){var e=this.targetConnection;if(!e)throw Error("Source connection not connected.");if(e.targetConnection!=this)throw Error("Target connection not connected to source connection.");if(this.isSuperior()){var r=this.sourceBlock_,l=e.getSourceBlock();e=this}else r=e.getSourceBlock(),l=this.sourceBlock_;var c=o.Events.getGroup();c||o.Events.setGroup(!0),this.disconnectInternal_(r,l),l.isShadow()||e.respawnShadow_(),c||o.Events.setGroup(!1)},o.Connection.prototype.disconnectInternal_=function(e,r){var l;o.Events.isEnabled()&&(l=new(o.Events.get(o.Events.BLOCK_MOVE))(r)),this.targetConnection=this.targetConnection.targetConnection=null,r.setParent(null),l&&(l.recordNew(),o.Events.fire(l))},o.Connection.prototype.respawnShadow_=function(){var e=this.getSourceBlock(),r=this.getShadowDom();if(e.workspace&&r)if((e=o.Xml.domToBlock(r,e.workspace)).outputConnection)this.connect(e.outputConnection);else{if(!e.previousConnection)throw Error("Child block does not have output or previous statement.");this.connect(e.previousConnection)}},o.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},o.Connection.prototype.checkType=function(e){return o.utils.deprecation.warn("Connection.prototype.checkType","October 2019","January 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,e,!1)},o.Connection.prototype.checkType_=function(e){return o.utils.deprecation.warn("Connection.prototype.checkType_","October 2019","January 2021","the workspace's connection checker"),this.checkType(e)},o.Connection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},o.Connection.prototype.setCheck=function(e){return e?(Array.isArray(e)||(e=[e]),this.check_=e,this.onCheckChanged_()):this.check_=null,this},o.Connection.prototype.getCheck=function(){return this.check_},o.Connection.prototype.setShadowDom=function(e){this.shadowDom_=e,(e=this.targetBlock())?e.isShadow()&&(e.dispose(!1),this.respawnShadow_()):this.respawnShadow_()},o.Connection.prototype.getShadowDom=function(e){return e&&this.targetBlock().isShadow()?o.Xml.blockToDom(this.targetBlock()):this.shadowDom_},o.Connection.prototype.neighbours=function(e){return[]},o.Connection.prototype.getParentInput=function(){for(var e=null,r=this.sourceBlock_.inputList,l=0;l<r.length;l++)if(r[l].connection===this){e=r[l];break}return e},o.Connection.prototype.toString=function(){var e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection==this)var r="Output Connection of ";else if(e.previousConnection==this)r="Previous Connection of ";else if(e.nextConnection==this)r="Next Connection of ";else{r=null;for(var c,l=0;c=e.inputList[l];l++)if(c.connection==this){r=c;break}if(!r)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";r='Input "'+r.name+'" connection on '}return r+e.toDevString()},o.IConnectionChecker=function(){},o.ConnectionChecker=function(){},o.ConnectionChecker.prototype.canConnect=function(e,r,l,c){return this.canConnectWithReason(e,r,l,c)==o.Connection.CAN_CONNECT},o.ConnectionChecker.prototype.canConnectWithReason=function(e,r,l,c){var p=this.doSafetyChecks(e,r);return p!=o.Connection.CAN_CONNECT?p:this.doTypeChecks(e,r)?l&&!this.doDragChecks(e,r,c||0)?o.Connection.REASON_DRAG_CHECKS_FAILED:o.Connection.CAN_CONNECT:o.Connection.REASON_CHECKS_FAILED},o.ConnectionChecker.prototype.getErrorMessage=function(e,r,l){switch(e){case o.Connection.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case o.Connection.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case o.Connection.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case o.Connection.REASON_TARGET_NULL:return"Target connection is null.";case o.Connection.REASON_CHECKS_FAILED:return"Connection checks failed. "+r+" expected "+r.getCheck()+", found "+l.getCheck();case o.Connection.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case o.Connection.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";default:return"Unknown connection failure: this should never happen!"}},o.ConnectionChecker.prototype.doSafetyChecks=function(e,r){if(!e||!r)return o.Connection.REASON_TARGET_NULL;if(e.isSuperior())var l=e.getSourceBlock(),c=r.getSourceBlock();else c=e.getSourceBlock(),l=r.getSourceBlock();return l==c?o.Connection.REASON_SELF_CONNECTION:r.type!=o.OPPOSITE_TYPE[e.type]?o.Connection.REASON_WRONG_TYPE:l.workspace!==c.workspace?o.Connection.REASON_DIFFERENT_WORKSPACES:l.isShadow()&&!c.isShadow()?o.Connection.REASON_SHADOW_PARENT:o.Connection.CAN_CONNECT},o.ConnectionChecker.prototype.doTypeChecks=function(e,r){if(e=e.getCheck(),r=r.getCheck(),!e||!r)return!0;for(var l=0;l<e.length;l++)if(-1!=r.indexOf(e[l]))return!0;return!1},o.ConnectionChecker.prototype.doDragChecks=function(e,r,l){if(e.distanceFrom(r)>l||r.getSourceBlock().isInsertionMarker())return!1;switch(r.type){case o.connectionTypes.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,r);case o.connectionTypes.OUTPUT_VALUE:if(r.isConnected()&&!r.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case o.connectionTypes.INPUT_VALUE:if(r.isConnected()&&!r.targetBlock().isMovable()&&!r.targetBlock().isShadow())return!1;break;case o.connectionTypes.NEXT_STATEMENT:if(r.isConnected()&&!e.getSourceBlock().nextConnection&&!r.targetBlock().isShadow()&&r.targetBlock().nextConnection)return!1;break;default:return!1}return-1==o.draggingConnections.indexOf(r)},o.ConnectionChecker.prototype.canConnectToPrevious_=function(e,r){return!(e.targetConnection||-1!=o.draggingConnections.indexOf(r)||r.targetConnection&&(!(e=r.targetBlock()).isInsertionMarker()||e.getPreviousBlock()))},o.registry.register(o.registry.Type.CONNECTION_CHECKER,o.registry.DEFAULT,o.ConnectionChecker),o.VariableMap=function(e){this.variableMap_=Object.create(null),this.workspace=e},o.VariableMap.prototype.clear=function(){this.variableMap_=Object.create(null)},o.VariableMap.prototype.renameVariable=function(e,r){var l=this.getVariable(r,e.type),c=this.workspace.getAllBlocks(!1);o.Events.setGroup(!0);try{l&&l.getId()!=e.getId()?this.renameVariableWithConflict_(e,r,l,c):this.renameVariableAndUses_(e,r,c)}finally{o.Events.setGroup(!1)}},o.VariableMap.prototype.renameVariableById=function(e,r){var l=this.getVariableById(e);if(!l)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(l,r)},o.VariableMap.prototype.renameVariableAndUses_=function(e,r,l){for(o.Events.fire(new(o.Events.get(o.Events.VAR_RENAME))(e,r)),e.name=r,r=0;r<l.length;r++)l[r].updateVarName(e)},o.VariableMap.prototype.renameVariableWithConflict_=function(e,r,l,c){var p=e.type;for(r!=l.name&&this.renameVariableAndUses_(l,r,c),r=0;r<c.length;r++)c[r].renameVarById(e.getId(),l.getId());o.Events.fire(new(o.Events.get(o.Events.VAR_DELETE))(e)),e=this.getVariablesOfType(p).indexOf(e),this.variableMap_[p].splice(e,1)},o.VariableMap.prototype.createVariable=function(e,r,l){var c=this.getVariable(e,r);if(c){if(l&&c.getId()!=l)throw Error('Variable "'+e+'" is already in use and its id is "'+c.getId()+'" which conflicts with the passed in id, "'+l+'".');return c}if(l&&this.getVariableById(l))throw Error('Variable id, "'+l+'", is already in use.');return c=l||o.utils.genUid(),c=new o.VariableModel(this.workspace,e,r=r||"",c),(e=this.variableMap_[r]||[]).push(c),delete this.variableMap_[r],this.variableMap_[r]=e,c},o.VariableMap.prototype.deleteVariable=function(e){for(var c,r=this.variableMap_[e.type],l=0;c=r[l];l++)if(c.getId()==e.getId()){r.splice(l,1),o.Events.fire(new(o.Events.get(o.Events.VAR_DELETE))(e));break}},o.VariableMap.prototype.deleteVariableById=function(e){var r=this.getVariableById(e);if(r){var p,l=r.name,c=this.getVariableUsesById(e);for(e=0;p=c[e];e++)if("procedures_defnoreturn"==p.type||"procedures_defreturn"==p.type)return e=p.getFieldValue("NAME"),l=o.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",l).replace("%2",e),void o.alert(l);var _=this;1<c.length?(l=o.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(c.length)).replace("%2",l),o.confirm(l,function(v){v&&r&&_.deleteVariableInternal(r,c)})):_.deleteVariableInternal(r,c)}else console.warn("Can't delete non-existent variable: "+e)},o.VariableMap.prototype.deleteVariableInternal=function(e,r){var l=o.Events.getGroup();l||o.Events.setGroup(!0);try{for(var c=0;c<r.length;c++)r[c].dispose(!0);this.deleteVariable(e)}finally{l||o.Events.setGroup(!1)}},o.VariableMap.prototype.getVariable=function(e,r){if(r=this.variableMap_[r||""])for(var c,l=0;c=r[l];l++)if(o.Names.equals(c.name,e))return c;return null},o.VariableMap.prototype.getVariableById=function(e){for(var r=Object.keys(this.variableMap_),l=0;l<r.length;l++)for(var _,c=r[l],p=0;_=this.variableMap_[c][p];p++)if(_.getId()==e)return _;return null},o.VariableMap.prototype.getVariablesOfType=function(e){return(e=this.variableMap_[e||""])?e.slice():[]},o.VariableMap.prototype.getVariableTypes=function(e){var r={};o.utils.object.mixin(r,this.variableMap_),e&&e.getPotentialVariableMap()&&o.utils.object.mixin(r,e.getPotentialVariableMap().variableMap_),e=Object.keys(r),r=!1;for(var l=0;l<e.length;l++)""==e[l]&&(r=!0);return r||e.push(""),e},o.VariableMap.prototype.getAllVariables=function(){var r,e=[];for(r in this.variableMap_)e=e.concat(this.variableMap_[r]);return e},o.VariableMap.prototype.getAllVariableNames=function(){var r,e=[];for(r in this.variableMap_)for(var p,l=this.variableMap_[r],c=0;p=l[c];c++)e.push(p.name);return e},o.VariableMap.prototype.getVariableUsesById=function(e){for(var r=[],l=this.workspace.getAllBlocks(!1),c=0;c<l.length;c++){var p=l[c].getVarModels();if(p)for(var _=0;_<p.length;_++)p[_].getId()==e&&r.push(l[c])}return r},o.Workspace=function(e){this.id=o.utils.genUid(),o.Workspace.WorkspaceDB_[this.id]=this,this.options=e||new o.Options({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(o.registry.getClassFromOptions(o.registry.Type.CONNECTION_CHECKER,this.options,!0))(this),this.topBlocks_=[],this.topComments_=[],this.commentDB_=Object.create(null),this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.typedBlocksDB_=Object.create(null),this.variableMap_=new o.VariableMap(this),this.potentialVariableMap_=null},o.Workspace.prototype.rendered=!1,o.Workspace.prototype.isClearing=!1,o.Workspace.prototype.MAX_UNDO=1024,o.Workspace.prototype.connectionDBList=null,o.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete o.Workspace.WorkspaceDB_[this.id]},o.Workspace.SCAN_ANGLE=3,o.Workspace.prototype.sortObjects_=function(e,r){return e=e.getRelativeToSurfaceXY(),r=r.getRelativeToSurfaceXY(),e.y+o.Workspace.prototype.sortObjects_.offset*e.x-(r.y+o.Workspace.prototype.sortObjects_.offset*r.x)},o.Workspace.prototype.addTopBlock=function(e){this.topBlocks_.push(e)},o.Workspace.prototype.removeTopBlock=function(e){if(!o.utils.arrayRemove(this.topBlocks_,e))throw Error("Block not present in workspace's list of top-most blocks.")},o.Workspace.prototype.getTopBlocks=function(e){var r=[].concat(this.topBlocks_);return e&&1<r.length&&(this.sortObjects_.offset=Math.sin(o.utils.math.toRadians(o.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),r.sort(this.sortObjects_)),r},o.Workspace.prototype.addTypedBlock=function(e){this.typedBlocksDB_[e.type]||(this.typedBlocksDB_[e.type]=[]),this.typedBlocksDB_[e.type].push(e)},o.Workspace.prototype.removeTypedBlock=function(e){this.typedBlocksDB_[e.type].splice(this.typedBlocksDB_[e.type].indexOf(e),1),this.typedBlocksDB_[e.type].length||delete this.typedBlocksDB_[e.type]},o.Workspace.prototype.getBlocksByType=function(e,r){return this.typedBlocksDB_[e]?(e=this.typedBlocksDB_[e].slice(0),r&&1<e.length&&(this.sortObjects_.offset=Math.sin(o.utils.math.toRadians(o.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e):[]},o.Workspace.prototype.addTopComment=function(e){this.topComments_.push(e),this.commentDB_[e.id]&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB_[e.id]=e},o.Workspace.prototype.removeTopComment=function(e){if(!o.utils.arrayRemove(this.topComments_,e))throw Error("Comment not present in workspace's list of top-most comments.");delete this.commentDB_[e.id]},o.Workspace.prototype.getTopComments=function(e){var r=[].concat(this.topComments_);return e&&1<r.length&&(this.sortObjects_.offset=Math.sin(o.utils.math.toRadians(o.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),r.sort(this.sortObjects_)),r},o.Workspace.prototype.getAllBlocks=function(e){if(e){e=this.getTopBlocks(!0);for(var r=[],l=0;l<e.length;l++)r.push.apply(r,e[l].getDescendants(!0))}else for(r=this.getTopBlocks(!1),l=0;l<r.length;l++)r.push.apply(r,r[l].getChildren(!1));return r.filter(function(c){return!c.isInsertionMarker()})},o.Workspace.prototype.clear=function(){this.isClearing=!0;try{var e=o.Events.getGroup();for(e||o.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose(!1);for(;this.topComments_.length;)this.topComments_[this.topComments_.length-1].dispose(!1);e||o.Events.setGroup(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()}finally{this.isClearing=!1}},o.Workspace.prototype.renameVariableById=function(e,r){this.variableMap_.renameVariableById(e,r)},o.Workspace.prototype.createVariable=function(e,r,l){return this.variableMap_.createVariable(e,r,l)},o.Workspace.prototype.getVariableUsesById=function(e){return this.variableMap_.getVariableUsesById(e)},o.Workspace.prototype.deleteVariableById=function(e){this.variableMap_.deleteVariableById(e)},o.Workspace.prototype.getVariable=function(e,r){return this.variableMap_.getVariable(e,r)},o.Workspace.prototype.getVariableById=function(e){return this.variableMap_.getVariableById(e)},o.Workspace.prototype.getVariablesOfType=function(e){return this.variableMap_.getVariablesOfType(e)},o.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes(this)},o.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},o.Workspace.prototype.getAllVariableNames=function(){return this.variableMap_.getAllVariableNames()},o.Workspace.prototype.getWidth=function(){return 0},o.Workspace.prototype.newBlock=function(e,r){return new o.Block(this,e,r)},o.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length},o.Workspace.prototype.remainingCapacityOfType=function(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0},o.Workspace.prototype.isCapacityAvailable=function(e){if(!this.hasBlockLimits())return!0;var l,r=0;for(l in e){if(e[l]>this.remainingCapacityOfType(l))return!1;r+=e[l]}return!(r>this.remainingCapacity())},o.Workspace.prototype.hasBlockLimits=function(){return this.options.maxBlocks!=1/0||!!this.options.maxInstances},o.Workspace.prototype.getUndoStack=function(){return this.undoStack_},o.Workspace.prototype.getRedoStack=function(){return this.redoStack_},o.Workspace.prototype.undo=function(e){var r=e?this.redoStack_:this.undoStack_,l=e?this.undoStack_:this.redoStack_,c=r.pop();if(c){for(var p=[c];r.length&&c.group&&c.group==r[r.length-1].group;)p.push(r.pop());for(r=0;c=p[r];r++)l.push(c);p=o.Events.filter(p,e),o.Events.recordUndo=!1;try{for(r=0;c=p[r];r++)c.run(e)}finally{o.Events.recordUndo=!0}}},o.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,o.Events.clearPendingUndo()},o.Workspace.prototype.addChangeListener=function(e){return this.listeners_.push(e),e},o.Workspace.prototype.removeChangeListener=function(e){o.utils.arrayRemove(this.listeners_,e)},o.Workspace.prototype.fireChangeListener=function(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(var l,r=0;l=this.listeners_[r];r++)l(e)},o.Workspace.prototype.getBlockById=function(e){return this.blockDB_[e]||null},o.Workspace.prototype.setBlockById=function(e,r){this.blockDB_[e]=r},o.Workspace.prototype.removeBlockById=function(e){delete this.blockDB_[e]},o.Workspace.prototype.getCommentById=function(e){return this.commentDB_[e]||null},o.Workspace.prototype.allInputsFilled=function(e){for(var c,r=this.getTopBlocks(!1),l=0;c=r[l];l++)if(!c.allInputsFilled(e))return!1;return!0},o.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},o.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new o.VariableMap(this)},o.Workspace.prototype.getVariableMap=function(){return this.variableMap_},o.Workspace.prototype.setVariableMap=function(e){this.variableMap_=e},o.Workspace.WorkspaceDB_=Object.create(null),o.Workspace.getById=function(e){return o.Workspace.WorkspaceDB_[e]||null},o.Workspace.getAll=function(){var r,e=[];for(r in o.Workspace.WorkspaceDB_)e.push(o.Workspace.WorkspaceDB_[r]);return e},o.WorkspaceDragSurfaceSvg=function(e){this.container_=e,this.createDom()},o.WorkspaceDragSurfaceSvg.prototype.SVG_=null,o.WorkspaceDragSurfaceSvg.prototype.container_=null,o.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=o.utils.dom.createSvgElement(o.utils.Svg.SVG,{xmlns:o.utils.dom.SVG_NS,"xmlns:html":o.utils.dom.HTML_NS,"xmlns:xlink":o.utils.dom.XLINK_NS,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},o.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(e,r){e=e.toFixed(0),r=r.toFixed(0),this.SVG_.style.display="block",o.utils.dom.setCssTransform(this.SVG_,"translate3d("+e+"px, "+r+"px, 0px)")},o.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return o.utils.getRelativeXY(this.SVG_)},o.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(e){if(!e)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var r=this.SVG_.childNodes[0],l=this.SVG_.childNodes[1];if(!(r&&l&&o.utils.dom.hasClass(r,"blocklyBlockCanvas")&&o.utils.dom.hasClass(l,"blocklyBubbleCanvas")))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(null!=this.previousSibling_?o.utils.dom.insertAfter(r,this.previousSibling_):e.insertBefore(r,e.firstChild),o.utils.dom.insertAfter(l,r),this.SVG_.style.display="none",this.SVG_.childNodes.length)throw Error("Drag surface was not cleared.");o.utils.dom.setCssTransform(this.SVG_,""),this.previousSibling_=null},o.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(e,r,l,c,p,_){if(this.SVG_.childNodes.length)throw Error("Already dragging a block.");this.previousSibling_=l,e.setAttribute("transform","translate(0, 0) scale("+_+")"),r.setAttribute("transform","translate(0, 0) scale("+_+")"),this.SVG_.setAttribute("width",c),this.SVG_.setAttribute("height",p),this.SVG_.appendChild(e),this.SVG_.appendChild(r),this.SVG_.style.display="block"},o.blockRendering={},o.blockRendering.useDebugger=!1,o.blockRendering.register=function(e,r){o.registry.register(o.registry.Type.RENDERER,e,r)},o.blockRendering.unregister=function(e){o.registry.unregister(o.registry.Type.RENDERER,e)},o.blockRendering.startDebugger=function(){o.blockRendering.useDebugger=!0},o.blockRendering.stopDebugger=function(){o.blockRendering.useDebugger=!1},o.blockRendering.init=function(e,r,l){return(e=new(o.registry.getClass(o.registry.Type.RENDERER,e))(e)).init(r,l),e},o.ASTNode=function(e,r,l){if(!r)throw Error("Cannot create a node without a location.");this.type_=e,this.isConnection_=o.ASTNode.isConnectionType_(e),this.location_=r,this.wsCoordinate_=null,this.processParams_(l||null)},o.ASTNode.types={FIELD:"field",BLOCK:"block",INPUT:"input",OUTPUT:"output",NEXT:"next",PREVIOUS:"previous",STACK:"stack",WORKSPACE:"workspace"},o.ASTNode.NAVIGATE_ALL_FIELDS=!1,o.ASTNode.DEFAULT_OFFSET_Y=-20,o.ASTNode.isConnectionType_=function(e){switch(e){case o.ASTNode.types.PREVIOUS:case o.ASTNode.types.NEXT:case o.ASTNode.types.INPUT:case o.ASTNode.types.OUTPUT:return!0}return!1},o.ASTNode.createFieldNode=function(e){return e?new o.ASTNode(o.ASTNode.types.FIELD,e):null},o.ASTNode.createConnectionNode=function(e){if(!e)return null;var r=e.type;return r==o.connectionTypes.INPUT_VALUE||r==o.connectionTypes.NEXT_STATEMENT&&e.getParentInput()?o.ASTNode.createInputNode(e.getParentInput()):r==o.connectionTypes.NEXT_STATEMENT?new o.ASTNode(o.ASTNode.types.NEXT,e):r==o.connectionTypes.OUTPUT_VALUE?new o.ASTNode(o.ASTNode.types.OUTPUT,e):r==o.connectionTypes.PREVIOUS_STATEMENT?new o.ASTNode(o.ASTNode.types.PREVIOUS,e):null},o.ASTNode.createInputNode=function(e){return e&&e.connection?new o.ASTNode(o.ASTNode.types.INPUT,e.connection):null},o.ASTNode.createBlockNode=function(e){return e?new o.ASTNode(o.ASTNode.types.BLOCK,e):null},o.ASTNode.createStackNode=function(e){return e?new o.ASTNode(o.ASTNode.types.STACK,e):null},o.ASTNode.createWorkspaceNode=function(e,r){return r&&e?new o.ASTNode(o.ASTNode.types.WORKSPACE,e,{wsCoordinate:r}):null},o.ASTNode.createTopNode=function(e){var r=e.previousConnection||e.outputConnection;return r?o.ASTNode.createConnectionNode(r):o.ASTNode.createBlockNode(e)},o.ASTNode.prototype.processParams_=function(e){e&&e.wsCoordinate&&(this.wsCoordinate_=e.wsCoordinate)},o.ASTNode.prototype.getLocation=function(){return this.location_},o.ASTNode.prototype.getType=function(){return this.type_},o.ASTNode.prototype.getWsCoordinate=function(){return this.wsCoordinate_},o.ASTNode.prototype.isConnection=function(){return this.isConnection_},o.ASTNode.prototype.findNextForInput_=function(){var l,e=this.location_.getParentInput(),r=e.getSourceBlock();for(e=r.inputList.indexOf(e)+1;l=r.inputList[e];e++){for(var _,c=l.fieldRow,p=0;_=c[p];p++)if(_.isClickable()||o.ASTNode.NAVIGATE_ALL_FIELDS)return o.ASTNode.createFieldNode(_);if(l.connection)return o.ASTNode.createInputNode(l)}return null},o.ASTNode.prototype.findNextForField_=function(){var e=this.location_,r=e.getParentInput(),l=e.getSourceBlock(),c=l.inputList.indexOf(r);for(e=r.fieldRow.indexOf(e)+1;r=l.inputList[c];c++){for(var p=r.fieldRow;e<p.length;){if(p[e].isClickable()||o.ASTNode.NAVIGATE_ALL_FIELDS)return o.ASTNode.createFieldNode(p[e]);e++}if(e=0,r.connection)return o.ASTNode.createInputNode(r)}return null},o.ASTNode.prototype.findPrevForInput_=function(){for(var c,e=this.location_.getParentInput(),r=e.getSourceBlock(),l=r.inputList.indexOf(e);c=r.inputList[l];l--){if(c.connection&&c!==e)return o.ASTNode.createInputNode(c);for(var _,p=(c=c.fieldRow).length-1;_=c[p];p--)if(_.isClickable()||o.ASTNode.NAVIGATE_ALL_FIELDS)return o.ASTNode.createFieldNode(_)}return null},o.ASTNode.prototype.findPrevForField_=function(){var p,e=this.location_,r=e.getParentInput(),l=e.getSourceBlock(),c=l.inputList.indexOf(r);for(e=r.fieldRow.indexOf(e)-1;p=l.inputList[c];c--){if(p.connection&&p!==r)return o.ASTNode.createInputNode(p);for(p=p.fieldRow;-1<e;){if(p[e].isClickable()||o.ASTNode.NAVIGATE_ALL_FIELDS)return o.ASTNode.createFieldNode(p[e]);e--}0<=c-1&&(e=l.inputList[c-1].fieldRow.length-1)}return null},o.ASTNode.prototype.navigateBetweenStacks_=function(e){var r=this.getLocation();if(r instanceof o.Block||(r=r.getSourceBlock()),!r||!r.workspace)return null;var l=r.getRootBlock();r=l.workspace.getTopBlocks(!0);for(var p,c=0;p=r[c];c++)if(l.id==p.id)return-1==(e=c+(e?1:-1))||e==r.length?null:o.ASTNode.createStackNode(r[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")},o.ASTNode.prototype.findTopASTNodeForBlock_=function(e){var r=e.previousConnection||e.outputConnection;return r?o.ASTNode.createConnectionNode(r):o.ASTNode.createBlockNode(e)},o.ASTNode.prototype.getOutAstNodeForBlock_=function(e){if(!e)return null;var r=(e=e.getTopStackBlock()).previousConnection||e.outputConnection;return r&&r.targetConnection&&r.targetConnection.getParentInput()?o.ASTNode.createInputNode(r.targetConnection.getParentInput()):o.ASTNode.createStackNode(e)},o.ASTNode.prototype.findFirstFieldOrInput_=function(e){e=e.inputList;for(var l,r=0;l=e[r];r++){for(var _,c=l.fieldRow,p=0;_=c[p];p++)if(_.isClickable()||o.ASTNode.NAVIGATE_ALL_FIELDS)return o.ASTNode.createFieldNode(_);if(l.connection)return o.ASTNode.createInputNode(l)}return null},o.ASTNode.prototype.getSourceBlock=function(){return this.getType()===o.ASTNode.types.BLOCK||this.getType()===o.ASTNode.types.STACK?this.getLocation():this.getType()===o.ASTNode.types.WORKSPACE?null:this.getLocation().getSourceBlock()},o.ASTNode.prototype.next=function(){switch(this.type_){case o.ASTNode.types.STACK:return this.navigateBetweenStacks_(!0);case o.ASTNode.types.OUTPUT:var e=this.location_;return o.ASTNode.createBlockNode(e.getSourceBlock());case o.ASTNode.types.FIELD:return this.findNextForField_();case o.ASTNode.types.INPUT:return this.findNextForInput_();case o.ASTNode.types.BLOCK:return o.ASTNode.createConnectionNode(this.location_.nextConnection);case o.ASTNode.types.PREVIOUS:return o.ASTNode.createBlockNode((e=this.location_).getSourceBlock());case o.ASTNode.types.NEXT:return o.ASTNode.createConnectionNode((e=this.location_).targetConnection)}return null},o.ASTNode.prototype.in=function(){switch(this.type_){case o.ASTNode.types.WORKSPACE:var e=this.location_.getTopBlocks(!0);if(0<e.length)return o.ASTNode.createStackNode(e[0]);break;case o.ASTNode.types.STACK:return this.findTopASTNodeForBlock_(e=this.location_);case o.ASTNode.types.BLOCK:return this.findFirstFieldOrInput_(e=this.location_);case o.ASTNode.types.INPUT:return o.ASTNode.createConnectionNode(this.location_.targetConnection)}return null},o.ASTNode.prototype.prev=function(){switch(this.type_){case o.ASTNode.types.STACK:return this.navigateBetweenStacks_(!1);case o.ASTNode.types.FIELD:return this.findPrevForField_();case o.ASTNode.types.INPUT:return this.findPrevForInput_();case o.ASTNode.types.BLOCK:var e=this.location_;return o.ASTNode.createConnectionNode(e.previousConnection||e.outputConnection);case o.ASTNode.types.PREVIOUS:if((e=(e=this.location_).targetConnection)&&!e.getParentInput())return o.ASTNode.createConnectionNode(e);break;case o.ASTNode.types.NEXT:return o.ASTNode.createBlockNode((e=this.location_).getSourceBlock())}return null},o.ASTNode.prototype.out=function(){switch(this.type_){case o.ASTNode.types.STACK:var e=this.location_,r=e.getRelativeToSurfaceXY();return r=new o.utils.Coordinate(r.x,r.y+o.ASTNode.DEFAULT_OFFSET_Y),o.ASTNode.createWorkspaceNode(e.workspace,r);case o.ASTNode.types.OUTPUT:return(r=(e=this.location_).targetConnection)?o.ASTNode.createConnectionNode(r):o.ASTNode.createStackNode(e.getSourceBlock());case o.ASTNode.types.FIELD:return o.ASTNode.createBlockNode(this.location_.getSourceBlock());case o.ASTNode.types.INPUT:return o.ASTNode.createBlockNode((e=this.location_).getSourceBlock());case o.ASTNode.types.BLOCK:return this.getOutAstNodeForBlock_(e=this.location_);case o.ASTNode.types.PREVIOUS:case o.ASTNode.types.NEXT:return this.getOutAstNodeForBlock_((e=this.location_).getSourceBlock())}return null},o.Blocks=Object.create(null),o.Extensions={},o.Extensions.ALL_=Object.create(null),o.Extensions.register=function(e,r){if("string"!=typeof e||""==e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(o.Extensions.ALL_[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof r)throw Error('Error: Extension "'+e+'" must be a function');o.Extensions.ALL_[e]=r},o.Extensions.registerMixin=function(e,r){if(!r||"object"!=typeof r)throw Error('Error: Mixin "'+e+'" must be a object');o.Extensions.register(e,function(){this.mixin(r)})},o.Extensions.registerMutator=function(e,r,l,c){var p='Error when registering mutator "'+e+'": ';o.Extensions.checkHasFunction_(p,r.domToMutation,"domToMutation"),o.Extensions.checkHasFunction_(p,r.mutationToDom,"mutationToDom");var _=o.Extensions.checkMutatorDialog_(r,p);if(l&&"function"!=typeof l)throw Error('Extension "'+e+'" is not a function');o.Extensions.register(e,function(){if(_){if(!o.Mutator)throw Error(p+"Missing require for Blockly.Mutator");this.setMutator(new o.Mutator(c||[]))}this.mixin(r),l&&l.apply(this)})},o.Extensions.unregister=function(e){o.Extensions.ALL_[e]?delete o.Extensions.ALL_[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},o.Extensions.apply=function(e,r,l){var c=o.Extensions.ALL_[e];if("function"!=typeof c)throw Error('Error: Extension "'+e+'" not found.');if(l)o.Extensions.checkNoMutatorProperties_(e,r);else var p=o.Extensions.getMutatorProperties_(r);if(c.apply(r),l)o.Extensions.checkBlockHasMutatorProperties_('Error after applying mutator "'+e+'": ',r);else if(!o.Extensions.mutatorPropertiesMatch_(p,r))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},o.Extensions.checkHasFunction_=function(e,r,l){if(!r)throw Error(e+'missing required property "'+l+'"');if("function"!=typeof r)throw Error(e+'" required property "'+l+'" must be a function')},o.Extensions.checkNoMutatorProperties_=function(e,r){if(o.Extensions.getMutatorProperties_(r).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+r.id)},o.Extensions.checkMutatorDialog_=function(e,r){var l=void 0!==e.compose,c=void 0!==e.decompose;if(l&&c){if("function"!=typeof e.compose)throw Error(r+"compose must be a function.");if("function"!=typeof e.decompose)throw Error(r+"decompose must be a function.");return!0}if(!l&&!c)return!1;throw Error(r+'Must have both or neither of "compose" and "decompose"')},o.Extensions.checkBlockHasMutatorProperties_=function(e,r){if("function"!=typeof r.domToMutation)throw Error(e+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof r.mutationToDom)throw Error(e+'Applying a mutator didn\'t add "mutationToDom"');o.Extensions.checkMutatorDialog_(r,e)},o.Extensions.getMutatorProperties_=function(e){var r=[];return void 0!==e.domToMutation&&r.push(e.domToMutation),void 0!==e.mutationToDom&&r.push(e.mutationToDom),void 0!==e.compose&&r.push(e.compose),void 0!==e.decompose&&r.push(e.decompose),r},o.Extensions.mutatorPropertiesMatch_=function(e,r){if((r=o.Extensions.getMutatorProperties_(r)).length!=e.length)return!1;for(var l=0;l<r.length;l++)if(e[l]!=r[l])return!1;return!0},o.Extensions.buildTooltipForDropdown=function(e,r){var l=[];return"object"==typeof document&&o.utils.runAfterPageLoad(function(){for(var c in r)o.utils.checkMessageReferences(r[c])}),function(){this.type&&-1==l.indexOf(this.type)&&(o.Extensions.checkDropdownOptionsInTable_(this,e,r),l.push(this.type)),this.setTooltip(function(){var c=String(this.getFieldValue(e)),p=r[c];return null==p?-1==l.indexOf(this.type)&&(c="No tooltip mapping for value "+c+" of field "+e,null!=this.type&&(c+=" of block type "+this.type),console.warn(c+".")):p=o.utils.replaceMessageReferences(p),p}.bind(this))}},o.Extensions.checkDropdownOptionsInTable_=function(e,r,l){var c=e.getField(r);if(!c.isOptionListDynamic()){c=c.getOptions();for(var p=0;p<c.length;++p){var _=c[p][1];null==l[_]&&console.warn("No tooltip mapping for value "+_+" of field "+r+" of block type "+e.type)}}},o.Extensions.buildTooltipWithFieldText=function(e,r){return"object"==typeof document&&o.utils.runAfterPageLoad(function(){o.utils.checkMessageReferences(e)}),function(){this.setTooltip(function(){var l=this.getField(r);return o.utils.replaceMessageReferences(e).replace("%1",l?l.getText():"")}.bind(this))}},o.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip(function(){var e=this.getParent();return e&&e.getInputsInline()&&e.tooltip||this.tooltipWhenNotConnected_}.bind(this))},o.Extensions.register("parent_tooltip_when_inline",o.Extensions.extensionParentTooltip_),o.fieldRegistry={},o.fieldRegistry.register=function(e,r){o.registry.register(o.registry.Type.FIELD,e,r)},o.fieldRegistry.unregister=function(e){o.registry.unregister(o.registry.Type.FIELD,e)},o.fieldRegistry.fromJson=function(e){var r=o.registry.getObject(o.registry.Type.FIELD,e.type);return r?r.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},o.IDeletable=function(){},o.blockAnimations={},o.blockAnimations.disconnectPid_=0,o.blockAnimations.disconnectGroup_=null,o.blockAnimations.disposeUiEffect=function(e){var r=e.workspace,l=e.getSvgRoot();r.getAudioManager().play("delete"),e=r.getSvgXY(l),(l=l.cloneNode(!0)).translateX_=e.x,l.translateY_=e.y,l.setAttribute("transform","translate("+e.x+","+e.y+")"),r.getParentSvg().appendChild(l),l.bBox_=l.getBBox(),o.blockAnimations.disposeUiStep_(l,r.RTL,new Date,r.scale)},o.blockAnimations.disposeUiStep_=function(e,r,l,c){var p=(new Date-l)/150;1<p?o.utils.dom.removeNode(e):(e.setAttribute("transform","translate("+(e.translateX_+(r?-1:1)*e.bBox_.width*c/2*p)+","+(e.translateY_+e.bBox_.height*c*p)+") scale("+(1-p)*c+")"),setTimeout(o.blockAnimations.disposeUiStep_,10,e,r,l,c))},o.blockAnimations.connectionUiEffect=function(e){var r=e.workspace,l=r.scale;if(r.getAudioManager().play("click"),!(1>l)){var c=r.getSvgXY(e.getSvgRoot());e.outputConnection?(c.x+=(e.RTL?3:-3)*l,c.y+=13*l):e.previousConnection&&(c.x+=(e.RTL?-23:23)*l,c.y+=3*l),e=o.utils.dom.createSvgElement(o.utils.Svg.CIRCLE,{cx:c.x,cy:c.y,r:0,fill:"none",stroke:"#888","stroke-width":10},r.getParentSvg()),o.blockAnimations.connectionUiStep_(e,new Date,l)}},o.blockAnimations.connectionUiStep_=function(e,r,l){var c=(new Date-r)/150;1<c?o.utils.dom.removeNode(e):(e.setAttribute("r",25*c*l),e.style.opacity=1-c,o.blockAnimations.disconnectPid_=setTimeout(o.blockAnimations.connectionUiStep_,10,e,r,l))},o.blockAnimations.disconnectUiEffect=function(e){if(e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var r=e.getHeightWidth().height;r=Math.atan(10/r)/Math.PI*180,e.RTL||(r*=-1),o.blockAnimations.disconnectUiStep_(e.getSvgRoot(),r,new Date)}},o.blockAnimations.disconnectUiStep_=function(e,r,l){var c=(new Date-l)/200;1<c?e.skew_="":(e.skew_="skewX("+Math.round(Math.sin(c*Math.PI*3)*(1-c)*r)+")",o.blockAnimations.disconnectGroup_=e,o.blockAnimations.disconnectPid_=setTimeout(o.blockAnimations.disconnectUiStep_,10,e,r,l)),e.setAttribute("transform",e.translate_+e.skew_)},o.blockAnimations.disconnectUiStop=function(){if(o.blockAnimations.disconnectGroup_){clearTimeout(o.blockAnimations.disconnectPid_);var e=o.blockAnimations.disconnectGroup_;e.skew_="",e.setAttribute("transform",e.translate_),o.blockAnimations.disconnectGroup_=null}},o.Events.BlockDrag=function(e,r,l){o.Events.BlockDrag.superClass_.constructor.call(this,e?e.workspace.id:void 0),this.blockId=e?e.id:null,this.isStart=r,this.blocks=l},o.utils.object.inherits(o.Events.BlockDrag,o.Events.UiBase),o.Events.BlockDrag.prototype.type=o.Events.BLOCK_DRAG,o.Events.BlockDrag.prototype.toJson=function(){var e=o.Events.BlockDrag.superClass_.toJson.call(this);return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e},o.Events.BlockDrag.prototype.fromJson=function(e){o.Events.BlockDrag.superClass_.fromJson.call(this,e),this.isStart=e.isStart,this.blockId=e.blockId,this.blocks=e.blocks},o.registry.register(o.registry.Type.EVENT,o.Events.BLOCK_DRAG,o.Events.BlockDrag),o.IBlockDragger=function(){},o.InsertionMarkerManager=function(e){this.topBlock_=o.selected=e,this.workspace_=e.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.fadedBlock_=this.highlightedBlock_=this.markerConnection_=null,this.availableConnections_=this.initAvailableConnections_()},o.InsertionMarkerManager.PREVIEW_TYPE={INSERTION_MARKER:0,INPUT_OUTLINE:1,REPLACEMENT_FADE:2},o.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",o.InsertionMarkerManager.prototype.dispose=function(){this.availableConnections_.length=0,o.Events.disable();try{this.firstMarker_&&this.firstMarker_.dispose(),this.lastMarker_&&this.lastMarker_.dispose()}finally{o.Events.enable()}},o.InsertionMarkerManager.prototype.updateAvailableConnections=function(){this.availableConnections_=this.initAvailableConnections_()},o.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},o.InsertionMarkerManager.prototype.wouldConnectBlock=function(){return!!this.closestConnection_},o.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_&&(o.Events.disable(),this.hidePreview_(),o.Events.enable(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered)){var e=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;o.blockAnimations.connectionUiEffect(e.getSourceBlock()),this.topBlock_.getRootBlock().bringToFront()}},o.InsertionMarkerManager.prototype.update=function(e,r){var l=this.getCandidate_(e);((this.wouldDeleteBlock_=this.shouldDelete_(l,r))||this.shouldUpdatePreviews_(l,e))&&(o.Events.disable(),this.maybeHidePreview_(l),this.maybeShowPreview_(l),o.Events.enable())},o.InsertionMarkerManager.prototype.createMarkerBlock_=function(e){var r=e.type;o.Events.disable();try{var l=this.workspace_.newBlock(r);if(l.setInsertionMarker(!0),e.mutationToDom){var c=e.mutationToDom();c&&l.domToMutation(c)}for(r=0;r<e.inputList.length;r++){var p=e.inputList[r];if(p.name!=o.constants.COLLAPSED_INPUT_NAME){var _=l.inputList[r];if(!_)throw Error(o.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","an input"));for(c=0;c<p.fieldRow.length;c++){var v=p.fieldRow[c],b=_.fieldRow[c];if(!b)throw Error(o.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","a field"));b.setValue(v.getValue())}}}l.setCollapsed(e.isCollapsed()),l.setInputsInline(e.getInputsInline()),l.initSvg(),l.getSvgRoot().setAttribute("visibility","hidden")}finally{o.Events.enable()}return l},o.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var e=this.topBlock_.getConnections_(!1),r=this.topBlock_.lastConnectionInStack(!0);if(r&&r!=this.topBlock_.nextConnection){if(e.push(r),this.lastOnStack_=r,this.lastMarker_){o.Events.disable();try{this.lastMarker_.dispose()}finally{o.Events.enable()}}this.lastMarker_=this.createMarkerBlock_(r.getSourceBlock())}return e},o.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(e,r){var l=e.local,c=e.closest;return e=e.radius,l&&c?this.localConnection_&&this.closestConnection_?!(this.closestConnection_==c&&this.localConnection_==l||(l=this.localConnection_.x+r.x-this.closestConnection_.x,r=this.localConnection_.y+r.y-this.closestConnection_.y,r=Math.sqrt(l*l+r*r),c&&e>r-o.CURRENT_CONNECTION_PREFERENCE)):!this.localConnection_&&!this.closestConnection_||(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why."),!0):!(!this.localConnection_||!this.closestConnection_)},o.InsertionMarkerManager.prototype.getCandidate_=function(e){for(var r=this.getStartRadius_(),l=null,c=null,p=0;p<this.availableConnections_.length;p++){var _=this.availableConnections_[p],v=_.closest(r,e);v.connection&&(l=v.connection,c=_,r=v.radius)}return{closest:l,local:c,radius:r}},o.InsertionMarkerManager.prototype.getStartRadius_=function(){return this.closestConnection_&&this.localConnection_?o.CONNECTING_SNAP_RADIUS:o.SNAP_RADIUS},o.InsertionMarkerManager.prototype.shouldDelete_=function(e,r){return!(!r||!this.workspace_.getComponentManager().hasCapability(r.id,o.ComponentManager.Capability.DELETE_AREA))&&r.wouldDelete(this.topBlock_,e&&!!e.closest)},o.InsertionMarkerManager.prototype.maybeShowPreview_=function(e){if(!this.wouldDeleteBlock_){var r=e.closest;e=e.local,r&&(r==this.closestConnection_||r.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=r,this.localConnection_=e,this.showPreview_()))}},o.InsertionMarkerManager.prototype.showPreview_=function(){var e=this.closestConnection_,r=this.workspace_.getRenderer();switch(r.getConnectionPreviewMethod(e,this.localConnection_,this.topBlock_)){case o.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline_();break;case o.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker_();break;case o.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade_()}e&&r.shouldHighlightConnection(e)&&e.highlight()},o.InsertionMarkerManager.prototype.maybeHidePreview_=function(e){if(e.closest){var r=this.closestConnection_!=e.closest;e=this.localConnection_!=e.local,this.closestConnection_&&this.localConnection_&&(r||e||this.wouldDeleteBlock_)&&this.hidePreview_()}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null},o.InsertionMarkerManager.prototype.hidePreview_=function(){this.closestConnection_&&this.closestConnection_.targetBlock()&&this.workspace_.getRenderer().shouldHighlightConnection(this.closestConnection_)&&this.closestConnection_.unhighlight(),this.fadedBlock_?this.hideReplacementFade_():this.highlightedBlock_?this.hideInsertionInputOutline_():this.markerConnection_&&this.hideInsertionMarker_()},o.InsertionMarkerManager.prototype.showInsertionMarker_=function(){var e=this.localConnection_,r=this.closestConnection_,l=this.lastOnStack_&&e==this.lastOnStack_?this.lastMarker_:this.firstMarker_;if((e=l.getMatchingConnection(e.getSourceBlock(),e))==this.markerConnection_)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");l.render(),l.rendered=!0,l.getSvgRoot().setAttribute("visibility","visible"),e&&r&&l.positionNearConnection(e,r),r&&e.connect(r),this.markerConnection_=e},o.InsertionMarkerManager.prototype.hideInsertionMarker_=function(){if(this.markerConnection_){var e=this.markerConnection_,r=e.getSourceBlock(),l=r.nextConnection,c=r.previousConnection,p=r.outputConnection;if(p=e.type==o.connectionTypes.INPUT_VALUE&&!(p&&p.targetConnection),!(e!=l||c&&c.targetConnection)||p?e.targetBlock().unplug(!1):e.type==o.connectionTypes.NEXT_STATEMENT&&e!=l?((l=e.targetConnection).getSourceBlock().unplug(!1),c=c?c.targetConnection:null,r.unplug(!0),c&&c.connect(l)):r.unplug(!0),e.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null,(e=r.getSvgRoot())&&e.setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},o.InsertionMarkerManager.prototype.showInsertionInputOutline_=function(){var e=this.closestConnection_;this.highlightedBlock_=e.getSourceBlock(),this.highlightedBlock_.highlightShapeForInput(e,!0)},o.InsertionMarkerManager.prototype.hideInsertionInputOutline_=function(){this.highlightedBlock_.highlightShapeForInput(this.closestConnection_,!1),this.highlightedBlock_=null},o.InsertionMarkerManager.prototype.showReplacementFade_=function(){this.fadedBlock_=this.closestConnection_.targetBlock(),this.fadedBlock_.fadeForReplacement(!0)},o.InsertionMarkerManager.prototype.hideReplacementFade_=function(){this.fadedBlock_.fadeForReplacement(!1),this.fadedBlock_=null},o.InsertionMarkerManager.prototype.getInsertionMarkers=function(){var e=[];return this.firstMarker_&&e.push(this.firstMarker_),this.lastMarker_&&e.push(this.lastMarker_),e},o.BlockDragger=function(e,r){this.draggingBlock_=e,this.workspace_=r,this.draggedConnectionManager_=new o.InsertionMarkerManager(this.draggingBlock_),this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=o.BlockDragger.initIconData_(e)},o.BlockDragger.prototype.dispose=function(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()},o.BlockDragger.initIconData_=function(e){var r=[];e=e.getDescendants(!1);for(var c,l=0;c=e[l];l++){c=c.getIcons();for(var p=0;p<c.length;p++){var _={location:c[p].getIconLocation(),icon:c[p]};r.push(_)}}return r},o.BlockDragger.prototype.startDrag=function(e,r){o.Events.getGroup()||o.Events.setGroup(!0),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),o.utils.dom.startTextWidthCache(),this.workspace_.setResizesEnabled(!1),o.blockAnimations.disconnectUiStop(),this.shouldDisconnect_(r)&&this.disconnectBlock_(r,e),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface()},o.BlockDragger.prototype.shouldDisconnect_=function(e){return!!(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())},o.BlockDragger.prototype.disconnectBlock_=function(e,r){this.draggingBlock_.unplug(e),e=this.pixelsToWorkspaceUnits_(r),e=o.utils.Coordinate.sum(this.startXY_,e),this.draggingBlock_.translate(e.x,e.y),o.blockAnimations.disconnectUiEffect(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()},o.BlockDragger.prototype.fireDragStartEvent_=function(){var e=new(o.Events.get(o.Events.BLOCK_DRAG))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));o.Events.fire(e)},o.BlockDragger.prototype.drag=function(e,r){r=this.pixelsToWorkspaceUnits_(r);var l=o.utils.Coordinate.sum(this.startXY_,r);this.draggingBlock_.moveDuringDrag(l),this.dragIcons_(r),l=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(e),this.draggedConnectionManager_.update(r,this.dragTarget_),e=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock(),e!=this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==l&&(l&&l.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)},o.BlockDragger.prototype.endDrag=function(e,r){if(this.drag(e,r),this.dragIconData_=[],this.fireDragEndEvent_(),o.utils.dom.stopTextWidthCache(),o.blockAnimations.disconnectUiStop(),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_))e=this.startXY_;else{var l=(e=this.getNewLocationAfterDrag_(r)).delta;e=e.newLocation}this.draggingBlock_.moveOffDragSurface(e),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(!1),l?this.updateBlockAfterMove_(l):o.bumpObjectIntoBounds_(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)),this.workspace_.setResizesEnabled(!0),o.Events.setGroup(!1)},o.BlockDragger.prototype.getNewLocationAfterDrag_=function(e){var r={};return r.delta=this.pixelsToWorkspaceUnits_(e),r.newLocation=o.utils.Coordinate.sum(this.startXY_,r.delta),r},o.BlockDragger.prototype.maybeDeleteBlock_=function(){return!!this.wouldDeleteBlock_&&(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),o.draggingConnections=[],!0)},o.BlockDragger.prototype.updateBlockAfterMove_=function(e){this.draggingBlock_.moveConnections(e.x,e.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()},o.BlockDragger.prototype.fireDragEndEvent_=function(){var e=new(o.Events.get(o.Events.BLOCK_DRAG))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));o.Events.fire(e)},o.BlockDragger.prototype.updateToolboxStyle_=function(e){var r=this.workspace_.getToolbox();if(r){var l=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";e&&"function"==typeof r.removeStyle?r.removeStyle(l):e||"function"!=typeof r.addStyle||r.addStyle(l)}},o.BlockDragger.prototype.fireMoveEvent_=function(){var e=new(o.Events.get(o.Events.BLOCK_MOVE))(this.draggingBlock_);e.oldCoordinate=this.startXY_,e.recordNew(),o.Events.fire(e)},o.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)},o.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(e){return e=new o.utils.Coordinate(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e},o.BlockDragger.prototype.dragIcons_=function(e){for(var r=0;r<this.dragIconData_.length;r++){var l=this.dragIconData_[r];l.icon.setIconLocation(o.utils.Coordinate.sum(l.location,e))}},o.BlockDragger.prototype.getInsertionMarkers=function(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]},o.registry.register(o.registry.Type.BLOCK_DRAGGER,o.registry.DEFAULT,o.BlockDragger),o.IContextMenu=function(){},o.IDraggable=function(){},o.IBubble=function(){},o.Bubble=function(e,r,l,c,p,_){this.workspace_=e,this.content_=r,this.shape_=l,this.onMouseDownResizeWrapper_=this.onMouseDownBubbleWrapper_=this.moveCallback_=this.resizeCallback_=null,this.disposed=!1,l=o.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(l=-l),this.arrow_radians_=o.utils.math.toRadians(l),e.getBubbleCanvas().appendChild(this.createDom_(r,!(!p||!_))),this.setAnchorLocation(c),p&&_||(p=(e=this.content_.getBBox()).width+2*o.Bubble.BORDER_WIDTH,_=e.height+2*o.Bubble.BORDER_WIDTH),this.setBubbleSize(p,_),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0},o.Bubble.BORDER_WIDTH=6,o.Bubble.ARROW_THICKNESS=5,o.Bubble.ARROW_ANGLE=20,o.Bubble.ARROW_BEND=4,o.Bubble.ANCHOR_RADIUS=8,o.Bubble.onMouseUpWrapper_=null,o.Bubble.onMouseMoveWrapper_=null,o.Bubble.unbindDragEvents_=function(){o.Bubble.onMouseUpWrapper_&&(o.browserEvents.unbind(o.Bubble.onMouseUpWrapper_),o.Bubble.onMouseUpWrapper_=null),o.Bubble.onMouseMoveWrapper_&&(o.browserEvents.unbind(o.Bubble.onMouseMoveWrapper_),o.Bubble.onMouseMoveWrapper_=null)},o.Bubble.bubbleMouseUp_=function(e){o.Touch.clearTouchIdentifier(),o.Bubble.unbindDragEvents_()},o.Bubble.prototype.rendered_=!1,o.Bubble.prototype.anchorXY_=null,o.Bubble.prototype.relativeLeft_=0,o.Bubble.prototype.relativeTop_=0,o.Bubble.prototype.width_=0,o.Bubble.prototype.height_=0,o.Bubble.prototype.autoLayout_=!0,o.Bubble.prototype.createDom_=function(e,r){this.bubbleGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{},null);var l={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return o.utils.userAgent.JAVA_FX&&(l={}),l=o.utils.dom.createSvgElement(o.utils.Svg.G,l,this.bubbleGroup_),this.bubbleArrow_=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{},l),this.bubbleBack_=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blocklyDraggable",x:0,y:0,rx:o.Bubble.BORDER_WIDTH,ry:o.Bubble.BORDER_WIDTH},l),r?(this.resizeGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),o.utils.dom.createSvgElement(o.utils.Svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,(r=2*o.Bubble.BORDER_WIDTH).toString())},this.resizeGroup_),o.utils.dom.createSvgElement(o.utils.Svg.LINE,{class:"blocklyResizeLine",x1:r/3,y1:r-1,x2:r-1,y2:r/3},this.resizeGroup_),o.utils.dom.createSvgElement(o.utils.Svg.LINE,{class:"blocklyResizeLine",x1:2*r/3,y1:r-1,x2:r-1,y2:2*r/3},this.resizeGroup_)):this.resizeGroup_=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper_=o.browserEvents.conditionalBind(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&(this.onMouseDownResizeWrapper_=o.browserEvents.conditionalBind(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))),this.bubbleGroup_.appendChild(e),this.bubbleGroup_},o.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},o.Bubble.prototype.setSvgId=function(e){this.bubbleGroup_.dataset&&(this.bubbleGroup_.dataset.blockId=e)},o.Bubble.prototype.bubbleMouseDown_=function(e){var r=this.workspace_.getGesture(e);r&&r.handleBubbleStart(e,this)},o.Bubble.prototype.showContextMenu=function(e){},o.Bubble.prototype.isDeletable=function(){return!1},o.Bubble.prototype.setDeleteStyle=function(e){},o.Bubble.prototype.resizeMouseDown_=function(e){this.promote(),o.Bubble.unbindDragEvents_(),o.utils.isRightButton(e)||(this.workspace_.startDrag(e,new o.utils.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),o.Bubble.onMouseUpWrapper_=o.browserEvents.conditionalBind(document,"mouseup",this,o.Bubble.bubbleMouseUp_),o.Bubble.onMouseMoveWrapper_=o.browserEvents.conditionalBind(document,"mousemove",this,this.resizeMouseMove_),o.hideChaff()),e.stopPropagation()},o.Bubble.prototype.resizeMouseMove_=function(e){this.autoLayout_=!1,e=this.workspace_.moveDrag(e),this.setBubbleSize(this.workspace_.RTL?-e.x:e.x,e.y),this.workspace_.RTL&&this.positionBubble_()},o.Bubble.prototype.registerResizeEvent=function(e){this.resizeCallback_=e},o.Bubble.prototype.registerMoveEvent=function(e){this.moveCallback_=e},o.Bubble.prototype.promote=function(){var e=this.bubbleGroup_.parentNode;return e.lastChild!==this.bubbleGroup_&&(e.appendChild(this.bubbleGroup_),!0)},o.Bubble.prototype.setAnchorLocation=function(e){this.anchorXY_=e,this.rendered_&&this.positionBubble_()},o.Bubble.prototype.layoutBubble_=function(){var e=this.workspace_.getMetricsManager().getViewMetrics(!0),r=this.getOptimalRelativeLeft_(e),l=this.getOptimalRelativeTop_(e),c=this.shape_.getBBox(),p={x:r,y:-this.height_-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},_={x:-this.width_-30,y:l};l={x:c.width,y:l};var v={x:r,y:c.height};r=c.width<c.height?l:v,c=c.width<c.height?v:l,l=this.getOverlap_(p,e),v=this.getOverlap_(_,e);var b=this.getOverlap_(r,e);e=this.getOverlap_(c,e),l==(e=Math.max(l,v,b,e))?(this.relativeLeft_=p.x,this.relativeTop_=p.y):v==e?(this.relativeLeft_=_.x,this.relativeTop_=_.y):b==e?(this.relativeLeft_=r.x,this.relativeTop_=r.y):(this.relativeLeft_=c.x,this.relativeTop_=c.y)},o.Bubble.prototype.getOverlap_=function(e,r){var l=this.workspace_.RTL?this.anchorXY_.x-e.x-this.width_:e.x+this.anchorXY_.x;return e=e.y+this.anchorXY_.y,Math.max(0,Math.min(1,(Math.min(l+this.width_,r.left+r.width)-Math.max(l,r.left))*(Math.min(e+this.height_,r.top+r.height)-Math.max(e,r.top))/(this.width_*this.height_)))},o.Bubble.prototype.getOptimalRelativeLeft_=function(e){var r=-this.width_/4;if(this.width_>e.width)return r;if(this.workspace_.RTL)var l=this.anchorXY_.x-r,c=l-this.width_,p=e.left+e.width,_=e.left+o.Scrollbar.scrollbarThickness/this.workspace_.scale;else l=(c=r+this.anchorXY_.x)+this.width_,_=e.left,p=e.left+e.width-o.Scrollbar.scrollbarThickness/this.workspace_.scale;return this.workspace_.RTL?c<_?r=-(_-this.anchorXY_.x+this.width_):l>p&&(r=-(p-this.anchorXY_.x)):c<_?r=_-this.anchorXY_.x:l>p&&(r=p-this.anchorXY_.x-this.width_),r},o.Bubble.prototype.getOptimalRelativeTop_=function(e){var r=-this.height_/4;if(this.height_>e.height)return r;var l=this.anchorXY_.y+r,p=e.top;e=e.top+e.height-o.Scrollbar.scrollbarThickness/this.workspace_.scale;var _=this.anchorXY_.y;return l<p?r=p-_:l+this.height_>e&&(r=e-_-this.height_),r},o.Bubble.prototype.positionBubble_=function(){var e=this.anchorXY_.x;this.moveTo(e=this.workspace_.RTL?e-(this.relativeLeft_+this.width_):e+this.relativeLeft_,this.relativeTop_+this.anchorXY_.y)},o.Bubble.prototype.moveTo=function(e,r){this.bubbleGroup_.setAttribute("transform","translate("+e+","+r+")")},o.Bubble.prototype.setDragging=function(e){!e&&this.moveCallback_&&this.moveCallback_()},o.Bubble.prototype.getBubbleSize=function(){return new o.utils.Size(this.width_,this.height_)},o.Bubble.prototype.setBubbleSize=function(e,r){var l=2*o.Bubble.BORDER_WIDTH;e=Math.max(e,l+45),r=Math.max(r,l+20),this.width_=e,this.height_=r,this.bubbleBack_.setAttribute("width",e),this.bubbleBack_.setAttribute("height",r),this.resizeGroup_&&this.resizeGroup_.setAttribute("transform",this.workspace_.RTL?"translate("+2*o.Bubble.BORDER_WIDTH+","+(r-l)+") scale(-1 1)":"translate("+(e-l)+","+(r-l)+")"),this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_(),this.resizeCallback_&&this.resizeCallback_()},o.Bubble.prototype.renderArrow_=function(){var e=[],r=this.width_/2,l=this.height_/2,c=-this.relativeLeft_,p=-this.relativeTop_;if(r==c&&l==p)e.push("M "+r+","+l);else{p-=l,c-=r,this.workspace_.RTL&&(c*=-1);var _=Math.sqrt(p*p+c*c),v=Math.acos(c/_);0>p&&(v=2*Math.PI-v);var b=v+Math.PI/2;b>2*Math.PI&&(b-=2*Math.PI);var w=Math.sin(b),F=Math.cos(b),X=this.getBubbleSize();b=(X.width+X.height)/o.Bubble.ARROW_THICKNESS,b=Math.min(b,X.width,X.height)/4,c=r+(X=1-o.Bubble.ANCHOR_RADIUS/_)*c,p=l+X*p,X=r+b*F;var xe=l+b*w;r-=b*F,l-=b*w,(w=v+this.arrow_radians_)>2*Math.PI&&(w-=2*Math.PI),v=Math.sin(w)*_/o.Bubble.ARROW_BEND,_=Math.cos(w)*_/o.Bubble.ARROW_BEND,e.push("M"+X+","+xe),e.push("C"+(X+_)+","+(xe+v)+" "+c+","+p+" "+c+","+p),e.push("C"+c+","+p+" "+(r+_)+","+(l+v)+" "+r+","+l)}e.push("z"),this.bubbleArrow_.setAttribute("d",e.join(" "))},o.Bubble.prototype.setColour=function(e){this.bubbleBack_.setAttribute("fill",e),this.bubbleArrow_.setAttribute("fill",e)},o.Bubble.prototype.dispose=function(){this.onMouseDownBubbleWrapper_&&o.browserEvents.unbind(this.onMouseDownBubbleWrapper_),this.onMouseDownResizeWrapper_&&o.browserEvents.unbind(this.onMouseDownResizeWrapper_),o.Bubble.unbindDragEvents_(),o.utils.dom.removeNode(this.bubbleGroup_),this.disposed=!0},o.Bubble.prototype.moveDuringDrag=function(e,r){e?e.translateSurface(r.x,r.y):this.moveTo(r.x,r.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-r.x-this.width_:r.x-this.anchorXY_.x,this.relativeTop_=r.y-this.anchorXY_.y,this.renderArrow_()},o.Bubble.prototype.getRelativeToSurfaceXY=function(){return new o.utils.Coordinate(this.workspace_.RTL?-this.relativeLeft_+this.anchorXY_.x-this.width_:this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},o.Bubble.prototype.setAutoLayout=function(e){this.autoLayout_=e},o.Bubble.textToDom=function(e){var r=o.utils.dom.createSvgElement(o.utils.Svg.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:o.Bubble.BORDER_WIDTH},null);e=e.split("\n");for(var l=0;l<e.length;l++){var c=o.utils.dom.createSvgElement(o.utils.Svg.TSPAN,{dy:"1em",x:o.Bubble.BORDER_WIDTH},r),p=document.createTextNode(e[l]);c.appendChild(p)}return r},o.Bubble.createNonEditableBubble=function(e,r,l){if((l=new o.Bubble(r.workspace,e,r.pathObject.svgPath,l,null,null)).setSvgId(r.id),r.RTL){r=e.getBBox().width;for(var p,c=0;p=e.childNodes[c];c++)p.setAttribute("text-anchor","end"),p.setAttribute("x",r+o.Bubble.BORDER_WIDTH)}return l},o.Events.CommentBase=function(e){this.commentId=(this.isBlank=void 0===e)?"":e.id,this.workspaceId=this.isBlank?"":e.workspace.id,this.group=o.Events.getGroup(),this.recordUndo=o.Events.recordUndo},o.utils.object.inherits(o.Events.CommentBase,o.Events.Abstract),o.Events.CommentBase.prototype.toJson=function(){var e=o.Events.CommentBase.superClass_.toJson.call(this);return this.commentId&&(e.commentId=this.commentId),e},o.Events.CommentBase.prototype.fromJson=function(e){o.Events.CommentBase.superClass_.fromJson.call(this,e),this.commentId=e.commentId},o.Events.CommentChange=function(e,r,l){o.Events.CommentChange.superClass_.constructor.call(this,e),e&&(this.oldContents_=void 0===r?"":r,this.newContents_=void 0===l?"":l)},o.utils.object.inherits(o.Events.CommentChange,o.Events.CommentBase),o.Events.CommentChange.prototype.type=o.Events.COMMENT_CHANGE,o.Events.CommentChange.prototype.toJson=function(){var e=o.Events.CommentChange.superClass_.toJson.call(this);return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e},o.Events.CommentChange.prototype.fromJson=function(e){o.Events.CommentChange.superClass_.fromJson.call(this,e),this.oldContents_=e.oldContents,this.newContents_=e.newContents},o.Events.CommentChange.prototype.isNull=function(){return this.oldContents_==this.newContents_},o.Events.CommentChange.prototype.run=function(e){var r=this.getEventWorkspace_().getCommentById(this.commentId);r?r.setContent(e?this.newContents_:this.oldContents_):console.warn("Can't change non-existent comment: "+this.commentId)},o.Events.CommentCreate=function(e){o.Events.CommentCreate.superClass_.constructor.call(this,e),e&&(this.xml=e.toXmlWithXY())},o.utils.object.inherits(o.Events.CommentCreate,o.Events.CommentBase),o.Events.CommentCreate.prototype.type=o.Events.COMMENT_CREATE,o.Events.CommentCreate.prototype.toJson=function(){var e=o.Events.CommentCreate.superClass_.toJson.call(this);return e.xml=o.Xml.domToText(this.xml),e},o.Events.CommentCreate.prototype.fromJson=function(e){o.Events.CommentCreate.superClass_.fromJson.call(this,e),this.xml=o.Xml.textToDom(e.xml)},o.Events.CommentCreate.prototype.run=function(e){o.Events.CommentCreateDeleteHelper(this,e)},o.Events.CommentCreateDeleteHelper=function(e,r){var l=e.getEventWorkspace_();r?((r=o.utils.xml.createElement("xml")).appendChild(e.xml),o.Xml.domToWorkspace(r,l)):(l=l.getCommentById(e.commentId))?l.dispose(!1,!1):console.warn("Can't uncreate non-existent comment: "+e.commentId)},o.Events.CommentDelete=function(e){o.Events.CommentDelete.superClass_.constructor.call(this,e),e&&(this.xml=e.toXmlWithXY())},o.utils.object.inherits(o.Events.CommentDelete,o.Events.CommentBase),o.Events.CommentDelete.prototype.type=o.Events.COMMENT_DELETE,o.Events.CommentDelete.prototype.toJson=function(){return o.Events.CommentDelete.superClass_.toJson.call(this)},o.Events.CommentDelete.prototype.fromJson=function(e){o.Events.CommentDelete.superClass_.fromJson.call(this,e)},o.Events.CommentDelete.prototype.run=function(e){o.Events.CommentCreateDeleteHelper(this,!e)},o.Events.CommentMove=function(e){o.Events.CommentMove.superClass_.constructor.call(this,e),e&&(this.comment_=e,this.oldCoordinate_=e.getXY(),this.newCoordinate_=null)},o.utils.object.inherits(o.Events.CommentMove,o.Events.CommentBase),o.Events.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw Error("Tried to record the new position of a comment on the same event twice.");this.newCoordinate_=this.comment_.getXY(),this.comment_=null},o.Events.CommentMove.prototype.type=o.Events.COMMENT_MOVE,o.Events.CommentMove.prototype.setOldCoordinate=function(e){this.oldCoordinate_=e},o.Events.CommentMove.prototype.toJson=function(){var e=o.Events.CommentMove.superClass_.toJson.call(this);return this.oldCoordinate_&&(e.oldCoordinate=Math.round(this.oldCoordinate_.x)+","+Math.round(this.oldCoordinate_.y)),this.newCoordinate_&&(e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y)),e},o.Events.CommentMove.prototype.fromJson=function(e){if(o.Events.CommentMove.superClass_.fromJson.call(this,e),e.oldCoordinate){var r=e.oldCoordinate.split(",");this.oldCoordinate_=new o.utils.Coordinate(Number(r[0]),Number(r[1]))}e.newCoordinate&&(r=e.newCoordinate.split(","),this.newCoordinate_=new o.utils.Coordinate(Number(r[0]),Number(r[1])))},o.Events.CommentMove.prototype.isNull=function(){return o.utils.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)},o.Events.CommentMove.prototype.run=function(e){var r=this.getEventWorkspace_().getCommentById(this.commentId);if(r){e=e?this.newCoordinate_:this.oldCoordinate_;var l=r.getXY();r.moveBy(e.x-l.x,e.y-l.y)}else console.warn("Can't move non-existent comment: "+this.commentId)},o.registry.register(o.registry.Type.EVENT,o.Events.COMMENT_CREATE,o.Events.CommentCreate),o.registry.register(o.registry.Type.EVENT,o.Events.COMMENT_CHANGE,o.Events.CommentChange),o.registry.register(o.registry.Type.EVENT,o.Events.COMMENT_MOVE,o.Events.CommentMove),o.registry.register(o.registry.Type.EVENT,o.Events.COMMENT_DELETE,o.Events.CommentDelete),o.BubbleDragger=function(e,r){this.draggingBubble_=e,this.workspace_=r,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=o.utils.is3dSupported()&&r.getBlockDragSurface()?r.getBlockDragSurface():null},o.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},o.BubbleDragger.prototype.startBubbleDrag=function(){o.Events.getGroup()||o.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_(),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!0)},o.BubbleDragger.prototype.dragBubble=function(e,r){r=this.pixelsToWorkspaceUnits_(r),r=o.utils.Coordinate.sum(this.startXY_,r),this.draggingBubble_.moveDuringDrag(this.dragSurface_,r),r=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(e),e=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),e!=this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==r&&(r&&r.onDragExit(this.draggingBubble_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBubble_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBubble_)},o.BubbleDragger.prototype.shouldDelete_=function(e){return!(!e||!this.workspace_.getComponentManager().hasCapability(e.id,o.ComponentManager.Capability.DELETE_AREA))&&e.wouldDelete(this.draggingBubble_,!1)},o.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.draggingBubble_.setDeleteStyle(this.wouldDeleteBubble_)},o.BubbleDragger.prototype.endBubbleDrag=function(e,r){this.dragBubble(e,r),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBubble_)?e=this.startXY_:(e=this.pixelsToWorkspaceUnits_(r),e=o.utils.Coordinate.sum(this.startXY_,e)),this.draggingBubble_.moveTo(e.x,e.y),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBubble_),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.draggingBubble_.dispose(!1,!0)):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!1),this.fireMoveEvent_()),this.workspace_.setResizesEnabled(!0),o.Events.setGroup(!1)},o.BubbleDragger.prototype.fireMoveEvent_=function(){if(this.draggingBubble_.isComment){var e=new(o.Events.get(o.Events.COMMENT_MOVE))(this.draggingBubble_);e.setOldCoordinate(this.startXY_),e.recordNew(),o.Events.fire(e)}},o.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(e){return e=new o.utils.Coordinate(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e},o.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())},o.Events.Click=function(e,r,l){o.Events.Click.superClass_.constructor.call(this,e?e.workspace.id:r),this.blockId=e?e.id:null,this.targetType=l},o.utils.object.inherits(o.Events.Click,o.Events.UiBase),o.Events.Click.prototype.type=o.Events.CLICK,o.Events.Click.prototype.toJson=function(){var e=o.Events.Click.superClass_.toJson.call(this);return e.targetType=this.targetType,this.blockId&&(e.blockId=this.blockId),e},o.Events.Click.prototype.fromJson=function(e){o.Events.Click.superClass_.fromJson.call(this,e),this.targetType=e.targetType,this.blockId=e.blockId},o.registry.register(o.registry.Type.EVENT,o.Events.CLICK,o.Events.Click),o.WorkspaceDragger=function(e){this.workspace_=e,this.horizontalScrollEnabled_=this.workspace_.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace_.isMovableVertically(),this.startScrollXY_=new o.utils.Coordinate(e.scrollX,e.scrollY)},o.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},o.WorkspaceDragger.prototype.startDrag=function(){o.selected&&o.selected.unselect(),this.workspace_.setupDragSurface()},o.WorkspaceDragger.prototype.endDrag=function(e){this.drag(e),this.workspace_.resetDragSurface()},o.WorkspaceDragger.prototype.drag=function(e){if(e=o.utils.Coordinate.sum(this.startScrollXY_,e),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace_.scroll(e.x,e.y);else if(this.horizontalScrollEnabled_)this.workspace_.scroll(e.x,this.workspace_.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace_.scroll(this.workspace_.scrollX,e.y)}},o.Gesture=function(e,r){this.mouseDownXY_=null,this.currentDragDeltaXY_=new o.utils.Coordinate(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.creatorWorkspace_=r,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=e,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.healStack_=!o.DRAG_STACK},o.Gesture.prototype.dispose=function(){o.Touch.clearTouchIdentifier(),o.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&o.browserEvents.unbind(this.onMoveWrapper_),this.onUpWrapper_&&o.browserEvents.unbind(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.bubbleDragger_&&this.bubbleDragger_.dispose()},o.Gesture.prototype.updateFromEvent_=function(e){var r=new o.utils.Coordinate(e.clientX,e.clientY);this.updateDragDelta_(r)&&(this.updateIsDragging_(),o.longStop_()),this.mostRecentEvent_=e},o.Gesture.prototype.updateDragDelta_=function(e){return this.currentDragDeltaXY_=o.utils.Coordinate.difference(e,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=o.utils.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?o.FLYOUT_DRAG_RADIUS:o.DRAG_RADIUS))},o.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(!this.targetBlock_||!this.flyout_.isBlockCreatable_(this.targetBlock_)||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),o.Events.getGroup()||o.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),0))},o.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},o.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},o.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new o.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},o.Gesture.prototype.updateIsDragging_=function(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},o.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new(o.registry.getClassFromOptions(o.registry.Type.BLOCK_DRAGGER,this.creatorWorkspace_.options,!0))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)},o.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new o.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},o.Gesture.prototype.doStart=function(e){o.utils.isTargetInput(e)?this.cancel():(this.hasStarted_=!0,o.blockAnimations.disconnectUiStop(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),o.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=e,o.Tooltip.block(),this.targetBlock_&&this.targetBlock_.select(),o.utils.isRightButton(e)?this.handleRightClick(e):("touchstart"!=e.type.toLowerCase()&&"pointerdown"!=e.type.toLowerCase()||"mouse"==e.pointerType||o.longStart(e,this),this.mouseDownXY_=new o.utils.Coordinate(e.clientX,e.clientY),this.healStack_=e.altKey||e.ctrlKey||e.metaKey,this.bindMouseEvents(e)))},o.Gesture.prototype.bindMouseEvents=function(e){this.onMoveWrapper_=o.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=o.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this)),e.preventDefault(),e.stopPropagation()},o.Gesture.prototype.handleMove=function(e){this.updateFromEvent_(e),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),e.preventDefault(),e.stopPropagation()},o.Gesture.prototype.handleUp=function(e){this.updateFromEvent_(e),o.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(e,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(e,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(e),e.preventDefault(),e.stopPropagation(),this.dispose())},o.Gesture.prototype.cancel=function(){this.isEnding_||(o.longStop_(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},o.Gesture.prototype.handleRightClick=function(e){this.targetBlock_?(this.bringBlockToFront_(),o.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(e)):this.startBubble_?this.startBubble_.showContextMenu(e):this.startWorkspace_&&!this.flyout_&&(o.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()},o.Gesture.prototype.handleWsStart=function(e,r){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(r),this.mostRecentEvent_=e,this.doStart(e)},o.Gesture.prototype.fireWorkspaceClick_=function(e){o.Events.fire(new(o.Events.get(o.Events.CLICK))(null,e.id,"workspace"))},o.Gesture.prototype.handleFlyoutStart=function(e,r){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(r),this.handleWsStart(e,r.getWorkspace())},o.Gesture.prototype.handleBlockStart=function(e,r){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(r),this.mostRecentEvent_=e},o.Gesture.prototype.handleBubbleStart=function(e,r){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(r),this.mostRecentEvent_=e},o.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus(),this.startBubble_.select&&this.startBubble_.select()},o.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()},o.Gesture.prototype.doBlockClick_=function(){if(this.flyout_&&this.flyout_.autoClose)this.targetBlock_.isEnabled()&&(o.Events.getGroup()||o.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump());else{var e=new(o.Events.get(o.Events.CLICK))(this.startBlock_,this.startWorkspace_.id,"block");o.Events.fire(e)}this.bringBlockToFront_(),o.Events.setGroup(!1)},o.Gesture.prototype.doWorkspaceClick_=function(e){e=this.creatorWorkspace_,o.selected&&o.selected.unselect(),this.fireWorkspaceClick_(this.startWorkspace_||e)},o.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},o.Gesture.prototype.setStartField=function(e){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=e)},o.Gesture.prototype.setStartBubble=function(e){this.startBubble_||(this.startBubble_=e)},o.Gesture.prototype.setStartBlock=function(e){this.startBlock_||this.startBubble_||(this.startBlock_=e,e.isInFlyout&&e!=e.getRootBlock()?this.setTargetBlock_(e.getRootBlock()):this.setTargetBlock_(e))},o.Gesture.prototype.setTargetBlock_=function(e){e.isShadow()?this.setTargetBlock_(e.getParent()):this.targetBlock_=e},o.Gesture.prototype.setStartWorkspace_=function(e){this.startWorkspace_||(this.startWorkspace_=e)},o.Gesture.prototype.setStartFlyout_=function(e){this.flyout_||(this.flyout_=e)},o.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},o.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},o.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isClickable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},o.Gesture.prototype.isWorkspaceClick_=function(){return!(this.startBlock_||this.startBubble_||this.startField_||this.hasExceededDragRadius_)},o.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},o.Gesture.prototype.hasStarted=function(){return this.hasStarted_},o.Gesture.prototype.getInsertionMarkers=function(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]},o.Gesture.prototype.getCurrentDragger=function(){return this.isDraggingBlock_?this.blockDragger_:this.isDraggingWorkspace_?this.workspaceDragger_:this.isDraggingBubble_?this.bubbleDragger_:null},o.Gesture.inProgress=function(){for(var l,e=o.Workspace.getAll(),r=0;l=e[r];r++)if(l.currentGesture_)return!0;return!1},o.IRegistrable=function(){},o.Marker=function(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"},o.Marker.prototype.setDrawer=function(e){this.drawer_=e},o.Marker.prototype.getDrawer=function(){return this.drawer_},o.Marker.prototype.getCurNode=function(){return this.curNode_},o.Marker.prototype.setCurNode=function(e){var r=this.curNode_;this.curNode_=e,this.drawer_&&this.drawer_.draw(r,this.curNode_)},o.Marker.prototype.draw=function(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)},o.Marker.prototype.hide=function(){this.drawer_&&this.drawer_.hide()},o.Marker.prototype.dispose=function(){this.getDrawer()&&this.getDrawer().dispose()},o.Cursor=function(){o.Cursor.superClass_.constructor.call(this),this.type="cursor"},o.utils.object.inherits(o.Cursor,o.Marker),o.Cursor.prototype.next=function(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()==o.ASTNode.types.NEXT||e.getType()==o.ASTNode.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e},o.Cursor.prototype.in=function(){var e=this.getCurNode();return e?((e.getType()==o.ASTNode.types.PREVIOUS||e.getType()==o.ASTNode.types.OUTPUT)&&(e=e.next()),(e=e.in())&&this.setCurNode(e),e):null},o.Cursor.prototype.prev=function(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()==o.ASTNode.types.NEXT||e.getType()==o.ASTNode.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e},o.Cursor.prototype.out=function(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()==o.ASTNode.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null},o.registry.register(o.registry.Type.CURSOR,o.registry.DEFAULT,o.Cursor),o.MarkerManager=function(e){this.cursorSvg_=this.cursor_=null,this.markers_=Object.create(null),this.workspace_=e},o.MarkerManager.LOCAL_MARKER="local_marker_1",o.MarkerManager.prototype.registerMarker=function(e,r){this.markers_[e]&&this.unregisterMarker(e),r.setDrawer(this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,r)),this.setMarkerSvg(r.getDrawer().createDom()),this.markers_[e]=r},o.MarkerManager.prototype.unregisterMarker=function(e){var r=this.markers_[e];if(!r)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");r.dispose(),delete this.markers_[e]},o.MarkerManager.prototype.getCursor=function(){return this.cursor_},o.MarkerManager.prototype.getMarker=function(e){return this.markers_[e]||null},o.MarkerManager.prototype.setCursor=function(e){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=e)&&(e=this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,this.cursor_),this.cursor_.setDrawer(e),this.setCursorSvg(this.cursor_.getDrawer().createDom()))},o.MarkerManager.prototype.setCursorSvg=function(e){e?(this.workspace_.getBlockCanvas().appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null},o.MarkerManager.prototype.setMarkerSvg=function(e){e?this.workspace_.getBlockCanvas()&&(this.cursorSvg_?this.workspace_.getBlockCanvas().insertBefore(e,this.cursorSvg_):this.workspace_.getBlockCanvas().appendChild(e)):this.markerSvg_=null},o.MarkerManager.prototype.updateMarkers=function(){this.workspace_.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace_.getCursor().draw()},o.MarkerManager.prototype.dispose=function(){for(var l,e=Object.keys(this.markers_),r=0;l=e[r];r++)this.unregisterMarker(l);this.markers_=null,this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)},o.WidgetDiv={},o.WidgetDiv.owner_=null,o.WidgetDiv.dispose_=null,o.WidgetDiv.rendererClassName_="",o.WidgetDiv.themeClassName_="",o.WidgetDiv.createDom=function(){o.WidgetDiv.DIV||(o.WidgetDiv.DIV=document.createElement("div"),o.WidgetDiv.DIV.className="blocklyWidgetDiv",(o.parentContainer||document.body).appendChild(o.WidgetDiv.DIV))},o.WidgetDiv.show=function(e,r,l){o.WidgetDiv.hide(),o.WidgetDiv.owner_=e,o.WidgetDiv.dispose_=l,(e=o.WidgetDiv.DIV).style.direction=r?"rtl":"ltr",e.style.display="block",r=o.getMainWorkspace(),o.WidgetDiv.rendererClassName_=r.getRenderer().getClassName(),o.WidgetDiv.themeClassName_=r.getTheme().getClassName(),o.utils.dom.addClass(e,o.WidgetDiv.rendererClassName_),o.utils.dom.addClass(e,o.WidgetDiv.themeClassName_)},o.WidgetDiv.hide=function(){if(o.WidgetDiv.isVisible()){o.WidgetDiv.owner_=null;var e=o.WidgetDiv.DIV;e.style.display="none",e.style.left="",e.style.top="",o.WidgetDiv.dispose_&&o.WidgetDiv.dispose_(),o.WidgetDiv.dispose_=null,e.textContent="",o.WidgetDiv.rendererClassName_&&(o.utils.dom.removeClass(e,o.WidgetDiv.rendererClassName_),o.WidgetDiv.rendererClassName_=""),o.WidgetDiv.themeClassName_&&(o.utils.dom.removeClass(e,o.WidgetDiv.themeClassName_),o.WidgetDiv.themeClassName_=""),o.getMainWorkspace().markFocused()}},o.WidgetDiv.isVisible=function(){return!!o.WidgetDiv.owner_},o.WidgetDiv.hideIfOwner=function(e){o.WidgetDiv.owner_==e&&o.WidgetDiv.hide()},o.WidgetDiv.positionInternal_=function(e,r,l){o.WidgetDiv.DIV.style.left=e+"px",o.WidgetDiv.DIV.style.top=r+"px",o.WidgetDiv.DIV.style.height=l+"px"},o.WidgetDiv.positionWithAnchor=function(e,r,l,c){var p=o.WidgetDiv.calculateY_(e,r,l);e=o.WidgetDiv.calculateX_(e,r,l,c),0>p?o.WidgetDiv.positionInternal_(e,0,l.height+p):o.WidgetDiv.positionInternal_(e,p,l.height)},o.WidgetDiv.calculateX_=function(e,r,l,c){return c?(r=Math.max(r.right-l.width,e.left),Math.min(r,e.right-l.width)):(r=Math.min(r.left,e.right-l.width),Math.max(r,e.left))},o.WidgetDiv.calculateY_=function(e,r,l){return r.bottom+l.height>=e.bottom?r.top-l.height:r.bottom},o.Field=function(e,r,l){this.value_=this.DEFAULT_VALUE,this.tooltip_=this.validator_=null,this.size_=new o.utils.Size(0,0),this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=null,l&&this.configure_(l),this.setValue(e),r&&this.setValidator(r)},o.Field.prototype.DEFAULT_VALUE=null,o.Field.prototype.name=void 0,o.Field.prototype.disposed=!1,o.Field.prototype.maxDisplayLength=50,o.Field.prototype.sourceBlock_=null,o.Field.prototype.isDirty_=!0,o.Field.prototype.visible_=!0,o.Field.prototype.clickTarget_=null,o.Field.NBSP="\xa0",o.Field.prototype.EDITABLE=!0,o.Field.prototype.SERIALIZABLE=!1,o.Field.prototype.configure_=function(e){var r=e.tooltip;"string"==typeof r&&(r=o.utils.replaceMessageReferences(e.tooltip)),r&&this.setTooltip(r)},o.Field.prototype.setSourceBlock=function(e){if(this.sourceBlock_)throw Error("Field already bound to a block.");this.sourceBlock_=e},o.Field.prototype.getConstants=function(){return!this.constants_&&this.sourceBlock_&&this.sourceBlock_.workspace&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_},o.Field.prototype.getSourceBlock=function(){return this.sourceBlock_},o.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{},null),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())},o.Field.prototype.initView=function(){this.createBorderRect_(),this.createTextElement_()},o.Field.prototype.initModel=function(){},o.Field.prototype.createBorderRect_=function(){this.borderRect_=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)},o.Field.prototype.createTextElement_=function(){this.textElement_=o.utils.dom.createSvgElement(o.utils.Svg.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)},o.Field.prototype.bindEvents_=function(){o.Tooltip.bindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_=o.browserEvents.conditionalBind(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)},o.Field.prototype.fromXml=function(e){this.setValue(e.textContent)},o.Field.prototype.toXml=function(e){return e.textContent=this.getValue(),e},o.Field.prototype.dispose=function(){o.DropDownDiv.hideIfOwner(this),o.WidgetDiv.hideIfOwner(this),o.Tooltip.unbindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_&&o.browserEvents.unbind(this.mouseDownWrapper_),o.utils.dom.removeNode(this.fieldGroup_),this.disposed=!0},o.Field.prototype.updateEditable=function(){var e=this.fieldGroup_;this.EDITABLE&&e&&(this.sourceBlock_.isEditable()?(o.utils.dom.addClass(e,"blocklyEditableText"),o.utils.dom.removeClass(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(o.utils.dom.addClass(e,"blocklyNonEditableText"),o.utils.dom.removeClass(e,"blocklyEditableText"),e.style.cursor=""))},o.Field.prototype.isClickable=function(){return!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&!!this.showEditor_&&"function"==typeof this.showEditor_},o.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},o.Field.prototype.isSerializable=function(){var e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e},o.Field.prototype.isVisible=function(){return this.visible_},o.Field.prototype.setVisible=function(e){if(this.visible_!=e){this.visible_=e;var r=this.getSvgRoot();r&&(r.style.display=e?"block":"none")}},o.Field.prototype.setValidator=function(e){this.validator_=e},o.Field.prototype.getValidator=function(){return this.validator_},o.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},o.Field.prototype.applyColour=function(){},o.Field.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()},o.Field.prototype.showEditor=function(e){this.isClickable()&&this.showEditor_(e)},o.Field.prototype.updateSize_=function(e){var r=this.getConstants(),l=2*(e=null!=e?e:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0),c=r.FIELD_TEXT_HEIGHT,p=0;this.textElement_&&(l+=p=o.utils.dom.getFastTextWidth(this.textElement_,r.FIELD_TEXT_FONTSIZE,r.FIELD_TEXT_FONTWEIGHT,r.FIELD_TEXT_FONTFAMILY)),this.borderRect_&&(c=Math.max(c,r.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=c,this.size_.width=l,this.positionTextElement_(e,p),this.positionBorderRect_()},o.Field.prototype.positionTextElement_=function(e,r){if(this.textElement_){var l=this.getConstants(),c=this.size_.height/2;this.textElement_.setAttribute("x",this.sourceBlock_.RTL?this.size_.width-r-e:e),this.textElement_.setAttribute("y",l.FIELD_TEXT_BASELINE_CENTER?c:c-l.FIELD_TEXT_HEIGHT/2+l.FIELD_TEXT_BASELINE)}},o.Field.prototype.positionBorderRect_=function(){this.borderRect_&&(this.borderRect_.setAttribute("width",this.size_.width),this.borderRect_.setAttribute("height",this.size_.height),this.borderRect_.setAttribute("rx",this.getConstants().FIELD_BORDER_RECT_RADIUS),this.borderRect_.setAttribute("ry",this.getConstants().FIELD_BORDER_RECT_RADIUS))},o.Field.prototype.getSize=function(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0==this.size_.width&&(console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."),this.render_()),this.size_):new o.utils.Size(0,0)},o.Field.prototype.getScaledBBox=function(){if(this.borderRect_)e=this.borderRect_.getBoundingClientRect(),l=o.utils.style.getPageOffset(this.borderRect_),c=e.width,e=e.height;else{var e=this.sourceBlock_.getHeightWidth(),r=this.sourceBlock_.workspace.scale,l=this.getAbsoluteXY_(),c=e.width*r;e=e.height*r,o.utils.userAgent.GECKO?(l.x+=1.5*r,l.y+=1.5*r):o.utils.userAgent.EDGE||o.utils.userAgent.IE||(l.x-=.5*r,l.y-=.5*r),c+=1*r,e+=1*r}return new o.utils.Rect(l.y,l.y+e,l.x,l.x+c)},o.Field.prototype.getDisplayText_=function(){var e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"\u2026"),e=e.replace(/\s/g,o.Field.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="\u200f"),e):o.Field.NBSP},o.Field.prototype.getText=function(){if(this.getText_){var e=this.getText_.call(this);if(null!==e)return String(e)}return String(this.getValue())},o.Field.prototype.markDirty=function(){this.isDirty_=!0,this.constants_=null},o.Field.prototype.forceRerender=function(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())},o.Field.prototype.setValue=function(e){if(null!==e){var r=this.doClassValidation_(e);if(!((e=this.processValidation_(e,r))instanceof Error)){if((r=this.getValidator())&&(r=r.call(this,e),(e=this.processValidation_(e,r))instanceof Error))return;if(!(r=this.sourceBlock_)||!r.disposed){var l=this.getValue();l===e?this.doValueUpdate_(e):(r&&o.Events.isEnabled()&&o.Events.fire(new(o.Events.get(o.Events.BLOCK_CHANGE))(r,"field",this.name||null,l,e)),this.doValueUpdate_(e),this.isDirty_&&this.forceRerender())}}}},o.Field.prototype.processValidation_=function(e,r){return null===r?(this.doValueInvalid_(e),this.isDirty_&&this.forceRerender(),Error()):(void 0!==r&&(e=r),e)},o.Field.prototype.getValue=function(){return this.value_},o.Field.prototype.doClassValidation_=function(e){return null==e?null:e},o.Field.prototype.doValueUpdate_=function(e){this.value_=e,this.isDirty_=!0},o.Field.prototype.doValueInvalid_=function(e){},o.Field.prototype.onMouseDown_=function(e){this.sourceBlock_&&this.sourceBlock_.workspace&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)},o.Field.prototype.setTooltip=function(e){e||""===e||(e=this.sourceBlock_);var r=this.getClickTarget_();r?r.tooltip=e:this.tooltip_=e},o.Field.prototype.getTooltip=function(){var e=this.getClickTarget_();return o.Tooltip.getTooltipOfObject(e||{tooltip:this.tooltip_})},o.Field.prototype.getClickTarget_=function(){return this.clickTarget_||this.getSvgRoot()},o.Field.prototype.getAbsoluteXY_=function(){return o.utils.style.getPageOffset(this.getClickTarget_())},o.Field.prototype.referencesVariables=function(){return!1},o.Field.prototype.getParentInput=function(){for(var e=null,r=this.sourceBlock_,l=r.inputList,c=0;c<r.inputList.length;c++)for(var p=l[c],_=p.fieldRow,v=0;v<_.length;v++)if(_[v]===this){e=p;break}return e},o.Field.prototype.getFlipRtl=function(){return!1},o.Field.prototype.isTabNavigable=function(){return!1},o.Field.prototype.onShortcut=function(e){return!1},o.Field.prototype.setCursorSvg=function(e){e?(this.fieldGroup_.appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null},o.Field.prototype.setMarkerSvg=function(e){e?(this.fieldGroup_.appendChild(e),this.markerSvg_=e):this.markerSvg_=null},o.Field.prototype.updateMarkers_=function(){var e=this.sourceBlock_.workspace;e.keyboardAccessibilityMode&&this.cursorSvg_&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg_&&e.getMarker(o.MarkerManager.LOCAL_MARKER).draw()},o.FieldLabel=function(e,r,l){this.class_=null,o.FieldLabel.superClass_.constructor.call(this,e,null,l),l||(this.class_=r||null)},o.utils.object.inherits(o.FieldLabel,o.Field),o.FieldLabel.prototype.DEFAULT_VALUE="",o.FieldLabel.fromJson=function(e){var r=o.utils.replaceMessageReferences(e.text);return new o.FieldLabel(r,void 0,e)},o.FieldLabel.prototype.EDITABLE=!1,o.FieldLabel.prototype.configure_=function(e){o.FieldLabel.superClass_.configure_.call(this,e),this.class_=e.class},o.FieldLabel.prototype.initView=function(){this.createTextElement_(),this.class_&&o.utils.dom.addClass(this.textElement_,this.class_)},o.FieldLabel.prototype.doClassValidation_=function(e){return null==e?null:String(e)},o.FieldLabel.prototype.setClass=function(e){this.textElement_&&(this.class_&&o.utils.dom.removeClass(this.textElement_,this.class_),e&&o.utils.dom.addClass(this.textElement_,e)),this.class_=e},o.fieldRegistry.register("field_label",o.FieldLabel),o.Input=function(e,r,l,c){if(e!=o.inputTypes.DUMMY&&!r)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=e,this.name=r,this.sourceBlock_=l,this.connection=c,this.fieldRow=[]},o.Input.prototype.align=o.constants.ALIGN.LEFT,o.Input.prototype.visible_=!0,o.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},o.Input.prototype.appendField=function(e,r){return this.insertFieldAt(this.fieldRow.length,e,r),this},o.Input.prototype.insertFieldAt=function(e,r,l){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(r||""==r&&l)&&("string"==typeof r&&(r=o.fieldRegistry.fromJson({type:"field_label",text:r})),r.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&(r.init(),r.applyColour()),r.name=l,r.setVisible(this.isVisible()),r.prefixField&&(e=this.insertFieldAt(e,r.prefixField)),this.fieldRow.splice(e,0,r),++e,r.suffixField&&(e=this.insertFieldAt(e,r.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours())),e},o.Input.prototype.removeField=function(e,r){for(var c,l=0;c=this.fieldRow[l];l++)if(c.name===e)return c.dispose(),this.fieldRow.splice(l,1),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;if(r)return!1;throw Error('Field "'+e+'" not found.')},o.Input.prototype.isVisible=function(){return this.visible_},o.Input.prototype.setVisible=function(e){var r=[];if(this.visible_==e)return r;this.visible_=e;for(var c,l=0;c=this.fieldRow[l];l++)c.setVisible(e);return this.connection&&(this.connection=this.connection,e?r=this.connection.startTrackingAll():this.connection.stopTrackingAll(),l=this.connection.targetBlock())&&(l.getSvgRoot().style.display=e?"block":"none"),r},o.Input.prototype.markDirty=function(){for(var r,e=0;r=this.fieldRow[e];e++)r.markDirty()},o.Input.prototype.setCheck=function(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this},o.Input.prototype.setAlign=function(e){return this.align=e,this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render()),this},o.Input.prototype.setShadowDom=function(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this},o.Input.prototype.getShadowDom=function(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()},o.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init()},o.Input.prototype.dispose=function(){for(var r,e=0;r=this.fieldRow[e];e++)r.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},o.Block=function(e,r,l){if(o.Generator&&void 0!==o.Generator.prototype[r])throw Error('Block prototypeName "'+r+'" conflicts with Blockly.Generator members.');if(this.id=l&&!e.getBlockById(l)?l:o.utils.genUid(),e.setBlockById(this.id,this),this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=this.outputShape_=null,this.commentModel={text:null,pinned:!1,size:new o.utils.Size(160,80)},this.xy_=new o.utils.Coordinate(0,0),this.workspace=e,this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,this.isInsertionMarker_=!1,this.hat=void 0,this.rendered=null,this.statementInputCount=0,r){if(this.type=r,!(l=o.Blocks[r])||"object"!=typeof l)throw TypeError("Unknown block type: "+r);o.utils.object.mixin(this,l)}e.addTopBlock(this),e.addTypedBlock(this),(e=o.Events.getGroup())||o.Events.setGroup(!0),r=o.Events.recordUndo;try{"function"==typeof this.init&&(o.Events.recordUndo=!1,this.init(),o.Events.recordUndo=r),o.Events.isEnabled()&&o.Events.fire(new(o.Events.get(o.Events.BLOCK_CREATE))(this))}finally{e||o.Events.setGroup(!1),o.Events.recordUndo=r}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)},o.Block.COLLAPSED_INPUT_NAME=o.constants.COLLAPSED_INPUT_NAME,o.Block.COLLAPSED_FIELD_NAME=o.constants.COLLAPSED_FIELD_NAME,o.Block.prototype.data=null,o.Block.prototype.disposed=!1,o.Block.prototype.hue_=null,o.Block.prototype.colour_="#000000",o.Block.prototype.styleName_="",o.Block.prototype.dispose=function(e){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(e),o.Events.isEnabled()&&o.Events.fire(new(o.Events.get(o.Events.BLOCK_DELETE))(this)),o.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.workspace=null),o.selected==this&&(o.selected=null);for(var r=this.childBlocks_.length-1;0<=r;r--)this.childBlocks_[r].dispose(!1);r=0;for(var l;l=this.inputList[r];r++)l.dispose();this.inputList.length=0;var p,c=this.getConnections_(!0);for(r=0;p=c[r];r++)p.dispose()}finally{o.Events.enable(),this.disposed=!0}}},o.Block.prototype.initModel=function(){for(var r,e=0;r=this.inputList[e];e++)for(var c,l=0;c=r.fieldRow[l];l++)c.initModel&&c.initModel()},o.Block.prototype.unplug=function(e){this.outputConnection?this.unplugFromRow_(e):this.previousConnection&&this.unplugFromStack_(e)},o.Block.prototype.unplugFromRow_=function(e){var r=null;this.outputConnection.isConnected()&&(r=this.outputConnection.targetConnection,this.outputConnection.disconnect()),r&&e&&(e=this.getOnlyValueConnection_())&&e.isConnected()&&!e.targetBlock().isShadow()&&((e=e.targetConnection).disconnect(),this.workspace.connectionChecker.canConnect(e,r,!1)?r.connect(e):e.onFailedConnect(r))},o.Block.prototype.getOnlyValueConnection_=function(){for(var e=null,r=0;r<this.inputList.length;r++){var l=this.inputList[r].connection;if(l&&l.type==o.connectionTypes.INPUT_VALUE&&l.targetConnection){if(e)return null;e=l}}return e},o.Block.prototype.unplugFromStack_=function(e){var r=null;this.previousConnection.isConnected()&&(r=this.previousConnection.targetConnection,this.previousConnection.disconnect());var l=this.getNextBlock();e&&l&&!l.isShadow()&&((e=this.nextConnection.targetConnection).disconnect(),r&&this.workspace.connectionChecker.canConnect(r,e,!1)&&r.connect(e))},o.Block.prototype.getConnections_=function(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(var l,r=0;l=this.inputList[r];r++)l.connection&&e.push(l.connection);return e},o.Block.prototype.lastConnectionInStack=function(e){for(var r=this.nextConnection;r;){var l=r.targetBlock();if(!l||e&&l.isShadow())return r;r=l.nextConnection}return null},o.Block.prototype.bumpNeighbours=function(){},o.Block.prototype.getParent=function(){return this.parentBlock_},o.Block.prototype.getInputWithBlock=function(e){for(var l,r=0;l=this.inputList[r];r++)if(l.connection&&l.connection.targetBlock()==e)return l;return null},o.Block.prototype.getSurroundParent=function(){var e=this;do{var r=e;if(!(e=e.getParent()))return null}while(e.getNextBlock()==r);return e},o.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},o.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},o.Block.prototype.getFirstStatementConnection=function(){for(var r,e=0;r=this.inputList[e];e++)if(r.connection&&r.connection.type==o.connectionTypes.NEXT_STATEMENT)return r.connection;return null},o.Block.prototype.getRootBlock=function(){var e=this;do{var r=e;e=r.parentBlock_}while(e);return r},o.Block.prototype.getTopStackBlock=function(){var e=this;do{var r=e.getPreviousBlock()}while(r&&r.getNextBlock()==e&&(e=r));return e},o.Block.prototype.getChildren=function(e){if(!e)return this.childBlocks_;e=[];for(var l,r=0;l=this.inputList[r];r++)l.connection&&(l=l.connection.targetBlock())&&e.push(l);return(r=this.getNextBlock())&&e.push(r),e},o.Block.prototype.setParent=function(e){if(e!=this.parentBlock_){if(this.parentBlock_){if(o.utils.arrayRemove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw Error("Still connected to previous block.");if(this.outputConnection&&this.outputConnection.isConnected())throw Error("Still connected to parent block.");this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}},o.Block.prototype.getDescendants=function(e){for(var c,r=[this],l=this.getChildren(e),p=0;c=l[p];p++)r.push.apply(r,c.getDescendants(e));return r},o.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},o.Block.prototype.setDeletable=function(e){this.deletable_=e},o.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},o.Block.prototype.setMovable=function(e){this.movable_=e},o.Block.prototype.isDuplicatable=function(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(o.utils.getBlockTypeCounts(this,!0))},o.Block.prototype.isShadow=function(){return this.isShadow_},o.Block.prototype.setShadow=function(e){this.isShadow_=e},o.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},o.Block.prototype.setInsertionMarker=function(e){this.isInsertionMarker_=e},o.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},o.Block.prototype.setEditable=function(e){this.editable_=e,e=0;for(var r;r=this.inputList[e];e++)for(var c,l=0;c=r.fieldRow[l];l++)c.updateEditable()},o.Block.prototype.isDisposed=function(){return this.disposed},o.Block.prototype.getMatchingConnection=function(e,r){var l=this.getConnections_(!0);if(e=e.getConnections_(!0),l.length!=e.length)throw Error("Connection lists did not match in length.");for(var c=0;c<e.length;c++)if(e[c]==r)return l[c];return null},o.Block.prototype.setHelpUrl=function(e){this.helpUrl=e},o.Block.prototype.setTooltip=function(e){this.tooltip=e},o.Block.prototype.getTooltip=function(){return o.Tooltip.getTooltipOfObject(this)},o.Block.prototype.getColour=function(){return this.colour_},o.Block.prototype.getStyleName=function(){return this.styleName_},o.Block.prototype.getHue=function(){return this.hue_},o.Block.prototype.setColour=function(e){e=o.utils.parseBlockColour(e),this.hue_=e.hue,this.colour_=e.hex},o.Block.prototype.setStyle=function(e){this.styleName_=e},o.Block.prototype.setOnChange=function(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=e)&&(this.onchangeWrapper_=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},o.Block.prototype.getField=function(e){if("string"!=typeof e)throw TypeError("Blockly.Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(var l,r=0;l=this.inputList[r];r++)for(var p,c=0;p=l.fieldRow[c];c++)if(p.name===e)return p;return null},o.Block.prototype.getVars=function(){for(var l,e=[],r=0;l=this.inputList[r];r++)for(var p,c=0;p=l.fieldRow[c];c++)p.referencesVariables()&&e.push(p.getValue());return e},o.Block.prototype.getVarModels=function(){for(var l,e=[],r=0;l=this.inputList[r];r++)for(var p,c=0;p=l.fieldRow[c];c++)p.referencesVariables()&&(p=this.workspace.getVariableById(p.getValue()))&&e.push(p);return e},o.Block.prototype.updateVarName=function(e){for(var l,r=0;l=this.inputList[r];r++)for(var p,c=0;p=l.fieldRow[c];c++)p.referencesVariables()&&e.getId()==p.getValue()&&p.refreshVariableName()},o.Block.prototype.renameVarById=function(e,r){for(var c,l=0;c=this.inputList[l];l++)for(var _,p=0;_=c.fieldRow[p];p++)_.referencesVariables()&&e==_.getValue()&&_.setValue(r)},o.Block.prototype.getFieldValue=function(e){return(e=this.getField(e))?e.getValue():null},o.Block.prototype.setFieldValue=function(e,r){var l=this.getField(r);if(!l)throw Error('Field "'+r+'" not found.');l.setValue(e)},o.Block.prototype.setPreviousStatement=function(e,r){if(e){if(void 0===r&&(r=null),!this.previousConnection){if(this.outputConnection)throw Error("Remove output connection prior to adding previous connection.");this.previousConnection=this.makeConnection_(o.connectionTypes.PREVIOUS_STATEMENT)}this.previousConnection.setCheck(r)}else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}},o.Block.prototype.setNextStatement=function(e,r){if(e)void 0===r&&(r=null),this.nextConnection||(this.nextConnection=this.makeConnection_(o.connectionTypes.NEXT_STATEMENT)),this.nextConnection.setCheck(r);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}},o.Block.prototype.setOutput=function(e,r){if(e){if(void 0===r&&(r=null),!this.outputConnection){if(this.previousConnection)throw Error("Remove previous connection prior to adding output connection.");this.outputConnection=this.makeConnection_(o.connectionTypes.OUTPUT_VALUE)}this.outputConnection.setCheck(r)}else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}},o.Block.prototype.setInputsInline=function(e){this.inputsInline!=e&&(o.Events.fire(new(o.Events.get(o.Events.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)},o.Block.prototype.getInputsInline=function(){if(null!=this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type==o.inputTypes.DUMMY&&this.inputList[e].type==o.inputTypes.DUMMY)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type==o.inputTypes.VALUE&&this.inputList[e].type==o.inputTypes.DUMMY)return!0;return!1},o.Block.prototype.setOutputShape=function(e){this.outputShape_=e},o.Block.prototype.getOutputShape=function(){return this.outputShape_},o.Block.prototype.isEnabled=function(){return!this.disabled},o.Block.prototype.setEnabled=function(e){this.isEnabled()!=e&&(o.Events.fire(new(o.Events.get(o.Events.BLOCK_CHANGE))(this,"disabled",null,this.disabled,!e)),this.disabled=!e)},o.Block.prototype.getInheritedDisabled=function(){for(var e=this.getSurroundParent();e;){if(e.disabled)return!0;e=e.getSurroundParent()}return!1},o.Block.prototype.isCollapsed=function(){return this.collapsed_},o.Block.prototype.setCollapsed=function(e){this.collapsed_!=e&&(o.Events.fire(new(o.Events.get(o.Events.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)},o.Block.prototype.toString=function(e,r){function l(F){var X=F.getCheck();return!X&&F.targetConnection&&(X=F.targetConnection.getCheck()),!!X&&(-1!=X.indexOf("Boolean")||-1!=X.indexOf("Number"))}function c(){v&&v.getType()==b.getType()&&v.getLocation()==b.getLocation()&&(v=null)}var p=[];r=r||"?";var _=o.ASTNode.NAVIGATE_ALL_FIELDS;o.ASTNode.NAVIGATE_ALL_FIELDS=!0;for(var v=o.ASTNode.createBlockNode(this),b=v;v;){switch(v.getType()){case o.ASTNode.types.INPUT:var w=v.getLocation();v.in()?l(w)&&p.push("("):p.push(r);break;case o.ASTNode.types.FIELD:(w=v.getLocation()).name!=o.constants.COLLAPSED_FIELD_NAME&&p.push(w.getText())}if(!(v=(w=v).in()||w.next())){for(v=w.out(),c();v&&!v.next();)v=v.out(),c(),v&&v.getType()==o.ASTNode.types.INPUT&&l(v.getLocation())&&p.push(")");v&&(v=v.next())}}for(o.ASTNode.NAVIGATE_ALL_FIELDS=_,r=2;r<p.length;r++)"("==p[r-2]&&")"==p[r]&&(p[r-2]=p[r-1],p.splice(r-1,2));return p=(p=p.reduce(function(F,X){return F+("("==F.substr(-1)||")"==X?"":" ")+X},"")).trim()||"???",e&&p.length>e&&(p=p.substring(0,e-3)+"..."),p},o.Block.prototype.appendValueInput=function(e){return this.appendInput_(o.inputTypes.VALUE,e)},o.Block.prototype.appendStatementInput=function(e){return this.appendInput_(o.inputTypes.STATEMENT,e)},o.Block.prototype.appendDummyInput=function(e){return this.appendInput_(o.inputTypes.DUMMY,e||"")},o.Block.prototype.jsonInit=function(e){var r=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(r+"Must not have both an output and a previousStatement.");if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(r+"Must not have both a colour and a style.");e.style?this.jsonInitStyle_(e,r):this.jsonInitColour_(e,r);for(var l=0;void 0!==e["message"+l];)this.interpolate_(e["message"+l],e["args"+l]||[],e["lastDummyAlign"+l],r),l++;if(void 0!==e.inputsInline&&this.setInputsInline(e.inputsInline),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(l=o.utils.replaceMessageReferences(l=e.tooltip),this.setTooltip(l)),void 0!==e.enableContextMenu&&(this.contextMenu=!!(l=e.enableContextMenu)),void 0!==e.helpUrl&&(l=o.utils.replaceMessageReferences(l=e.helpUrl),this.setHelpUrl(l)),"string"==typeof e.extensions&&(console.warn(r+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&o.Extensions.apply(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(r=0;r<e.length;++r)o.Extensions.apply(e[r],this,!1)},o.Block.prototype.jsonInitColour_=function(e,r){if("colour"in e)if(void 0===e.colour)console.warn(r+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch(l){console.warn(r+"Illegal colour value: ",e)}}},o.Block.prototype.jsonInitStyle_=function(e,r){e=e.style;try{this.setStyle(e)}catch(l){console.warn(r+"Style does not exist: ",e)}},o.Block.prototype.mixin=function(e,r){if(void 0!==r&&"boolean"!=typeof r)throw Error("opt_disableCheck must be a boolean if provided");if(!r){for(var l in r=[],e)void 0!==this[l]&&r.push(l);if(r.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(r))}o.utils.object.mixin(this,e)},o.Block.prototype.interpolate_=function(e,r,l,c){e=o.utils.tokenizeInterpolation(e),this.validateTokens_(e,r.length),r=this.interpolateArguments_(e,r,l),l=[],e=0;for(var p;p=r[e];e++)if(this.isInputKeyword_(p.type)){if(p=this.inputFromJson_(p,c)){for(var v,_=0;v=l[_];_++)p.appendField(v[0],v[1]);l.length=0}}else(_=this.fieldFromJson_(p))&&l.push([_,p.name])},o.Block.prototype.validateTokens_=function(e,r){for(var l=[],c=0,p=0;p<e.length;p++){var _=e[p];if("number"==typeof _){if(1>_||_>r)throw Error('Block "'+this.type+'": Message index %'+_+" out of range.");if(l[_])throw Error('Block "'+this.type+'": Message index %'+_+" duplicated.");l[_]=!0,c++}}if(c!=r)throw Error('Block "'+this.type+'": Message does not reference all '+r+" arg(s).")},o.Block.prototype.interpolateArguments_=function(e,r,l){for(var c=[],p=0;p<e.length;p++){var _=e[p];"number"==typeof _&&(_=r[_-1]),("string"!=typeof _||(_=this.stringToFieldJson_(_)))&&c.push(_)}return(e=c.length)&&!this.isInputKeyword_(c[e-1].type)&&(e={type:"input_dummy"},l&&(e.align=l),c.push(e)),c},o.Block.prototype.fieldFromJson_=function(e){var r=o.fieldRegistry.fromJson(e);return!r&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson_(e.alt))?this.fieldFromJson_(e):null:this.fieldFromJson_(e.alt):r},o.Block.prototype.inputFromJson_=function(e,r){var l={LEFT:o.constants.ALIGN.LEFT,RIGHT:o.constants.ALIGN.RIGHT,CENTRE:o.constants.ALIGN.CENTRE,CENTER:o.constants.ALIGN.CENTRE},c=null;switch(e.type){case"input_value":c=this.appendValueInput(e.name);break;case"input_statement":c=this.appendStatementInput(e.name);break;case"input_dummy":c=this.appendDummyInput(e.name)}return c?(e.check&&c.setCheck(e.check),e.align&&(void 0===(l=l[e.align.toUpperCase()])?console.warn(r+"Illegal align value: ",e.align):c.setAlign(l)),c):null},o.Block.prototype.isInputKeyword_=function(e){return"input_value"==e||"input_statement"==e||"input_dummy"==e},o.Block.prototype.stringToFieldJson_=function(e){return(e=e.trim())?{type:"field_label",text:e}:null},o.Block.prototype.appendInput_=function(e,r){var l=null;return(e==o.inputTypes.VALUE||e==o.inputTypes.STATEMENT)&&(l=this.makeConnection_(e)),e==o.inputTypes.STATEMENT&&this.statementInputCount++,e=new o.Input(e,r,this,l),this.inputList.push(e),e},o.Block.prototype.moveInputBefore=function(e,r){if(e!=r){for(var _,l=-1,c=r?-1:this.inputList.length,p=0;_=this.inputList[p];p++)if(_.name==e){if(l=p,-1!=c)break}else if(r&&_.name==r&&(c=p,-1!=l))break;if(-1==l)throw Error('Named input "'+e+'" not found.');if(-1==c)throw Error('Reference input "'+r+'" not found.');this.moveNumberedInputBefore(l,c)}},o.Block.prototype.moveNumberedInputBefore=function(e,r){if(e==r)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(r>this.inputList.length)throw RangeError("Reference input "+r+" out of bounds.");var l=this.inputList[e];this.inputList.splice(e,1),e<r&&r--,this.inputList.splice(r,0,l)},o.Block.prototype.removeInput=function(e,r){for(var c,l=0;c=this.inputList[l];l++)if(c.name==e)return c.type==o.inputTypes.STATEMENT&&this.statementInputCount--,c.dispose(),this.inputList.splice(l,1),!0;if(r)return!1;throw Error("Input not found: "+e)},o.Block.prototype.getInput=function(e){for(var l,r=0;l=this.inputList[r];r++)if(l.name==e)return l;return null},o.Block.prototype.getInputTargetBlock=function(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()},o.Block.prototype.getCommentText=function(){return this.commentModel.text},o.Block.prototype.setCommentText=function(e){this.commentModel.text!=e&&(o.Events.fire(new(o.Events.get(o.Events.BLOCK_CHANGE))(this,"comment",null,this.commentModel.text,e)),this.comment=this.commentModel.text=e)},o.Block.prototype.setWarningText=function(e,r){},o.Block.prototype.setMutator=function(e){},o.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},o.Block.prototype.moveBy=function(e,r){if(this.parentBlock_)throw Error("Block has parent.");var l=new(o.Events.get(o.Events.BLOCK_MOVE))(this);this.xy_.translate(e,r),l.recordNew(),o.Events.fire(l)},o.Block.prototype.makeConnection_=function(e){return new o.Connection(this,e)},o.Block.prototype.allInputsFilled=function(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(var l,r=0;l=this.inputList[r];r++)if(l.connection&&(!(l=l.connection.targetBlock())||!l.allInputsFilled(e)))return!1;return!(r=this.getNextBlock())||r.allInputsFilled(e)},o.Block.prototype.toDevString=function(){var e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e},o.blockRendering.IPathObject=function(e,r){},o.utils.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},o.Menu=function(){this.menuItems_=[],this.roleName_=this.element_=this.onKeyDownHandler_=this.mouseLeaveHandler_=this.mouseEnterHandler_=this.clickHandler_=this.mouseOverHandler_=this.highlightedItem_=this.openingCoords=null},o.Menu.prototype.addChild=function(e){this.menuItems_.push(e)},o.Menu.prototype.render=function(e){var r=document.createElement("div");r.className="blocklyMenu goog-menu blocklyNonSelectable",r.tabIndex=0,this.roleName_&&o.utils.aria.setRole(r,this.roleName_),this.element_=r;for(var c,l=0;c=this.menuItems_[l];l++)r.appendChild(c.createDom());this.mouseOverHandler_=o.browserEvents.conditionalBind(r,"mouseover",this,this.handleMouseOver_,!0),this.clickHandler_=o.browserEvents.conditionalBind(r,"click",this,this.handleClick_,!0),this.mouseEnterHandler_=o.browserEvents.conditionalBind(r,"mouseenter",this,this.handleMouseEnter_,!0),this.mouseLeaveHandler_=o.browserEvents.conditionalBind(r,"mouseleave",this,this.handleMouseLeave_,!0),this.onKeyDownHandler_=o.browserEvents.conditionalBind(r,"keydown",this,this.handleKeyEvent_),e.appendChild(r)},o.Menu.prototype.getElement=function(){return this.element_},o.Menu.prototype.focus=function(){var e=this.getElement();e&&(e.focus({preventScroll:!0}),o.utils.dom.addClass(e,"blocklyFocused"))},o.Menu.prototype.blur_=function(){var e=this.getElement();e&&(e.blur(),o.utils.dom.removeClass(e,"blocklyFocused"))},o.Menu.prototype.setRole=function(e){this.roleName_=e},o.Menu.prototype.dispose=function(){this.mouseOverHandler_&&(o.browserEvents.unbind(this.mouseOverHandler_),this.mouseOverHandler_=null),this.clickHandler_&&(o.browserEvents.unbind(this.clickHandler_),this.clickHandler_=null),this.mouseEnterHandler_&&(o.browserEvents.unbind(this.mouseEnterHandler_),this.mouseEnterHandler_=null),this.mouseLeaveHandler_&&(o.browserEvents.unbind(this.mouseLeaveHandler_),this.mouseLeaveHandler_=null),this.onKeyDownHandler_&&(o.browserEvents.unbind(this.onKeyDownHandler_),this.onKeyDownHandler_=null);for(var r,e=0;r=this.menuItems_[e];e++)r.dispose();this.element_=null},o.Menu.prototype.getMenuItem_=function(e){for(var r=this.getElement();e&&e!=r;){if(o.utils.dom.hasClass(e,"blocklyMenuItem"))for(var c,l=0;c=this.menuItems_[l];l++)if(c.getElement()==e)return c;e=e.parentElement}return null},o.Menu.prototype.setHighlighted=function(e){var r=this.highlightedItem_;r&&(r.setHighlighted(!1),this.highlightedItem_=null),e&&(e.setHighlighted(!0),this.highlightedItem_=e,r=this.getElement(),o.utils.style.scrollIntoContainerView(e.getElement(),r),o.utils.aria.setState(r,o.utils.aria.State.ACTIVEDESCENDANT,e.getId()))},o.Menu.prototype.highlightNext=function(){var e=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(e,1)},o.Menu.prototype.highlightPrevious=function(){var e=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(0>e?this.menuItems_.length:e,-1)},o.Menu.prototype.highlightFirst_=function(){this.highlightHelper_(-1,1)},o.Menu.prototype.highlightLast_=function(){this.highlightHelper_(this.menuItems_.length,-1)},o.Menu.prototype.highlightHelper_=function(e,r){e+=r;for(var l;l=this.menuItems_[e];){if(l.isEnabled()){this.setHighlighted(l);break}e+=r}},o.Menu.prototype.handleMouseOver_=function(e){(e=this.getMenuItem_(e.target))&&(e.isEnabled()?this.highlightedItem_!=e&&this.setHighlighted(e):this.setHighlighted(null))},o.Menu.prototype.handleClick_=function(e){var r=this.openingCoords;if(this.openingCoords=null,r&&"number"==typeof e.clientX){var l=new o.utils.Coordinate(e.clientX,e.clientY);if(1>o.utils.Coordinate.distance(r,l))return}(e=this.getMenuItem_(e.target))&&e.performAction()},o.Menu.prototype.handleMouseEnter_=function(e){this.focus()},o.Menu.prototype.handleMouseLeave_=function(e){this.getElement()&&(this.blur_(),this.setHighlighted(null))},o.Menu.prototype.handleKeyEvent_=function(e){if(this.menuItems_.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var r=this.highlightedItem_;switch(e.keyCode){case o.utils.KeyCodes.ENTER:case o.utils.KeyCodes.SPACE:r&&r.performAction();break;case o.utils.KeyCodes.UP:this.highlightPrevious();break;case o.utils.KeyCodes.DOWN:this.highlightNext();break;case o.utils.KeyCodes.PAGE_UP:case o.utils.KeyCodes.HOME:this.highlightFirst_();break;case o.utils.KeyCodes.PAGE_DOWN:case o.utils.KeyCodes.END:this.highlightLast_();break;default:return}e.preventDefault(),e.stopPropagation()}},o.Menu.prototype.getSize=function(){var e=this.getElement(),r=o.utils.style.getSize(e);return r.height=e.scrollHeight,r},o.MenuItem=function(e,r){this.content_=e,this.value_=r,this.enabled_=!0,this.element_=null,this.rightToLeft_=!1,this.roleName_=null,this.highlight_=this.checked_=this.checkable_=!1,this.actionHandler_=null},o.MenuItem.prototype.createDom=function(){var e=document.createElement("div");e.id=o.utils.IdGenerator.getNextUniqueId(),this.element_=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled_?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked_?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight_?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft_?"blocklyMenuItemRtl goog-menuitem-rtl ":"");var r=document.createElement("div");if(r.className="blocklyMenuItemContent goog-menuitem-content",this.checkable_){var l=document.createElement("div");l.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",r.appendChild(l)}return l=this.content_,"string"==typeof this.content_&&(l=document.createTextNode(this.content_)),r.appendChild(l),e.appendChild(r),this.roleName_&&o.utils.aria.setRole(e,this.roleName_),o.utils.aria.setState(e,o.utils.aria.State.SELECTED,this.checkable_&&this.checked_||!1),o.utils.aria.setState(e,o.utils.aria.State.DISABLED,!this.enabled_),e},o.MenuItem.prototype.dispose=function(){this.element_=null},o.MenuItem.prototype.getElement=function(){return this.element_},o.MenuItem.prototype.getId=function(){return this.element_.id},o.MenuItem.prototype.getValue=function(){return this.value_},o.MenuItem.prototype.setRightToLeft=function(e){this.rightToLeft_=e},o.MenuItem.prototype.setRole=function(e){this.roleName_=e},o.MenuItem.prototype.setCheckable=function(e){this.checkable_=e},o.MenuItem.prototype.setChecked=function(e){this.checked_=e},o.MenuItem.prototype.setHighlighted=function(e){this.highlight_=e;var r=this.getElement();r&&this.isEnabled()&&(e?(o.utils.dom.addClass(r,"blocklyMenuItemHighlight"),o.utils.dom.addClass(r,"goog-menuitem-highlight")):(o.utils.dom.removeClass(r,"blocklyMenuItemHighlight"),o.utils.dom.removeClass(r,"goog-menuitem-highlight")))},o.MenuItem.prototype.isEnabled=function(){return this.enabled_},o.MenuItem.prototype.setEnabled=function(e){this.enabled_=e},o.MenuItem.prototype.performAction=function(){this.isEnabled()&&this.actionHandler_&&this.actionHandler_(this)},o.MenuItem.prototype.onAction=function(e,r){this.actionHandler_=e.bind(r)},o.ContextMenu={},o.ContextMenu.currentBlock=null,o.ContextMenu.menu_=null,o.ContextMenu.show=function(e,r,l){if(o.WidgetDiv.show(o.ContextMenu,l,o.ContextMenu.dispose),r.length){var c=o.ContextMenu.populate_(r,l);o.ContextMenu.menu_=c,o.ContextMenu.position_(c,e,l),setTimeout(function(){c.focus()},1),o.ContextMenu.currentBlock=null}else o.ContextMenu.hide()},o.ContextMenu.populate_=function(e,r){var l=new o.Menu;l.setRole(o.utils.aria.Role.MENU);for(var p,c=0;p=e[c];c++){var _=new o.MenuItem(p.text);_.setRightToLeft(r),_.setRole(o.utils.aria.Role.MENUITEM),l.addChild(_),_.setEnabled(p.enabled),p.enabled&&_.onAction(function(v){o.ContextMenu.hide(),this.callback(this.scope)},p)}return l},o.ContextMenu.position_=function(e,r,l){var c=o.utils.getViewportBBox();r=new o.utils.Rect(r.clientY+c.top,r.clientY+c.top,r.clientX+c.left,r.clientX+c.left),o.ContextMenu.createWidget_(e);var p=e.getSize();l&&(r.left+=p.width,r.right+=p.width,c.left+=p.width,c.right+=p.width),o.WidgetDiv.positionWithAnchor(c,r,p,l),e.focus()},o.ContextMenu.createWidget_=function(e){e.render(o.WidgetDiv.DIV);var r=e.getElement();o.utils.dom.addClass(r,"blocklyContextMenu"),o.browserEvents.conditionalBind(r,"contextmenu",null,o.utils.noEvent),e.focus()},o.ContextMenu.hide=function(){o.WidgetDiv.hideIfOwner(o.ContextMenu),o.ContextMenu.currentBlock=null},o.ContextMenu.dispose=function(){o.ContextMenu.menu_&&(o.ContextMenu.menu_.dispose(),o.ContextMenu.menu_=null)},o.ContextMenu.callbackFactory=function(e,r){return function(){o.Events.disable();try{var l=o.Xml.domToBlock(r,e.workspace),c=e.getRelativeToSurfaceXY();c.x=e.RTL?c.x-o.SNAP_RADIUS:c.x+o.SNAP_RADIUS,c.y+=2*o.SNAP_RADIUS,l.moveBy(c.x,c.y)}finally{o.Events.enable()}o.Events.isEnabled()&&!l.isShadow()&&o.Events.fire(new(o.Events.get(o.Events.BLOCK_CREATE))(l)),l.select()}},o.ContextMenu.commentDeleteOption=function(e){return{text:o.Msg.REMOVE_COMMENT,enabled:!0,callback:function(){o.Events.setGroup(!0),e.dispose(!0,!0),o.Events.setGroup(!1)}}},o.ContextMenu.commentDuplicateOption=function(e){return{text:o.Msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){o.duplicate(e)}}},o.ContextMenu.workspaceCommentOption=function(e,r){if(!o.WorkspaceCommentSvg)throw Error("Missing require for Blockly.WorkspaceCommentSvg");var l={enabled:!o.utils.userAgent.IE};return l.text=o.Msg.ADD_COMMENT,l.callback=function(){var c=new o.WorkspaceCommentSvg(e,o.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT,o.WorkspaceCommentSvg.DEFAULT_SIZE,o.WorkspaceCommentSvg.DEFAULT_SIZE),p=e.getInjectionDiv().getBoundingClientRect();p=new o.utils.Coordinate(r.clientX-p.left,r.clientY-p.top);var _=e.getOriginOffsetInPixels();(p=o.utils.Coordinate.difference(p,_)).scale(1/e.scale),c.moveBy(p.x,p.y),e.rendered&&(c.initSvg(),c.render(),c.select())},l},o.ContextMenuRegistry=function(){o.ContextMenuRegistry.registry=this,this.registry_=Object.create(null)},o.ContextMenuRegistry.ScopeType={BLOCK:"block",WORKSPACE:"workspace"},o.ContextMenuRegistry.registry=null,o.ContextMenuRegistry.prototype.register=function(e){if(this.registry_[e.id])throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registry_[e.id]=e},o.ContextMenuRegistry.prototype.unregister=function(e){if(!this.registry_[e])throw Error('Menu item with ID "'+e+'" not found.');delete this.registry_[e]},o.ContextMenuRegistry.prototype.getItem=function(e){return this.registry_[e]||null},o.ContextMenuRegistry.prototype.getContextMenuOptions=function(e,r){var l=[],c=this.registry_;return Object.keys(c).forEach(function(p){if(e==(p=c[p]).scopeType){var _=p.preconditionFn(r);"hidden"!=_&&(p={text:"function"==typeof p.displayText?p.displayText(r):p.displayText,enabled:"enabled"==_,callback:p.callback,scope:r,weight:p.weight},l.push(p))}}),l.sort(function(p,_){return p.weight-_.weight}),l},new o.ContextMenuRegistry,o.Events.Selected=function(e,r,l){o.Events.Selected.superClass_.constructor.call(this,l),this.oldElementId=e,this.newElementId=r},o.utils.object.inherits(o.Events.Selected,o.Events.UiBase),o.Events.Selected.prototype.type=o.Events.SELECTED,o.Events.Selected.prototype.toJson=function(){var e=o.Events.Selected.superClass_.toJson.call(this);return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e},o.Events.Selected.prototype.fromJson=function(e){o.Events.Selected.superClass_.fromJson.call(this,e),this.oldElementId=e.oldElementId,this.newElementId=e.newElementId},o.registry.register(o.registry.Type.EVENT,o.Events.SELECTED,o.Events.Selected),o.IBoundedElement=function(){},o.ICopyable=function(){},o.RenderedConnection=function(e,r){o.RenderedConnection.superClass_.constructor.call(this,e,r),this.db_=e.workspace.connectionDBList[r],this.dbOpposite_=e.workspace.connectionDBList[o.OPPOSITE_TYPE[r]],this.offsetInBlock_=new o.utils.Coordinate(0,0),this.trackedState_=o.RenderedConnection.TrackedState.WILL_TRACK,this.targetConnection=null},o.utils.object.inherits(o.RenderedConnection,o.Connection),o.RenderedConnection.TrackedState={WILL_TRACK:-1,UNTRACKED:0,TRACKED:1},o.RenderedConnection.prototype.dispose=function(){o.RenderedConnection.superClass_.dispose.call(this),this.trackedState_==o.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)},o.RenderedConnection.prototype.getSourceBlock=function(){return o.RenderedConnection.superClass_.getSourceBlock.call(this)},o.RenderedConnection.prototype.targetBlock=function(){return o.RenderedConnection.superClass_.targetBlock.call(this)},o.RenderedConnection.prototype.distanceFrom=function(e){var r=this.x-e.x;return e=this.y-e.y,Math.sqrt(r*r+e*e)},o.RenderedConnection.prototype.bumpAwayFrom=function(e){if(!this.sourceBlock_.workspace.isDragging()){var r=this.sourceBlock_.getRootBlock();if(!r.isInFlyout){var l=!1;if(!r.isMovable()){if(!(r=e.getSourceBlock().getRootBlock()).isMovable())return;e=this,l=!0}var c=o.selected==r;c||r.addSelect();var p=e.x+o.SNAP_RADIUS+Math.floor(Math.random()*o.BUMP_RANDOMNESS)-this.x,_=e.y+o.SNAP_RADIUS+Math.floor(Math.random()*o.BUMP_RANDOMNESS)-this.y;l&&(_=-_),r.RTL&&(p=e.x-o.SNAP_RADIUS-Math.floor(Math.random()*o.BUMP_RANDOMNESS)-this.x),r.moveBy(p,_),c||r.removeSelect()}}},o.RenderedConnection.prototype.moveTo=function(e,r){this.trackedState_==o.RenderedConnection.TrackedState.WILL_TRACK?(this.db_.addConnection(this,r),this.trackedState_=o.RenderedConnection.TrackedState.TRACKED):this.trackedState_==o.RenderedConnection.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,r)),this.x=e,this.y=r},o.RenderedConnection.prototype.moveBy=function(e,r){this.moveTo(this.x+e,this.y+r)},o.RenderedConnection.prototype.moveToOffset=function(e){this.moveTo(e.x+this.offsetInBlock_.x,e.y+this.offsetInBlock_.y)},o.RenderedConnection.prototype.setOffsetInBlock=function(e,r){this.offsetInBlock_.x=e,this.offsetInBlock_.y=r},o.RenderedConnection.prototype.getOffsetInBlock=function(){return this.offsetInBlock_},o.RenderedConnection.prototype.tighten=function(){var e=this.targetConnection.x-this.x,r=this.targetConnection.y-this.y;if(0!=e||0!=r){var l=this.targetBlock(),c=l.getSvgRoot();if(!c)throw Error("block is not rendered.");c=o.utils.getRelativeXY(c),l.getSvgRoot().setAttribute("transform","translate("+(c.x-e)+","+(c.y-r)+")"),l.moveConnections(-e,-r)}},o.RenderedConnection.prototype.closest=function(e,r){return this.dbOpposite_.searchForClosest(this,e,r)},o.RenderedConnection.prototype.highlight=function(){var e=this.sourceBlock_.workspace.getRenderer().getConstants(),r=e.shapeFor(this);r=this.type==o.connectionTypes.INPUT_VALUE||this.type==o.connectionTypes.OUTPUT_VALUE?o.utils.svgPaths.moveBy(0,-(e=e.TAB_OFFSET_FROM_TOP))+o.utils.svgPaths.lineOnAxis("v",e)+r.pathDown+o.utils.svgPaths.lineOnAxis("v",e):o.utils.svgPaths.moveBy(-(e=e.NOTCH_OFFSET_LEFT-e.CORNER_RADIUS),0)+o.utils.svgPaths.lineOnAxis("h",e)+r.pathLeft+o.utils.svgPaths.lineOnAxis("h",e),e=this.sourceBlock_.getRelativeToSurfaceXY(),o.Connection.highlightedPath_=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyHighlightedConnectionPath",d:r,transform:"translate("+(this.x-e.x)+","+(this.y-e.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},o.RenderedConnection.prototype.unhighlight=function(){o.utils.dom.removeNode(o.Connection.highlightedPath_),delete o.Connection.highlightedPath_},o.RenderedConnection.prototype.setTracking=function(e){e&&this.trackedState_==o.RenderedConnection.TrackedState.TRACKED||!e&&this.trackedState_==o.RenderedConnection.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db_.addConnection(this,this.y),this.trackedState_=o.RenderedConnection.TrackedState.TRACKED):(this.trackedState_==o.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=o.RenderedConnection.TrackedState.UNTRACKED))},o.RenderedConnection.prototype.stopTrackingAll=function(){if(this.setTracking(!1),this.targetConnection)for(var e=this.targetBlock().getDescendants(!1),r=0;r<e.length;r++){for(var l=e[r],c=l.getConnections_(!0),p=0;p<c.length;p++)c[p].setTracking(!1);for(l=l.getIcons(),p=0;p<l.length;p++)l[p].setVisible(!1)}},o.RenderedConnection.prototype.startTrackingAll=function(){this.setTracking(!0);var e=[];if(this.type!=o.connectionTypes.INPUT_VALUE&&this.type!=o.connectionTypes.NEXT_STATEMENT)return e;var r=this.targetBlock();if(r){if(r.isCollapsed()){var l=[];r.outputConnection&&l.push(r.outputConnection),r.nextConnection&&l.push(r.nextConnection),r.previousConnection&&l.push(r.previousConnection)}else l=r.getConnections_(!0);for(var c=0;c<l.length;c++)e.push.apply(e,l[c].startTrackingAll());e.length||(e[0]=r)}return e},o.RenderedConnection.prototype.isConnectionAllowed=function(e,r){return o.utils.deprecation.warn("RenderedConnection.prototype.isConnectionAllowed","July 2020","July 2021","Blockly.Workspace.prototype.getConnectionChecker().canConnect"),!(this.distanceFrom(e)>r)&&o.RenderedConnection.superClass_.isConnectionAllowed.call(this,e)},o.RenderedConnection.prototype.onFailedConnect=function(e){var r=this.getSourceBlock();if(o.Events.recordUndo){var l=o.Events.getGroup();setTimeout(function(){r.isDisposed()||r.getParent()||(o.Events.setGroup(l),this.bumpAwayFrom(e),o.Events.setGroup(!1))}.bind(this),o.BUMP_DELAY)}},o.RenderedConnection.prototype.disconnectInternal_=function(e,r){o.RenderedConnection.superClass_.disconnectInternal_.call(this,e,r),e.rendered&&e.render(),r.rendered&&(r.updateDisabled(),r.render(),r.getSvgRoot().style.display="block")},o.RenderedConnection.prototype.respawnShadow_=function(){o.RenderedConnection.superClass_.respawnShadow_.call(this);var e=this.targetBlock();e&&(e.initSvg(),e.render(!1),(e=this.getSourceBlock()).rendered&&e.render())},o.RenderedConnection.prototype.neighbours=function(e){return this.dbOpposite_.getNeighbours(this,e)},o.RenderedConnection.prototype.connect_=function(e){o.RenderedConnection.superClass_.connect_.call(this,e);var r=this.getSourceBlock();e=e.getSourceBlock();var l=r.rendered,c=e.rendered;l&&r.updateDisabled(),c&&e.updateDisabled(),l&&c&&(this.type==o.connectionTypes.NEXT_STATEMENT||this.type==o.connectionTypes.PREVIOUS_STATEMENT?e.render():r.render()),(r=r.getInputWithBlock(e))&&(r=r.isVisible(),e.getSvgRoot().style.display=r?"block":"none")},o.RenderedConnection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())},o.BasicCursor=function(){o.BasicCursor.superClass_.constructor.call(this)},o.utils.object.inherits(o.BasicCursor,o.Cursor),o.BasicCursor.registrationName="basicCursor",o.BasicCursor.prototype.next=function(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null},o.BasicCursor.prototype.in=function(){return this.next()},o.BasicCursor.prototype.prev=function(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null},o.BasicCursor.prototype.out=function(){return this.prev()},o.BasicCursor.prototype.getNextNode_=function(e,r){if(!e)return null;var l=e.in()||e.next();return r(l)?l:l?this.getNextNode_(l,r):r(e=this.findSiblingOrParent_(e.out()))?e:e?this.getNextNode_(e,r):null},o.BasicCursor.prototype.getPreviousNode_=function(e,r){if(!e)return null;var l=e.prev();return r(l=l?this.getRightMostChild_(l):e.out())?l:l?this.getPreviousNode_(l,r):null},o.BasicCursor.prototype.validNode_=function(e){var r=!1;return((e=e&&e.getType())==o.ASTNode.types.OUTPUT||e==o.ASTNode.types.INPUT||e==o.ASTNode.types.FIELD||e==o.ASTNode.types.NEXT||e==o.ASTNode.types.PREVIOUS||e==o.ASTNode.types.WORKSPACE)&&(r=!0),r},o.BasicCursor.prototype.findSiblingOrParent_=function(e){return e?e.next()||this.findSiblingOrParent_(e.out()):null},o.BasicCursor.prototype.getRightMostChild_=function(e){if(!e.in())return e;for(e=e.in();e.next();)e=e.next();return this.getRightMostChild_(e)},o.registry.register(o.registry.Type.CURSOR,o.BasicCursor.registrationName,o.BasicCursor),o.TabNavigateCursor=function(){o.TabNavigateCursor.superClass_.constructor.call(this)},o.utils.object.inherits(o.TabNavigateCursor,o.BasicCursor),o.TabNavigateCursor.prototype.validNode_=function(e){var r=!1,l=e&&e.getType();return e&&(e=e.getLocation(),l==o.ASTNode.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(r=!0)),r},o.BlockSvg=function(e,r,l){this.svgGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{},null),this.svgGroup_.translate_="",this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup_,this.style),this.renderIsInProgress_=this.rendered=!1,this.workspace=e,this.previousConnection=this.nextConnection=this.outputConnection=null,this.useDragSurface_=o.utils.is3dSupported()&&!!e.getBlockDragSurface();var c=this.pathObject.svgPath;c.tooltip=this,o.Tooltip.bindMouseEvents(c),o.BlockSvg.superClass_.constructor.call(this,e,r,l),this.svgGroup_.dataset?this.svgGroup_.dataset.id=this.id:o.utils.userAgent.IE&&this.svgGroup_.setAttribute("data-id",this.id)},o.utils.object.inherits(o.BlockSvg,o.Block),o.BlockSvg.prototype.height=0,o.BlockSvg.prototype.width=0,o.BlockSvg.prototype.warningTextDb_=null,o.BlockSvg.INLINE=-1,o.BlockSvg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",o.BlockSvg.prototype.initSvg=function(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var r,e=0;r=this.inputList[e];e++)r.init();for(r=this.getIcons(),e=0;e<r.length;e++)r[e].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||o.browserEvents.conditionalBind(e,"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,e.parentNode||this.workspace.getCanvas().appendChild(e)},o.BlockSvg.prototype.getColourSecondary=function(){return this.style.colourSecondary},o.BlockSvg.prototype.getColourTertiary=function(){return this.style.colourTertiary},o.BlockSvg.prototype.getColourShadow=function(){return o.utils.deprecation.warn("BlockSvg.prototype.getColourShadow","January 2020","January 2021","style.colourSecondary"),this.getColourSecondary()},o.BlockSvg.prototype.getColourBorder=function(){return o.utils.deprecation.warn("BlockSvg.prototype.getColourBorder","January 2020","January 2021","style.colourTertiary"),{colourBorder:this.getColourTertiary(),colourLight:null,colourDark:null}},o.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(o.selected!=this){var e=null;if(o.selected){e=o.selected.id,o.Events.disable();try{o.selected.unselect()}finally{o.Events.enable()}}e=new(o.Events.get(o.Events.SELECTED))(e,this.id,this.workspace.id),o.Events.fire(e),o.selected=this,this.addSelect()}},o.BlockSvg.prototype.unselect=function(){if(o.selected==this){var e=new(o.Events.get(o.Events.SELECTED))(this.id,null,this.workspace.id);e.workspaceId=this.workspace.id,o.Events.fire(e),o.selected=null,this.removeSelect()}},o.BlockSvg.prototype.mutator=null,o.BlockSvg.prototype.comment=null,o.BlockSvg.prototype.commentIcon_=null,o.BlockSvg.prototype.warning=null,o.BlockSvg.prototype.getIcons=function(){var e=[];return this.mutator&&e.push(this.mutator),this.commentIcon_&&e.push(this.commentIcon_),this.warning&&e.push(this.warning),e},o.BlockSvg.prototype.setParent=function(e){var r=this.parentBlock_;if(e!=r){o.utils.dom.startTextWidthCache(),o.BlockSvg.superClass_.setParent.call(this,e),o.utils.dom.stopTextWidthCache();var l=this.getSvgRoot();if(!this.workspace.isClearing&&l){var c=this.getRelativeToSurfaceXY();e?(e.getSvgRoot().appendChild(l),e=this.getRelativeToSurfaceXY(),this.moveConnections(e.x-c.x,e.y-c.y)):r&&(this.workspace.getCanvas().appendChild(l),this.translate(c.x,c.y)),this.applyColour()}}},o.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var e=0,r=0,l=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null,c=this.getSvgRoot();if(c)do{var p=o.utils.getRelativeXY(c);e+=p.x,r+=p.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()==c&&(e+=(p=this.workspace.getBlockDragSurface().getSurfaceTranslation()).x,r+=p.y),c=c.parentNode}while(c&&c!=this.workspace.getCanvas()&&c!=l);return new o.utils.Coordinate(e,r)},o.BlockSvg.prototype.moveBy=function(e,r){if(this.parentBlock_)throw Error("Block has parent.");var l=o.Events.isEnabled();if(l)var c=new(o.Events.get(o.Events.BLOCK_MOVE))(this);var p=this.getRelativeToSurfaceXY();this.translate(p.x+e,p.y+r),this.moveConnections(e,r),l&&(c.recordNew(),o.Events.fire(c)),this.workspace.resizeContents()},o.BlockSvg.prototype.translate=function(e,r){this.getSvgRoot().setAttribute("transform","translate("+e+","+r+")")},o.BlockSvg.prototype.moveToDragSurface=function(){if(this.useDragSurface_){var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(e.x,e.y),(e=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(e)}},o.BlockSvg.prototype.moveTo=function(e){var r=this.getRelativeToSurfaceXY();this.moveBy(e.x-r.x,e.y-r.y)},o.BlockSvg.prototype.moveOffDragSurface=function(e){this.useDragSurface_&&(this.translate(e.x,e.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))},o.BlockSvg.prototype.moveDuringDrag=function(e){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(e.x,e.y):(this.svgGroup_.translate_="translate("+e.x+","+e.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},o.BlockSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},o.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(e&&e.shouldSnap()){var r=e.getSpacing(),l=r/2,c=this.getRelativeToSurfaceXY();e=Math.round((c.x-l)/r)*r+l-c.x,r=Math.round((c.y-l)/r)*r+l-c.y,e=Math.round(e),r=Math.round(r),0==e&&0==r||this.moveBy(e,r)}}},o.BlockSvg.prototype.getBoundingRectangle=function(){var e=this.getRelativeToSurfaceXY(),r=this.getHeightWidth();if(this.RTL)var l=e.x-r.width,c=e.x;else l=e.x,c=e.x+r.width;return new o.utils.Rect(e.y,e.y+r.height,l,c)},o.BlockSvg.prototype.markDirty=function(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(var r,e=0;r=this.inputList[e];e++)r.markDirty()},o.BlockSvg.prototype.setCollapsed=function(e){this.collapsed_!=e&&(o.BlockSvg.superClass_.setCollapsed.call(this,e),e?this.rendered&&this.render():this.updateCollapsed_())},o.BlockSvg.prototype.updateCollapsed_=function(){for(var p,e=this.isCollapsed(),r=o.constants.COLLAPSED_INPUT_NAME,l=o.constants.COLLAPSED_FIELD_NAME,c=0;p=this.inputList[c];c++)p.name!=r&&p.setVisible(!e);if(e){for(p=this.getIcons(),c=0;e=p[c];c++)e.setVisible(!1);c=this.toString(o.COLLAPSE_CHARS),(p=this.getField(l))?p.setValue(c):(p=this.getInput(r)||this.appendDummyInput(r)).appendField(new o.FieldLabel(c),l)}else this.updateDisabled(),this.removeInput(r)},o.BlockSvg.prototype.tab=function(e,r){var l=new o.TabNavigateCursor;l.setCurNode(o.ASTNode.createFieldNode(e)),e=l.getCurNode(),r?l.next():l.prev(),(r=l.getCurNode())&&r!==e&&(r.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(r))},o.BlockSvg.prototype.onMouseDown_=function(e){var r=this.workspace&&this.workspace.getGesture(e);r&&r.handleBlockStart(e,this)},o.BlockSvg.prototype.showHelp=function(){var e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)},o.BlockSvg.prototype.generateContextMenu=function(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var e=o.ContextMenuRegistry.registry.getContextMenuOptions(o.ContextMenuRegistry.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e},o.BlockSvg.prototype.showContextMenu=function(e){var r=this.generateContextMenu();r&&r.length&&(o.ContextMenu.show(e,r,this.RTL),o.ContextMenu.currentBlock=this)},o.BlockSvg.prototype.moveConnections=function(e,r){if(this.rendered){for(var l=this.getConnections_(!1),c=0;c<l.length;c++)l[c].moveBy(e,r);for(l=this.getIcons(),c=0;c<l.length;c++)l[c].computeIconLocation();for(c=0;c<this.childBlocks_.length;c++)this.childBlocks_[c].moveConnections(e,r)}},o.BlockSvg.prototype.setDragging=function(e){if(e){var r=this.getSvgRoot();r.translate_="",r.skew_="",o.draggingConnections=o.draggingConnections.concat(this.getConnections_(!0)),o.utils.dom.addClass(this.svgGroup_,"blocklyDragging")}else o.draggingConnections=[],o.utils.dom.removeClass(this.svgGroup_,"blocklyDragging");for(r=0;r<this.childBlocks_.length;r++)this.childBlocks_[r].setDragging(e)},o.BlockSvg.prototype.setMovable=function(e){o.BlockSvg.superClass_.setMovable.call(this,e),this.pathObject.updateMovable(e)},o.BlockSvg.prototype.setEditable=function(e){o.BlockSvg.superClass_.setEditable.call(this,e),e=this.getIcons();for(var r=0;r<e.length;r++)e[r].updateEditable()},o.BlockSvg.prototype.setShadow=function(e){o.BlockSvg.superClass_.setShadow.call(this,e),this.applyColour()},o.BlockSvg.prototype.setInsertionMarker=function(e){this.isInsertionMarker_!=e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))},o.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},o.BlockSvg.prototype.dispose=function(e,r){if(this.workspace){o.Tooltip.dispose(),o.Tooltip.unbindMouseEvents(this.pathObject.svgPath),o.utils.dom.startTextWidthCache();var l=this.workspace;if(o.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),o.ContextMenu.currentBlock==this&&o.ContextMenu.hide(),r&&this.rendered&&(this.unplug(e),o.blockAnimations.disposeUiEffect(this)),this.rendered=!1,this.warningTextDb_){for(var c in this.warningTextDb_)clearTimeout(this.warningTextDb_[c]);this.warningTextDb_=null}for(r=this.getIcons(),c=0;c<r.length;c++)r[c].dispose();o.BlockSvg.superClass_.dispose.call(this,!!e),o.utils.dom.removeNode(this.svgGroup_),l.resizeContents(),this.svgGroup_=null,o.utils.dom.stopTextWidthCache()}},o.BlockSvg.prototype.toCopyData=function(){if(this.isInsertionMarker_)return null;var e=o.Xml.blockToDom(this,!0);o.Xml.deleteNext(e);var r=this.getRelativeToSurfaceXY();return e.setAttribute("x",this.RTL?-r.x:r.x),e.setAttribute("y",r.y),{xml:e,source:this.workspace,typeCounts:o.utils.getBlockTypeCounts(this,!0)}},o.BlockSvg.prototype.applyColour=function(){this.pathObject.applyColour(this);for(var e=this.getIcons(),r=0;r<e.length;r++)e[r].applyColour();for(e=0;r=this.inputList[e];e++)for(var c,l=0;c=r.fieldRow[l];l++)c.applyColour()},o.BlockSvg.prototype.updateDisabled=function(){var e=this.getChildren(!1);if(this.applyColour(),!this.isCollapsed())for(var l,r=0;l=e[r];r++)l.rendered&&l.updateDisabled()},o.BlockSvg.prototype.getCommentIcon=function(){return this.commentIcon_},o.BlockSvg.prototype.setCommentText=function(e){if(!o.Comment)throw Error("Missing require for Blockly.Comment");this.commentModel.text!=e&&(o.BlockSvg.superClass_.setCommentText.call(this,e),!!this.commentIcon_==(e=null!=e)?this.commentIcon_.updateText():(e?this.comment=this.commentIcon_=new o.Comment(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))},o.BlockSvg.prototype.setWarningText=function(e,r){if(!o.Warning)throw Error("Missing require for Blockly.Warning");this.warningTextDb_||(this.warningTextDb_=Object.create(null));var l=r||"";if(l)this.warningTextDb_[l]&&(clearTimeout(this.warningTextDb_[l]),delete this.warningTextDb_[l]);else for(var c in this.warningTextDb_)clearTimeout(this.warningTextDb_[c]),delete this.warningTextDb_[c];if(this.workspace.isDragging()){var p=this;this.warningTextDb_[l]=setTimeout(function(){p.workspace&&(delete p.warningTextDb_[l],p.setWarningText(e,l))},100)}else{if(this.isInFlyout&&(e=null),r=!1,"string"==typeof e){c=this.getSurroundParent();for(var _=null;c;)c.isCollapsed()&&(_=c),c=c.getSurroundParent();_&&_.setWarningText(o.Msg.COLLAPSED_WARNINGS_WARNING,o.BlockSvg.COLLAPSED_WARNING_ID),this.warning||(this.warning=new o.Warning(this),r=!0),this.warning.setText(e,l)}else this.warning&&!l?(this.warning.dispose(),r=!0):this.warning&&(r=this.warning.getText(),this.warning.setText("",l),(c=this.warning.getText())||this.warning.dispose(),r=r!=c);r&&this.rendered&&(this.render(),this.bumpNeighbours())}},o.BlockSvg.prototype.setMutator=function(e){this.mutator&&this.mutator!==e&&this.mutator.dispose(),e&&(e.setBlock(this),this.mutator=e,e.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())},o.BlockSvg.prototype.setEnabled=function(e){this.isEnabled()!=e&&(o.BlockSvg.superClass_.setEnabled.call(this,e),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())},o.BlockSvg.prototype.setHighlighted=function(e){this.rendered&&this.pathObject.updateHighlighted(e)},o.BlockSvg.prototype.addSelect=function(){this.pathObject.updateSelected(!0)},o.BlockSvg.prototype.removeSelect=function(){this.pathObject.updateSelected(!1)},o.BlockSvg.prototype.setDeleteStyle=function(e){this.pathObject.updateDraggingDelete(e)},o.BlockSvg.prototype.getColour=function(){return this.style.colourPrimary},o.BlockSvg.prototype.setColour=function(e){o.BlockSvg.superClass_.setColour.call(this,e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()},o.BlockSvg.prototype.setStyle=function(e){var r=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,!r)throw Error("Invalid style name: "+e);this.hat=r.hat,this.pathObject.setStyle(r),this.colour_=r.colourPrimary,this.style=r,this.applyColour()},o.BlockSvg.prototype.bringToFront=function(){var e=this;do{var r=e.getSvgRoot(),l=r.parentNode,c=l.childNodes;c[c.length-1]!==r&&l.appendChild(r),e=e.getParent()}while(e)},o.BlockSvg.prototype.setPreviousStatement=function(e,r){o.BlockSvg.superClass_.setPreviousStatement.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours())},o.BlockSvg.prototype.setNextStatement=function(e,r){o.BlockSvg.superClass_.setNextStatement.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours())},o.BlockSvg.prototype.setOutput=function(e,r){o.BlockSvg.superClass_.setOutput.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours())},o.BlockSvg.prototype.setInputsInline=function(e){o.BlockSvg.superClass_.setInputsInline.call(this,e),this.rendered&&(this.render(),this.bumpNeighbours())},o.BlockSvg.prototype.removeInput=function(e,r){return e=o.BlockSvg.superClass_.removeInput.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours()),e},o.BlockSvg.prototype.moveNumberedInputBefore=function(e,r){o.BlockSvg.superClass_.moveNumberedInputBefore.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours())},o.BlockSvg.prototype.appendInput_=function(e,r){return e=o.BlockSvg.superClass_.appendInput_.call(this,e,r),this.rendered&&(this.render(),this.bumpNeighbours()),e},o.BlockSvg.prototype.setConnectionTracking=function(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var r=this.nextConnection.targetBlock();r&&r.setConnectionTracking(e)}if(!this.collapsed_)for(r=0;r<this.inputList.length;r++){var l=this.inputList[r].connection;l&&(l.setTracking(e),(l=l.targetBlock())&&l.setConnectionTracking(e))}},o.BlockSvg.prototype.getConnections_=function(e){var r=[];if((e||this.rendered)&&(this.outputConnection&&r.push(this.outputConnection),this.previousConnection&&r.push(this.previousConnection),this.nextConnection&&r.push(this.nextConnection),e||!this.collapsed_)){e=0;for(var l;l=this.inputList[e];e++)l.connection&&r.push(l.connection)}return r},o.BlockSvg.prototype.lastConnectionInStack=function(e){return o.BlockSvg.superClass_.lastConnectionInStack.call(this,e)},o.BlockSvg.prototype.getMatchingConnection=function(e,r){return o.BlockSvg.superClass_.getMatchingConnection.call(this,e,r)},o.BlockSvg.prototype.makeConnection_=function(e){return new o.RenderedConnection(this,e)},o.BlockSvg.prototype.bumpNeighbours=function(){if(this.workspace&&!this.workspace.isDragging()){var e=this.getRootBlock();if(!e.isInFlyout)for(var c,r=this.getConnections_(!1),l=0;c=r[l];l++){c.isConnected()&&c.isSuperior()&&c.targetBlock().bumpNeighbours();for(var v,p=c.neighbours(o.SNAP_RADIUS),_=0;v=p[_];_++)c.isConnected()&&v.isConnected()||v.getSourceBlock().getRootBlock()!=e&&(c.isSuperior()?v.bumpAwayFrom(c):c.bumpAwayFrom(v))}}},o.BlockSvg.prototype.scheduleSnapAndBump=function(){var e=this,r=o.Events.getGroup();setTimeout(function(){o.Events.setGroup(r),e.snapToGrid(),o.Events.setGroup(!1)},o.BUMP_DELAY/2),setTimeout(function(){o.Events.setGroup(r),e.bumpNeighbours(),o.Events.setGroup(!1)},o.BUMP_DELAY)},o.BlockSvg.prototype.positionNearConnection=function(e,r){e.type!=o.connectionTypes.NEXT_STATEMENT&&e.type!=o.connectionTypes.INPUT_VALUE||this.moveBy(r.x-e.x,r.y-e.y)},o.BlockSvg.prototype.getParent=function(){return o.BlockSvg.superClass_.getParent.call(this)},o.BlockSvg.prototype.getRootBlock=function(){return o.BlockSvg.superClass_.getRootBlock.call(this)},o.BlockSvg.prototype.render=function(e){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{if(this.rendered=!0,o.utils.dom.startTextWidthCache(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),!1!==e){var r=this.getParent();r?r.render(!0):this.workspace.resizeContents()}o.utils.dom.stopTextWidthCache(),this.updateMarkers_()}finally{this.renderIsInProgress_=!1}}},o.BlockSvg.prototype.updateMarkers_=function(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(o.MarkerManager.LOCAL_MARKER).draw()},o.BlockSvg.prototype.updateConnectionLocations_=function(){var e=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(e),this.outputConnection&&this.outputConnection.moveToOffset(e);for(var r=0;r<this.inputList.length;r++){var l=this.inputList[r].connection;l&&(l.moveToOffset(e),l.isConnected()&&l.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(e),this.nextConnection.isConnected()&&this.nextConnection.tighten())},o.BlockSvg.prototype.setCursorSvg=function(e){this.pathObject.setCursorSvg(e)},o.BlockSvg.prototype.setMarkerSvg=function(e){this.pathObject.setMarkerSvg(e)},o.BlockSvg.prototype.getHeightWidth=function(){var e=this.height,r=this.width,l=this.getNextBlock();if(l){l=l.getHeightWidth();var c=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=l.height-c,r=Math.max(r,l.width)}return{height:e,width:r}},o.BlockSvg.prototype.fadeForReplacement=function(e){this.pathObject.updateReplacementFade(e)},o.BlockSvg.prototype.highlightShapeForInput=function(e,r){this.pathObject.updateShapeForInputHighlight(e,r)},o.ConnectionDB=function(e){this.connections_=[],this.connectionChecker_=e},o.ConnectionDB.prototype.addConnection=function(e,r){r=this.calculateIndexForYPos_(r),this.connections_.splice(r,0,e)},o.ConnectionDB.prototype.findIndexOfConnection_=function(e,r){if(!this.connections_.length)return-1;var l=this.calculateIndexForYPos_(r);if(l>=this.connections_.length)return-1;r=e.y;for(var c=l;0<=c&&this.connections_[c].y==r;){if(this.connections_[c]==e)return c;c--}for(c=l;c<this.connections_.length&&this.connections_[c].y==r;){if(this.connections_[c]==e)return c;c++}return-1},o.ConnectionDB.prototype.calculateIndexForYPos_=function(e){if(!this.connections_.length)return 0;for(var r=0,l=this.connections_.length;r<l;){var c=Math.floor((r+l)/2);if(this.connections_[c].y<e)r=c+1;else{if(!(this.connections_[c].y>e)){r=c;break}l=c}}return r},o.ConnectionDB.prototype.removeConnection=function(e,r){if(-1==(e=this.findIndexOfConnection_(e,r)))throw Error("Unable to find connection in connectionDB.");this.connections_.splice(e,1)},o.ConnectionDB.prototype.getNeighbours=function(e,r){function l(F){var X=p-c[F].x,xe=_-c[F].y;return Math.sqrt(X*X+xe*xe)<=r&&w.push(c[F]),xe<r}var c=this.connections_,p=e.x,_=e.y;e=0;for(var v=c.length-2,b=v;e<b;)c[b].y<_?e=b:v=b,b=Math.floor((e+v)/2);var w=[];if(v=e=b,c.length){for(;0<=e&&l(e);)e--;do{v++}while(v<c.length&&l(v))}return w},o.ConnectionDB.prototype.isInYRange_=function(e,r,l){return Math.abs(this.connections_[e].y-r)<=l},o.ConnectionDB.prototype.searchForClosest=function(e,r,l){if(!this.connections_.length)return{connection:null,radius:r};var c=e.y,p=e.x;e.x=p+l.x,e.y=c+l.y;var _=this.calculateIndexForYPos_(e.y);l=null;for(var b,v=r,w=_-1;0<=w&&this.isInYRange_(w,e.y,r);)this.connectionChecker_.canConnect(e,b=this.connections_[w],!0,v)&&(l=b,v=b.distanceFrom(e)),w--;for(;_<this.connections_.length&&this.isInYRange_(_,e.y,r);)this.connectionChecker_.canConnect(e,b=this.connections_[_],!0,v)&&(l=b,v=b.distanceFrom(e)),_++;return e.x=p,e.y=c,{connection:l,radius:v}},o.ConnectionDB.init=function(e){var r=[];return r[o.connectionTypes.INPUT_VALUE]=new o.ConnectionDB(e),r[o.connectionTypes.OUTPUT_VALUE]=new o.ConnectionDB(e),r[o.connectionTypes.NEXT_STATEMENT]=new o.ConnectionDB(e),r[o.connectionTypes.PREVIOUS_STATEMENT]=new o.ConnectionDB(e),r},o.Events.ThemeChange=function(e,r){o.Events.ThemeChange.superClass_.constructor.call(this,r),this.themeName=e},o.utils.object.inherits(o.Events.ThemeChange,o.Events.UiBase),o.Events.ThemeChange.prototype.type=o.Events.THEME_CHANGE,o.Events.ThemeChange.prototype.toJson=function(){var e=o.Events.ThemeChange.superClass_.toJson.call(this);return e.themeName=this.themeName,e},o.Events.ThemeChange.prototype.fromJson=function(e){o.Events.ThemeChange.superClass_.fromJson.call(this,e),this.themeName=e.themeName},o.registry.register(o.registry.Type.EVENT,o.Events.THEME_CHANGE,o.Events.ThemeChange),o.Events.ViewportChange=function(e,r,l,c,p){o.Events.ViewportChange.superClass_.constructor.call(this,c),this.viewTop=e,this.viewLeft=r,this.scale=l,this.oldScale=p},o.utils.object.inherits(o.Events.ViewportChange,o.Events.UiBase),o.Events.ViewportChange.prototype.type=o.Events.VIEWPORT_CHANGE,o.Events.ViewportChange.prototype.toJson=function(){var e=o.Events.ViewportChange.superClass_.toJson.call(this);return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e},o.Events.ViewportChange.prototype.fromJson=function(e){o.Events.ViewportChange.superClass_.fromJson.call(this,e),this.viewTop=e.viewTop,this.viewLeft=e.viewLeft,this.scale=e.scale,this.oldScale=e.oldScale},o.registry.register(o.registry.Type.EVENT,o.Events.VIEWPORT_CHANGE,o.Events.ViewportChange),o.IMetricsManager=function(){},o.MetricsManager=function(e){this.workspace_=e},o.MetricsManager.prototype.getDimensionsPx_=function(e){var r=0,l=0;return e&&(r=e.getWidth(),l=e.getHeight()),new o.utils.Size(r,l)},o.MetricsManager.prototype.getFlyoutMetrics=function(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}},o.MetricsManager.prototype.getToolboxMetrics=function(){var e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}},o.MetricsManager.prototype.getSvgMetrics=function(){return this.workspace_.getCachedParentSvgSize()},o.MetricsManager.prototype.getAbsoluteMetrics=function(){var e=0,r=this.getToolboxMetrics(),l=this.getFlyoutMetrics(!0),c=!!this.workspace_.getToolbox(),p=!!this.workspace_.getFlyout(!0),_=c?r.position:l.position,v=_==o.utils.toolbox.Position.LEFT;return _=_==o.utils.toolbox.Position.TOP,c&&v?e=r.width:p&&v&&(e=l.width),v=0,c&&_?v=r.height:p&&_&&(v=l.height),{top:v,left:e}},o.MetricsManager.prototype.getViewMetrics=function(e){e=e?this.workspace_.scale:1;var r=this.getSvgMetrics(),l=this.getToolboxMetrics(),c=this.getFlyoutMetrics(!0),p=this.workspace_.getToolbox()?l.position:c.position;return this.workspace_.getToolbox()?p==o.utils.toolbox.Position.TOP||p==o.utils.toolbox.Position.BOTTOM?r.height-=l.height:(p==o.utils.toolbox.Position.LEFT||p==o.utils.toolbox.Position.RIGHT)&&(r.width-=l.width):this.workspace_.getFlyout(!0)&&(p==o.utils.toolbox.Position.TOP||p==o.utils.toolbox.Position.BOTTOM?r.height-=c.height:(p==o.utils.toolbox.Position.LEFT||p==o.utils.toolbox.Position.RIGHT)&&(r.width-=c.width)),{height:r.height/e,width:r.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}},o.MetricsManager.prototype.getContentMetrics=function(e){e=e?1:this.workspace_.scale;var r=this.workspace_.getBlocksBoundingBox();return{height:(r.bottom-r.top)*e,width:(r.right-r.left)*e,top:r.top*e,left:r.left*e}},o.MetricsManager.prototype.hasFixedEdges=function(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()},o.MetricsManager.prototype.getComputedFixedEdges_=function(e){if(!this.hasFixedEdges())return{};var r=this.workspace_.isMovableHorizontally(),l=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);var c={};return l||(c.top=e.top,c.bottom=e.top+e.height),r||(c.left=e.left,c.right=e.left+e.width),c},o.MetricsManager.prototype.getPaddedContent_=function(e,r){var l=r.top+r.height,c=r.left+r.width,p=e.width,_=p/2,v=(e=e.height)/2;return{top:Math.min(r.top-v,l-e),bottom:Math.max(l+v,r.top+e),left:Math.min(r.left-_,c-p),right:Math.max(c+_,r.left+p)}},o.MetricsManager.prototype.getScrollMetrics=function(e,r,l){e=e?this.workspace_.scale:1,r=r||this.getViewMetrics(!1);var c=l||this.getContentMetrics();l=this.getComputedFixedEdges_(r),r=this.getPaddedContent_(r,c);var p=void 0!==l.left?l.left:r.left;return{top:(c=void 0!==l.top?l.top:r.top)/e,left:p/e,width:((void 0!==l.right?l.right:r.right)-p)/e,height:((void 0!==l.bottom?l.bottom:r.bottom)-c)/e}},o.MetricsManager.prototype.getUiMetrics=function(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}},o.MetricsManager.prototype.getMetrics=function(){var e=this.getToolboxMetrics(),r=this.getFlyoutMetrics(!0),l=this.getSvgMetrics(),c=this.getAbsoluteMetrics(),p=this.getViewMetrics(),_=this.getContentMetrics(),v=this.getScrollMetrics(!1,p,_);return{contentHeight:_.height,contentWidth:_.width,contentTop:_.top,contentLeft:_.left,scrollHeight:v.height,scrollWidth:v.width,scrollTop:v.top,scrollLeft:v.left,viewHeight:p.height,viewWidth:p.width,viewTop:p.top,viewLeft:p.left,absoluteTop:c.top,absoluteLeft:c.left,svgHeight:l.height,svgWidth:l.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:r.width,flyoutHeight:r.height}},o.registry.register(o.registry.Type.METRICS_MANAGER,o.registry.DEFAULT,o.MetricsManager),o.FlyoutMetricsManager=function(e,r){this.flyout_=r,o.FlyoutMetricsManager.superClass_.constructor.call(this,e)},o.utils.object.inherits(o.FlyoutMetricsManager,o.MetricsManager),o.FlyoutMetricsManager.prototype.getBoundingBox_=function(){try{var e=this.workspace_.getCanvas().getBBox()}catch(r){e={height:0,y:0,width:0,x:0}}return e},o.FlyoutMetricsManager.prototype.getContentMetrics=function(e){var r=this.getBoundingBox_();return{height:r.height*(e=e?1:this.workspace_.scale),width:r.width*e,top:r.y*e,left:r.x*e}},o.FlyoutMetricsManager.prototype.getScrollMetrics=function(e,r,l){return{height:((r=l||this.getContentMetrics()).height+2*(l=this.flyout_.MARGIN*this.workspace_.scale))/(e=e?this.workspace_.scale:1),width:(r.width+r.left+l)/e,top:0,left:0}},o.ThemeManager=function(e,r){this.workspace_=e,this.theme_=r,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)},o.ThemeManager.prototype.getTheme=function(){return this.theme_},o.ThemeManager.prototype.setTheme=function(e){var l,r=this.theme_;for(this.theme_=e,(e=this.workspace_.getInjectionDiv())&&(r&&o.utils.dom.removeClass(e,r.getClassName()),o.utils.dom.addClass(e,this.theme_.getClassName())),r=0;e=this.subscribedWorkspaces_[r];r++)e.refreshTheme();for(r=0,e=Object.keys(this.componentDB_);l=e[r];r++)for(var p,c=0;p=this.componentDB_[l][c];c++){var _=p.element;p=p.propertyName;var v=this.theme_&&this.theme_.getComponentStyle(l);_.style[p]=v||""}o.hideChaff()},o.ThemeManager.prototype.subscribeWorkspace=function(e){this.subscribedWorkspaces_.push(e)},o.ThemeManager.prototype.unsubscribeWorkspace=function(e){if(0>(e=this.subscribedWorkspaces_.indexOf(e)))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");this.subscribedWorkspaces_.splice(e,1)},o.ThemeManager.prototype.subscribe=function(e,r,l){this.componentDB_[r]||(this.componentDB_[r]=[]),this.componentDB_[r].push({element:e,propertyName:l}),r=this.theme_&&this.theme_.getComponentStyle(r),e.style[l]=r||""},o.ThemeManager.prototype.unsubscribe=function(e){if(e)for(var c,r=Object.keys(this.componentDB_),l=0;c=r[l];l++){for(var p=this.componentDB_[c],_=p.length-1;0<=_;_--)p[_].element===e&&p.splice(_,1);this.componentDB_[c].length||delete this.componentDB_[c]}},o.ThemeManager.prototype.dispose=function(){this.componentDB_=this.subscribedWorkspaces_=this.theme_=this.owner_=null},o.TouchGesture=function(e,r){o.TouchGesture.superClass_.constructor.call(this,e,r),this.isMultiTouch_=!1,this.cachedPoints_=Object.create(null),this.startDistance_=this.previousScale_=0,this.isPinchZoomEnabled_=this.onStartWrapper_=null},o.utils.object.inherits(o.TouchGesture,o.Gesture),o.TouchGesture.ZOOM_IN_MULTIPLIER=5,o.TouchGesture.ZOOM_OUT_MULTIPLIER=6,o.TouchGesture.prototype.doStart=function(e){this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,o.TouchGesture.superClass_.doStart.call(this,e),!this.isEnding_&&o.Touch.isTouchEvent(e)&&this.handleTouchStart(e)},o.TouchGesture.prototype.bindMouseEvents=function(e){this.onStartWrapper_=o.browserEvents.conditionalBind(document,"mousedown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=o.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=o.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this),!0),e.preventDefault(),e.stopPropagation()},o.TouchGesture.prototype.handleStart=function(e){!this.isDragging()&&o.Touch.isTouchEvent(e)&&(this.handleTouchStart(e),this.isMultiTouch()&&o.longStop_())},o.TouchGesture.prototype.handleMove=function(e){this.isDragging()?o.Touch.shouldHandleEvent(e)&&o.TouchGesture.superClass_.handleMove.call(this,e):this.isMultiTouch()?(o.Touch.isTouchEvent(e)&&this.handleTouchMove(e),o.longStop_()):o.TouchGesture.superClass_.handleMove.call(this,e)},o.TouchGesture.prototype.handleUp=function(e){o.Touch.isTouchEvent(e)&&!this.isDragging()&&this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()?o.Touch.shouldHandleEvent(e)&&o.TouchGesture.superClass_.handleUp.call(this,e):(e.preventDefault(),e.stopPropagation(),this.dispose())},o.TouchGesture.prototype.isMultiTouch=function(){return this.isMultiTouch_},o.TouchGesture.prototype.dispose=function(){o.TouchGesture.superClass_.dispose.call(this),this.onStartWrapper_&&o.browserEvents.unbind(this.onStartWrapper_)},o.TouchGesture.prototype.handleTouchStart=function(e){var r=o.Touch.getTouchIdentifierFromEvent(e);this.cachedPoints_[r]=this.getTouchPoint(e),2==(r=Object.keys(this.cachedPoints_)).length&&(this.startDistance_=o.utils.Coordinate.distance(this.cachedPoints_[r[0]],this.cachedPoints_[r[1]]),this.isMultiTouch_=!0,e.preventDefault())},o.TouchGesture.prototype.handleTouchMove=function(e){var r=o.Touch.getTouchIdentifierFromEvent(e);this.cachedPoints_[r]=this.getTouchPoint(e),r=Object.keys(this.cachedPoints_),this.isPinchZoomEnabled_&&2===r.length?this.handlePinch_(e):o.TouchGesture.superClass_.handleMove.call(this,e)},o.TouchGesture.prototype.handlePinch_=function(e){var r=Object.keys(this.cachedPoints_);if(r=o.utils.Coordinate.distance(this.cachedPoints_[r[0]],this.cachedPoints_[r[1]])/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){var l=r-this.previousScale_;l=0<l?l*o.TouchGesture.ZOOM_IN_MULTIPLIER:l*o.TouchGesture.ZOOM_OUT_MULTIPLIER;var c=this.startWorkspace_,p=o.utils.mouseToSvg(e,c.getParentSvg(),c.getInverseScreenCTM());c.zoom(p.x,p.y,l)}this.previousScale_=r,e.preventDefault()},o.TouchGesture.prototype.handleTouchEnd=function(e){e=o.Touch.getTouchIdentifierFromEvent(e),this.cachedPoints_[e]&&delete this.cachedPoints_[e],2>Object.keys(this.cachedPoints_).length&&(this.cachedPoints_=Object.create(null),this.previousScale_=0)},o.TouchGesture.prototype.getTouchPoint=function(e){return this.startWorkspace_?new o.utils.Coordinate(e.pageX?e.pageX:e.changedTouches[0].pageX,e.pageY?e.pageY:e.changedTouches[0].pageY):null},o.WorkspaceAudio=function(e){this.parentWorkspace_=e,this.SOUNDS_=Object.create(null)},o.WorkspaceAudio.prototype.lastSound_=null,o.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},o.WorkspaceAudio.prototype.load=function(e,r){if(e.length){try{var l=new o.utils.global.Audio}catch(b){return}for(var c,p=0;p<e.length;p++){var _=e[p],v=_.match(/\.(\w+)$/);if(v&&l.canPlayType("audio/"+v[1])){c=new o.utils.global.Audio(_);break}}c&&c.play&&(this.SOUNDS_[r]=c)}},o.WorkspaceAudio.prototype.preload=function(){for(var e in this.SOUNDS_){var r=this.SOUNDS_[e];r.volume=.01;var l=r.play();if(void 0!==l?l.then(r.pause).catch(function(){}):r.pause(),o.utils.userAgent.IPAD||o.utils.userAgent.IPHONE)break}},o.WorkspaceAudio.prototype.play=function(e,r){var l=this.SOUNDS_[e];l?(e=new Date,null!=this.lastSound_&&e-this.lastSound_<o.SOUND_LIMIT||(this.lastSound_=e,(l=o.utils.userAgent.IPAD||o.utils.userAgent.ANDROID?l:l.cloneNode()).volume=void 0===r?1:r,l.play())):this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(e,r)},o.WorkspaceSvg=function(e,r,l){o.WorkspaceSvg.superClass_.constructor.call(this,e),this.metricsManager_=new(o.registry.getClassFromOptions(o.registry.Type.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager_.getMetrics.bind(this.metricsManager_),this.setMetrics=e.setMetrics||o.WorkspaceSvg.setTopLevelWorkspaceMetrics_,this.componentManager_=new o.ComponentManager,this.connectionDBList=o.ConnectionDB.init(this.connectionChecker),r&&(this.blockDragSurface_=r),l&&(this.workspaceDragSurface_=l),this.useWorkspaceDragSurface_=!!this.workspaceDragSurface_&&o.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new o.WorkspaceAudio(e.parentWorkspace),this.grid_=this.options.gridPattern?new o.Grid(this.options.gridPattern,e.gridOptions):null,this.markerManager_=new o.MarkerManager(this),this.toolboxCategoryCallbacks_=Object.create(null),this.flyoutButtonCallbacks_=Object.create(null),o.Variables&&o.Variables.flyoutCategory&&this.registerToolboxCategoryCallback(o.VARIABLE_CATEGORY_NAME,o.Variables.flyoutCategory),o.VariablesDynamic&&o.VariablesDynamic.flyoutCategory&&this.registerToolboxCategoryCallback(o.VARIABLE_DYNAMIC_CATEGORY_NAME,o.VariablesDynamic.flyoutCategory),o.Procedures&&o.Procedures.flyoutCategory&&(this.registerToolboxCategoryCallback(o.PROCEDURE_CATEGORY_NAME,o.Procedures.flyoutCategory),this.addChangeListener(o.Procedures.mutatorOpenListener)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new o.ThemeManager(this,this.options.theme||o.Themes.Classic),this.themeManager_.subscribeWorkspace(this),this.renderer_=o.blockRendering.init(this.options.renderer||"geras",this.getTheme(),this.options.rendererOverrides),this.cachedParentSvg_=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements_=[],this.dragTargetAreas_=[],this.cachedParentSvgSize_=new o.utils.Size(0,0)},o.utils.object.inherits(o.WorkspaceSvg,o.Workspace),o.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,o.WorkspaceSvg.prototype.rendered=!0,o.WorkspaceSvg.prototype.isVisible_=!0,o.WorkspaceSvg.prototype.isFlyout=!1,o.WorkspaceSvg.prototype.isMutator=!1,o.WorkspaceSvg.prototype.resizesEnabled_=!0,o.WorkspaceSvg.prototype.scrollX=0,o.WorkspaceSvg.prototype.scrollY=0,o.WorkspaceSvg.prototype.startScrollX=0,o.WorkspaceSvg.prototype.startScrollY=0,o.WorkspaceSvg.prototype.dragDeltaXY_=null,o.WorkspaceSvg.prototype.scale=1,o.WorkspaceSvg.prototype.oldScale_=1,o.WorkspaceSvg.prototype.oldTop_=0,o.WorkspaceSvg.prototype.oldLeft_=0,o.WorkspaceSvg.prototype.trashcan=null,o.WorkspaceSvg.prototype.scrollbar=null,o.WorkspaceSvg.prototype.flyout_=null,o.WorkspaceSvg.prototype.toolbox_=null,o.WorkspaceSvg.prototype.currentGesture_=null,o.WorkspaceSvg.prototype.blockDragSurface_=null,o.WorkspaceSvg.prototype.workspaceDragSurface_=null,o.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,o.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,o.WorkspaceSvg.prototype.injectionDiv_=null,o.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,o.WorkspaceSvg.prototype.targetWorkspace=null,o.WorkspaceSvg.prototype.inverseScreenCTM_=null,o.WorkspaceSvg.prototype.inverseScreenCTMDirty_=!0,o.WorkspaceSvg.prototype.getMarkerManager=function(){return this.markerManager_},o.WorkspaceSvg.prototype.getMetricsManager=function(){return this.metricsManager_},o.WorkspaceSvg.prototype.setMetricsManager=function(e){this.metricsManager_=e,this.getMetrics=this.metricsManager_.getMetrics.bind(this.metricsManager_)},o.WorkspaceSvg.prototype.getComponentManager=function(){return this.componentManager_},o.WorkspaceSvg.prototype.setCursorSvg=function(e){this.markerManager_.setCursorSvg(e)},o.WorkspaceSvg.prototype.setMarkerSvg=function(e){this.markerManager_.setMarkerSvg(e)},o.WorkspaceSvg.prototype.getMarker=function(e){return this.markerManager_?this.markerManager_.getMarker(e):null},o.WorkspaceSvg.prototype.getCursor=function(){return this.markerManager_?this.markerManager_.getCursor():null},o.WorkspaceSvg.prototype.getRenderer=function(){return this.renderer_},o.WorkspaceSvg.prototype.getThemeManager=function(){return this.themeManager_},o.WorkspaceSvg.prototype.getTheme=function(){return this.themeManager_.getTheme()},o.WorkspaceSvg.prototype.setTheme=function(e){e||(e=o.Themes.Classic),this.themeManager_.setTheme(e)},o.WorkspaceSvg.prototype.refreshTheme=function(){this.svgGroup_&&this.renderer_.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(r){return!!r.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);var e=new(o.Events.get(o.Events.THEME_CHANGE))(this.getTheme().name,this.id);o.Events.fire(e)},o.WorkspaceSvg.prototype.updateBlockStyles_=function(e){for(var l,r=0;l=e[r];r++){var c=l.getStyleName();c&&(l.setStyle(c),l.mutator&&l.mutator.updateBlockStyle())}},o.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM_=e.inverse(),this.inverseScreenCTMDirty_=!1)}return this.inverseScreenCTM_},o.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=!0},o.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_},o.WorkspaceSvg.prototype.getSvgXY=function(e){var r=0,l=0,c=1;(o.utils.dom.containsNode(this.getCanvas(),e)||o.utils.dom.containsNode(this.getBubbleCanvas(),e))&&(c=this.scale);do{var p=o.utils.getRelativeXY(e);(e==this.getCanvas()||e==this.getBubbleCanvas())&&(c=1),r+=p.x*c,l+=p.y*c,e=e.parentNode}while(e&&e!=this.getParentSvg());return new o.utils.Coordinate(r,l)},o.WorkspaceSvg.prototype.getCachedParentSvgSize=function(){var e=this.cachedParentSvgSize_;return new o.utils.Size(e.width,e.height)},o.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return o.utils.getInjectionDivXY_(this.getCanvas())},o.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var e=this.svgGroup_;e;){if(-1!=(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=e;break}e=e.parentNode}return this.injectionDiv_},o.WorkspaceSvg.prototype.getBlockCanvas=function(){return this.svgBlockCanvas_},o.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(e){this.resizeHandlerWrapper_=e},o.WorkspaceSvg.prototype.createDom=function(e){return this.svgGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blocklyWorkspace"},null),e&&(this.svgBackground_=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"==e&&this.grid_?this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(o.browserEvents.conditionalBind(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),o.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(o.registry.getClassFromOptions(o.registry.Type.TOOLBOX,this.options,!0))(this)),this.grid_&&this.grid_.update(this.scale),this.recordDragTargets(),(e=o.registry.getClassFromOptions(o.registry.Type.CURSOR,this.options))&&this.markerManager_.setCursor(new e),this.renderer_.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_},o.WorkspaceSvg.prototype.dispose=function(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&(o.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.renderer_.dispose(),this.markerManager_&&(this.markerManager_.dispose(),this.markerManager_=null),o.WorkspaceSvg.superClass_.dispose.call(this),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||(this.themeManager_.dispose(),this.themeManager_=null)),this.flyoutButtonCallbacks_=this.toolboxCategoryCallbacks_=this.connectionDBList=null,!this.options.parentWorkspace){var e=this.getParentSvg();e&&e.parentNode&&o.utils.dom.removeNode(e.parentNode)}this.resizeHandlerWrapper_&&(o.browserEvents.unbind(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},o.WorkspaceSvg.prototype.newBlock=function(e,r){return new o.BlockSvg(this,e,r)},o.WorkspaceSvg.prototype.addTrashcan=function(){if(!o.Trashcan)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new o.Trashcan(this);var e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.svgBlockCanvas_)},o.WorkspaceSvg.prototype.addZoomControls=function(){if(!o.ZoomControls)throw Error("Missing require for Blockly.ZoomControls");this.zoomControls_=new o.ZoomControls(this);var e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)},o.WorkspaceSvg.prototype.addFlyout=function(e){var r=new o.Options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return r.toolboxPosition=this.options.toolboxPosition,this.flyout_=this.horizontalLayout?new(o.registry.getClassFromOptions(o.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(r):new(o.registry.getClassFromOptions(o.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(r),this.flyout_.autoClose=!1,this.flyout_.getWorkspace().setVisible(!0),this.flyout_.createDom(e)},o.WorkspaceSvg.prototype.getFlyout=function(e){return this.flyout_||e?this.flyout_:this.toolbox_?this.toolbox_.getFlyout():null},o.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_},o.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDragTargets()},o.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},o.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position();for(var p,e=this.componentManager_.getComponents(o.ComponentManager.Capability.POSITIONABLE,!0),r=this.getMetricsManager().getUiMetrics(),l=[],c=0;p=e[c];c++)p.position(r,l),(p=p.getBoundingRectangle())&&l.push(p);this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},o.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var e=o.utils.getDocumentScroll();o.utils.Coordinate.equals(this.lastRecordedPageScroll_,e)||(this.lastRecordedPageScroll_=e,this.updateScreenCalculations_())},o.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},o.WorkspaceSvg.prototype.setCachedParentSvgSize=function(e,r){var l=this.getParentSvg();e&&(this.cachedParentSvgSize_.width=e,l.cachedWidth_=e),r&&(this.cachedParentSvgSize_.height=r,l.cachedHeight_=r)},o.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},o.WorkspaceSvg.prototype.getParentSvg=function(){if(!this.cachedParentSvg_)for(var e=this.svgGroup_;e;){if("svg"==e.tagName){this.cachedParentSvg_=e;break}e=e.parentNode}return this.cachedParentSvg_},o.WorkspaceSvg.prototype.maybeFireViewportChangeEvent=function(){if(o.Events.isEnabled()){var e=this.scale,r=-this.scrollY,l=-this.scrollX;if(!(e==this.oldScale_&&1>Math.abs(r-this.oldTop_)&&1>Math.abs(l-this.oldLeft_))){var c=new(o.Events.get(o.Events.VIEWPORT_CHANGE))(r,l,e,this.id,this.oldScale_);this.oldScale_=e,this.oldTop_=r,this.oldLeft_=l,o.Events.fire(c)}}},o.WorkspaceSvg.prototype.translate=function(e,r){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(e,r);else{var l="translate("+e+","+r+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",l),this.svgBubbleCanvas_.setAttribute("transform",l)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(e,r,this.scale),this.grid_&&this.grid_.moveTo(e,r),this.maybeFireViewportChangeEvent()},o.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var e=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),this.svgBlockCanvas_.setAttribute("transform",e="translate("+e.x+","+e.y+") scale("+this.scale+")"),this.svgBubbleCanvas_.setAttribute("transform",e)}},o.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var e=this.svgBlockCanvas_.previousSibling,r=parseInt(this.getParentSvg().getAttribute("width"),10),l=parseInt(this.getParentSvg().getAttribute("height"),10),c=o.utils.getRelativeXY(this.getCanvas());this.workspaceDragSurface_.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),e,r,l,this.scale),this.workspaceDragSurface_.translateSurface(c.x,c.y)}},o.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},o.WorkspaceSvg.prototype.getWidth=function(){var e=this.getMetrics();return e?e.viewWidth/this.scale:0},o.WorkspaceSvg.prototype.setVisible=function(e){if(this.isVisible_=e,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox_&&this.toolbox_.setVisible(e),e){for(var r=(e=this.getAllBlocks(!1)).length-1;0<=r;r--)e[r].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else o.hideChaff(!0)},o.WorkspaceSvg.prototype.render=function(){for(var e=this.getAllBlocks(!1),r=e.length-1;0<=r;r--)e[r].render(!1);if(this.currentGesture_)for(e=this.currentGesture_.getInsertionMarkers(),r=0;r<e.length;r++)e[r].render(!1);this.markerManager_.updateMarkers()},o.WorkspaceSvg.prototype.highlightBlock=function(e,r){if(void 0===r){for(var c,l=0;c=this.highlightedBlocks_[l];l++)c.setHighlighted(!1);this.highlightedBlocks_.length=0}(c=e?this.getBlockById(e):null)&&((e=void 0===r||r)?-1==this.highlightedBlocks_.indexOf(c)&&this.highlightedBlocks_.push(c):o.utils.arrayRemove(this.highlightedBlocks_,c),c.setHighlighted(e))},o.WorkspaceSvg.prototype.paste=function(e){!this.rendered||!e.tagName||e.getElementsByTagName("block").length>=this.remainingCapacity()||(this.currentGesture_&&this.currentGesture_.cancel(),"comment"==e.tagName.toLowerCase()?this.pasteWorkspaceComment_(e):this.pasteBlock_(e))},o.WorkspaceSvg.prototype.pasteBlock_=function(e){o.Events.disable();try{var r=o.Xml.domToBlock(e,this),l=parseInt(e.getAttribute("x"),10),c=parseInt(e.getAttribute("y"),10);if(!isNaN(l)&&!isNaN(c)){this.RTL&&(l=-l);do{e=!1;for(var v,p=this.getAllBlocks(!1),_=0;v=p[_];_++){var b=v.getRelativeToSurfaceXY();if(1>=Math.abs(l-b.x)&&1>=Math.abs(c-b.y)){e=!0;break}}if(!e){var F,w=r.getConnections_(!1);for(_=0;F=w[_];_++)if(F.closest(o.SNAP_RADIUS,new o.utils.Coordinate(l,c)).connection){e=!0;break}}e&&(l=this.RTL?l-o.SNAP_RADIUS:l+o.SNAP_RADIUS,c+=2*o.SNAP_RADIUS)}while(e);r.moveBy(l,c)}}finally{o.Events.enable()}o.Events.isEnabled()&&!r.isShadow()&&o.Events.fire(new(o.Events.get(o.Events.BLOCK_CREATE))(r)),r.select()},o.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(e){o.Events.disable();try{var r=o.WorkspaceCommentSvg.fromXml(e,this),l=parseInt(e.getAttribute("x"),10),c=parseInt(e.getAttribute("y"),10);isNaN(l)||isNaN(c)||(this.RTL&&(l=-l),r.moveBy(l+50,c+50))}finally{o.Events.enable()}o.Events.isEnabled()&&o.WorkspaceComment.fireCreateEvent(r),r.select()},o.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox_&&e.toolbox_.getFlyout()&&e.toolbox_.refreshSelection()},o.WorkspaceSvg.prototype.renameVariableById=function(e,r){o.WorkspaceSvg.superClass_.renameVariableById.call(this,e,r),this.refreshToolboxSelection()},o.WorkspaceSvg.prototype.deleteVariableById=function(e){o.WorkspaceSvg.superClass_.deleteVariableById.call(this,e),this.refreshToolboxSelection()},o.WorkspaceSvg.prototype.createVariable=function(e,r,l){return e=o.WorkspaceSvg.superClass_.createVariable.call(this,e,r,l),this.refreshToolboxSelection(),e},o.WorkspaceSvg.prototype.recordDeleteAreas=function(){o.utils.deprecation.warn("WorkspaceSvg.prototype.recordDeleteAreas","June 2021","June 2022","WorkspaceSvg.prototype.recordDragTargets"),this.recordDragTargets()},o.WorkspaceSvg.prototype.recordDragTargets=function(){var e=this.componentManager_.getComponents(o.ComponentManager.Capability.DRAG_TARGET,!0);this.dragTargetAreas_=[];for(var l,r=0;l=e[r];r++){var c=l.getClientRect();c&&this.dragTargetAreas_.push({component:l,clientRect:c})}},o.WorkspaceSvg.prototype.getDragTarget=function(e){for(var l,r=0;l=this.dragTargetAreas_[r];r++)if(l.clientRect.contains(e.clientX,e.clientY))return l.component;return null},o.WorkspaceSvg.prototype.onMouseDown_=function(e){var r=this.getGesture(e);r&&r.handleWsStart(e,this)},o.WorkspaceSvg.prototype.startDrag=function(e,r){(e=o.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,this.dragDeltaXY_=o.utils.Coordinate.difference(r,e)},o.WorkspaceSvg.prototype.moveDrag=function(e){return(e=o.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,o.utils.Coordinate.sum(this.dragDeltaXY_,e)},o.WorkspaceSvg.prototype.isDragging=function(){return null!=this.currentGesture_&&this.currentGesture_.isDragging()},o.WorkspaceSvg.prototype.isDraggable=function(){return this.options.moveOptions&&this.options.moveOptions.drag},o.WorkspaceSvg.prototype.isMovable=function(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},o.WorkspaceSvg.prototype.isMovableHorizontally=function(){var e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())},o.WorkspaceSvg.prototype.isMovableVertically=function(){var e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())},o.WorkspaceSvg.prototype.onMouseWheel_=function(e){if(o.Gesture.inProgress())e.preventDefault(),e.stopPropagation();else{var r=this.options.zoomOptions&&this.options.zoomOptions.wheel,l=this.options.moveOptions&&this.options.moveOptions.wheel;if(r||l){var c=o.utils.getScrollDeltaPixels(e);!r||!e.ctrlKey&&l?(r=this.scrollX-c.x,l=this.scrollY-c.y,e.shiftKey&&!c.x&&(r=this.scrollX-c.y,l=this.scrollY),this.scroll(r,l)):(c=-c.y/50,r=o.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(r.x,r.y,c)),e.preventDefault()}}},o.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var e=this.getTopBoundedElements();if(!e.length)return new o.utils.Rect(0,0,0,0);for(var r=e[0].getBoundingRectangle(),l=1;l<e.length;l++){var c=e[l];c.isInsertionMarker&&c.isInsertionMarker()||((c=c.getBoundingRectangle()).top<r.top&&(r.top=c.top),c.bottom>r.bottom&&(r.bottom=c.bottom),c.left<r.left&&(r.left=c.left),c.right>r.right&&(r.right=c.right))}return r},o.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),o.Events.setGroup(!0);for(var c,e=this.getTopBlocks(!0),r=0,l=0;c=e[l];l++)if(c.isMovable()){var p=c.getRelativeToSurfaceXY();c.moveBy(-p.x,r-p.y),c.snapToGrid(),r=c.getRelativeToSurfaceXY().y+c.getHeightWidth().height+this.renderer_.getConstants().MIN_BLOCK_HEIGHT}o.Events.setGroup(!1),this.setResizesEnabled(!0)},o.WorkspaceSvg.prototype.showContextMenu=function(e){if(!this.options.readOnly&&!this.isFlyout){var r=o.ContextMenuRegistry.registry.getContextMenuOptions(o.ContextMenuRegistry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(r,e),o.ContextMenu.show(e,r,this.RTL)}},o.WorkspaceSvg.prototype.updateToolbox=function(e){if(e=o.utils.toolbox.convertToolboxDefToJson(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(o.utils.toolbox.hasCategories(e)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox_.render(e)}else{if(!this.flyout_)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout_.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")},o.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(o.mainWorkspace=this,this.setBrowserFocus())},o.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0})}catch(e){try{this.getParentSvg().parentNode.setActive()}catch(r){this.getParentSvg().parentNode.focus({preventScroll:!0})}}},o.WorkspaceSvg.prototype.zoom=function(e,r,l){l=Math.pow(this.options.zoomOptions.scaleSpeed,l);var c=this.scale*l;if(this.scale!=c){c>this.options.zoomOptions.maxScale?l=this.options.zoomOptions.maxScale/this.scale:c<this.options.zoomOptions.minScale&&(l=this.options.zoomOptions.minScale/this.scale);var p=this.getCanvas().getCTM(),_=this.getParentSvg().createSVGPoint();_.x=e,_.y=r,_=_.matrixTransform(p.inverse()),p=p.translate((e=_.x)*(1-l),(r=_.y)*(1-l)).scale(l),this.scrollX=p.e,this.scrollY=p.f,this.setScale(c)}},o.WorkspaceSvg.prototype.zoomCenter=function(e){var r=this.getMetrics();if(this.flyout_){var l=r.svgWidth?r.svgWidth/2:0;r=r.svgHeight?r.svgHeight/2:0}else l=r.viewWidth/2+r.absoluteLeft,r=r.viewHeight/2+r.absoluteTop;this.zoom(l,r,e)},o.WorkspaceSvg.prototype.zoomToFit=function(){if(this.isMovable()){var e=this.getMetrics(),r=e.viewWidth;e=e.viewHeight;var l=this.getBlocksBoundingBox(),c=l.right-l.left;if(l=l.bottom-l.top,c){this.flyout_&&(this.horizontalLayout?(e+=this.flyout_.getHeight(),l+=this.flyout_.getHeight()/this.scale):(r+=this.flyout_.getWidth(),c+=this.flyout_.getWidth()/this.scale)),r/=c,e/=l,o.Events.disable();try{this.setScale(Math.min(r,e)),this.scrollCenter()}finally{o.Events.enable()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},o.WorkspaceSvg.prototype.beginCanvasTransition=function(){o.utils.dom.addClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),o.utils.dom.addClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},o.WorkspaceSvg.prototype.endCanvasTransition=function(){o.utils.dom.removeClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),o.utils.dom.removeClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},o.WorkspaceSvg.prototype.scrollCenter=function(){if(this.isMovable()){var e=this.getMetrics(),r=(e.scrollWidth-e.viewWidth)/2,l=(e.scrollHeight-e.viewHeight)/2;this.scroll(r=-r-e.scrollLeft,l=-l-e.scrollTop)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},o.WorkspaceSvg.prototype.centerOnBlock=function(e){if(this.isMovable()){if(e=e?this.getBlockById(e):null){var r=e.getRelativeToSurfaceXY(),l=e.getHeightWidth(),c=this.scale;e=(r.x+(this.RTL?-1:1)*l.width/2)*c,r=(r.y+l.height/2)*c,l=this.getMetrics(),this.scroll(-(e-l.viewWidth/2),-(r-l.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},o.WorkspaceSvg.prototype.setScale=function(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,o.hideChaff(!1),this.flyout_&&(this.flyout_.reflow(),this.recordDragTargets()),this.grid_&&this.grid_.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout_?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))},o.WorkspaceSvg.prototype.getScale=function(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale},o.WorkspaceSvg.prototype.scroll=function(e,r){o.hideChaff(!0);var l=this.getMetrics();e=Math.min(e,-l.scrollLeft),r=Math.min(r,-l.scrollTop);var c=l.scrollTop+Math.max(0,l.scrollHeight-l.viewHeight);e=Math.max(e,-(l.scrollLeft+Math.max(0,l.scrollWidth-l.viewWidth))),r=Math.max(r,-c),this.scrollX=e,this.scrollY=r,this.scrollbar&&this.scrollbar.set(-(e+l.scrollLeft),-(r+l.scrollTop),!1),this.translate(e+=l.absoluteLeft,r+=l.absoluteTop)},o.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(e){var r=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(r.scrollLeft+(r.scrollWidth-r.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(r.scrollTop+(r.scrollHeight-r.viewHeight)*e.y)),this.translate(this.scrollX+r.absoluteLeft,this.scrollY+r.absoluteTop)},o.WorkspaceSvg.prototype.getBlockById=function(e){return o.WorkspaceSvg.superClass_.getBlockById.call(this,e)},o.WorkspaceSvg.prototype.getTopBlocks=function(e){return o.WorkspaceSvg.superClass_.getTopBlocks.call(this,e)},o.WorkspaceSvg.prototype.addTopBlock=function(e){this.addTopBoundedElement(e),o.WorkspaceSvg.superClass_.addTopBlock.call(this,e)},o.WorkspaceSvg.prototype.removeTopBlock=function(e){this.removeTopBoundedElement(e),o.WorkspaceSvg.superClass_.removeTopBlock.call(this,e)},o.WorkspaceSvg.prototype.addTopComment=function(e){this.addTopBoundedElement(e),o.WorkspaceSvg.superClass_.addTopComment.call(this,e)},o.WorkspaceSvg.prototype.removeTopComment=function(e){this.removeTopBoundedElement(e),o.WorkspaceSvg.superClass_.removeTopComment.call(this,e)},o.WorkspaceSvg.prototype.addTopBoundedElement=function(e){this.topBoundedElements_.push(e)},o.WorkspaceSvg.prototype.removeTopBoundedElement=function(e){o.utils.arrayRemove(this.topBoundedElements_,e)},o.WorkspaceSvg.prototype.getTopBoundedElements=function(){return[].concat(this.topBoundedElements_)},o.WorkspaceSvg.prototype.setResizesEnabled=function(e){var r=!this.resizesEnabled_&&e;this.resizesEnabled_=e,r&&this.resizeContents()},o.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),o.WorkspaceSvg.superClass_.clear.call(this),this.topBoundedElements_=[],this.setResizesEnabled(!0)},o.WorkspaceSvg.prototype.registerButtonCallback=function(e,r){if("function"!=typeof r)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks_[e]=r},o.WorkspaceSvg.prototype.getButtonCallback=function(e){return(e=this.flyoutButtonCallbacks_[e])?e:null},o.WorkspaceSvg.prototype.removeButtonCallback=function(e){this.flyoutButtonCallbacks_[e]=null},o.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(e,r){if("function"!=typeof r)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[e]=r},o.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(e){return this.toolboxCategoryCallbacks_[e]||null},o.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(e){this.toolboxCategoryCallbacks_[e]=null},o.WorkspaceSvg.prototype.getGesture=function(e){var r="mousedown"==e.type||"touchstart"==e.type||"pointerdown"==e.type,l=this.currentGesture_;return l?r&&l.hasStarted()?(console.warn("Tried to start the same gesture twice."),l.cancel(),null):l:r?this.currentGesture_=new o.TouchGesture(e,this):null},o.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},o.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},o.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},o.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},o.inject=function(e,r){if(o.checkBlockColourConstants(),"string"==typeof e&&(e=document.getElementById(e)||document.querySelector(e)),!e||!o.utils.dom.containsNode(document,e))throw Error("Error: container is not in current document.");r=new o.Options(r||{});var l=document.createElement("div");l.className="injectionDiv",l.tabIndex=0,o.utils.aria.setState(l,o.utils.aria.State.LABEL,o.Msg.WORKSPACE_ARIA_LABEL),e.appendChild(l),e=o.createDom_(l,r);var c=new o.BlockDragSurfaceSvg(l),p=new o.WorkspaceDragSurfaceSvg(l),_=o.createMainWorkspace_(e,r,c,p);return o.init_(_),o.mainWorkspace=_,o.svgResize(_),l.addEventListener("focusin",function(){o.mainWorkspace=_}),_},o.createDom_=function(e,r){e.setAttribute("dir","LTR"),o.Css.inject(r.hasCss,r.pathToMedia),e=o.utils.dom.createSvgElement(o.utils.Svg.SVG,{xmlns:o.utils.dom.SVG_NS,"xmlns:html":o.utils.dom.HTML_NS,"xmlns:xlink":o.utils.dom.XLINK_NS,version:"1.1",class:"blocklySvg",tabindex:"0"},e);var l=o.utils.dom.createSvgElement(o.utils.Svg.DEFS,{},e),c=String(Math.random()).substring(2);return r.gridPattern=o.Grid.createDom(c,r.gridOptions,l),e},o.createMainWorkspace_=function(e,r,l,c){return r.parentWorkspace=null,(r=new o.WorkspaceSvg(r,l,c)).scale=(l=r.options).zoomOptions.startScale,e.appendChild(r.createDom("blocklyMainBackground")),o.utils.dom.addClass(r.getInjectionDiv(),r.getRenderer().getClassName()),o.utils.dom.addClass(r.getInjectionDiv(),r.getTheme().getClassName()),!l.hasCategories&&l.languageTree&&(c=r.addFlyout(o.utils.Svg.SVG),o.utils.dom.insertAfter(c,e)),l.hasTrashcan&&r.addTrashcan(),l.zoomOptions&&l.zoomOptions.controls&&r.addZoomControls(),r.getThemeManager().subscribe(e,"workspaceBackgroundColour","background-color"),r.translate(0,0),r.addChangeListener(o.bumpIntoBoundsHandler_(r)),o.svgResize(r),o.WidgetDiv.createDom(),o.DropDownDiv.createDom(),o.Tooltip.createDom(),r},o.extractObjectFromEvent_=function(e,r){var l=null;switch(r.type){case o.Events.BLOCK_CREATE:case o.Events.BLOCK_MOVE:(l=e.getBlockById(r.blockId))&&(l=l.getRootBlock());break;case o.Events.COMMENT_CREATE:case o.Events.COMMENT_MOVE:l=e.getCommentById(r.commentId)}return l},o.bumpTopObjectsIntoBounds_=function(e){var r=e.getMetricsManager();if(r.hasFixedEdges()&&!e.isDragging()){r=r.getScrollMetrics(!0);for(var p,l=e.getTopBoundedElements(),c=0;p=l[c];c++)o.bumpObjectIntoBounds_(e,r,p)}},o.bumpIntoBoundsHandler_=function(e){return function(r){var l=e.getMetricsManager();if(l.hasFixedEdges()&&!e.isDragging())if(-1!==o.Events.BUMP_EVENTS.indexOf(r.type)){l=l.getScrollMetrics(!0);var c=o.extractObjectFromEvent_(e,r);if(c){var p=o.Events.getGroup();o.Events.setGroup(r.group),o.bumpObjectIntoBounds_(e,l,c)&&!r.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),null!==p&&o.Events.setGroup(p)}}else r.type===o.Events.VIEWPORT_CHANGE&&r.scale>r.oldScale&&o.bumpTopObjectsIntoBounds_(e)}},o.bumpObjectIntoBounds_=function(e,r,l){var c=l.getBoundingRectangle(),p=c.right-c.left,_=o.utils.math.clamp(r.top,c.top,r.top+r.height-(c.bottom-c.top))-c.top,v=r.left;return r=r.left+r.width-p,e.RTL?v=Math.min(r,v):r=Math.max(v,r),!(!(e=o.utils.math.clamp(v,c.left,r)-c.left)&&!_||(l.moveBy(e,_),0))},o.init_=function(e){var r=e.options,l=e.getParentSvg();if(o.browserEvents.conditionalBind(l.parentNode,"contextmenu",null,function(p){o.utils.isTargetInput(p)||p.preventDefault()}),l=o.browserEvents.conditionalBind(window,"resize",null,function(){o.hideChaff(!0),o.svgResize(e),o.bumpTopObjectsIntoBounds_(e)}),e.setResizeHandlerWrapper(l),o.inject.bindDocumentEvents_(),r.languageTree){l=e.getToolbox();var c=e.getFlyout(!0);l?l.init():c&&(c.init(e),c.show(r.languageTree),"function"==typeof c.scrollToStart&&c.scrollToStart())}r.hasTrashcan&&e.trashcan.init(),r.zoomOptions&&r.zoomOptions.controls&&e.zoomControls_.init(),r.moveOptions&&r.moveOptions.scrollbars?(e.scrollbar=new o.ScrollbarPair(e,!0===r.moveOptions.scrollbars||!!r.moveOptions.scrollbars.horizontal,!0===r.moveOptions.scrollbars||!!r.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),r.hasSounds&&o.inject.loadSounds_(r.pathToMedia,e)},o.inject.bindDocumentEvents_=function(){o.documentEventsBound_||(o.browserEvents.conditionalBind(document,"scroll",null,function(){for(var l,e=o.Workspace.getAll(),r=0;l=e[r];r++)l.updateInverseScreenCTM&&l.updateInverseScreenCTM()}),o.browserEvents.conditionalBind(document,"keydown",null,o.onKeyDown),o.browserEvents.bind(document,"touchend",null,o.longStop_),o.browserEvents.bind(document,"touchcancel",null,o.longStop_),o.utils.userAgent.IPAD&&o.browserEvents.conditionalBind(window,"orientationchange",document,function(){o.svgResize(o.getMainWorkspace())})),o.documentEventsBound_=!0},o.inject.loadSounds_=function(e,r){var l=r.getAudioManager();l.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),l.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),l.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");var c=[];e=function(){for(;c.length;)o.browserEvents.unbind(c.pop());l.preload()},c.push(o.browserEvents.conditionalBind(document,"mousemove",null,e,!0)),c.push(o.browserEvents.conditionalBind(document,"touchstart",null,e,!0))},o.Names=function(e,r){if(this.variablePrefix_=r||"",this.reservedDict_=Object.create(null),e)for(e=e.split(","),r=0;r<e.length;r++)this.reservedDict_[e[r]]=!0;this.reset()},o.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",o.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},o.Names.prototype.setVariableMap=function(e){this.variableMap_=e},o.Names.prototype.getNameForUserVariable_=function(e){return this.variableMap_?(e=this.variableMap_.getVariableById(e))?e.name:null:(console.warn("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)},o.Names.prototype.populateVariables=function(e){e=o.Variables.allUsedVarModels(e);for(var r=0;r<e.length;r++)this.getName(e[r].getId(),o.VARIABLE_CATEGORY_NAME)},o.Names.prototype.populateProcedures=function(e){e=(e=o.Procedures.allProcedures(e))[0].concat(e[1]);for(var r=0;r<e.length;r++)this.getName(e[r][0],o.PROCEDURE_CATEGORY_NAME)},o.Names.prototype.getName=function(e,r){var l=e;r==o.VARIABLE_CATEGORY_NAME&&(e=this.getNameForUserVariable_(e))&&(l=e),e=l.toLowerCase();var c=r==o.VARIABLE_CATEGORY_NAME||r==o.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";r in this.db_||(this.db_[r]=Object.create(null));var p=this.db_[r];return e in p?c+p[e]:(r=this.getDistinctName(l,r),p[e]=r.substr(c.length),r)},o.Names.prototype.getUserNames=function(e){return Object.keys(this.db_[e]||{})},o.Names.prototype.getDistinctName=function(e,r){e=this.safeName_(e);for(var l="";this.dbReverse_[e+l]||e+l in this.reservedDict_;)l=l?l+1:2;return this.dbReverse_[e+=l]=!0,(r==o.VARIABLE_CATEGORY_NAME||r==o.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+e},o.Names.prototype.safeName_=function(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(e[0])&&(e="my_"+e)):e=o.Msg.UNNAMED_KEY||"unnamed",e},o.Names.equals=function(e,r){return e.toLowerCase()==r.toLowerCase()},o.Procedures={},o.Procedures.NAME_TYPE=o.PROCEDURE_CATEGORY_NAME,o.Procedures.DEFAULT_ARG="x",o.Procedures.allProcedures=function(e){var r=e.getBlocksByType("procedures_defnoreturn",!1).map(function(l){return l.getProcedureDef()});return e=e.getBlocksByType("procedures_defreturn",!1).map(function(l){return l.getProcedureDef()}),r.sort(o.Procedures.procTupleComparator_),e.sort(o.Procedures.procTupleComparator_),[r,e]},o.Procedures.procTupleComparator_=function(e,r){return e[0].localeCompare(r[0],void 0,{sensitivity:"base"})},o.Procedures.findLegalName=function(e,r){if(r.isInFlyout)return e;for(e=e||o.Msg.UNNAMED_KEY||"unnamed";!o.Procedures.isLegalName_(e,r.workspace,r);){var l=e.match(/^(.*?)(\d+)$/);e=l?l[1]+(parseInt(l[2],10)+1):e+"2"}return e},o.Procedures.isLegalName_=function(e,r,l){return!o.Procedures.isNameUsed(e,r,l)},o.Procedures.isNameUsed=function(e,r,l){r=r.getAllBlocks(!1);for(var c=0;c<r.length;c++)if(r[c]!=l&&r[c].getProcedureDef){var p=r[c].getProcedureDef();if(o.Names.equals(p[0],e))return!0}return!1},o.Procedures.rename=function(e){e=e.trim();var r=o.Procedures.findLegalName(e,this.getSourceBlock()),l=this.getValue();if(l!=e&&l!=r){e=this.getSourceBlock().workspace.getAllBlocks(!1);for(var c=0;c<e.length;c++)e[c].renameProcedure&&e[c].renameProcedure(l,r)}return r},o.Procedures.flyoutCategory=function(e){function r(_,v){for(var b=0;b<_.length;b++){var w=_[b][0],F=_[b][1],X=o.utils.xml.createElement("block");X.setAttribute("type",v),X.setAttribute("gap",16);var xe=o.utils.xml.createElement("mutation");for(xe.setAttribute("name",w),X.appendChild(xe),w=0;w<F.length;w++){var Ve=o.utils.xml.createElement("arg");Ve.setAttribute("name",F[w]),xe.appendChild(Ve)}l.push(X)}}var l=[];if(o.Blocks.procedures_defnoreturn){var c=o.utils.xml.createElement("block");c.setAttribute("type","procedures_defnoreturn"),c.setAttribute("gap",16);var p=o.utils.xml.createElement("field");p.setAttribute("name","NAME"),p.appendChild(o.utils.xml.createTextNode(o.Msg.PROCEDURES_DEFNORETURN_PROCEDURE)),c.appendChild(p),l.push(c)}return o.Blocks.procedures_defreturn&&((c=o.utils.xml.createElement("block")).setAttribute("type","procedures_defreturn"),c.setAttribute("gap",16),(p=o.utils.xml.createElement("field")).setAttribute("name","NAME"),p.appendChild(o.utils.xml.createTextNode(o.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),c.appendChild(p),l.push(c)),o.Blocks.procedures_ifreturn&&((c=o.utils.xml.createElement("block")).setAttribute("type","procedures_ifreturn"),c.setAttribute("gap",16),l.push(c)),l.length&&l[l.length-1].setAttribute("gap",24),r((e=o.Procedures.allProcedures(e))[0],"procedures_callnoreturn"),r(e[1],"procedures_callreturn"),l},o.Procedures.updateMutatorFlyout_=function(e){for(var p,r=[],l=e.getBlocksByType("procedures_mutatorarg",!1),c=0;p=l[c];c++)r.push(p.getFieldValue("NAME"));l=o.utils.xml.createElement("xml"),(c=o.utils.xml.createElement("block")).setAttribute("type","procedures_mutatorarg"),(p=o.utils.xml.createElement("field")).setAttribute("name","NAME"),r=o.Variables.generateUniqueNameFromOptions(o.Procedures.DEFAULT_ARG,r),r=o.utils.xml.createTextNode(r),p.appendChild(r),c.appendChild(p),l.appendChild(c),e.updateToolbox(l)},o.Procedures.mutatorOpenListener=function(e){if(e.type==o.Events.BUBBLE_OPEN&&"mutator"===e.bubbleType&&e.isOpen){var r=(e=o.Workspace.getById(e.workspaceId).getBlockById(e.blockId)).type;("procedures_defnoreturn"==r||"procedures_defreturn"==r)&&(e=e.mutator.getWorkspace(),o.Procedures.updateMutatorFlyout_(e),e.addChangeListener(o.Procedures.mutatorChangeListener_))}},o.Procedures.mutatorChangeListener_=function(e){(e.type==o.Events.BLOCK_CREATE||e.type==o.Events.BLOCK_DELETE||e.type==o.Events.BLOCK_CHANGE)&&(e=o.Workspace.getById(e.workspaceId),o.Procedures.updateMutatorFlyout_(e))},o.Procedures.getCallers=function(e,r){var l=[];r=r.getAllBlocks(!1);for(var c=0;c<r.length;c++)if(r[c].getProcedureCall){var p=r[c].getProcedureCall();p&&o.Names.equals(p,e)&&l.push(r[c])}return l},o.Procedures.mutateCallers=function(e){var p,r=o.Events.recordUndo,l=e.getProcedureDef()[0],c=e.mutationToDom(!0);for(e=o.Procedures.getCallers(l,e.workspace),l=0;p=e[l];l++){var _=p.mutationToDom();_=_&&o.Xml.domToText(_),p.domToMutation(c);var v=p.mutationToDom();_!=(v=v&&o.Xml.domToText(v))&&(o.Events.recordUndo=!1,o.Events.fire(new(o.Events.get(o.Events.BLOCK_CHANGE))(p,"mutation",null,_,v)),o.Events.recordUndo=r)}},o.Procedures.getDefinition=function(e,r){r=r.getAllBlocks(!1);for(var l=0;l<r.length;l++)if(r[l].getProcedureDef){var c=r[l].getProcedureDef();if(c&&o.Names.equals(c[0],e))return r[l]}return null},o.ShortcutRegistry=function(){o.ShortcutRegistry.registry=this,this.registry_=Object.create(null),this.keyMap_=Object.create(null)},o.ShortcutRegistry.modifierKeys={Shift:o.utils.KeyCodes.SHIFT,Control:o.utils.KeyCodes.CTRL,Alt:o.utils.KeyCodes.ALT,Meta:o.utils.KeyCodes.META},o.ShortcutRegistry.prototype.register=function(e,r){if(this.registry_[e.name]&&!r)throw Error('Shortcut with name "'+e.name+'" already exists.');this.registry_[e.name]=e},o.ShortcutRegistry.prototype.unregister=function(e){return this.registry_[e]?(this.removeAllKeyMappings(e),delete this.registry_[e],!0):(console.warn('Keyboard shortcut with name "'+e+'" not found.'),!1)},o.ShortcutRegistry.prototype.addKeyMapping=function(e,r,l){e=String(e);var c=this.keyMap_[e];if(c&&!l)throw Error('Shortcut with name "'+r+'" collides with shortcuts '+c.toString());c&&l?c.unshift(r):this.keyMap_[e]=[r]},o.ShortcutRegistry.prototype.removeKeyMapping=function(e,r,l){var c=this.keyMap_[e];if(!c&&!l)return console.warn('No keyboard shortcut with name "'+r+'" registered with key code "'+e+'"'),!1;var p=c.indexOf(r);return-1<p?(c.splice(p,1),0==c.length&&delete this.keyMap_[e],!0):(l||console.warn('No keyboard shortcut with name "'+r+'" registered with key code "'+e+'"'),!1)},o.ShortcutRegistry.prototype.removeAllKeyMappings=function(e){for(var r in this.keyMap_)this.removeKeyMapping(r,e,!0)},o.ShortcutRegistry.prototype.setKeyMap=function(e){this.keyMap_=e},o.ShortcutRegistry.prototype.getKeyMap=function(){return o.utils.object.deepMerge(Object.create(null),this.keyMap_)},o.ShortcutRegistry.prototype.getRegistry=function(){return o.utils.object.deepMerge(Object.create(null),this.registry_)},o.ShortcutRegistry.prototype.onKeyDown=function(e,r){var l=this.serializeKeyEvent_(r);if(!(l=this.getShortcutNamesByKeyCode(l)))return!1;for(var p,c=0;p=l[c];c++)if((!(p=this.registry_[p]).preconditionFn||p.preconditionFn(e))&&p.callback&&p.callback(e,r,p))return!0;return!1},o.ShortcutRegistry.prototype.getShortcutNamesByKeyCode=function(e){return this.keyMap_[e]||[]},o.ShortcutRegistry.prototype.getKeyCodesByShortcutName=function(e){var l,r=[];for(l in this.keyMap_)-1<this.keyMap_[l].indexOf(e)&&r.push(l);return r},o.ShortcutRegistry.prototype.serializeKeyEvent_=function(e){var l,r="";for(l in o.ShortcutRegistry.modifierKeys)e.getModifierState(l)&&(""!=r&&(r+="+"),r+=l);return""!=r&&e.keyCode?r=r+"+"+e.keyCode:e.keyCode&&(r=e.keyCode.toString()),r},o.ShortcutRegistry.prototype.checkModifiers_=function(e){for(var c,r=o.utils.object.values(o.ShortcutRegistry.modifierKeys),l=0;c=e[l];l++)if(0>r.indexOf(c))throw Error(c+" is not a valid modifier key.")},o.ShortcutRegistry.prototype.createSerializedKey=function(e,r){var l="";if(r)for(var c in this.checkModifiers_(r),o.ShortcutRegistry.modifierKeys)-1<r.indexOf(o.ShortcutRegistry.modifierKeys[c])&&(""!=l&&(l+="+"),l+=c);return""!=l&&e?l=l+"+"+e:e&&(l=e.toString()),l},new o.ShortcutRegistry,o.VariableModel=function(e,r,l,c){this.workspace=e,this.name=r,this.type=l||"",this.id_=c||o.utils.genUid(),o.Events.fire(new(o.Events.get(o.Events.VAR_CREATE))(this))},o.VariableModel.prototype.getId=function(){return this.id_},o.VariableModel.compareByName=function(e,r){return e.name.localeCompare(r.name,void 0,{sensitivity:"base"})},o.Variables={},o.Variables.NAME_TYPE=o.VARIABLE_CATEGORY_NAME,o.Variables.allUsedVarModels=function(e){var r=e.getAllBlocks(!1);e=Object.create(null);for(var l=0;l<r.length;l++){var c=r[l].getVarModels();if(c)for(var p=0;p<c.length;p++){var _=c[p],v=_.getId();v&&(e[v]=_)}}for(v in r=[],e)r.push(e[v]);return r},o.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_={},o.Variables.allDeveloperVariables=function(e){e=e.getAllBlocks(!1);for(var c,r=Object.create(null),l=0;c=e[l];l++){var p=c.getDeveloperVariables;if(!p&&c.getDeveloperVars&&(p=c.getDeveloperVars,o.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[c.type]||(console.warn("Function getDeveloperVars() deprecated. Use getDeveloperVariables() (block type '"+c.type+"')"),o.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[c.type]=!0)),p)for(c=p(),p=0;p<c.length;p++)r[c[p]]=!0}return Object.keys(r)},o.Variables.flyoutCategory=function(e){var r=[],l=document.createElement("button");return l.setAttribute("text","%{BKY_NEW_VARIABLE}"),l.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(c){o.Variables.createVariableButtonHandler(c.getTargetWorkspace())}),r.push(l),e=o.Variables.flyoutCategoryBlocks(e),r.concat(e)},o.Variables.flyoutCategoryBlocks=function(e){var r=[];if(0<(e=e.getVariablesOfType("")).length){var l=e[e.length-1];if(o.Blocks.variables_set){var c=o.utils.xml.createElement("block");c.setAttribute("type","variables_set"),c.setAttribute("gap",o.Blocks.math_change?8:24),c.appendChild(o.Variables.generateVariableFieldDom(l)),r.push(c)}if(o.Blocks.math_change&&((c=o.utils.xml.createElement("block")).setAttribute("type","math_change"),c.setAttribute("gap",o.Blocks.variables_get?20:8),c.appendChild(o.Variables.generateVariableFieldDom(l)),l=o.Xml.textToDom('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),c.appendChild(l),r.push(c)),o.Blocks.variables_get){e.sort(o.VariableModel.compareByName),l=0;for(var p;p=e[l];l++)(c=o.utils.xml.createElement("block")).setAttribute("type","variables_get"),c.setAttribute("gap",8),c.appendChild(o.Variables.generateVariableFieldDom(p)),r.push(c)}}return r},o.Variables.VAR_LETTER_OPTIONS="ijkmnopqrstuvwxyzabcdefgh",o.Variables.generateUniqueName=function(e){return o.Variables.generateUniqueNameFromOptions(o.Variables.VAR_LETTER_OPTIONS.charAt(0),e.getAllVariableNames())},o.Variables.generateUniqueNameFromOptions=function(e,r){if(!r.length)return e;for(var l=o.Variables.VAR_LETTER_OPTIONS,c="",p=l.indexOf(e);;){for(var _=!1,v=0;v<r.length;v++)if(r[v].toLowerCase()==e){_=!0;break}if(!_)return e;++p==l.length&&(p=0,c=Number(c)+1),e=l.charAt(p)+c}},o.Variables.createVariableButtonHandler=function(e,r,l){var c=l||"",p=function(_){o.Variables.promptName(o.Msg.NEW_VARIABLE_TITLE,_,function(v){if(v){var b=o.Variables.nameUsedWithAnyType(v,e);if(b){if(b.type==c)var w=o.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",b.name);else w=(w=o.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",b.name).replace("%2",b.type);o.alert(w,function(){p(v)})}else e.createVariable(v,c),r&&r(v)}else r&&r(null)})};p("")},o.Variables.createVariable=o.Variables.createVariableButtonHandler,o.Variables.renameVariable=function(e,r,l){var c=function(p){var _=o.Msg.RENAME_VARIABLE_TITLE.replace("%1",r.name);o.Variables.promptName(_,p,function(v){if(v){var b=o.Variables.nameUsedWithOtherType_(v,r.type,e);b?(b=o.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",b.name).replace("%2",b.type),o.alert(b,function(){c(v)})):(e.renameVariableById(r.getId(),v),l&&l(v))}else l&&l(null)})};c("")},o.Variables.promptName=function(e,r,l){o.prompt(e,r,function(c){c&&((c=c.replace(/[\s\xa0]+/g," ").trim())==o.Msg.RENAME_VARIABLE||c==o.Msg.NEW_VARIABLE)&&(c=null),l(c)})},o.Variables.nameUsedWithOtherType_=function(e,r,l){l=l.getVariableMap().getAllVariables(),e=e.toLowerCase();for(var p,c=0;p=l[c];c++)if(p.name.toLowerCase()==e&&p.type!=r)return p;return null},o.Variables.nameUsedWithAnyType=function(e,r){r=r.getVariableMap().getAllVariables(),e=e.toLowerCase();for(var c,l=0;c=r[l];l++)if(c.name.toLowerCase()==e)return c;return null},o.Variables.generateVariableFieldDom=function(e){var r=o.utils.xml.createElement("field");return r.setAttribute("name","VAR"),r.setAttribute("id",e.getId()),r.setAttribute("variabletype",e.type),e=o.utils.xml.createTextNode(e.name),r.appendChild(e),r},o.Variables.getOrCreateVariablePackage=function(e,r,l,c){var p=o.Variables.getVariable(e,r,l,c);return p||(p=o.Variables.createVariable_(e,r,l,c)),p},o.Variables.getVariable=function(e,r,l,c){var p=e.getPotentialVariableMap(),_=null;if(r&&(!(_=e.getVariableById(r))&&p&&(_=p.getVariableById(r)),_))return _;if(l){if(null==c)throw Error("Tried to look up a variable by name without a type");!(_=e.getVariable(l,c))&&p&&(_=p.getVariable(l,c))}return _},o.Variables.createVariable_=function(e,r,l,c){var p=e.getPotentialVariableMap();return l||(l=o.Variables.generateUniqueName(e.isFlyout?e.targetWorkspace:e)),p?p.createVariable(l,c,r):e.createVariable(l,c,r)},o.Variables.getAddedVariables=function(e,r){e=e.getAllVariables();var l=[];if(r.length!=e.length)for(var c=0;c<e.length;c++){var p=e[c];-1==r.indexOf(p)&&l.push(p)}return l},o.VERSION="6.20210701.0",o.mainWorkspace=null,o.selected=null,o.draggingConnections=[],o.clipboardXml_=null,o.clipboardSource_=null,o.clipboardTypeCounts_=null,o.cache3dSupported_=null,o.parentContainer=null,o.svgSize=function(e){return o.utils.deprecation.warn("Blockly.svgSize","March 2021","March 2022","workspace.getCachedParentSvgSize"),new o.utils.Size(e.cachedWidth_,e.cachedHeight_)},o.resizeSvgContents=function(e){e.resizeContents()},o.svgResize=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;var r=e.getParentSvg(),l=e.getCachedParentSvgSize(),c=r.parentNode;if(c){var p=c.offsetWidth;c=c.offsetHeight,l.width!=p&&(r.setAttribute("width",p+"px"),e.setCachedParentSvgSize(p,null)),l.height!=c&&(r.setAttribute("height",c+"px"),e.setCachedParentSvgSize(null,c)),e.resize()}},o.onKeyDown=function(e){var r=o.mainWorkspace;r&&!(o.utils.isTargetInput(e)||r.rendered&&!r.isVisible())&&o.ShortcutRegistry.registry.onKeyDown(r,e)},o.deleteBlock=function(e){e.workspace.isFlyout||(o.Events.setGroup(!0),o.hideChaff(),e.dispose(!e.outputConnection,!0),o.Events.setGroup(!1))},o.copy=function(e){(e=e.toCopyData())&&(o.clipboardXml_=e.xml,o.clipboardSource_=e.source,o.clipboardTypeCounts_=e.typeCounts)},o.paste=function(){if(!o.clipboardXml_)return!1;var e=o.clipboardSource_;return e.isFlyout&&(e=e.targetWorkspace),!(!o.clipboardTypeCounts_||!e.isCapacityAvailable(o.clipboardTypeCounts_)||(o.Events.setGroup(!0),e.paste(o.clipboardXml_),o.Events.setGroup(!1),0))},o.duplicate=function(e){var r=o.clipboardXml_,l=o.clipboardSource_;o.copy(e),e.workspace.paste(o.clipboardXml_),o.clipboardXml_=r,o.clipboardSource_=l},o.onContextMenu_=function(e){o.utils.isTargetInput(e)||e.preventDefault()},o.hideChaff=function(e){o.Tooltip.hide(),o.WidgetDiv.hide(),o.DropDownDiv.hideWithoutAnimation();var r=!!e;o.getMainWorkspace().getComponentManager().getComponents(o.ComponentManager.Capability.AUTOHIDEABLE,!0).forEach(function(l){l.autoHide(r)})},o.getMainWorkspace=function(){return o.mainWorkspace},o.alert=function(e,r){alert(e),r&&r()},o.confirm=function(e,r){r(confirm(e))},o.prompt=function(e,r,l){l(prompt(e,r))},o.jsonInitFactory_=function(e){return function(){this.jsonInit(e)}},o.defineBlocksWithJsonArray=function(e){for(var r=0;r<e.length;r++){var l=e[r];if(l){var c=l.type;null==c||""===c?console.warn("Block definition #"+r+" in JSON array is missing a type attribute. Skipping."):(o.Blocks[c]&&console.warn("Block definition #"+r+' in JSON array overwrites prior definition of "'+c+'".'),o.Blocks[c]={init:o.jsonInitFactory_(l)})}else console.warn("Block definition #"+r+" in JSON array is "+l+". Skipping.")}},o.isNumber=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},o.hueToHex=function(e){return o.utils.colour.hsvToHex(e,o.HSV_SATURATION,255*o.HSV_VALUE)},o.checkBlockColourConstants=function(){o.checkBlockColourConstant_("LOGIC_HUE",["Blocks","logic","HUE"],void 0),o.checkBlockColourConstant_("LOGIC_HUE",["Constants","Logic","HUE"],210),o.checkBlockColourConstant_("LOOPS_HUE",["Blocks","loops","HUE"],void 0),o.checkBlockColourConstant_("LOOPS_HUE",["Constants","Loops","HUE"],120),o.checkBlockColourConstant_("MATH_HUE",["Blocks","math","HUE"],void 0),o.checkBlockColourConstant_("MATH_HUE",["Constants","Math","HUE"],230),o.checkBlockColourConstant_("TEXTS_HUE",["Blocks","texts","HUE"],void 0),o.checkBlockColourConstant_("TEXTS_HUE",["Constants","Text","HUE"],160),o.checkBlockColourConstant_("LISTS_HUE",["Blocks","lists","HUE"],void 0),o.checkBlockColourConstant_("LISTS_HUE",["Constants","Lists","HUE"],260),o.checkBlockColourConstant_("COLOUR_HUE",["Blocks","colour","HUE"],void 0),o.checkBlockColourConstant_("COLOUR_HUE",["Constants","Colour","HUE"],20),o.checkBlockColourConstant_("VARIABLES_HUE",["Blocks","variables","HUE"],void 0),o.checkBlockColourConstant_("VARIABLES_HUE",["Constants","Variables","HUE"],330),o.checkBlockColourConstant_("VARIABLES_DYNAMIC_HUE",["Constants","VariablesDynamic","HUE"],310),o.checkBlockColourConstant_("PROCEDURES_HUE",["Blocks","procedures","HUE"],void 0)},o.checkBlockColourConstant_=function(e,r,l){for(var c="Blockly",p=o,_=0;_<r.length;++_)c+="."+r[_],p&&(p=p[r[_]]);p&&p!==l&&(e=(void 0===l?'%1 has been removed. Use Blockly.Msg["%2"].':'%1 is deprecated and unused. Override Blockly.Msg["%2"].').replace("%1",c).replace("%2",e),console.warn(e))},o.setParentContainer=function(e){o.parentContainer=e},o.bindEvent_=o.browserEvents.bind,o.unbindEvent_=o.browserEvents.unbind,o.bindEventWithChecks_=o.browserEvents.conditionalBind,o.ALIGN_LEFT=o.constants.ALIGN.LEFT,o.ALIGN_CENTRE=o.constants.ALIGN.CENTRE,o.ALIGN_RIGHT=o.constants.ALIGN.RIGHT,o.INPUT_VALUE=o.connectionTypes.INPUT_VALUE,o.OUTPUT_VALUE=o.connectionTypes.OUTPUT_VALUE,o.NEXT_STATEMENT=o.connectionTypes.NEXT_STATEMENT,o.PREVIOUS_STATEMENT=o.connectionTypes.PREVIOUS_STATEMENT,o.DUMMY_INPUT=o.inputTypes.DUMMY,o.TOOLBOX_AT_TOP=o.utils.toolbox.Position.TOP,o.TOOLBOX_AT_BOTTOM=o.utils.toolbox.Position.BOTTOM,o.TOOLBOX_AT_LEFT=o.utils.toolbox.Position.LEFT,o.TOOLBOX_AT_RIGHT=o.utils.toolbox.Position.RIGHT,o.Events.BubbleOpen=function(e,r,l){o.Events.BubbleOpen.superClass_.constructor.call(this,e?e.workspace.id:void 0),this.blockId=e?e.id:null,this.isOpen=r,this.bubbleType=l},o.utils.object.inherits(o.Events.BubbleOpen,o.Events.UiBase),o.Events.BubbleOpen.prototype.type=o.Events.BUBBLE_OPEN,o.Events.BubbleOpen.prototype.toJson=function(){var e=o.Events.BubbleOpen.superClass_.toJson.call(this);return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId,e},o.Events.BubbleOpen.prototype.fromJson=function(e){o.Events.BubbleOpen.superClass_.fromJson.call(this,e),this.isOpen=e.isOpen,this.bubbleType=e.bubbleType,this.blockId=e.blockId},o.registry.register(o.registry.Type.EVENT,o.Events.BUBBLE_OPEN,o.Events.BubbleOpen),o.Icon=function(e){this.block_=e,this.iconGroup_=null},o.Icon.prototype.collapseHidden=!0,o.Icon.prototype.SIZE=17,o.Icon.prototype.bubble_=null,o.Icon.prototype.iconXY_=null,o.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&o.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),o.browserEvents.conditionalBind(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},o.Icon.prototype.dispose=function(){o.utils.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},o.Icon.prototype.updateEditable=function(){},o.Icon.prototype.isVisible=function(){return!!this.bubble_},o.Icon.prototype.iconClick_=function(e){this.block_.workspace.isDragging()||this.block_.isInFlyout||o.utils.isRightButton(e)||this.setVisible(!this.isVisible())},o.Icon.prototype.applyColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.style.colourPrimary)},o.Icon.prototype.setIconLocation=function(e){this.iconXY_=e,this.isVisible()&&this.bubble_.setAnchorLocation(e)},o.Icon.prototype.computeIconLocation=function(){var e=this.block_.getRelativeToSurfaceXY(),r=o.utils.getRelativeXY(this.iconGroup_);e=new o.utils.Coordinate(e.x+r.x+this.SIZE/2,e.y+r.y+this.SIZE/2),o.utils.Coordinate.equals(this.getIconLocation(),e)||this.setIconLocation(e)},o.Icon.prototype.getIconLocation=function(){return this.iconXY_},o.Icon.prototype.getCorrectedSize=function(){return new o.utils.Size(o.Icon.prototype.SIZE,o.Icon.prototype.SIZE-2)},o.Warning=function(e){o.Warning.superClass_.constructor.call(this,e),this.createIcon(),this.text_=Object.create(null)},o.utils.object.inherits(o.Warning,o.Icon),o.Warning.prototype.collapseHidden=!1,o.Warning.prototype.drawIcon_=function(e){o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},e),o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},e),o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},e)},o.Warning.prototype.setVisible=function(e){e!=this.isVisible()&&(o.Events.fire(new(o.Events.get(o.Events.BUBBLE_OPEN))(this.block_,e,"warning")),e?this.createBubble_():this.disposeBubble_())},o.Warning.prototype.createBubble_=function(){this.paragraphElement_=o.Bubble.textToDom(this.getText()),this.bubble_=o.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},o.Warning.prototype.disposeBubble_=function(){this.bubble_.dispose(),this.paragraphElement_=this.bubble_=null},o.Warning.prototype.setText=function(e,r){this.text_[r]!=e&&(e?this.text_[r]=e:delete this.text_[r],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},o.Warning.prototype.getText=function(){var r,e=[];for(r in this.text_)e.push(this.text_[r]);return e.join("\n")},o.Warning.prototype.dispose=function(){this.block_.warning=null,o.Icon.prototype.dispose.call(this)},o.Comment=function(e){o.Comment.superClass_.constructor.call(this,e),this.model_=e.commentModel,this.model_.text=this.model_.text||"",this.cachedText_="",this.onInputWrapper_=this.onChangeWrapper_=this.onWheelWrapper_=this.onMouseUpWrapper_=null,this.createIcon()},o.utils.object.inherits(o.Comment,o.Icon),o.Comment.prototype.drawIcon_=function(e){o.utils.dom.createSvgElement(o.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},e),o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},e),o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},e)},o.Comment.prototype.createEditor_=function(){this.foreignObject_=o.utils.dom.createSvgElement(o.utils.Svg.FOREIGNOBJECT,{x:o.Bubble.BORDER_WIDTH,y:o.Bubble.BORDER_WIDTH},null);var e=document.createElementNS(o.utils.dom.HTML_NS,"body");e.setAttribute("xmlns",o.utils.dom.HTML_NS),e.className="blocklyMinimalBody";var r=this.textarea_=document.createElementNS(o.utils.dom.HTML_NS,"textarea");return r.className="blocklyCommentTextarea",r.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),r.value=this.model_.text,this.resizeTextarea_(),e.appendChild(r),this.foreignObject_.appendChild(e),this.onMouseUpWrapper_=o.browserEvents.conditionalBind(r,"mouseup",this,this.startEdit_,!0,!0),this.onWheelWrapper_=o.browserEvents.conditionalBind(r,"wheel",this,function(l){l.stopPropagation()}),this.onChangeWrapper_=o.browserEvents.conditionalBind(r,"change",this,function(l){this.cachedText_!=this.model_.text&&o.Events.fire(new(o.Events.get(o.Events.BLOCK_CHANGE))(this.block_,"comment",null,this.cachedText_,this.model_.text))}),this.onInputWrapper_=o.browserEvents.conditionalBind(r,"input",this,function(l){this.model_.text=r.value}),setTimeout(r.focus.bind(r),0),this.foreignObject_},o.Comment.prototype.updateEditable=function(){o.Comment.superClass_.updateEditable.call(this),this.isVisible()&&(this.disposeBubble_(),this.createBubble_())},o.Comment.prototype.onBubbleResize_=function(){this.isVisible()&&(this.model_.size=this.bubble_.getBubbleSize(),this.resizeTextarea_())},o.Comment.prototype.resizeTextarea_=function(){var e=this.model_.size,r=2*o.Bubble.BORDER_WIDTH,l=e.width-r;e=e.height-r,this.foreignObject_.setAttribute("width",l),this.foreignObject_.setAttribute("height",e),this.textarea_.style.width=l-4+"px",this.textarea_.style.height=e-4+"px"},o.Comment.prototype.setVisible=function(e){e!=this.isVisible()&&(o.Events.fire(new(o.Events.get(o.Events.BUBBLE_OPEN))(this.block_,e,"comment")),(this.model_.pinned=e)?this.createBubble_():this.disposeBubble_())},o.Comment.prototype.createBubble_=function(){!this.block_.isEditable()||o.utils.userAgent.IE?this.createNonEditableBubble_():this.createEditableBubble_()},o.Comment.prototype.createEditableBubble_=function(){this.bubble_=new o.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,this.model_.size.width,this.model_.size.height),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this)),this.applyColour()},o.Comment.prototype.createNonEditableBubble_=function(){this.paragraphElement_=o.Bubble.textToDom(this.block_.getCommentText()),this.bubble_=o.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},o.Comment.prototype.disposeBubble_=function(){this.onMouseUpWrapper_&&(o.browserEvents.unbind(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onWheelWrapper_&&(o.browserEvents.unbind(this.onWheelWrapper_),this.onWheelWrapper_=null),this.onChangeWrapper_&&(o.browserEvents.unbind(this.onChangeWrapper_),this.onChangeWrapper_=null),this.onInputWrapper_&&(o.browserEvents.unbind(this.onInputWrapper_),this.onInputWrapper_=null),this.bubble_.dispose(),this.paragraphElement_=this.foreignObject_=this.textarea_=this.bubble_=null},o.Comment.prototype.startEdit_=function(e){this.bubble_.promote()&&this.textarea_.focus(),this.cachedText_=this.model_.text},o.Comment.prototype.getBubbleSize=function(){return this.model_.size},o.Comment.prototype.setBubbleSize=function(e,r){this.bubble_?this.bubble_.setBubbleSize(e,r):(this.model_.size.width=e,this.model_.size.height=r)},o.Comment.prototype.updateText=function(){this.textarea_?this.textarea_.value=this.model_.text:this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model_.text)},o.Comment.prototype.dispose=function(){this.block_.comment=null,o.Icon.prototype.dispose.call(this)},o.Css.register(".blocklyCommentTextarea {,background-color: #fef49c;,border: 0;,outline: 0;,margin: 0;,padding: 3px;,resize: none;,display: block;,text-overflow: hidden;,}".split(",")),o.IComponent=function(){},o.IDragTarget=function(){},o.DragTarget=function(){},o.DragTarget.prototype.onDragEnter=function(e){},o.DragTarget.prototype.onDragOver=function(e){},o.DragTarget.prototype.onDragExit=function(e){},o.DragTarget.prototype.onDrop=function(e){},o.DragTarget.prototype.shouldPreventMove=function(e){return!1},o.IDeleteArea=function(){},o.DeleteArea=function(){o.DeleteArea.superClass_.constructor.call(this),this.wouldDelete_=!1},o.utils.object.inherits(o.DeleteArea,o.DragTarget),o.DeleteArea.prototype.wouldDelete=function(e,r){return e instanceof o.BlockSvg?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e&&!r)):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_},o.DeleteArea.prototype.updateWouldDelete_=function(e){this.wouldDelete_=e},o.IFlyout=function(){},o.Flyout=function(e){o.Flyout.superClass_.constructor.call(this),e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new o.WorkspaceSvg(e),this.workspace_.setMetricsManager(new o.FlyoutMetricsManager(this.workspace_,this)),this.workspace_.isFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=o.utils.genUid(),this.RTL=!!e.RTL,this.horizontalLayout=!1,this.toolboxPosition_=e.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.targetWorkspace=null},o.utils.object.inherits(o.Flyout,o.DeleteArea),o.Flyout.prototype.autoClose=!0,o.Flyout.prototype.isVisible_=!1,o.Flyout.prototype.containerVisible_=!0,o.Flyout.prototype.CORNER_RADIUS=8,o.Flyout.prototype.MARGIN=o.Flyout.prototype.CORNER_RADIUS,o.Flyout.prototype.GAP_X=3*o.Flyout.prototype.MARGIN,o.Flyout.prototype.GAP_Y=3*o.Flyout.prototype.MARGIN,o.Flyout.prototype.SCROLLBAR_MARGIN=2.5,o.Flyout.prototype.width_=0,o.Flyout.prototype.height_=0,o.Flyout.prototype.dragAngleRange_=70,o.Flyout.prototype.createDom=function(e){return this.svgGroup_=o.utils.dom.createSvgElement(e,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_},o.Flyout.prototype.init=function(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new o.ScrollbarPair(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,o.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,o.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:1,capabilities:[o.ComponentManager.Capability.DELETE_AREA,o.ComponentManager.Capability.DRAG_TARGET]})},o.Flyout.prototype.dispose=function(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),o.browserEvents.unbind(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(o.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace=this.svgBackground_=null},o.Flyout.prototype.getWidth=function(){return this.width_},o.Flyout.prototype.getHeight=function(){return this.height_},o.Flyout.prototype.getFlyoutScale=function(){return this.targetWorkspace.scale},o.Flyout.prototype.getWorkspace=function(){return this.workspace_},o.Flyout.prototype.isVisible=function(){return this.isVisible_},o.Flyout.prototype.setVisible=function(e){var r=e!=this.isVisible();this.isVisible_=e,r&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())},o.Flyout.prototype.setContainerVisible=function(e){var r=e!=this.containerVisible_;this.containerVisible_=e,r&&this.updateDisplay_()},o.Flyout.prototype.updateDisplay_=function(){var e=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=e?"block":"none",this.workspace_.scrollbar.setContainerVisible(e)},o.Flyout.prototype.positionAt_=function(e,r,l,c){this.svgGroup_.setAttribute("width",e),this.svgGroup_.setAttribute("height",r),this.workspace_.setCachedParentSvgSize(e,r),"svg"==this.svgGroup_.tagName?o.utils.dom.setCssTransform(this.svgGroup_,"translate("+l+"px,"+c+"px)"):this.svgGroup_.setAttribute("transform","translate("+l+","+c+")"),(e=this.workspace_.scrollbar)&&(e.setOrigin(l,c),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))},o.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var r,e=0;r=this.listeners_[e];e++)o.browserEvents.unbind(r);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},o.Flyout.prototype.show=function(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof e&&(e=this.getDynamicCategoryContents_(e)),this.setVisible(!0),e=o.utils.toolbox.convertFlyoutDefToJsonArray(e),e=this.createFlyoutInfo_(e),this.layout_(e.contents,e.gaps),this.listeners_.push(o.browserEvents.conditionalBind(this.svgBackground_,"mouseover",this,function(){for(var c,r=this.workspace_.getTopBlocks(!1),l=0;c=r[l];l++)c.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},o.Flyout.prototype.createFlyoutInfo_=function(e){var r=[],l=[];this.permanentlyDisabled_.length=0;for(var _,c=this.horizontalLayout?this.GAP_X:this.GAP_Y,p=0;_=e[p];p++)switch(_.custom&&(_=this.getDynamicCategoryContents_(_.custom),_=o.utils.toolbox.convertFlyoutDefToJsonArray(_),e.splice.apply(e,[p,1].concat(_)),_=e[p]),_.kind.toUpperCase()){case"BLOCK":var v=_,b=this.getBlockXml_(v);_=this.createBlock_(b),v=parseInt(v.gap||b.getAttribute("gap"),10),l.push(isNaN(v)?c:v),r.push({type:"block",block:_});break;case"SEP":this.addSeparatorGap_(_,l,c);break;case"LABEL":_=this.createButton_(_,!0),r.push({type:"button",button:_}),l.push(c);break;case"BUTTON":_=this.createButton_(_,!1),r.push({type:"button",button:_}),l.push(c)}return{contents:r,gaps:l}},o.Flyout.prototype.getDynamicCategoryContents_=function(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");if(e=e(this.workspace_.targetWorkspace),!Array.isArray(e))throw new TypeError("Result of toolbox category callback must be an array.");return e},o.Flyout.prototype.createButton_=function(e,r){if(!o.FlyoutButton)throw Error("Missing require for Blockly.FlyoutButton");return new o.FlyoutButton(this.workspace_,this.targetWorkspace,e,r)},o.Flyout.prototype.createBlock_=function(e){return(e=o.Xml.domToBlock(e,this.workspace_)).isEnabled()||this.permanentlyDisabled_.push(e),e},o.Flyout.prototype.getBlockXml_=function(e){var r=null,l=e.blockxml;if(l&&"string"!=typeof l?r=l:l&&"string"==typeof l?(r=o.Xml.textToDom(l),e.blockxml=r):e.type&&((r=o.utils.xml.createElement("xml")).setAttribute("type",e.type),r.setAttribute("disabled",e.disabled),e.blockxml=r),!r)throw Error("Error: Invalid block definition. Block definition must have blockxml or type.");return r},o.Flyout.prototype.addSeparatorGap_=function(e,r,l){e=parseInt(e.gap,10),!isNaN(e)&&0<r.length?r[r.length-1]=e:r.push(l)},o.Flyout.prototype.clearOldBlocks_=function(){for(var l,e=this.workspace_.getTopBlocks(!1),r=0;l=e[r];r++)l.workspace==this.workspace_&&l.dispose(!1,!1);for(r=0;r<this.mats_.length;r++)(e=this.mats_[r])&&(o.Tooltip.unbindMouseEvents(e),o.utils.dom.removeNode(e));for(r=this.mats_.length=0;e=this.buttons_[r];r++)e.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},o.Flyout.prototype.addBlockListeners_=function(e,r,l){this.listeners_.push(o.browserEvents.conditionalBind(e,"mousedown",null,this.blockMouseDown_(r))),this.listeners_.push(o.browserEvents.conditionalBind(l,"mousedown",null,this.blockMouseDown_(r))),this.listeners_.push(o.browserEvents.bind(e,"mouseenter",r,r.addSelect)),this.listeners_.push(o.browserEvents.bind(e,"mouseleave",r,r.removeSelect)),this.listeners_.push(o.browserEvents.bind(l,"mouseenter",r,r.addSelect)),this.listeners_.push(o.browserEvents.bind(l,"mouseleave",r,r.removeSelect))},o.Flyout.prototype.blockMouseDown_=function(e){var r=this;return function(l){var c=r.targetWorkspace.getGesture(l);c&&(c.setStartBlock(e),c.handleFlyoutStart(l,r))}},o.Flyout.prototype.onMouseDown_=function(e){var r=this.targetWorkspace.getGesture(e);r&&r.handleFlyoutStart(e,this)},o.Flyout.prototype.isBlockCreatable_=function(e){return e.isEnabled()},o.Flyout.prototype.createBlock=function(e){var r=null;o.Events.disable();var l=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{r=this.placeNewBlock_(e)}finally{o.Events.enable()}if(o.hideChaff(),e=o.Variables.getAddedVariables(this.targetWorkspace,l),o.Events.isEnabled()){for(o.Events.setGroup(!0),l=0;l<e.length;l++){var c=e[l];o.Events.fire(new(o.Events.get(o.Events.VAR_CREATE))(c))}o.Events.fire(new(o.Events.get(o.Events.BLOCK_CREATE))(r))}return this.autoClose?this.hide():this.filterForCapacity_(),r},o.Flyout.prototype.initFlyoutButton_=function(e,r,l){var c=e.createDom();e.moveTo(r,l),e.show(),this.listeners_.push(o.browserEvents.conditionalBind(c,"mousedown",this,this.onMouseDown_)),this.buttons_.push(e)},o.Flyout.prototype.createRect_=function(e,r,l,c,p){return(r=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{"fill-opacity":0,x:r,y:l,height:c.height,width:c.width},null)).tooltip=e,o.Tooltip.bindMouseEvents(r),this.workspace_.getCanvas().insertBefore(r,e.getSvgRoot()),e.flyoutRect_=r,this.mats_[p]=r},o.Flyout.prototype.moveRectToBlock_=function(e,r){var l=r.getHeightWidth();e.setAttribute("width",l.width),e.setAttribute("height",l.height),r=r.getRelativeToSurfaceXY(),e.setAttribute("y",r.y),e.setAttribute("x",this.RTL?r.x-l.width:r.x)},o.Flyout.prototype.filterForCapacity_=function(){for(var l,e=this.workspace_.getTopBlocks(!1),r=0;l=e[r];r++)if(-1==this.permanentlyDisabled_.indexOf(l))for(var c=this.targetWorkspace.isCapacityAvailable(o.utils.getBlockTypeCounts(l));l;)l.setEnabled(c),l=l.getNextBlock()},o.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},o.Flyout.prototype.isScrollable=function(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()},o.Flyout.prototype.placeNewBlock_=function(e){var r=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered.");var l=o.Xml.blockToDom(e,!0);if(r.setResizesEnabled(!1),!(l=o.Xml.domToBlock(l,r)).getSvgRoot())throw Error("block is not rendered.");var c=r.getOriginOffsetInPixels(),p=this.workspace_.getOriginOffsetInPixels();return(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),e=o.utils.Coordinate.sum(p,e),(c=o.utils.Coordinate.difference(e,c)).scale(1/r.scale),l.moveBy(c.x,c.y),l},o.HorizontalFlyout=function(e){o.HorizontalFlyout.superClass_.constructor.call(this,e),this.horizontalLayout=!0},o.utils.object.inherits(o.HorizontalFlyout,o.Flyout),o.HorizontalFlyout.prototype.setMetrics_=function(e){if(this.isVisible()){var r=this.workspace_.getMetricsManager(),l=r.getScrollMetrics(),c=r.getViewMetrics();r=r.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(l.left+(l.width-c.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+r.left,this.workspace_.scrollY+r.top)}},o.HorizontalFlyout.prototype.getX=function(){return 0},o.HorizontalFlyout.prototype.getY=function(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager(),r=e.getAbsoluteMetrics(),l=e.getViewMetrics();e=e.getToolboxMetrics();var c=this.toolboxPosition_==o.utils.toolbox.Position.TOP;return this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?c?e.height:l.height-this.height_:c?0:l.height:c?0:l.height+r.top-this.height_},o.HorizontalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath_(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var r=this.getY();this.positionAt_(this.width_,this.height_,e,r)}},o.HorizontalFlyout.prototype.setBackgroundPath_=function(e,r){var l=this.toolboxPosition_==o.utils.toolbox.Position.TOP,c=["M 0,"+(l?0:this.CORNER_RADIUS)];l?(c.push("h",e+2*this.CORNER_RADIUS),c.push("v",r),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("h",-e),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),c.push("h",e),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("v",r),c.push("h",-e-2*this.CORNER_RADIUS)),c.push("z"),this.svgBackground_.setAttribute("d",c.join(" "))},o.HorizontalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setX(this.RTL?1/0:0)},o.HorizontalFlyout.prototype.wheel_=function(e){var r=o.utils.getScrollDeltaPixels(e);if(r=r.x||r.y){var l=this.workspace_.getMetricsManager(),c=l.getScrollMetrics();r=l.getViewMetrics().left-c.left+r,this.workspace_.scrollbar.setX(r),o.WidgetDiv.hide(),o.DropDownDiv.hideWithoutAnimation()}e.preventDefault(),e.stopPropagation()},o.HorizontalFlyout.prototype.layout_=function(e,r){this.workspace_.scale=this.targetWorkspace.scale;var l=this.MARGIN,c=l+this.tabWidth_;this.RTL&&(e=e.reverse());for(var _,p=0;_=e[p];p++)if("block"==_.type){for(var w,v=(_=_.block).getDescendants(!1),b=0;w=v[b];b++)w.isInFlyout=!0;_.render(),v=_.getSvgRoot(),b=_.getHeightWidth(),w=_.outputConnection?this.tabWidth_:0,_.moveBy(w=this.RTL?c+b.width:c-w,l),w=this.createRect_(_,w,l,b,p),c+=b.width+r[p],this.addBlockListeners_(v,_,w)}else"button"==_.type&&(this.initFlyoutButton_(_.button,c,l),c+=_.button.width+r[p])},o.HorizontalFlyout.prototype.isDragTowardWorkspace=function(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var r=this.dragAngleRange_;return e<90+r&&e>90-r||e>-90-r&&e<-90+r},o.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var e=this.svgGroup_.getBoundingClientRect(),r=e.top;return this.toolboxPosition_==o.utils.toolbox.Position.TOP?new o.utils.Rect(-1e9,r+e.height,-1e9,1e9):new o.utils.Rect(r,1e9,-1e9,1e9)},o.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var c,e=0,r=this.workspace_.getTopBlocks(!1),l=0;c=r[l];l++)e=Math.max(e,c.getHeightWidth().height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,this.height_!=(e+=o.Scrollbar.scrollbarThickness)){for(l=0;c=r[l];l++)c.flyoutRect_&&this.moveRectToBlock_(c.flyoutRect_,c);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=o.utils.toolbox.Position.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.recordDragTargets()}},o.registry.register(o.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,o.registry.DEFAULT,o.HorizontalFlyout),o.VerticalFlyout=function(e){o.VerticalFlyout.superClass_.constructor.call(this,e)},o.utils.object.inherits(o.VerticalFlyout,o.Flyout),o.VerticalFlyout.registryName="verticalFlyout",o.VerticalFlyout.prototype.setMetrics_=function(e){if(this.isVisible()){var r=this.workspace_.getMetricsManager(),l=r.getScrollMetrics(),c=r.getViewMetrics();r=r.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(l.top+(l.height-c.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+r.left,this.workspace_.scrollY+r.top)}},o.VerticalFlyout.prototype.getX=function(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager(),r=e.getAbsoluteMetrics(),l=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_==o.utils.toolbox.Position.LEFT?e.width:l.width-this.width_:this.toolboxPosition_==o.utils.toolbox.Position.LEFT?0:l.width:this.toolboxPosition_==o.utils.toolbox.Position.LEFT?0:l.width+r.left-this.width_},o.VerticalFlyout.prototype.getY=function(){return 0},o.VerticalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var r=this.getY();this.positionAt_(this.width_,this.height_,e,r)}},o.VerticalFlyout.prototype.setBackgroundPath_=function(e,r){var l=this.toolboxPosition_==o.utils.toolbox.Position.RIGHT,c=e+this.CORNER_RADIUS;(c=["M "+(l?c:0)+",0"]).push("h",l?-e:e),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,l?0:1,l?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("v",Math.max(0,r)),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,l?0:1,l?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("h",l?e:-e),c.push("z"),this.svgBackground_.setAttribute("d",c.join(" "))},o.VerticalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setY(0)},o.VerticalFlyout.prototype.wheel_=function(e){var r=o.utils.getScrollDeltaPixels(e);if(r.y){var l=this.workspace_.getMetricsManager(),c=l.getScrollMetrics();r=l.getViewMetrics().top-c.top+r.y,this.workspace_.scrollbar.setY(r),o.WidgetDiv.hide(),o.DropDownDiv.hideWithoutAnimation()}e.preventDefault(),e.stopPropagation()},o.VerticalFlyout.prototype.layout_=function(e,r){this.workspace_.scale=this.targetWorkspace.scale;for(var _,l=this.MARGIN,c=this.RTL?l:l+this.tabWidth_,p=0;_=e[p];p++)if("block"==_.type){for(var w,v=(_=_.block).getDescendants(!1),b=0;w=v[b];b++)w.isInFlyout=!0;_.render(),v=_.getSvgRoot(),b=_.getHeightWidth(),_.moveBy(w=_.outputConnection?c-this.tabWidth_:c,l),w=this.createRect_(_,this.RTL?w-b.width:w,l,b,p),this.addBlockListeners_(v,_,w),l+=b.height+r[p]}else"button"==_.type&&(this.initFlyoutButton_(_.button,c,l),l+=_.button.height+r[p])},o.VerticalFlyout.prototype.isDragTowardWorkspace=function(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var r=this.dragAngleRange_;return e<r&&e>-r||e<-180+r||e>180-r},o.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var e=this.svgGroup_.getBoundingClientRect(),r=e.left;return this.toolboxPosition_==o.utils.toolbox.Position.LEFT?new o.utils.Rect(-1e9,1e9,-1e9,r+e.width):new o.utils.Rect(-1e9,1e9,r,1e9)},o.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var c,e=0,r=this.workspace_.getTopBlocks(!1),l=0;c=r[l];l++){var p=c.getHeightWidth().width;c.outputConnection&&(p-=this.tabWidth_),e=Math.max(e,p)}for(l=0;c=this.buttons_[l];l++)e=Math.max(e,c.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,this.width_!=(e+=o.Scrollbar.scrollbarThickness)){for(l=0;c=r[l];l++){if(this.RTL){p=c.getRelativeToSurfaceXY().x;var _=e/this.workspace_.scale-this.MARGIN;c.outputConnection||(_-=this.tabWidth_),c.moveBy(_-p,0)}c.flyoutRect_&&this.moveRectToBlock_(c.flyoutRect_,c)}if(this.RTL)for(l=0;c=this.buttons_[l];l++)r=c.getPosition().y,c.moveTo(e/this.workspace_.scale-c.width-this.MARGIN-this.tabWidth_,r);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=o.utils.toolbox.Position.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.recordDragTargets()}},o.registry.register(o.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,o.registry.DEFAULT,o.VerticalFlyout),o.FlyoutButton=function(e,r,l,c){this.workspace_=e,this.targetWorkspace_=r,this.text_=l.text,this.position_=new o.utils.Coordinate(0,0),this.isLabel_=c,this.callbackKey_=l.callbackKey||l.callbackkey,this.cssClass_=l["web-class"]||null,this.onMouseUpWrapper_=null,this.info=l},o.FlyoutButton.MARGIN_X=5,o.FlyoutButton.MARGIN_Y=2,o.FlyoutButton.prototype.width=0,o.FlyoutButton.prototype.height=0,o.FlyoutButton.prototype.createDom=function(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_&&(e+=" "+this.cssClass_),this.svgGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:e},this.workspace_.getCanvas()),!this.isLabel_)var r=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);e=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var l=o.utils.dom.createSvgElement(o.utils.Svg.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_),c=o.utils.replaceMessageReferences(this.text_);this.workspace_.RTL&&(c+="\u200f"),l.textContent=c,this.isLabel_&&(this.svgText_=l,this.workspace_.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));var p=o.utils.style.getComputedStyle(l,"fontSize"),_=o.utils.style.getComputedStyle(l,"fontWeight"),v=o.utils.style.getComputedStyle(l,"fontFamily");return this.width=o.utils.dom.getFastTextWidthWithSizeString(l,p,_,v),c=o.utils.dom.measureFontMetrics(c,p,_,v),this.height=c.height,this.isLabel_||(this.width+=2*o.FlyoutButton.MARGIN_X,this.height+=2*o.FlyoutButton.MARGIN_Y,r.setAttribute("width",this.width),r.setAttribute("height",this.height)),e.setAttribute("width",this.width),e.setAttribute("height",this.height),l.setAttribute("x",this.width/2),l.setAttribute("y",this.height/2-c.height/2+c.baseline),this.updateTransform_(),this.onMouseUpWrapper_=o.browserEvents.conditionalBind(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},o.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},o.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},o.FlyoutButton.prototype.moveTo=function(e,r){this.position_.x=e,this.position_.y=r,this.updateTransform_()},o.FlyoutButton.prototype.isLabel=function(){return this.isLabel_},o.FlyoutButton.prototype.getPosition=function(){return this.position_},o.FlyoutButton.prototype.getButtonText=function(){return this.text_},o.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},o.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&o.browserEvents.unbind(this.onMouseUpWrapper_),this.svgGroup_&&o.utils.dom.removeNode(this.svgGroup_),this.svgText_&&this.workspace_.getThemeManager().unsubscribe(this.svgText_)},o.FlyoutButton.prototype.onMouseUp_=function(e){(e=this.targetWorkspace_.getGesture(e))&&e.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace_.getButtonCallback(this.callbackKey_)?this.isLabel_||this.targetWorkspace_.getButtonCallback(this.callbackKey_)(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)},o.Css.register(".blocklyFlyoutButton {,fill: #888;,cursor: default;,},.blocklyFlyoutButtonShadow {,fill: #666;,},.blocklyFlyoutButton:hover {,fill: #aaa;,},.blocklyFlyoutLabel {,cursor: default;,},.blocklyFlyoutLabelBackground {,opacity: 0;,}".split(",")),o.Generator=function(e){this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},o.Generator.prototype.INFINITE_LOOP_TRAP=null,o.Generator.prototype.STATEMENT_PREFIX=null,o.Generator.prototype.STATEMENT_SUFFIX=null,o.Generator.prototype.INDENT="  ",o.Generator.prototype.COMMENT_WRAP=60,o.Generator.prototype.ORDER_OVERRIDES=[],o.Generator.prototype.isInitialized=null,o.Generator.prototype.workspaceToCode=function(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=o.getMainWorkspace());var r=[];this.init(e),e=e.getTopBlocks(!0);for(var c,l=0;c=e[l];l++){var p=this.blockToCode(c);Array.isArray(p)&&(p=p[0]),p&&(c.outputConnection&&(p=this.scrubNakedValue(p),this.STATEMENT_PREFIX&&!c.suppressPrefixSuffix&&(p=this.injectId(this.STATEMENT_PREFIX,c)+p),this.STATEMENT_SUFFIX&&!c.suppressPrefixSuffix&&(p+=this.injectId(this.STATEMENT_SUFFIX,c))),r.push(p))}return r=r.join("\n"),(r=(r=(r=this.finish(r)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},o.Generator.prototype.prefixLines=function(e,r){return r+e.replace(/(?!\n$)\n/g,"\n"+r)},o.Generator.prototype.allNestedComments=function(e){var r=[];e=e.getDescendants(!0);for(var l=0;l<e.length;l++){var c=e[l].getCommentText();c&&r.push(c)}return r.length&&r.push(""),r.join("\n")},o.Generator.prototype.blockToCode=function(e,r){if(!1===this.isInitialized&&console.warn("Generator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return r?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return r?"":this.blockToCode(e.getChildren(!1)[0]);var l=this[e.type];if("function"!=typeof l)throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+e.type+'".');if(l=l.call(e,e),Array.isArray(l)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,l[0],r),l[1]]}if("string"==typeof l)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(l=this.injectId(this.STATEMENT_PREFIX,e)+l),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(l+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,l,r);if(null===l)return"";throw SyntaxError("Invalid code generated: "+l)},o.Generator.prototype.valueToCode=function(e,r,l){if(isNaN(l))throw TypeError("Expecting valid order from block: "+e.type);var c=e.getInputTargetBlock(r);if(!c||""===(r=this.blockToCode(c)))return"";if(!Array.isArray(r))throw TypeError("Expecting tuple from value block: "+c.type);if(e=r[0],r=r[1],isNaN(r))throw TypeError("Expecting valid order from value block: "+c.type);if(!e)return"";c=!1;var p=Math.floor(l),_=Math.floor(r);if(p<=_&&(p!=_||0!=p&&99!=p))for(c=!0,p=0;p<this.ORDER_OVERRIDES.length;p++)if(this.ORDER_OVERRIDES[p][0]==l&&this.ORDER_OVERRIDES[p][1]==r){c=!1;break}return c&&(e="("+e+")"),e},o.Generator.prototype.statementToCode=function(e,r){if(e=e.getInputTargetBlock(r),"string"!=typeof(r=this.blockToCode(e)))throw TypeError("Expecting code from statement block: "+(e&&e.type));return r&&(r=this.prefixLines(r,this.INDENT)),r},o.Generator.prototype.addLoopTrap=function(e,r){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,r),this.INDENT)+e),this.STATEMENT_SUFFIX&&!r.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,r),this.INDENT)+e),this.STATEMENT_PREFIX&&!r.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,r),this.INDENT)),e},o.Generator.prototype.injectId=function(e,r){return r=r.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+r+"'")},o.Generator.prototype.RESERVED_WORDS_="",o.Generator.prototype.addReservedWords=function(e){this.RESERVED_WORDS_+=e+","},o.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",Object.defineProperty(o.Generator.prototype,"variableDB_",{get:function(){return o.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_},set:function(e){o.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_=e}}),o.Generator.prototype.provideFunction_=function(e,r){if(!this.definitions_[e]){var c,l=this.nameDB_.getDistinctName(e,o.PROCEDURE_CATEGORY_NAME);for(this.functionNames_[e]=l,r=r.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,l);c!=r;)c=r,r=r.replace(/^(( {2})*) {2}/gm,"$1\0");r=r.replace(/\0/g,this.INDENT),this.definitions_[e]=r}return this.functionNames_[e]},o.Generator.prototype.init=function(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)},o.Generator.prototype.scrub_=function(e,r,l){return r},o.Generator.prototype.finish=function(e){return delete this.definitions_,delete this.functionNames_,e},o.Generator.prototype.scrubNakedValue=function(e){return e},o.IToolboxItem=function(){},o.ISelectableToolboxItem=function(){},o.ICollapsibleToolboxItem=function(){},o.ToolboxItem=function(e,r,l){this.id_=e.toolboxitemid||o.utils.IdGenerator.getNextUniqueId(),this.level_=(this.parent_=l||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=r,this.workspace_=this.parentToolbox_.getWorkspace()},o.ToolboxItem.prototype.init=function(){},o.ToolboxItem.prototype.getDiv=function(){return null},o.ToolboxItem.prototype.getId=function(){return this.id_},o.ToolboxItem.prototype.getParent=function(){return null},o.ToolboxItem.prototype.getLevel=function(){return this.level_},o.ToolboxItem.prototype.isSelectable=function(){return!1},o.ToolboxItem.prototype.isCollapsible=function(){return!1},o.ToolboxItem.prototype.dispose=function(){},o.ToolboxCategory=function(e,r,l){o.ToolboxCategory.superClass_.constructor.call(this,e,r,l),this.name_=o.utils.replaceMessageReferences(e.name),this.colour_=this.getColour_(e),this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.cssConfig_=this.makeDefaultCssConfig_(),o.utils.object.mixin(this.cssConfig_,e.cssconfig||e.cssConfig),this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.parseContents_(e)},o.utils.object.inherits(o.ToolboxCategory,o.ToolboxItem),o.ToolboxCategory.registrationName="category",o.ToolboxCategory.nestedPadding=19,o.ToolboxCategory.borderWidth=8,o.ToolboxCategory.defaultBackgroundColour="#57e",o.ToolboxCategory.prototype.makeDefaultCssConfig_=function(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}},o.ToolboxCategory.prototype.parseContents_=function(e){var r=e.contents;if(e.custom)this.flyoutItems_=e.custom;else if(r){e=0;for(var l;l=r[e];e++)this.flyoutItems_.push(l)}},o.ToolboxCategory.prototype.init=function(){this.createDom_(),"true"==this.toolboxItemDef_.hidden&&this.hide()},o.ToolboxCategory.prototype.createDom_=function(){return this.htmlDiv_=this.createContainer_(),o.utils.aria.setRole(this.htmlDiv_,o.utils.aria.Role.TREEITEM),o.utils.aria.setState(this.htmlDiv_,o.utils.aria.State.SELECTED,!1),o.utils.aria.setState(this.htmlDiv_,o.utils.aria.State.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),o.utils.aria.setRole(this.iconDom_,o.utils.aria.Role.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_),o.utils.aria.setState(this.htmlDiv_,o.utils.aria.State.LABELLEDBY,this.labelDom_.getAttribute("id")),this.addColourBorder_(this.colour_),this.htmlDiv_},o.ToolboxCategory.prototype.createContainer_=function(){var e=document.createElement("div");return o.utils.dom.addClass(e,this.cssConfig_.container),e},o.ToolboxCategory.prototype.createRowContainer_=function(){var e=document.createElement("div");o.utils.dom.addClass(e,this.cssConfig_.row);var r=o.ToolboxCategory.nestedPadding*this.getLevel();return r=r.toString()+"px",this.workspace_.RTL?e.style.paddingRight=r:e.style.paddingLeft=r,e},o.ToolboxCategory.prototype.createRowContentsContainer_=function(){var e=document.createElement("div");return o.utils.dom.addClass(e,this.cssConfig_.rowcontentcontainer),e},o.ToolboxCategory.prototype.createIconDom_=function(){var e=document.createElement("span");return this.parentToolbox_.isHorizontal()||o.utils.dom.addClass(e,this.cssConfig_.icon),e.style.display="inline-block",e},o.ToolboxCategory.prototype.createLabelDom_=function(e){var r=document.createElement("span");return r.setAttribute("id",this.getId()+".label"),r.textContent=e,o.utils.dom.addClass(r,this.cssConfig_.label),r},o.ToolboxCategory.prototype.refreshTheme=function(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)},o.ToolboxCategory.prototype.addColourBorder_=function(e){e&&(e=o.ToolboxCategory.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)},o.ToolboxCategory.prototype.getColour_=function(e){var r=e.categorystyle||e.categoryStyle;return(e=e.colour)&&r?(console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour'),""):r?this.getColourfromStyle_(r):this.parseColour_(e)},o.ToolboxCategory.prototype.getColourfromStyle_=function(e){var r=this.workspace_.getTheme();if(e&&r){if((r=r.categoryStyles[e])&&r.colour)return this.parseColour_(r.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""},o.ToolboxCategory.prototype.getClickTarget=function(){return this.rowDiv_},o.ToolboxCategory.prototype.parseColour_=function(e){if(null==(e=o.utils.replaceMessageReferences(e))||""===e)return"";var r=Number(e);return isNaN(r)?(r=o.utils.colour.parse(e))?r:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):o.hueToHex(r)},o.ToolboxCategory.prototype.openIcon_=function(e){e&&(o.utils.dom.removeClasses(e,this.cssConfig_.closedicon),o.utils.dom.addClass(e,this.cssConfig_.openicon))},o.ToolboxCategory.prototype.closeIcon_=function(e){e&&(o.utils.dom.removeClasses(e,this.cssConfig_.openicon),o.utils.dom.addClass(e,this.cssConfig_.closedicon))},o.ToolboxCategory.prototype.setVisible_=function(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},o.ToolboxCategory.prototype.hide=function(){this.setVisible_(!1)},o.ToolboxCategory.prototype.show=function(){this.setVisible_(!0)},o.ToolboxCategory.prototype.isVisible=function(){return!this.isHidden_&&this.allAncestorsExpanded_()},o.ToolboxCategory.prototype.allAncestorsExpanded_=function(){for(var e=this;e.getParent();)if(!(e=e.getParent()).isExpanded())return!1;return!0},o.ToolboxCategory.prototype.isSelectable=function(){return this.isVisible()&&!this.isDisabled_},o.ToolboxCategory.prototype.onClick=function(e){},o.ToolboxCategory.prototype.setSelected=function(e){if(e){var r=this.parseColour_(o.ToolboxCategory.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||r,o.utils.dom.addClass(this.rowDiv_,this.cssConfig_.selected)}else this.rowDiv_.style.backgroundColor="",o.utils.dom.removeClass(this.rowDiv_,this.cssConfig_.selected);o.utils.aria.setState(this.htmlDiv_,o.utils.aria.State.SELECTED,e)},o.ToolboxCategory.prototype.setDisabled=function(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",e),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")},o.ToolboxCategory.prototype.getName=function(){return this.name_},o.ToolboxCategory.prototype.getParent=function(){return this.parent_},o.ToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},o.ToolboxCategory.prototype.getContents=function(){return this.flyoutItems_},o.ToolboxCategory.prototype.updateFlyoutContents=function(e){this.flyoutItems_=[],"string"==typeof e?this.toolboxItemDef_.custom=e:(delete this.toolboxItemDef_.custom,this.toolboxItemDef_.contents=o.utils.toolbox.convertFlyoutDefToJsonArray(e)),this.parseContents_(this.toolboxItemDef_)},o.ToolboxCategory.prototype.dispose=function(){o.utils.dom.removeNode(this.htmlDiv_)},o.Css.register([".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: rgba(255, 255, 255, 0.2);","}",'.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {',"margin: 1px 5px 1px 0;","}",'.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {',"margin: 1px 0 1px 5px;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","padding-right: 0px","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","visibility: hidden;","width: 16px;","}",".blocklyTreeIconClosed {","background-position: -32px -1px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {',"background-position: 0 -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosed {","background-position: -32px -17px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {',"background-position: 0 -17px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeLabel {","cursor: default;","font: 16px sans-serif;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}"]),o.registry.register(o.registry.Type.TOOLBOX_ITEM,o.ToolboxCategory.registrationName,o.ToolboxCategory),o.ToolboxSeparator=function(e,r){o.ToolboxSeparator.superClass_.constructor.call(this,e,r),this.cssConfig_={container:"blocklyTreeSeparator"},o.utils.object.mixin(this.cssConfig_,e.cssconfig||e.cssConfig)},o.utils.object.inherits(o.ToolboxSeparator,o.ToolboxItem),o.ToolboxSeparator.registrationName="sep",o.ToolboxSeparator.prototype.init=function(){this.createDom_()},o.ToolboxSeparator.prototype.createDom_=function(){var e=document.createElement("div");return o.utils.dom.addClass(e,this.cssConfig_.container),this.htmlDiv_=e},o.ToolboxSeparator.prototype.getDiv=function(){return this.htmlDiv_},o.ToolboxSeparator.prototype.dispose=function(){o.utils.dom.removeNode(this.htmlDiv_)},o.Css.register('.blocklyTreeSeparator {,border-bottom: solid #e5e5e5 1px;,height: 0;,margin: 5px 0;,},.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {,border-right: solid #e5e5e5 1px;,border-bottom: none;,height: auto;,margin: 0 5px 0 5px;,padding: 5px 0;,width: 0;,}'.split(",")),o.registry.register(o.registry.Type.TOOLBOX_ITEM,o.ToolboxSeparator.registrationName,o.ToolboxSeparator),o.CollapsibleToolboxCategory=function(e,r,l){this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[],o.CollapsibleToolboxCategory.superClass_.constructor.call(this,e,r,l)},o.utils.object.inherits(o.CollapsibleToolboxCategory,o.ToolboxCategory),o.CollapsibleToolboxCategory.registrationName="collapsibleCategory",o.CollapsibleToolboxCategory.prototype.makeDefaultCssConfig_=function(){var e=o.CollapsibleToolboxCategory.superClass_.makeDefaultCssConfig_.call(this);return e.contents="blocklyToolboxContents",e},o.CollapsibleToolboxCategory.prototype.parseContents_=function(e){var r=e.contents,l=!0;if(e.custom)this.flyoutItems_=e.custom;else if(r){e=0;for(var c;c=r[e];e++)!o.registry.hasItem(o.registry.Type.TOOLBOX_ITEM,c.kind)||c.kind.toLowerCase()==o.ToolboxSeparator.registrationName&&l?(this.flyoutItems_.push(c),l=!0):(this.createToolboxItem_(c),l=!1)}},o.CollapsibleToolboxCategory.prototype.createToolboxItem_=function(e){var r=e.kind;"CATEGORY"==r.toUpperCase()&&o.utils.toolbox.isCategoryCollapsible(e)&&(r=o.CollapsibleToolboxCategory.registrationName),e=new(o.registry.getClass(o.registry.Type.TOOLBOX_ITEM,r))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)},o.CollapsibleToolboxCategory.prototype.init=function(){o.CollapsibleToolboxCategory.superClass_.init.call(this),this.setExpanded("true"==this.toolboxItemDef_.expanded||this.toolboxItemDef_.expanded)},o.CollapsibleToolboxCategory.prototype.createDom_=function(){o.CollapsibleToolboxCategory.superClass_.createDom_.call(this);var e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),o.utils.aria.setRole(this.subcategoriesDiv_,o.utils.aria.Role.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_},o.CollapsibleToolboxCategory.prototype.createIconDom_=function(){var e=document.createElement("span");return this.parentToolbox_.isHorizontal()||(o.utils.dom.addClass(e,this.cssConfig_.icon),e.style.visibility="visible"),e.style.display="inline-block",e},o.CollapsibleToolboxCategory.prototype.createSubCategoriesDom_=function(e){var r=document.createElement("div");o.utils.dom.addClass(r,this.cssConfig_.contents);for(var l=0;l<e.length;l++){var c=e[l];c.init();var p=c.getDiv();r.appendChild(p),c.getClickTarget&&c.getClickTarget().setAttribute("id",c.getId())}return r},o.CollapsibleToolboxCategory.prototype.setExpanded=function(e){this.expanded_!=e&&((this.expanded_=e)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),o.utils.aria.setState(this.htmlDiv_,o.utils.aria.State.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize())},o.CollapsibleToolboxCategory.prototype.setVisible_=function(e){this.htmlDiv_.style.display=e?"block":"none";for(var l,r=0;l=this.getChildToolboxItems()[r];r++)l.setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},o.CollapsibleToolboxCategory.prototype.isExpanded=function(){return this.expanded_},o.CollapsibleToolboxCategory.prototype.isCollapsible=function(){return!0},o.CollapsibleToolboxCategory.prototype.onClick=function(e){this.toggleExpanded()},o.CollapsibleToolboxCategory.prototype.toggleExpanded=function(){this.setExpanded(!this.expanded_)},o.CollapsibleToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},o.CollapsibleToolboxCategory.prototype.getChildToolboxItems=function(){return this.toolboxItems_},o.registry.register(o.registry.Type.TOOLBOX_ITEM,o.CollapsibleToolboxCategory.registrationName,o.CollapsibleToolboxCategory),o.Events.ToolboxItemSelect=function(e,r,l){o.Events.ToolboxItemSelect.superClass_.constructor.call(this,l),this.oldItem=e,this.newItem=r},o.utils.object.inherits(o.Events.ToolboxItemSelect,o.Events.UiBase),o.Events.ToolboxItemSelect.prototype.type=o.Events.TOOLBOX_ITEM_SELECT,o.Events.ToolboxItemSelect.prototype.toJson=function(){var e=o.Events.ToolboxItemSelect.superClass_.toJson.call(this);return e.oldItem=this.oldItem,e.newItem=this.newItem,e},o.Events.ToolboxItemSelect.prototype.fromJson=function(e){o.Events.ToolboxItemSelect.superClass_.fromJson.call(this,e),this.oldItem=e.oldItem,this.newItem=e.newItem},o.registry.register(o.registry.Type.EVENT,o.Events.TOOLBOX_ITEM_SELECT,o.Events.ToolboxItemSelect),o.IAutoHideable=function(){},o.IStyleable=function(){},o.IToolbox=function(){},o.Toolbox=function(e){o.Toolbox.superClass_.constructor.call(this),this.workspace_=e,this.id="toolbox",this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout_=e.options.horizontalLayout,this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.RTL=e.options.RTL,this.flyout_=null,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[]},o.utils.object.inherits(o.Toolbox,o.DeleteArea),o.Toolbox.prototype.onShortcut=function(e){return!1},o.Toolbox.prototype.init=function(){var e=this.workspace_,r=e.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),o.utils.dom.insertAfter(this.flyout_.createDom("svg"),r),this.setVisible(!0),this.flyout_.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[o.ComponentManager.Capability.AUTOHIDEABLE,o.ComponentManager.Capability.DELETE_AREA,o.ComponentManager.Capability.DRAG_TARGET]})},o.Toolbox.prototype.createDom_=function(e){e=e.getParentSvg();var r=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,o.utils.aria.setRole(this.contentsDiv_,o.utils.aria.Role.TREE),r.appendChild(this.contentsDiv_),e.parentNode.insertBefore(r,e),this.attachEvents_(r,this.contentsDiv_),r},o.Toolbox.prototype.createContainer_=function(){var e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),o.utils.dom.addClass(e,"blocklyToolboxDiv"),o.utils.dom.addClass(e,"blocklyNonSelectable"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e},o.Toolbox.prototype.createContentsContainer_=function(){var e=document.createElement("div");return o.utils.dom.addClass(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e},o.Toolbox.prototype.attachEvents_=function(e,r){e=o.browserEvents.conditionalBind(e,"click",this,this.onClick_,!1,!0),this.boundEvents_.push(e),r=o.browserEvents.conditionalBind(r,"keydown",this,this.onKeyDown_,!1,!0),this.boundEvents_.push(r)},o.Toolbox.prototype.onClick_=function(e){if(o.utils.isRightButton(e)||e.target==this.HtmlDiv)o.hideChaff(!1);else{var r=e.target.getAttribute("id");r&&(r=this.getToolboxItemById(r)).isSelectable()&&(this.setSelectedItem(r),r.onClick(e)),o.hideChaff(!0)}o.Touch.clearTouchIdentifier()},o.Toolbox.prototype.onKeyDown_=function(e){var r=!1;switch(e.keyCode){case o.utils.KeyCodes.DOWN:r=this.selectNext_();break;case o.utils.KeyCodes.UP:r=this.selectPrevious_();break;case o.utils.KeyCodes.LEFT:r=this.selectParent_();break;case o.utils.KeyCodes.RIGHT:r=this.selectChild_();break;case o.utils.KeyCodes.ENTER:case o.utils.KeyCodes.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),r=!0);break;default:r=!1}!r&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(r=this.selectedItem_.onKeyDown(e)),r&&e.preventDefault()},o.Toolbox.prototype.createFlyout_=function(){var e=this.workspace_,r=new o.Options({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:!0}});return r.toolboxPosition=e.options.toolboxPosition,new(o.registry.getClassFromOptions(e.horizontalLayout?o.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX:o.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(r)},o.Toolbox.prototype.render=function(e){this.toolboxDef_=e;for(var r=0;r<this.contents_.length;r++){var l=this.contents_[r];l&&l.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()},o.Toolbox.prototype.renderContents_=function(e){for(var c,r=document.createDocumentFragment(),l=0;c=e[l];l++)this.createToolboxItem_(c,r);this.contentsDiv_.appendChild(r)},o.Toolbox.prototype.createToolboxItem_=function(e,r){var l=e.kind;"CATEGORY"==l.toUpperCase()&&o.utils.toolbox.isCategoryCollapsible(e)&&(l=o.CollapsibleToolboxCategory.registrationName),(l=o.registry.getClass(o.registry.Type.TOOLBOX_ITEM,l.toLowerCase()))&&(e=new l(e,this),this.addToolboxItem_(e),e.init(),(l=e.getDiv())&&r.appendChild(l),e.getClickTarget&&e.getClickTarget().setAttribute("id",e.getId()))},o.Toolbox.prototype.addToolboxItem_=function(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible())for(var l,r=0;l=e.getChildToolboxItems()[r];r++)this.addToolboxItem_(l)},o.Toolbox.prototype.getToolboxItems=function(){return this.contents_},o.Toolbox.prototype.addStyle=function(e){o.utils.dom.addClass(this.HtmlDiv,e)},o.Toolbox.prototype.removeStyle=function(e){o.utils.dom.removeClass(this.HtmlDiv,e)},o.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect(),r=e.top,l=r+e.height,c=e.left;return e=c+e.width,this.toolboxPosition==o.utils.toolbox.Position.TOP?new o.utils.Rect(-1e7,l,-1e7,1e7):this.toolboxPosition==o.utils.toolbox.Position.BOTTOM?new o.utils.Rect(r,1e7,-1e7,1e7):this.toolboxPosition==o.utils.toolbox.Position.LEFT?new o.utils.Rect(-1e7,1e7,-1e7,e):new o.utils.Rect(-1e7,1e7,c,1e7)},o.Toolbox.prototype.wouldDelete=function(e,r){return this.updateWouldDelete_(e instanceof o.BlockSvg?!e.getParent()&&e.isDeletable():e.isDeletable()),this.wouldDelete_},o.Toolbox.prototype.onDragEnter=function(e){this.updateCursorDeleteStyle_(!0)},o.Toolbox.prototype.onDragExit=function(e){this.updateCursorDeleteStyle_(!1)},o.Toolbox.prototype.onDrop=function(e){this.updateCursorDeleteStyle_(!1)},o.Toolbox.prototype.updateWouldDelete_=function(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))},o.Toolbox.prototype.updateCursorDeleteStyle_=function(e){var r=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(r):this.removeStyle(r)},o.Toolbox.prototype.getToolboxItemById=function(e){return this.contentMap_[e]||null},o.Toolbox.prototype.getWidth=function(){return this.width_},o.Toolbox.prototype.getHeight=function(){return this.height_},o.Toolbox.prototype.getFlyout=function(){return this.flyout_},o.Toolbox.prototype.getWorkspace=function(){return this.workspace_},o.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_},o.Toolbox.prototype.getPreviouslySelectedItem=function(){return this.previouslySelectedItem_},o.Toolbox.prototype.isHorizontal=function(){return this.horizontalLayout_},o.Toolbox.prototype.position=function(){var e=this.workspace_.getMetrics(),r=this.HtmlDiv;r&&(this.horizontalLayout_?(r.style.left="0",r.style.height="auto",r.style.width="100%",this.height_=r.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition==o.utils.toolbox.Position.TOP?r.style.top="0":r.style.bottom="0"):(this.toolboxPosition==o.utils.toolbox.Position.RIGHT?r.style.right="0":r.style.left="0",r.style.height="100%",this.width_=r.offsetWidth,this.height_=e.viewHeight),this.flyout_.position())},o.Toolbox.prototype.handleToolboxItemResize=function(){var e=this.workspace_,r=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition==o.utils.toolbox.Position.LEFT?e.scrollX+r.width:e.scrollX,this.toolboxPosition==o.utils.toolbox.Position.TOP?e.scrollY+r.height:e.scrollY),o.svgResize(e)},o.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)},o.Toolbox.prototype.refreshTheme=function(){for(var e=0;e<this.contents_.length;e++){var r=this.contents_[e];r.refreshTheme&&r.refreshTheme()}},o.Toolbox.prototype.refreshSelection=function(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())},o.Toolbox.prototype.setVisible=function(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())},o.Toolbox.prototype.autoHide=function(e){!e&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()},o.Toolbox.prototype.setSelectedItem=function(e){var r=this.selectedItem_;!e&&!r||e&&!e.isSelectable()||(this.shouldDeselectItem_(r,e)&&null!=r&&this.deselectItem_(r),this.shouldSelectItem_(r,e)&&null!=e&&this.selectItem_(r,e),this.updateFlyout_(r,e),this.fireSelectEvent_(r,e))},o.Toolbox.prototype.shouldDeselectItem_=function(e,r){return null!=e&&(!e.isCollapsible()||e!=r)},o.Toolbox.prototype.shouldSelectItem_=function(e,r){return null!=r&&r!=e},o.Toolbox.prototype.deselectItem_=function(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),o.utils.aria.setState(this.contentsDiv_,o.utils.aria.State.ACTIVEDESCENDANT,"")},o.Toolbox.prototype.selectItem_=function(e,r){this.selectedItem_=r,this.previouslySelectedItem_=e,r.setSelected(!0),o.utils.aria.setState(this.contentsDiv_,o.utils.aria.State.ACTIVEDESCENDANT,r.getId())},o.Toolbox.prototype.selectItemByPosition=function(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e]).isSelectable()&&this.setSelectedItem(e)},o.Toolbox.prototype.updateFlyout_=function(e,r){(e!=r||r.isCollapsible())&&r&&r.getContents().length?(this.flyout_.show(r.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()},o.Toolbox.prototype.fireSelectEvent_=function(e,r){var l=e&&e.getName(),c=r&&r.getName();e==r&&(c=null),e=new(o.Events.get(o.Events.TOOLBOX_ITEM_SELECT))(l,c,this.workspace_.id),o.Events.fire(e)},o.Toolbox.prototype.selectParent_=function(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.setExpanded(!1),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))},o.Toolbox.prototype.selectChild_=function(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;var e=this.selectedItem_;return e.isExpanded()?this.selectNext_():e.setExpanded(!0),!0},o.Toolbox.prototype.selectNext_=function(){if(!this.selectedItem_)return!1;var e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){for(var r=this.contents_[e];r&&!r.isSelectable();)r=this.contents_[++e];if(r&&r.isSelectable())return this.setSelectedItem(r),!0}return!1},o.Toolbox.prototype.selectPrevious_=function(){if(!this.selectedItem_)return!1;var e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){for(var r=this.contents_[e];r&&!r.isSelectable();)r=this.contents_[--e];if(r&&r.isSelectable())return this.setSelectedItem(r),!0}return!1},o.Toolbox.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)o.browserEvents.unbind(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),o.utils.dom.removeNode(this.HtmlDiv)},o.Css.register([".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","padding: 4px 0 4px 0;","position: absolute;","z-index: 70;","-webkit-tap-highlight-color: transparent;","}",".blocklyToolboxContents {","display: flex;","flex-wrap: wrap;","flex-direction: column;","}",".blocklyToolboxContents:focus {","outline: none;","}"]),o.registry.register(o.registry.Type.TOOLBOX,o.registry.DEFAULT,o.Toolbox),o.Events.TrashcanOpen=function(e,r){o.Events.TrashcanOpen.superClass_.constructor.call(this,r),this.isOpen=e},o.utils.object.inherits(o.Events.TrashcanOpen,o.Events.UiBase),o.Events.TrashcanOpen.prototype.type=o.Events.TRASHCAN_OPEN,o.Events.TrashcanOpen.prototype.toJson=function(){var e=o.Events.TrashcanOpen.superClass_.toJson.call(this);return e.isOpen=this.isOpen,e},o.Events.TrashcanOpen.prototype.fromJson=function(e){o.Events.TrashcanOpen.superClass_.fromJson.call(this,e),this.isOpen=e.isOpen},o.registry.register(o.registry.Type.EVENT,o.Events.TRASHCAN_OPEN,o.Events.TrashcanOpen),o.IPositionable=function(){},o.uiPosition={},o.uiPosition.verticalPosition={TOP:0,BOTTOM:1},o.uiPosition.horizontalPosition={LEFT:0,RIGHT:1},o.uiPosition.bumpDirection={UP:0,DOWN:1},o.uiPosition.getStartPositionRect=function(e,r,l,c,p,_){var v=_.scrollbar&&_.scrollbar.canScrollVertically();return e.horizontal===o.uiPosition.horizontalPosition.LEFT?(l=p.absoluteMetrics.left+l,v&&_.RTL&&(l+=o.Scrollbar.scrollbarThickness)):(l=p.absoluteMetrics.left+p.viewMetrics.width-r.width-l,v&&!_.RTL&&(l-=o.Scrollbar.scrollbarThickness)),e.vertical===o.uiPosition.verticalPosition.TOP?e=p.absoluteMetrics.top+c:(e=p.absoluteMetrics.top+p.viewMetrics.height-r.height-c,_.scrollbar&&_.scrollbar.canScrollHorizontally()&&(e-=o.Scrollbar.scrollbarThickness)),new o.utils.Rect(e,e+r.height,l,l+r.width)},o.uiPosition.getCornerOppositeToolbox=function(e,r){return{horizontal:r.toolboxMetrics.position===o.utils.toolbox.Position.LEFT||e.horizontalLayout&&!e.RTL?o.uiPosition.horizontalPosition.RIGHT:o.uiPosition.horizontalPosition.LEFT,vertical:r.toolboxMetrics.position===o.utils.toolbox.Position.BOTTOM?o.uiPosition.verticalPosition.TOP:o.uiPosition.verticalPosition.BOTTOM}},o.uiPosition.bumpPositionRect=function(e,r,l,c){for(var w,p=e.left,_=e.right-e.left,v=e.bottom-e.top,b=0;w=c[b];b++)e.intersects(w)&&(e=new o.utils.Rect(e=l===o.uiPosition.bumpDirection.UP?w.top-v-r:w.bottom+r,e+v,p,p+_),b=-1);return e},o.Trashcan=function(e){o.Trashcan.superClass_.constructor.call(this),this.workspace_=e,this.id="trashcan",this.contents_=[],this.flyout=null,0>=this.workspace_.options.maxTrashcanContents||(e=new o.Options({scrollbars:!0,parentWorkspace:this.workspace_,rtl:this.workspace_.RTL,oneBasedIndex:this.workspace_.options.oneBasedIndex,renderer:this.workspace_.options.renderer,rendererOverrides:this.workspace_.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace_.horizontalLayout?(e.toolboxPosition=this.workspace_.toolboxPosition==o.utils.toolbox.Position.TOP?o.utils.toolbox.Position.BOTTOM:o.utils.toolbox.Position.TOP,this.flyout=new(o.registry.getClassFromOptions(o.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace_.options,!0))(e)):(e.toolboxPosition=this.workspace_.toolboxPosition==o.utils.toolbox.Position.RIGHT?o.utils.toolbox.Position.LEFT:o.utils.toolbox.Position.RIGHT,this.flyout=new(o.registry.getClassFromOptions(o.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.workspace_.options,!0))(e)),this.workspace_.addChangeListener(this.onDelete_.bind(this)))},o.utils.object.inherits(o.Trashcan,o.DeleteArea),o.Trashcan.prototype.WIDTH_=47,o.Trashcan.prototype.BODY_HEIGHT_=44,o.Trashcan.prototype.LID_HEIGHT_=16,o.Trashcan.prototype.MARGIN_VERTICAL_=20,o.Trashcan.prototype.MARGIN_HORIZONTAL_=20,o.Trashcan.prototype.MARGIN_HOTSPOT_=10,o.Trashcan.prototype.SPRITE_LEFT_=0,o.Trashcan.prototype.SPRITE_TOP_=32,o.Trashcan.prototype.HAS_BLOCKS_LID_ANGLE_=.1,o.Trashcan.ANIMATION_LENGTH_=80,o.Trashcan.ANIMATION_FRAMES_=4,o.Trashcan.OPACITY_MIN_=.4,o.Trashcan.OPACITY_MAX_=.8,o.Trashcan.MAX_LID_ANGLE_=45,o.Trashcan.prototype.isLidOpen=!1,o.Trashcan.prototype.minOpenness_=0,o.Trashcan.prototype.svgGroup_=null,o.Trashcan.prototype.svgLid_=null,o.Trashcan.prototype.lidTask_=0,o.Trashcan.prototype.lidOpen_=0,o.Trashcan.prototype.left_=0,o.Trashcan.prototype.top_=0,o.Trashcan.prototype.initialized_=!1,o.Trashcan.prototype.createDom=function(){this.svgGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blocklyTrash"},null);var e=String(Math.random()).substring(2),r=o.utils.dom.createSvgElement(o.utils.Svg.CLIPPATH,{id:"blocklyTrashBodyClipPath"+e},this.svgGroup_);o.utils.dom.createSvgElement(o.utils.Svg.RECT,{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},r);var l=o.utils.dom.createSvgElement(o.utils.Svg.IMAGE,{width:o.SPRITE.width,x:-this.SPRITE_LEFT_,height:o.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+e+")"},this.svgGroup_);return l.setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+o.SPRITE.url),r=o.utils.dom.createSvgElement(o.utils.Svg.CLIPPATH,{id:"blocklyTrashLidClipPath"+e},this.svgGroup_),o.utils.dom.createSvgElement(o.utils.Svg.RECT,{width:this.WIDTH_,height:this.LID_HEIGHT_},r),this.svgLid_=o.utils.dom.createSvgElement(o.utils.Svg.IMAGE,{width:o.SPRITE.width,x:-this.SPRITE_LEFT_,height:o.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+e+")"},this.svgGroup_),this.svgLid_.setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+o.SPRITE.url),o.browserEvents.bind(this.svgGroup_,"mousedown",this,this.blockMouseDownWhenOpenable_),o.browserEvents.bind(this.svgGroup_,"mouseup",this,this.click),o.browserEvents.bind(l,"mouseover",this,this.mouseOver_),o.browserEvents.bind(l,"mouseout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_},o.Trashcan.prototype.init=function(){0<this.workspace_.options.maxTrashcanContents&&(o.utils.dom.insertAfter(this.flyout.createDom(o.utils.Svg.SVG),this.workspace_.getParentSvg()),this.flyout.init(this.workspace_)),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[o.ComponentManager.Capability.AUTOHIDEABLE,o.ComponentManager.Capability.DELETE_AREA,o.ComponentManager.Capability.DRAG_TARGET,o.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0,this.setLidOpen(!1)},o.Trashcan.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&(o.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},o.Trashcan.prototype.hasContents_=function(){return!!this.contents_.length},o.Trashcan.prototype.contentsIsOpen=function(){return this.flyout.isVisible()},o.Trashcan.prototype.openFlyout=function(){if(!this.contentsIsOpen()){var e=this.contents_.map(o.Xml.textToDom);this.flyout.show(e),this.fireUiEvent_(!0)}},o.Trashcan.prototype.closeFlyout=function(){this.contentsIsOpen()&&(this.flyout.hide(),this.fireUiEvent_(!1))},o.Trashcan.prototype.autoHide=function(e){!e&&this.flyout&&this.closeFlyout()},o.Trashcan.prototype.emptyContents=function(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())},o.Trashcan.prototype.position=function(e,r){if(this.initialized_){var l=o.uiPosition.getCornerOppositeToolbox(this.workspace_,e);e=o.uiPosition.getStartPositionRect(l,new o.utils.Size(this.WIDTH_,this.BODY_HEIGHT_+this.LID_HEIGHT_),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,e,this.workspace_),r=o.uiPosition.bumpPositionRect(e,this.MARGIN_VERTICAL_,l.vertical===o.uiPosition.verticalPosition.TOP?o.uiPosition.bumpDirection.DOWN:o.uiPosition.bumpDirection.UP,r),this.top_=r.top,this.left_=r.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},o.Trashcan.prototype.getBoundingRectangle=function(){return new o.utils.Rect(this.top_,this.top_+this.BODY_HEIGHT_+this.LID_HEIGHT_,this.left_,this.left_+this.WIDTH_)},o.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect(),r=e.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_;return new o.utils.Rect(r,r+this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_,e=e.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,e+this.WIDTH_+2*this.MARGIN_HOTSPOT_)},o.Trashcan.prototype.onDragOver=function(e){this.setLidOpen(this.wouldDelete_)},o.Trashcan.prototype.onDragExit=function(e){this.setLidOpen(!1)},o.Trashcan.prototype.onDrop=function(e){setTimeout(this.setLidOpen.bind(this,!1),100)},o.Trashcan.prototype.setLidOpen=function(e){this.isLidOpen!=e&&(clearTimeout(this.lidTask_),this.isLidOpen=e,this.animateLid_())},o.Trashcan.prototype.animateLid_=function(){var e=o.Trashcan.ANIMATION_FRAMES_,r=1/(e+1);this.lidOpen_+=this.isLidOpen?r:-r,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*o.Trashcan.MAX_LID_ANGLE_),this.svgGroup_.style.opacity=(r=o.Trashcan.OPACITY_MIN_)+this.lidOpen_*(o.Trashcan.OPACITY_MAX_-r),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),o.Trashcan.ANIMATION_LENGTH_/e))},o.Trashcan.prototype.setLidAngle_=function(e){var r=this.workspace_.toolboxPosition==o.utils.toolbox.Position.RIGHT||this.workspace_.horizontalLayout&&this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(r?-e:e)+","+(r?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")")},o.Trashcan.prototype.setMinOpenness_=function(e){this.minOpenness_=e,this.isLidOpen||this.setLidAngle_(e*o.Trashcan.MAX_LID_ANGLE_)},o.Trashcan.prototype.closeLid=function(){this.setLidOpen(!1)},o.Trashcan.prototype.click=function(){this.hasContents_()&&this.openFlyout()},o.Trashcan.prototype.fireUiEvent_=function(e){e=new(o.Events.get(o.Events.TRASHCAN_OPEN))(e,this.workspace_.id),o.Events.fire(e)},o.Trashcan.prototype.blockMouseDownWhenOpenable_=function(e){!this.contentsIsOpen()&&this.hasContents_()&&e.stopPropagation()},o.Trashcan.prototype.mouseOver_=function(){this.hasContents_()&&this.setLidOpen(!0)},o.Trashcan.prototype.mouseOut_=function(){this.setLidOpen(!1)},o.Trashcan.prototype.onDelete_=function(e){if(!(0>=this.workspace_.options.maxTrashcanContents)&&e.type==o.Events.BLOCK_DELETE&&e.oldXml.tagName&&"shadow"!=e.oldXml.tagName.toLowerCase()&&(e=this.cleanBlockXML_(e.oldXml),-1==this.contents_.indexOf(e))){for(this.contents_.unshift(e);this.contents_.length>this.workspace_.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(this.HAS_BLOCKS_LID_ANGLE_)}},o.Trashcan.prototype.cleanBlockXML_=function(e){for(var r=e=e.cloneNode(!0);r;){r.removeAttribute&&(r.removeAttribute("x"),r.removeAttribute("y"),r.removeAttribute("id"),r.removeAttribute("disabled"),"comment"==r.nodeName&&(r.removeAttribute("h"),r.removeAttribute("w"),r.removeAttribute("pinned")));var l=r.firstChild||r.nextSibling;if(!l)for(l=r.parentNode;l;){if(l.nextSibling){l=l.nextSibling;break}l=l.parentNode}r=l}return o.Xml.domToText(e)},o.VariablesDynamic={},o.VariablesDynamic.onCreateVariableButtonClick_String=function(e){o.Variables.createVariableButtonHandler(e.getTargetWorkspace(),void 0,"String")},o.VariablesDynamic.onCreateVariableButtonClick_Number=function(e){o.Variables.createVariableButtonHandler(e.getTargetWorkspace(),void 0,"Number")},o.VariablesDynamic.onCreateVariableButtonClick_Colour=function(e){o.Variables.createVariableButtonHandler(e.getTargetWorkspace(),void 0,"Colour")},o.VariablesDynamic.flyoutCategory=function(e){var r=[],l=document.createElement("button");return l.setAttribute("text",o.Msg.NEW_STRING_VARIABLE),l.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),r.push(l),(l=document.createElement("button")).setAttribute("text",o.Msg.NEW_NUMBER_VARIABLE),l.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),r.push(l),(l=document.createElement("button")).setAttribute("text",o.Msg.NEW_COLOUR_VARIABLE),l.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),r.push(l),e.registerButtonCallback("CREATE_VARIABLE_STRING",o.VariablesDynamic.onCreateVariableButtonClick_String),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",o.VariablesDynamic.onCreateVariableButtonClick_Number),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",o.VariablesDynamic.onCreateVariableButtonClick_Colour),e=o.VariablesDynamic.flyoutCategoryBlocks(e),r.concat(e)},o.VariablesDynamic.flyoutCategoryBlocks=function(e){var r=[];if(0<(e=e.getAllVariables()).length){if(o.Blocks.variables_set_dynamic){var l=e[e.length-1],c=o.utils.xml.createElement("block");c.setAttribute("type","variables_set_dynamic"),c.setAttribute("gap",24),c.appendChild(o.Variables.generateVariableFieldDom(l)),r.push(c)}if(o.Blocks.variables_get_dynamic){e.sort(o.VariableModel.compareByName),l=0;for(var p;p=e[l];l++)(c=o.utils.xml.createElement("block")).setAttribute("type","variables_get_dynamic"),c.setAttribute("gap",8),c.appendChild(o.Variables.generateVariableFieldDom(p)),r.push(c)}}return r},o.ZoomControls=function(e){this.workspace_=e,this.id="zoomControls",this.zoomResetGroup_=this.zoomOutGroup_=this.zoomInGroup_=this.onZoomOutWrapper_=this.onZoomInWrapper_=this.onZoomResetWrapper_=null},o.ZoomControls.prototype.WIDTH_=32,o.ZoomControls.prototype.HEIGHT_=32,o.ZoomControls.prototype.SMALL_SPACING_=2,o.ZoomControls.prototype.LARGE_SPACING_=11,o.ZoomControls.prototype.MARGIN_VERTICAL_=20,o.ZoomControls.prototype.MARGIN_HORIZONTAL_=20,o.ZoomControls.prototype.svgGroup_=null,o.ZoomControls.prototype.left_=0,o.ZoomControls.prototype.top_=0,o.ZoomControls.prototype.initialized_=!1,o.ZoomControls.prototype.createDom=function(){this.svgGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{},null);var e=String(Math.random()).substring(2);return this.createZoomOutSvg_(e),this.createZoomInSvg_(e),this.workspace_.isMovable()&&this.createZoomResetSvg_(e),this.svgGroup_},o.ZoomControls.prototype.init=function(){this.workspace_.getComponentManager().addComponent({component:this,weight:2,capabilities:[o.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0},o.ZoomControls.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("zoomControls"),this.svgGroup_&&o.utils.dom.removeNode(this.svgGroup_),this.onZoomResetWrapper_&&o.browserEvents.unbind(this.onZoomResetWrapper_),this.onZoomInWrapper_&&o.browserEvents.unbind(this.onZoomInWrapper_),this.onZoomOutWrapper_&&o.browserEvents.unbind(this.onZoomOutWrapper_)},o.ZoomControls.prototype.getBoundingRectangle=function(){var e=this.SMALL_SPACING_+2*this.HEIGHT_;return this.zoomResetGroup_&&(e+=this.LARGE_SPACING_+this.HEIGHT_),new o.utils.Rect(this.top_,this.top_+e,this.left_,this.left_+this.WIDTH_)},o.ZoomControls.prototype.position=function(e,r){if(this.initialized_){var l=o.uiPosition.getCornerOppositeToolbox(this.workspace_,e),c=this.SMALL_SPACING_+2*this.HEIGHT_;this.zoomResetGroup_&&(c+=this.LARGE_SPACING_+this.HEIGHT_),e=o.uiPosition.getStartPositionRect(l,new o.utils.Size(this.WIDTH_,c),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,e,this.workspace_),r=o.uiPosition.bumpPositionRect(e,this.MARGIN_VERTICAL_,(l=l.vertical)===o.uiPosition.verticalPosition.TOP?o.uiPosition.bumpDirection.DOWN:o.uiPosition.bumpDirection.UP,r),l===o.uiPosition.verticalPosition.TOP?(this.zoomInGroup_.setAttribute("transform","translate(0, "+(l=this.SMALL_SPACING_+this.HEIGHT_)+")"),this.zoomResetGroup_&&this.zoomResetGroup_.setAttribute("transform","translate(0, "+(l+this.LARGE_SPACING_+this.HEIGHT_)+")")):(this.zoomInGroup_.setAttribute("transform","translate(0, "+(l=this.zoomResetGroup_?this.LARGE_SPACING_+this.HEIGHT_:0)+")"),this.zoomOutGroup_.setAttribute("transform","translate(0, "+(l+this.SMALL_SPACING_+this.HEIGHT_)+")")),this.top_=r.top,this.left_=r.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},o.ZoomControls.prototype.createZoomOutSvg_=function(e){this.zoomOutGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var r=o.utils.dom.createSvgElement(o.utils.Svg.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup_);o.utils.dom.createSvgElement(o.utils.Svg.RECT,{width:32,height:32},r),o.utils.dom.createSvgElement(o.utils.Svg.IMAGE,{width:o.SPRITE.width,height:o.SPRITE.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup_).setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+o.SPRITE.url),this.onZoomOutWrapper_=o.browserEvents.conditionalBind(this.zoomOutGroup_,"mousedown",null,this.zoom_.bind(this,-1))},o.ZoomControls.prototype.createZoomInSvg_=function(e){this.zoomInGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var r=o.utils.dom.createSvgElement(o.utils.Svg.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup_);o.utils.dom.createSvgElement(o.utils.Svg.RECT,{width:32,height:32},r),o.utils.dom.createSvgElement(o.utils.Svg.IMAGE,{width:o.SPRITE.width,height:o.SPRITE.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup_).setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+o.SPRITE.url),this.onZoomInWrapper_=o.browserEvents.conditionalBind(this.zoomInGroup_,"mousedown",null,this.zoom_.bind(this,1))},o.ZoomControls.prototype.zoom_=function(e,r){this.workspace_.markFocused(),this.workspace_.zoomCenter(e),this.fireZoomEvent_(),o.Touch.clearTouchIdentifier(),r.stopPropagation(),r.preventDefault()},o.ZoomControls.prototype.createZoomResetSvg_=function(e){this.zoomResetGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var r=o.utils.dom.createSvgElement(o.utils.Svg.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup_);o.utils.dom.createSvgElement(o.utils.Svg.RECT,{width:32,height:32},r),o.utils.dom.createSvgElement(o.utils.Svg.IMAGE,{width:o.SPRITE.width,height:o.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup_).setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+o.SPRITE.url),this.onZoomResetWrapper_=o.browserEvents.conditionalBind(this.zoomResetGroup_,"mousedown",null,this.resetZoom_.bind(this))},o.ZoomControls.prototype.resetZoom_=function(e){this.workspace_.markFocused();var r=Math.log(this.workspace_.options.zoomOptions.startScale/this.workspace_.scale)/Math.log(this.workspace_.options.zoomOptions.scaleSpeed);this.workspace_.beginCanvasTransition(),this.workspace_.zoomCenter(r),this.workspace_.scrollCenter(),setTimeout(this.workspace_.endCanvasTransition.bind(this.workspace_),500),this.fireZoomEvent_(),o.Touch.clearTouchIdentifier(),e.stopPropagation(),e.preventDefault()},o.ZoomControls.prototype.fireZoomEvent_=function(){var e=new(o.Events.get(o.Events.CLICK))(null,this.workspace_.id,"zoom_controls");o.Events.fire(e)},o.Css.register([".blocklyZoom>image, .blocklyZoom>svg>image {","opacity: .4;","}",".blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {","opacity: .6;","}",".blocklyZoom>image:active, .blocklyZoom>svg>image:active {","opacity: .8;","}"]),o.ShortcutItems={},o.ShortcutItems.names={ESCAPE:"escape",DELETE:"delete",COPY:"copy",CUT:"cut",PASTE:"paste",UNDO:"undo",REDO:"redo"},o.ShortcutItems.registerEscape=function(){var e={name:o.ShortcutItems.names.ESCAPE,preconditionFn:function(r){return!r.options.readOnly},callback:function(){return o.hideChaff(),!0}};o.ShortcutRegistry.registry.register(e),o.ShortcutRegistry.registry.addKeyMapping(o.utils.KeyCodes.ESC,e.name)},o.ShortcutItems.registerDelete=function(){var e={name:o.ShortcutItems.names.DELETE,preconditionFn:function(r){return!r.options.readOnly&&o.selected&&o.selected.isDeletable()},callback:function(r,l){return l.preventDefault(),!o.Gesture.inProgress()&&(o.deleteBlock(o.selected),!0)}};o.ShortcutRegistry.registry.register(e),o.ShortcutRegistry.registry.addKeyMapping(o.utils.KeyCodes.DELETE,e.name),o.ShortcutRegistry.registry.addKeyMapping(o.utils.KeyCodes.BACKSPACE,e.name)},o.ShortcutItems.registerCopy=function(){var e={name:o.ShortcutItems.names.COPY,preconditionFn:function(l){return!l.options.readOnly&&!o.Gesture.inProgress()&&o.selected&&o.selected.isDeletable()&&o.selected.isMovable()},callback:function(l,c){return c.preventDefault(),o.hideChaff(),o.copy(o.selected),!0}};o.ShortcutRegistry.registry.register(e);var r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.C,[o.utils.KeyCodes.CTRL]);o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.C,[o.utils.KeyCodes.ALT]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.C,[o.utils.KeyCodes.META]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name)},o.ShortcutItems.registerCut=function(){var e={name:o.ShortcutItems.names.CUT,preconditionFn:function(l){return!l.options.readOnly&&!o.Gesture.inProgress()&&o.selected&&o.selected.isDeletable()&&o.selected.isMovable()&&!o.selected.workspace.isFlyout},callback:function(){return o.copy(o.selected),o.deleteBlock(o.selected),!0}};o.ShortcutRegistry.registry.register(e);var r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.X,[o.utils.KeyCodes.CTRL]);o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.X,[o.utils.KeyCodes.ALT]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.X,[o.utils.KeyCodes.META]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name)},o.ShortcutItems.registerPaste=function(){var e={name:o.ShortcutItems.names.PASTE,preconditionFn:function(l){return!l.options.readOnly&&!o.Gesture.inProgress()},callback:function(){return o.paste()}};o.ShortcutRegistry.registry.register(e);var r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.V,[o.utils.KeyCodes.CTRL]);o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.V,[o.utils.KeyCodes.ALT]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.V,[o.utils.KeyCodes.META]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name)},o.ShortcutItems.registerUndo=function(){var e={name:o.ShortcutItems.names.UNDO,preconditionFn:function(l){return!l.options.readOnly&&!o.Gesture.inProgress()},callback:function(l){return o.hideChaff(),l.undo(!1),!0}};o.ShortcutRegistry.registry.register(e);var r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.Z,[o.utils.KeyCodes.CTRL]);o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.Z,[o.utils.KeyCodes.ALT]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.Z,[o.utils.KeyCodes.META]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name)},o.ShortcutItems.registerRedo=function(){var e={name:o.ShortcutItems.names.REDO,preconditionFn:function(l){return!o.Gesture.inProgress()&&!l.options.readOnly},callback:function(l){return o.hideChaff(),l.undo(!0),!0}};o.ShortcutRegistry.registry.register(e);var r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.Z,[o.utils.KeyCodes.SHIFT,o.utils.KeyCodes.CTRL]);o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.Z,[o.utils.KeyCodes.SHIFT,o.utils.KeyCodes.ALT]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.Z,[o.utils.KeyCodes.SHIFT,o.utils.KeyCodes.META]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name),r=o.ShortcutRegistry.registry.createSerializedKey(o.utils.KeyCodes.Y,[o.utils.KeyCodes.CTRL]),o.ShortcutRegistry.registry.addKeyMapping(r,e.name)},o.ShortcutItems.registerDefaultShortcuts=function(){o.ShortcutItems.registerEscape(),o.ShortcutItems.registerDelete(),o.ShortcutItems.registerCopy(),o.ShortcutItems.registerCut(),o.ShortcutItems.registerPaste(),o.ShortcutItems.registerUndo(),o.ShortcutItems.registerRedo()},o.ShortcutItems.registerDefaultShortcuts(),o.ContextMenuItems={},o.ContextMenuItems.registerUndo=function(){o.ContextMenuRegistry.registry.register({displayText:function(){return o.Msg.UNDO},preconditionFn:function(e){return 0<e.workspace.getUndoStack().length?"enabled":"disabled"},callback:function(e){e.workspace.undo(!1)},scopeType:o.ContextMenuRegistry.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},o.ContextMenuItems.registerRedo=function(){o.ContextMenuRegistry.registry.register({displayText:function(){return o.Msg.REDO},preconditionFn:function(e){return 0<e.workspace.getRedoStack().length?"enabled":"disabled"},callback:function(e){e.workspace.undo(!0)},scopeType:o.ContextMenuRegistry.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},o.ContextMenuItems.registerCleanup=function(){o.ContextMenuRegistry.registry.register({displayText:function(){return o.Msg.CLEAN_UP},preconditionFn:function(e){return e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback:function(e){e.workspace.cleanUp()},scopeType:o.ContextMenuRegistry.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},o.ContextMenuItems.toggleOption_=function(e,r){for(var l=0,c=0;c<r.length;c++)for(var p=r[c];p;)setTimeout(p.setCollapsed.bind(p,e),l),p=p.getNextBlock(),l+=10},o.ContextMenuItems.registerCollapse=function(){o.ContextMenuRegistry.registry.register({displayText:function(){return o.Msg.COLLAPSE_ALL},preconditionFn:function(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(var r=0;r<e.length;r++)for(var l=e[r];l;){if(!l.isCollapsed())return"enabled";l=l.getNextBlock()}return"disabled"}return"hidden"},callback:function(e){o.ContextMenuItems.toggleOption_(!0,e.workspace.getTopBlocks(!0))},scopeType:o.ContextMenuRegistry.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},o.ContextMenuItems.registerExpand=function(){o.ContextMenuRegistry.registry.register({displayText:function(){return o.Msg.EXPAND_ALL},preconditionFn:function(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(var r=0;r<e.length;r++)for(var l=e[r];l;){if(l.isCollapsed())return"enabled";l=l.getNextBlock()}return"disabled"}return"hidden"},callback:function(e){o.ContextMenuItems.toggleOption_(!1,e.workspace.getTopBlocks(!0))},scopeType:o.ContextMenuRegistry.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},o.ContextMenuItems.addDeletableBlocks_=function(e,r){if(e.isDeletable())Array.prototype.push.apply(r,e.getDescendants(!1));else{e=e.getChildren(!1);for(var l=0;l<e.length;l++)o.ContextMenuItems.addDeletableBlocks_(e[l],r)}},o.ContextMenuItems.getDeletableBlocks_=function(e){var r=[];e=e.getTopBlocks(!0);for(var l=0;l<e.length;l++)o.ContextMenuItems.addDeletableBlocks_(e[l],r);return r},o.ContextMenuItems.deleteNext_=function(e,r){o.Events.setGroup(r);var l=e.shift();l&&(l.workspace?(l.dispose(!1,!0),setTimeout(o.ContextMenuItems.deleteNext_,10,e,r)):o.ContextMenuItems.deleteNext_(e,r)),o.Events.setGroup(!1)},o.ContextMenuItems.registerDeleteAll=function(){o.ContextMenuRegistry.registry.register({displayText:function(e){if(e.workspace)return 1==(e=o.ContextMenuItems.getDeletableBlocks_(e.workspace).length)?o.Msg.DELETE_BLOCK:o.Msg.DELETE_X_BLOCKS.replace("%1",String(e))},preconditionFn:function(e){if(e.workspace)return 0<o.ContextMenuItems.getDeletableBlocks_(e.workspace).length?"enabled":"disabled"},callback:function(e){if(e.workspace){e.workspace.cancelCurrentGesture();var r=o.ContextMenuItems.getDeletableBlocks_(e.workspace),l=o.utils.genUid();2>r.length?o.ContextMenuItems.deleteNext_(r,l):o.confirm(o.Msg.DELETE_ALL_BLOCKS.replace("%1",r.length),function(c){c&&o.ContextMenuItems.deleteNext_(r,l)})}},scopeType:o.ContextMenuRegistry.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},o.ContextMenuItems.registerWorkspaceOptions_=function(){o.ContextMenuItems.registerUndo(),o.ContextMenuItems.registerRedo(),o.ContextMenuItems.registerCleanup(),o.ContextMenuItems.registerCollapse(),o.ContextMenuItems.registerExpand(),o.ContextMenuItems.registerDeleteAll()},o.ContextMenuItems.registerDuplicate=function(){o.ContextMenuRegistry.registry.register({displayText:function(){return o.Msg.DUPLICATE_BLOCK},preconditionFn:function(e){return!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback:function(e){e.block&&o.duplicate(e.block)},scopeType:o.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},o.ContextMenuItems.registerComment=function(){o.ContextMenuRegistry.registry.register({displayText:function(e){return e.block.getCommentIcon()?o.Msg.REMOVE_COMMENT:o.Msg.ADD_COMMENT},preconditionFn:function(e){return e=e.block,o.utils.userAgent.IE||e.isInFlyout||!e.workspace.options.comments||e.isCollapsed()||!e.isEditable()?"hidden":"enabled"},callback:function(e){(e=e.block).getCommentIcon()?e.setCommentText(null):e.setCommentText("")},scopeType:o.ContextMenuRegistry.ScopeType.BLOCK,id:"blockComment",weight:2})},o.ContextMenuItems.registerInline=function(){o.ContextMenuRegistry.registry.register({displayText:function(e){return e.block.getInputsInline()?o.Msg.EXTERNAL_INPUTS:o.Msg.INLINE_INPUTS},preconditionFn:function(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed())for(var r=1;r<e.inputList.length;r++)if(e.inputList[r-1].type!=o.inputTypes.STATEMENT&&e.inputList[r].type!=o.inputTypes.STATEMENT)return"enabled";return"hidden"},callback:function(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:o.ContextMenuRegistry.ScopeType.BLOCK,id:"blockInline",weight:3})},o.ContextMenuItems.registerCollapseExpandBlock=function(){o.ContextMenuRegistry.registry.register({displayText:function(e){return e.block.isCollapsed()?o.Msg.EXPAND_BLOCK:o.Msg.COLLAPSE_BLOCK},preconditionFn:function(e){return!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback:function(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:o.ContextMenuRegistry.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},o.ContextMenuItems.registerDisable=function(){o.ContextMenuRegistry.registry.register({displayText:function(e){return e.block.isEnabled()?o.Msg.DISABLE_BLOCK:o.Msg.ENABLE_BLOCK},preconditionFn:function(e){return!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()?e.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback:function(e){e=e.block;var r=o.Events.getGroup();r||o.Events.setGroup(!0),e.setEnabled(!e.isEnabled()),r||o.Events.setGroup(!1)},scopeType:o.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDisable",weight:5})},o.ContextMenuItems.registerDelete=function(){o.ContextMenuRegistry.registry.register({displayText:function(e){var r=e.block;return e=r.getDescendants(!1).length,(r=r.getNextBlock())&&(e-=r.getDescendants(!1).length),1==e?o.Msg.DELETE_BLOCK:o.Msg.DELETE_X_BLOCKS.replace("%1",String(e))},preconditionFn:function(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback:function(e){o.Events.setGroup(!0),e.block&&o.deleteBlock(e.block),o.Events.setGroup(!1)},scopeType:o.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDelete",weight:6})},o.ContextMenuItems.registerHelp=function(){o.ContextMenuRegistry.registry.register({displayText:function(){return o.Msg.HELP},preconditionFn:function(e){return("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback:function(e){e.block.showHelp()},scopeType:o.ContextMenuRegistry.ScopeType.BLOCK,id:"blockHelp",weight:7})},o.ContextMenuItems.registerBlockOptions_=function(){o.ContextMenuItems.registerDuplicate(),o.ContextMenuItems.registerComment(),o.ContextMenuItems.registerInline(),o.ContextMenuItems.registerCollapseExpandBlock(),o.ContextMenuItems.registerDisable(),o.ContextMenuItems.registerDelete(),o.ContextMenuItems.registerHelp()},o.ContextMenuItems.registerDefaultOptions=function(){o.ContextMenuItems.registerWorkspaceOptions_(),o.ContextMenuItems.registerBlockOptions_()},o.ContextMenuItems.registerDefaultOptions(),o.Mutator=function(e){o.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=e},o.utils.object.inherits(o.Mutator,o.Icon),o.Mutator.prototype.workspace_=null,o.Mutator.prototype.workspaceWidth_=0,o.Mutator.prototype.workspaceHeight_=0,o.Mutator.prototype.setBlock=function(e){this.block_=e},o.Mutator.prototype.getWorkspace=function(){return this.workspace_},o.Mutator.prototype.drawIcon_=function(e){o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},e),o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},e),o.utils.dom.createSvgElement(o.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},e)},o.Mutator.prototype.iconClick_=function(e){this.block_.isEditable()&&o.Icon.prototype.iconClick_.call(this,e)},o.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=o.utils.dom.createSvgElement(o.utils.Svg.SVG,{x:o.Bubble.BORDER_WIDTH,y:o.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var l,e=o.utils.xml.createElement("xml"),r=0;l=this.quarkNames_[r];r++){var c=o.utils.xml.createElement("block");c.setAttribute("type",l),e.appendChild(c)}else e=null;return(r=new o.Options({disable:!1,parentWorkspace:this.block_.workspace,media:this.block_.workspace.options.pathToMedia,rtl:this.block_.RTL,horizontalLayout:!1,renderer:this.block_.workspace.options.renderer,rendererOverrides:this.block_.workspace.options.rendererOverrides})).toolboxPosition=this.block_.RTL?o.utils.toolbox.Position.RIGHT:o.utils.toolbox.Position.LEFT,(l=!!e)&&(r.languageTree=o.utils.toolbox.convertToolboxDefToJson(e)),this.workspace_=new o.WorkspaceSvg(r),this.workspace_.isMutator=!0,this.workspace_.addChangeListener(o.Events.disableOrphans),e=l?this.workspace_.addFlyout(o.utils.Svg.G):null,r=this.workspace_.createDom("blocklyMutatorBackground"),e&&r.insertBefore(e,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(r),this.svgDialog_},o.Mutator.prototype.updateEditable=function(){o.Mutator.superClass_.updateEditable.call(this),this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&o.utils.dom.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&o.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly")))},o.Mutator.prototype.resizeBubble_=function(){var e=2*o.Bubble.BORDER_WIDTH,r=this.workspace_.getCanvas().getBBox(),l=r.width+r.x,c=r.height+3*e,p=this.workspace_.getFlyout();if(p){var _=p.getWorkspace().getMetricsManager().getScrollMetrics();c=Math.max(c,_.height+20),l+=p.getWidth()}this.block_.RTL&&(l=-r.x),l+=3*e,(Math.abs(this.workspaceWidth_-l)>e||Math.abs(this.workspaceHeight_-c)>e)&&(this.workspaceWidth_=l,this.workspaceHeight_=c,this.bubble_.setBubbleSize(l+e,c+e),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_),this.workspace_.setCachedParentSvgSize(this.workspaceWidth_,this.workspaceHeight_)),this.block_.RTL&&(e="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",e)),this.workspace_.resize()},o.Mutator.prototype.onBubbleMove_=function(){this.workspace_&&this.workspace_.recordDragTargets()},o.Mutator.prototype.setVisible=function(e){if(e!=this.isVisible())if(o.Events.fire(new(o.Events.get(o.Events.BUBBLE_OPEN))(this.block_,e,"mutator")),e){this.bubble_=new o.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerMoveEvent(this.onBubbleMove_.bind(this));var r=this.workspace_.options.languageTree;e=this.workspace_.getFlyout(),r&&(e.init(this.workspace_),e.show(r)),this.rootBlock_=this.block_.decompose(this.workspace_),r=this.rootBlock_.getDescendants(!1);for(var c,l=0;c=r[l];l++)c.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),e?(r=2*e.CORNER_RADIUS,e=this.rootBlock_.RTL?e.getWidth()+r:r):e=r=16,this.block_.RTL&&(e=-e),this.rootBlock_.moveBy(e,r),this.block_.saveConnections){var p=this,_=this.block_;_.saveConnections(this.rootBlock_),this.sourceListener_=function(){_.saveConnections(p.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.applyColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},o.Mutator.prototype.workspaceChanged_=function(e){if(!(e.isUiEvent||e.type==o.Events.CHANGE&&"disabled"==e.element)){if(!this.workspace_.isDragging()){e=this.workspace_.getTopBlocks(!1);for(var l,r=0;l=e[r];r++){var c=l.getRelativeToSurfaceXY();if(20>c.y&&l.moveBy(0,20-c.y),l.RTL){var p=-20,_=this.workspace_.getFlyout();_&&(p-=_.getWidth()),c.x>p&&l.moveBy(p-c.x,0)}else 20>c.x&&l.moveBy(20-c.x,0)}}if(this.rootBlock_.workspace==this.workspace_){if(o.Events.setGroup(!0),e=(e=(l=this.block_).mutationToDom())&&o.Xml.domToText(e),r=l.rendered,l.rendered=!1,l.compose(this.rootBlock_),l.rendered=r,l.initSvg(),l.rendered&&l.render(),e!=(r=(r=l.mutationToDom())&&o.Xml.domToText(r))){o.Events.fire(new(o.Events.get(o.Events.BLOCK_CHANGE))(l,"mutation",null,e,r));var v=o.Events.getGroup();setTimeout(function(){o.Events.setGroup(v),l.bumpNeighbours(),o.Events.setGroup(!1)},o.BUMP_DELAY)}this.workspace_.isDragging()||this.resizeBubble_(),o.Events.setGroup(!1)}}},o.Mutator.prototype.dispose=function(){this.block_.mutator=null,o.Icon.prototype.dispose.call(this)},o.Mutator.prototype.updateBlockStyle=function(){var e=this.workspace_;if(e&&e.getAllBlocks(!1)){for(var c,r=e.getAllBlocks(!1),l=0;c=r[l];l++)c.setStyle(c.getStyleName());if(l=e.getFlyout())for(e=l.workspace_.getAllBlocks(!1),l=0;c=e[l];l++)c.setStyle(c.getStyleName())}},o.Mutator.reconnect=function(e,r,l){if(!e||!e.getSourceBlock().workspace)return!1;l=r.getInput(l).connection;var c=e.targetBlock();return!(c&&c!=r||l.targetConnection==e||(l.isConnected()&&l.disconnect(),l.connect(e),0))},o.Mutator.findParentWs=function(e){var r=null;if(e&&e.options){var l=e.options.parentWorkspace;e.isFlyout?l&&l.options&&(r=l.options.parentWorkspace):l&&(r=l)}return r},o.FieldTextInput=function(e,r,l){this.spellcheck_=!0,o.FieldTextInput.superClass_.constructor.call(this,e,r,l),this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.htmlInput_=null,this.fullBlockClickTarget_=!1,this.workspace_=null},o.utils.object.inherits(o.FieldTextInput,o.Field),o.FieldTextInput.prototype.DEFAULT_VALUE="",o.FieldTextInput.fromJson=function(e){var r=o.utils.replaceMessageReferences(e.text);return new o.FieldTextInput(r,void 0,e)},o.FieldTextInput.prototype.SERIALIZABLE=!0,o.FieldTextInput.BORDERRADIUS=4,o.FieldTextInput.prototype.CURSOR="text",o.FieldTextInput.prototype.configure_=function(e){o.FieldTextInput.superClass_.configure_.call(this,e),"boolean"==typeof e.spellcheck&&(this.spellcheck_=e.spellcheck)},o.FieldTextInput.prototype.initView=function(){if(this.getConstants().FULL_BLOCK_FIELDS){for(var c,e=0,r=0,l=0;c=this.sourceBlock_.inputList[l];l++){for(var p=0;c.fieldRow[p];p++)e++;c.connection&&r++}this.fullBlockClickTarget_=1>=e&&this.sourceBlock_.outputConnection&&!r}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()},o.FieldTextInput.prototype.doClassValidation_=function(e){return null==e?null:String(e)},o.FieldTextInput.prototype.doValueInvalid_=function(e){this.isBeingEdited_&&(this.isTextValid_=!1,e=this.value_,this.value_=this.htmlInput_.untypedDefaultValue_,this.sourceBlock_&&o.Events.isEnabled()&&o.Events.fire(new(o.Events.get(o.Events.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))},o.FieldTextInput.prototype.doValueUpdate_=function(e){this.isTextValid_=!0,this.value_=e,this.isBeingEdited_||(this.isDirty_=!0)},o.FieldTextInput.prototype.applyColour=function(){this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS&&(this.borderRect_?this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR))},o.FieldTextInput.prototype.render_=function(){if(o.FieldTextInput.superClass_.render_.call(this),this.isBeingEdited_){this.resizeEditor_();var e=this.htmlInput_;this.isTextValid_?(o.utils.dom.removeClass(e,"blocklyInvalidInput"),o.utils.aria.setState(e,o.utils.aria.State.INVALID,!1)):(o.utils.dom.addClass(e,"blocklyInvalidInput"),o.utils.aria.setState(e,o.utils.aria.State.INVALID,!0))}},o.FieldTextInput.prototype.setSpellcheck=function(e){e!=this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))},o.FieldTextInput.prototype.showEditor_=function(e,r){this.workspace_=this.sourceBlock_.workspace,!(e=r||!1)&&(o.utils.userAgent.MOBILE||o.utils.userAgent.ANDROID||o.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(e)},o.FieldTextInput.prototype.showPromptEditor_=function(){o.prompt(o.Msg.CHANGE_VALUE_TITLE,this.getText(),function(e){this.setValue(this.getValueFromEditorText_(e))}.bind(this))},o.FieldTextInput.prototype.showInlineEditor_=function(e){o.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())},o.FieldTextInput.prototype.widgetCreate_=function(){var e=o.WidgetDiv.DIV;o.utils.dom.addClass(this.getClickTarget_(),"editing");var r=document.createElement("input");r.className="blocklyHtmlInput",r.setAttribute("spellcheck",this.spellcheck_);var l=this.workspace_.getScale(),c=this.getConstants().FIELD_TEXT_FONTSIZE*l+"pt";if(e.style.fontSize=c,r.style.fontSize=c,c=o.FieldTextInput.BORDERRADIUS*l+"px",this.fullBlockClickTarget_){c=((c=this.getScaledBBox()).bottom-c.top)/2+"px";var p=this.sourceBlock_.getParent()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;r.style.border=1*l+"px solid "+p,e.style.borderRadius=c,e.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(e.style.boxShadow="rgba(255, 255, 255, 0.3) 0px 0px 0px "+4*l+"px")}return r.style.borderRadius=c,e.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.untypedDefaultValue_=this.value_,r.oldValue_=null,this.resizeEditor_(),this.bindInputEvents_(r),r},o.FieldTextInput.prototype.widgetDispose_=function(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_&&this.onFinishEditing_(this.value_),this.unbindInputEvents_();var e=o.WidgetDiv.DIV.style;e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,o.utils.dom.removeClass(this.getClickTarget_(),"editing")},o.FieldTextInput.prototype.bindInputEvents_=function(e){this.onKeyDownWrapper_=o.browserEvents.conditionalBind(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=o.browserEvents.conditionalBind(e,"input",this,this.onHtmlInputChange_)},o.FieldTextInput.prototype.unbindInputEvents_=function(){this.onKeyDownWrapper_&&(o.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(o.browserEvents.unbind(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)},o.FieldTextInput.prototype.onHtmlInputKeyDown_=function(e){e.keyCode==o.utils.KeyCodes.ENTER?(o.WidgetDiv.hide(),o.DropDownDiv.hideWithoutAnimation()):e.keyCode==o.utils.KeyCodes.ESC?(this.setValue(this.htmlInput_.untypedDefaultValue_),o.WidgetDiv.hide(),o.DropDownDiv.hideWithoutAnimation()):e.keyCode==o.utils.KeyCodes.TAB&&(o.WidgetDiv.hide(),o.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())},o.FieldTextInput.prototype.onHtmlInputChange_=function(e){(e=this.htmlInput_.value)!==this.htmlInput_.oldValue_&&(this.htmlInput_.oldValue_=e,o.Events.setGroup(!0),e=this.getValueFromEditorText_(e),this.setValue(e),this.forceRerender(),this.resizeEditor_(),o.Events.setGroup(!1))},o.FieldTextInput.prototype.setEditorValue_=function(e){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e)},o.FieldTextInput.prototype.resizeEditor_=function(){var e=o.WidgetDiv.DIV,r=this.getScaledBBox();e.style.width=r.right-r.left+"px",e.style.height=r.bottom-r.top+"px",r=new o.utils.Coordinate(this.sourceBlock_.RTL?r.right-e.offsetWidth:r.left,r.top),e.style.left=r.x+"px",e.style.top=r.y+"px"},o.FieldTextInput.prototype.isTabNavigable=function(){return!0},o.FieldTextInput.prototype.getText_=function(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null},o.FieldTextInput.prototype.getEditorText_=function(e){return String(e)},o.FieldTextInput.prototype.getValueFromEditorText_=function(e){return e},o.fieldRegistry.register("field_input",o.FieldTextInput),o.FieldAngle=function(e,r,l){this.clockwise_=o.FieldAngle.CLOCKWISE,this.offset_=o.FieldAngle.OFFSET,this.wrap_=o.FieldAngle.WRAP,this.round_=o.FieldAngle.ROUND,o.FieldAngle.superClass_.constructor.call(this,e,r,l),this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.line_=this.gauge_=this.editor_=null},o.utils.object.inherits(o.FieldAngle,o.FieldTextInput),o.FieldAngle.prototype.DEFAULT_VALUE=0,o.FieldAngle.fromJson=function(e){return new o.FieldAngle(e.angle,void 0,e)},o.FieldAngle.prototype.SERIALIZABLE=!0,o.FieldAngle.ROUND=15,o.FieldAngle.HALF=50,o.FieldAngle.CLOCKWISE=!1,o.FieldAngle.OFFSET=0,o.FieldAngle.WRAP=360,o.FieldAngle.RADIUS=o.FieldAngle.HALF-1,o.FieldAngle.prototype.configure_=function(e){switch(o.FieldAngle.superClass_.configure_.call(this,e),e.mode){case"compass":this.clockwise_=!0,this.offset_=90;break;case"protractor":this.clockwise_=!1,this.offset_=0}var r=e.clockwise;"boolean"==typeof r&&(this.clockwise_=r),null!=(r=e.offset)&&(r=Number(r),isNaN(r)||(this.offset_=r)),null!=(r=e.wrap)&&(r=Number(r),isNaN(r)||(this.wrap_=r)),null!=(e=e.round)&&(e=Number(e),isNaN(e)||(this.round_=e))},o.FieldAngle.prototype.initView=function(){o.FieldAngle.superClass_.initView.call(this),this.symbol_=o.utils.dom.createSvgElement(o.utils.Svg.TSPAN,{},null),this.symbol_.appendChild(document.createTextNode("\xb0")),this.textElement_.appendChild(this.symbol_)},o.FieldAngle.prototype.render_=function(){o.FieldAngle.superClass_.render_.call(this),this.updateGraph_()},o.FieldAngle.prototype.showEditor_=function(e){o.FieldAngle.superClass_.showEditor_.call(this,e,o.utils.userAgent.MOBILE||o.utils.userAgent.ANDROID||o.utils.userAgent.IPAD),this.dropdownCreate_(),o.DropDownDiv.getContentDiv().appendChild(this.editor_),o.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),o.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.updateGraph_()},o.FieldAngle.prototype.dropdownCreate_=function(){var e=o.utils.dom.createSvgElement(o.utils.Svg.SVG,{xmlns:o.utils.dom.SVG_NS,"xmlns:html":o.utils.dom.HTML_NS,"xmlns:xlink":o.utils.dom.XLINK_NS,version:"1.1",height:2*o.FieldAngle.HALF+"px",width:2*o.FieldAngle.HALF+"px",style:"touch-action: none"},null),r=o.utils.dom.createSvgElement(o.utils.Svg.CIRCLE,{cx:o.FieldAngle.HALF,cy:o.FieldAngle.HALF,r:o.FieldAngle.RADIUS,class:"blocklyAngleCircle"},e);this.gauge_=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyAngleGauge"},e),this.line_=o.utils.dom.createSvgElement(o.utils.Svg.LINE,{x1:o.FieldAngle.HALF,y1:o.FieldAngle.HALF,class:"blocklyAngleLine"},e);for(var l=0;360>l;l+=15)o.utils.dom.createSvgElement(o.utils.Svg.LINE,{x1:o.FieldAngle.HALF+o.FieldAngle.RADIUS,y1:o.FieldAngle.HALF,x2:o.FieldAngle.HALF+o.FieldAngle.RADIUS-(l%45==0?10:5),y2:o.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+l+","+o.FieldAngle.HALF+","+o.FieldAngle.HALF+")"},e);this.clickWrapper_=o.browserEvents.conditionalBind(e,"click",this,this.hide_),this.clickSurfaceWrapper_=o.browserEvents.conditionalBind(r,"click",this,this.onMouseMove_,!0,!0),this.moveSurfaceWrapper_=o.browserEvents.conditionalBind(r,"mousemove",this,this.onMouseMove_,!0,!0),this.editor_=e},o.FieldAngle.prototype.dropdownDispose_=function(){this.clickWrapper_&&(o.browserEvents.unbind(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(o.browserEvents.unbind(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(o.browserEvents.unbind(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null},o.FieldAngle.prototype.hide_=function(){o.DropDownDiv.hideIfOwner(this),o.WidgetDiv.hide()},o.FieldAngle.prototype.onMouseMove_=function(e){var r=this.gauge_.ownerSVGElement.getBoundingClientRect(),l=e.clientX-r.left-o.FieldAngle.HALF;e=e.clientY-r.top-o.FieldAngle.HALF,r=Math.atan(-e/l),isNaN(r)||(r=o.utils.math.toDegrees(r),0>l?r+=180:0<e&&(r+=360),this.displayMouseOrKeyboardValue_(r=this.clockwise_?this.offset_+360-r:360-(this.offset_-r)))},o.FieldAngle.prototype.displayMouseOrKeyboardValue_=function(e){this.round_&&(e=Math.round(e/this.round_)*this.round_),(e=this.wrapValue_(e))!=this.value_&&this.setEditorValue_(e)},o.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var e=Number(this.getText())+this.offset_,r=o.utils.math.toRadians(e%360);e=["M ",o.FieldAngle.HALF,",",o.FieldAngle.HALF];var l=o.FieldAngle.HALF,c=o.FieldAngle.HALF;if(!isNaN(r)){var p=Number(this.clockwise_),_=o.utils.math.toRadians(this.offset_),v=Math.cos(_)*o.FieldAngle.RADIUS,b=Math.sin(_)*-o.FieldAngle.RADIUS;p&&(r=2*_-r),l+=Math.cos(r)*o.FieldAngle.RADIUS,c-=Math.sin(r)*o.FieldAngle.RADIUS,r=Math.abs(Math.floor((r-_)/Math.PI)%2),p&&(r=1-r),e.push(" l ",v,",",b," A ",o.FieldAngle.RADIUS,",",o.FieldAngle.RADIUS," 0 ",r," ",p," ",l,",",c," z")}this.gauge_.setAttribute("d",e.join("")),this.line_.setAttribute("x2",l),this.line_.setAttribute("y2",c)}},o.FieldAngle.prototype.onHtmlInputKeyDown_=function(e){var r;if(o.FieldAngle.superClass_.onHtmlInputKeyDown_.call(this,e),e.keyCode===o.utils.KeyCodes.LEFT?r=this.sourceBlock_.RTL?1:-1:e.keyCode===o.utils.KeyCodes.RIGHT?r=this.sourceBlock_.RTL?-1:1:e.keyCode===o.utils.KeyCodes.DOWN?r=-1:e.keyCode===o.utils.KeyCodes.UP&&(r=1),r){var l=this.getValue();this.displayMouseOrKeyboardValue_(l+r*this.round_),e.preventDefault(),e.stopPropagation()}},o.FieldAngle.prototype.doClassValidation_=function(e){return e=Number(e),isNaN(e)||!isFinite(e)?null:this.wrapValue_(e)},o.FieldAngle.prototype.wrapValue_=function(e){return 0>(e%=360)&&(e+=360),e>this.wrap_&&(e-=360),e},o.Css.register(".blocklyAngleCircle {,stroke: #444;,stroke-width: 1;,fill: #ddd;,fill-opacity: .8;,},.blocklyAngleMarks {,stroke: #444;,stroke-width: 1;,},.blocklyAngleGauge {,fill: #f88;,fill-opacity: .8;,pointer-events: none;,},.blocklyAngleLine {,stroke: #f00;,stroke-width: 2;,stroke-linecap: round;,pointer-events: none;,}".split(",")),o.fieldRegistry.register("field_angle",o.FieldAngle),o.FieldCheckbox=function(e,r,l){this.checkChar_=null,o.FieldCheckbox.superClass_.constructor.call(this,e,r,l)},o.utils.object.inherits(o.FieldCheckbox,o.Field),o.FieldCheckbox.prototype.DEFAULT_VALUE=!1,o.FieldCheckbox.fromJson=function(e){return new o.FieldCheckbox(e.checked,void 0,e)},o.FieldCheckbox.CHECK_CHAR="\u2713",o.FieldCheckbox.prototype.SERIALIZABLE=!0,o.FieldCheckbox.prototype.CURSOR="default",o.FieldCheckbox.prototype.configure_=function(e){o.FieldCheckbox.superClass_.configure_.call(this,e),e.checkCharacter&&(this.checkChar_=e.checkCharacter)},o.FieldCheckbox.prototype.initView=function(){o.FieldCheckbox.superClass_.initView.call(this),o.utils.dom.addClass(this.textElement_,"blocklyCheckbox"),this.textElement_.style.display=this.value_?"block":"none"},o.FieldCheckbox.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)},o.FieldCheckbox.prototype.getDisplayText_=function(){return this.checkChar_||o.FieldCheckbox.CHECK_CHAR},o.FieldCheckbox.prototype.setCheckCharacter=function(e){this.checkChar_=e,this.forceRerender()},o.FieldCheckbox.prototype.showEditor_=function(){this.setValue(!this.value_)},o.FieldCheckbox.prototype.doClassValidation_=function(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null},o.FieldCheckbox.prototype.doValueUpdate_=function(e){this.value_=this.convertValueToBool_(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")},o.FieldCheckbox.prototype.getValue=function(){return this.value_?"TRUE":"FALSE"},o.FieldCheckbox.prototype.getValueBoolean=function(){return this.value_},o.FieldCheckbox.prototype.getText=function(){return String(this.convertValueToBool_(this.value_))},o.FieldCheckbox.prototype.convertValueToBool_=function(e){return"string"==typeof e?"TRUE"==e:!!e},o.fieldRegistry.register("field_checkbox",o.FieldCheckbox),o.FieldColour=function(e,r,l){o.FieldColour.superClass_.constructor.call(this,e,r,l),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null},o.utils.object.inherits(o.FieldColour,o.Field),o.FieldColour.fromJson=function(e){return new o.FieldColour(e.colour,void 0,e)},o.FieldColour.prototype.SERIALIZABLE=!0,o.FieldColour.prototype.CURSOR="default",o.FieldColour.prototype.isDirty_=!1,o.FieldColour.prototype.colours_=null,o.FieldColour.prototype.titles_=null,o.FieldColour.prototype.columns_=0,o.FieldColour.prototype.configure_=function(e){o.FieldColour.superClass_.configure_.call(this,e),e.colourOptions&&(this.colours_=e.colourOptions,this.titles_=e.colourTitles),e.columns&&(this.columns_=e.columns)},o.FieldColour.prototype.initView=function(){this.size_=new o.utils.Size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.clickTarget_=this.sourceBlock_.getSvgRoot():(this.createBorderRect_(),this.borderRect_.style.fillOpacity="1")},o.FieldColour.prototype.applyColour=function(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())},o.FieldColour.prototype.doClassValidation_=function(e){return"string"!=typeof e?null:o.utils.colour.parse(e)},o.FieldColour.prototype.doValueUpdate_=function(e){this.value_=e,this.borderRect_?this.borderRect_.style.fill=e:this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",e),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))},o.FieldColour.prototype.getText=function(){var e=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(e)&&(e="#"+e[1]+e[3]+e[5]),e},o.FieldColour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),o.FieldColour.prototype.DEFAULT_VALUE=o.FieldColour.COLOURS[0],o.FieldColour.TITLES=[],o.FieldColour.COLUMNS=7,o.FieldColour.prototype.setColours=function(e,r){return this.colours_=e,r&&(this.titles_=r),this},o.FieldColour.prototype.setColumns=function(e){return this.columns_=e,this},o.FieldColour.prototype.showEditor_=function(){this.dropdownCreate_(),o.DropDownDiv.getContentDiv().appendChild(this.picker_),o.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:!0})},o.FieldColour.prototype.onClick_=function(e){null!==(e=(e=e.target)&&e.label)&&(this.setValue(e),o.DropDownDiv.hideIfOwner(this))},o.FieldColour.prototype.onKeyDown_=function(e){var r=!1;e.keyCode===o.utils.KeyCodes.UP?(this.moveHighlightBy_(0,-1),r=!0):e.keyCode===o.utils.KeyCodes.DOWN?(this.moveHighlightBy_(0,1),r=!0):e.keyCode===o.utils.KeyCodes.LEFT?(this.moveHighlightBy_(-1,0),r=!0):e.keyCode===o.utils.KeyCodes.RIGHT?(this.moveHighlightBy_(1,0),r=!0):e.keyCode===o.utils.KeyCodes.ENTER&&((r=this.getHighlighted_())&&null!==(r=r&&r.label)&&this.setValue(r),o.DropDownDiv.hideWithoutAnimation(),r=!0),r&&e.stopPropagation()},o.FieldColour.prototype.moveHighlightBy_=function(e,r){var l=this.colours_||o.FieldColour.COLOURS,c=this.columns_||o.FieldColour.COLUMNS,p=this.highlightedIndex_%c,_=Math.floor(this.highlightedIndex_/c);p+=e,_+=r,0>e?0>p&&0<_?(p=c-1,_--):0>p&&(p=0):0<e?p>c-1&&_<Math.floor(l.length/c)-1?(p=0,_++):p>c-1&&p--:0>r?0>_&&(_=0):0<r&&_>Math.floor(l.length/c)-1&&(_=Math.floor(l.length/c)-1),this.setHighlightedCell_(this.picker_.childNodes[_].childNodes[p],_*c+p)},o.FieldColour.prototype.onMouseMove_=function(e){var r=(e=e.target)&&Number(e.getAttribute("data-index"));null!==r&&r!==this.highlightedIndex_&&this.setHighlightedCell_(e,r)},o.FieldColour.prototype.onMouseEnter_=function(){this.picker_.focus({preventScroll:!0})},o.FieldColour.prototype.onMouseLeave_=function(){this.picker_.blur();var e=this.getHighlighted_();e&&o.utils.dom.removeClass(e,"blocklyColourHighlighted")},o.FieldColour.prototype.getHighlighted_=function(){var e=this.columns_||o.FieldColour.COLUMNS,r=this.picker_.childNodes[Math.floor(this.highlightedIndex_/e)];return r?r.childNodes[this.highlightedIndex_%e]:null},o.FieldColour.prototype.setHighlightedCell_=function(e,r){var l=this.getHighlighted_();l&&o.utils.dom.removeClass(l,"blocklyColourHighlighted"),o.utils.dom.addClass(e,"blocklyColourHighlighted"),this.highlightedIndex_=r,o.utils.aria.setState(this.picker_,o.utils.aria.State.ACTIVEDESCENDANT,e.getAttribute("id"))},o.FieldColour.prototype.dropdownCreate_=function(){var e=this.columns_||o.FieldColour.COLUMNS,r=this.colours_||o.FieldColour.COLOURS,l=this.titles_||o.FieldColour.TITLES,c=this.getValue(),p=document.createElement("table");p.className="blocklyColourTable",p.tabIndex=0,p.dir="ltr",o.utils.aria.setRole(p,o.utils.aria.Role.GRID),o.utils.aria.setState(p,o.utils.aria.State.EXPANDED,!0),o.utils.aria.setState(p,o.utils.aria.State.ROWCOUNT,Math.floor(r.length/e)),o.utils.aria.setState(p,o.utils.aria.State.COLCOUNT,e);for(var _,v=0;v<r.length;v++){v%e==0&&(_=document.createElement("tr"),o.utils.aria.setRole(_,o.utils.aria.Role.ROW),p.appendChild(_));var b=document.createElement("td");_.appendChild(b),b.label=r[v],b.title=l[v]||r[v],b.id=o.utils.IdGenerator.getNextUniqueId(),b.setAttribute("data-index",v),o.utils.aria.setRole(b,o.utils.aria.Role.GRIDCELL),o.utils.aria.setState(b,o.utils.aria.State.LABEL,r[v]),o.utils.aria.setState(b,o.utils.aria.State.SELECTED,r[v]==c),b.style.backgroundColor=r[v],r[v]==c&&(b.className="blocklyColourSelected",this.highlightedIndex_=v)}this.onClickWrapper_=o.browserEvents.conditionalBind(p,"click",this,this.onClick_,!0),this.onMouseMoveWrapper_=o.browserEvents.conditionalBind(p,"mousemove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=o.browserEvents.conditionalBind(p,"mouseenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=o.browserEvents.conditionalBind(p,"mouseleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=o.browserEvents.conditionalBind(p,"keydown",this,this.onKeyDown_),this.picker_=p},o.FieldColour.prototype.dropdownDispose_=function(){this.onClickWrapper_&&(o.browserEvents.unbind(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(o.browserEvents.unbind(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(o.browserEvents.unbind(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(o.browserEvents.unbind(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(o.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null},o.Css.register([".blocklyColourTable {","border-collapse: collapse;","display: block;","outline: none;","padding: 1px;","}",".blocklyColourTable>tr>td {","border: .5px solid #888;","box-sizing: border-box;","cursor: pointer;","display: inline-block;","height: 20px;","padding: 0;","width: 20px;","}",".blocklyColourTable>tr>td.blocklyColourHighlighted {","border-color: #eee;","box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);","position: relative;","}",".blocklyColourSelected, .blocklyColourSelected:hover {","border-color: #eee !important;","outline: 1px solid #333;","position: relative;","}"]),o.fieldRegistry.register("field_colour",o.FieldColour),o.FieldDropdown=function(e,r,l){"function"!=typeof e&&o.FieldDropdown.validateOptions_(e),this.menuGenerator_=e,this.suffixField=this.prefixField=this.generatedOptions_=null,this.trimOptions_(),this.selectedOption_=this.getOptions(!1)[0],o.FieldDropdown.superClass_.constructor.call(this,this.selectedOption_[1],r,l),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null},o.utils.object.inherits(o.FieldDropdown,o.Field),o.FieldDropdown.fromJson=function(e){return new o.FieldDropdown(e.options,void 0,e)},o.FieldDropdown.prototype.fromXml=function(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)},o.FieldDropdown.prototype.SERIALIZABLE=!0,o.FieldDropdown.CHECKMARK_OVERHANG=25,o.FieldDropdown.MAX_MENU_HEIGHT_VH=.45,o.FieldDropdown.IMAGE_Y_OFFSET=5,o.FieldDropdown.IMAGE_Y_PADDING=2*o.FieldDropdown.IMAGE_Y_OFFSET,o.FieldDropdown.ARROW_CHAR=o.utils.userAgent.ANDROID?"\u25bc":"\u25be",o.FieldDropdown.prototype.CURSOR="default",o.FieldDropdown.prototype.initView=function(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=o.utils.dom.createSvgElement(o.utils.Svg.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&o.utils.dom.addClass(this.borderRect_,"blocklyDropdownRect")},o.FieldDropdown.prototype.shouldAddBorderRect_=function(){return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!this.sourceBlock_.isShadow()},o.FieldDropdown.prototype.createTextArrow_=function(){this.arrow_=o.utils.dom.createSvgElement(o.utils.Svg.TSPAN,{},this.textElement_),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?o.FieldDropdown.ARROW_CHAR+" ":" "+o.FieldDropdown.ARROW_CHAR)),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textContent_):this.textElement_.appendChild(this.arrow_)},o.FieldDropdown.prototype.createSVGArrow_=function(){this.svgArrow_=o.utils.dom.createSvgElement(o.utils.Svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)},o.FieldDropdown.prototype.showEditor_=function(e){if(this.dropdownCreate_(),this.menu_.openingCoords=e&&"number"==typeof e.clientX?new o.utils.Coordinate(e.clientX,e.clientY):null,this.menu_.render(o.DropDownDiv.getContentDiv()),e=this.menu_.getElement(),o.utils.dom.addClass(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){e=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().getColour():this.sourceBlock_.getColour();var r=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;o.DropDownDiv.setColour(e,r)}o.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()},o.FieldDropdown.prototype.dropdownCreate_=function(){var e=new o.Menu;e.setRole(o.utils.aria.Role.LISTBOX),this.menu_=e;var r=this.getOptions(!1);this.selectedMenuItem_=null;for(var l=0;l<r.length;l++){var c=r[l][0],p=r[l][1];if("object"==typeof c){var _=new Image(c.width,c.height);_.src=c.src,_.alt=c.alt||"",c=_}(c=new o.MenuItem(c,p)).setRole(o.utils.aria.Role.OPTION),c.setRightToLeft(this.sourceBlock_.RTL),c.setCheckable(!0),e.addChild(c),c.setChecked(p==this.value_),p==this.value_&&(this.selectedMenuItem_=c),c.onAction(this.handleMenuActionEvent_,this)}},o.FieldDropdown.prototype.dropdownDispose_=function(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()},o.FieldDropdown.prototype.handleMenuActionEvent_=function(e){o.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)},o.FieldDropdown.prototype.onItemSelected_=function(e,r){this.setValue(r.getValue())},o.FieldDropdown.prototype.trimOptions_=function(){var e=this.menuGenerator_;if(Array.isArray(e)){for(var r=!1,l=0;l<e.length;l++){var c=e[l][0];"string"==typeof c?e[l][0]=o.utils.replaceMessageReferences(c):(null!=c.alt&&(e[l][0].alt=o.utils.replaceMessageReferences(c.alt)),r=!0)}if(!(r||2>e.length)){for(r=[],l=0;l<e.length;l++)r.push(e[l][0]);l=o.utils.string.shortestStringLength(r),c=o.utils.string.commonWordPrefix(r,l);var p=o.utils.string.commonWordSuffix(r,l);!c&&!p||l<=c+p||(c&&(this.prefixField=r[0].substring(0,c-1)),p&&(this.suffixField=r[0].substr(1-p)),this.menuGenerator_=o.FieldDropdown.applyTrim_(e,c,p))}}},o.FieldDropdown.applyTrim_=function(e,r,l){for(var c=[],p=0;p<e.length;p++){var _=e[p][0],v=e[p][1];_=_.substring(r,_.length-l),c[p]=[_,v]}return c},o.FieldDropdown.prototype.isOptionListDynamic=function(){return"function"==typeof this.menuGenerator_},o.FieldDropdown.prototype.getOptions=function(e){return this.isOptionListDynamic()?(this.generatedOptions_&&e||(this.generatedOptions_=this.menuGenerator_.call(this),o.FieldDropdown.validateOptions_(this.generatedOptions_)),this.generatedOptions_):this.menuGenerator_},o.FieldDropdown.prototype.doClassValidation_=function(e){for(var p,r=!1,l=this.getOptions(!0),c=0;p=l[c];c++)if(p[1]==e){r=!0;break}return r?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)},o.FieldDropdown.prototype.doValueUpdate_=function(e){o.FieldDropdown.superClass_.doValueUpdate_.call(this,e),e=this.getOptions(!0);for(var l,r=0;l=e[r];r++)l[1]==this.value_&&(this.selectedOption_=l)},o.FieldDropdown.prototype.applyColour=function(){this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary),this.borderRect_.setAttribute("fill",this.menu_?this.sourceBlock_.style.colourTertiary:"transparent")),this.sourceBlock_&&this.arrow_&&(this.arrow_.style.fill=this.sourceBlock_.isShadow()?this.sourceBlock_.style.colourSecondary:this.sourceBlock_.style.colourPrimary)},o.FieldDropdown.prototype.render_=function(){this.textContent_.nodeValue="",this.imageElement_.style.display="none";var e=this.selectedOption_&&this.selectedOption_[0];e&&"object"==typeof e?this.renderSelectedImage_(e):this.renderSelectedText_(),this.positionBorderRect_()},o.FieldDropdown.prototype.renderSelectedImage_=function(e){this.imageElement_.style.display="",this.imageElement_.setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",e.src),this.imageElement_.setAttribute("height",e.height),this.imageElement_.setAttribute("width",e.width);var r=Number(e.height);e=Number(e.width);var l=!!this.borderRect_,c=Math.max(l?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,r+o.FieldDropdown.IMAGE_Y_PADDING);l=l?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var p=this.svgArrow_?this.positionSVGArrow_(e+l,c/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):o.utils.dom.getFastTextWidth(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=e+p+2*l,this.size_.height=c;var _=0;this.sourceBlock_.RTL?this.imageElement_.setAttribute("x",l+p):(_=e+p,this.textElement_.setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",l)),this.imageElement_.setAttribute("y",c/2-r/2),this.positionTextElement_(_+l,e+p)},o.FieldDropdown.prototype.renderSelectedText_=function(){this.textContent_.nodeValue=this.getDisplayText_(),o.utils.dom.addClass(this.textElement_,"blocklyDropdownText"),this.textElement_.setAttribute("text-anchor","start");var e=!!this.borderRect_,r=Math.max(e?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),l=o.utils.dom.getFastTextWidth(this.textElement_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);e=e?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var c=0;this.svgArrow_&&(c=this.positionSVGArrow_(l+e,r/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=l+c+2*e,this.size_.height=r,this.positionTextElement_(e,l)},o.FieldDropdown.prototype.positionSVGArrow_=function(e,r){if(!this.svgArrow_)return 0;var l=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,c=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,p=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(this.sourceBlock_.RTL?l:e+c)+","+r+")"),p+c},o.FieldDropdown.prototype.getText_=function(){if(!this.selectedOption_)return null;var e=this.selectedOption_[0];return"object"==typeof e?e.alt:e},o.FieldDropdown.validateOptions_=function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");for(var r=!1,l=0;l<e.length;++l){var c=e[l];Array.isArray(c)?"string"!=typeof c[1]?(r=!0,console.error("Invalid option["+l+"]: Each FieldDropdown option id must be a string. Found "+c[1]+" in: ",c)):c[0]&&"string"!=typeof c[0]&&"string"!=typeof c[0].src&&(r=!0,console.error("Invalid option["+l+"]: Each FieldDropdown option must have a string label or image description. Found"+c[0]+" in: ",c)):(r=!0,console.error("Invalid option["+l+"]: Each FieldDropdown option must be an array. Found: ",c))}if(r)throw TypeError("Found invalid FieldDropdown options.")},o.fieldRegistry.register("field_dropdown",o.FieldDropdown),o.FieldLabelSerializable=function(e,r,l){o.FieldLabelSerializable.superClass_.constructor.call(this,e,r,l)},o.utils.object.inherits(o.FieldLabelSerializable,o.FieldLabel),o.FieldLabelSerializable.fromJson=function(e){var r=o.utils.replaceMessageReferences(e.text);return new o.FieldLabelSerializable(r,void 0,e)},o.FieldLabelSerializable.prototype.EDITABLE=!1,o.FieldLabelSerializable.prototype.SERIALIZABLE=!0,o.fieldRegistry.register("field_label_serializable",o.FieldLabelSerializable),o.FieldImage=function(e,r,l,c,p,_,v){if(!e)throw Error("Src value of an image field is required");if(e=o.utils.replaceMessageReferences(e),l=Number(o.utils.replaceMessageReferences(l)),r=Number(o.utils.replaceMessageReferences(r)),isNaN(l)||isNaN(r))throw Error("Height and width values of an image field must cast to numbers.");if(0>=l||0>=r)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",o.FieldImage.superClass_.constructor.call(this,e,null,v),v||(this.flipRtl_=!!_,this.altText_=o.utils.replaceMessageReferences(c)||""),this.size_=new o.utils.Size(r,l+o.FieldImage.Y_PADDING),this.imageHeight_=l,this.clickHandler_=null,"function"==typeof p&&(this.clickHandler_=p),this.imageElement_=null},o.utils.object.inherits(o.FieldImage,o.Field),o.FieldImage.prototype.DEFAULT_VALUE="",o.FieldImage.fromJson=function(e){return new o.FieldImage(e.src,e.width,e.height,void 0,void 0,void 0,e)},o.FieldImage.Y_PADDING=1,o.FieldImage.prototype.EDITABLE=!1,o.FieldImage.prototype.isDirty_=!1,o.FieldImage.prototype.configure_=function(e){o.FieldImage.superClass_.configure_.call(this,e),this.flipRtl_=!!e.flipRtl,this.altText_=o.utils.replaceMessageReferences(e.alt)||""},o.FieldImage.prototype.initView=function(){this.imageElement_=o.utils.dom.createSvgElement(o.utils.Svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")},o.FieldImage.prototype.updateSize_=function(){},o.FieldImage.prototype.doClassValidation_=function(e){return"string"!=typeof e?null:e},o.FieldImage.prototype.doValueUpdate_=function(e){this.value_=e,this.imageElement_&&this.imageElement_.setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",String(this.value_))},o.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},o.FieldImage.prototype.setAlt=function(e){e!=this.altText_&&(this.altText_=e||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},o.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},o.FieldImage.prototype.setOnClickHandler=function(e){this.clickHandler_=e},o.FieldImage.prototype.getText_=function(){return this.altText_},o.fieldRegistry.register("field_image",o.FieldImage),o.FieldMultilineInput=function(e,r,l){o.FieldMultilineInput.superClass_.constructor.call(this,e,r,l),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=!1},o.utils.object.inherits(o.FieldMultilineInput,o.FieldTextInput),o.FieldMultilineInput.prototype.configure_=function(e){o.FieldMultilineInput.superClass_.configure_.call(this,e),e.maxLines&&this.setMaxLines(e.maxLines)},o.FieldMultilineInput.fromJson=function(e){var r=o.utils.replaceMessageReferences(e.text);return new o.FieldMultilineInput(r,void 0,e)},o.FieldMultilineInput.prototype.toXml=function(e){return e.textContent=this.getValue().replace(/\n/g,"&#10;"),e},o.FieldMultilineInput.prototype.fromXml=function(e){this.setValue(e.textContent.replace(/&#10;/g,"\n"))},o.FieldMultilineInput.prototype.initView=function(){this.createBorderRect_(),this.textGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)},o.FieldMultilineInput.prototype.getDisplayText_=function(){var e=this.getText();if(!e)return o.Field.NBSP;var r=e.split("\n");e="";for(var l=this.isOverflowedY_?this.maxLines_:r.length,c=0;c<l;c++){var p=r[c];p.length>this.maxDisplayLength?p=p.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&c===l-1&&(p=p.substring(0,p.length-3)+"..."),e+=p=p.replace(/\s/g,o.Field.NBSP),c!==l-1&&(e+="\n")}return this.sourceBlock_.RTL&&(e+="\u200f"),e},o.FieldMultilineInput.prototype.doValueUpdate_=function(e){o.FieldMultilineInput.superClass_.doValueUpdate_.call(this,e),this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_},o.FieldMultilineInput.prototype.render_=function(){for(var e;e=this.textGroup_.firstChild;)this.textGroup_.removeChild(e);e=this.getDisplayText_().split("\n");for(var r=0,l=0;l<e.length;l++){var c=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;o.utils.dom.createSvgElement(o.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:r+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(e[l])),r+=c}this.isBeingEdited_&&(e=this.htmlInput_,this.isOverflowedY_?o.utils.dom.addClass(e,"blocklyHtmlTextAreaInputOverflowedY"):o.utils.dom.removeClass(e,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),e=this.htmlInput_,this.isTextValid_?(o.utils.dom.removeClass(e,"blocklyInvalidInput"),o.utils.aria.setState(e,o.utils.aria.State.INVALID,!1)):(o.utils.dom.addClass(e,"blocklyInvalidInput"),o.utils.aria.setState(e,o.utils.aria.State.INVALID,!0)))},o.FieldMultilineInput.prototype.updateSize_=function(){for(var e=this.textGroup_.childNodes,r=0,l=0,c=0;c<e.length;c++){var p=o.utils.dom.getTextWidth(e[c]);p>r&&(r=p),l+=this.getConstants().FIELD_TEXT_HEIGHT+(0<c?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){e=this.value_.split("\n"),p=o.utils.dom.createSvgElement(o.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText"});var _=this.getConstants().FIELD_TEXT_FONTSIZE,v=this.getConstants().FIELD_TEXT_FONTWEIGHT,b=this.getConstants().FIELD_TEXT_FONTFAMILY;for(c=0;c<e.length;c++){e[c].length>this.maxDisplayLength&&(e[c]=e[c].substring(0,this.maxDisplayLength)),p.textContent=e[c];var w=o.utils.dom.getFastTextWidth(p,_,v,b);w>r&&(r=w)}r+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(l+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,r+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",r),this.borderRect_.setAttribute("height",l)),this.size_.width=r,this.size_.height=l,this.positionBorderRect_()},o.FieldMultilineInput.prototype.showEditor_=function(e,r){o.FieldMultilineInput.superClass_.showEditor_.call(this,e,r),this.forceRerender()},o.FieldMultilineInput.prototype.widgetCreate_=function(){var e=o.WidgetDiv.DIV,r=this.workspace_.getScale(),l=document.createElement("textarea");l.className="blocklyHtmlInput blocklyHtmlTextAreaInput",l.setAttribute("spellcheck",this.spellcheck_);var c=this.getConstants().FIELD_TEXT_FONTSIZE*r+"pt";e.style.fontSize=c,l.style.fontSize=c,l.style.borderRadius=o.FieldTextInput.BORDERRADIUS*r+"px",c=this.getConstants().FIELD_BORDER_RECT_X_PADDING*r;var p=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*r/2;return l.style.padding=p+"px "+c+"px "+p+"px "+c+"px",c=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,l.style.lineHeight=c*r+"px",e.appendChild(l),l.value=l.defaultValue=this.getEditorText_(this.value_),l.untypedDefaultValue_=this.value_,l.oldValue_=null,o.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(l),l},o.FieldMultilineInput.prototype.setMaxLines=function(e){"number"==typeof e&&0<e&&e!==this.maxLines_&&(this.maxLines_=e,this.forceRerender())},o.FieldMultilineInput.prototype.getMaxLines=function(){return this.maxLines_},o.FieldMultilineInput.prototype.onHtmlInputKeyDown_=function(e){e.keyCode!==o.utils.KeyCodes.ENTER&&o.FieldMultilineInput.superClass_.onHtmlInputKeyDown_.call(this,e)},o.Css.register(".blocklyHtmlTextAreaInput {,font-family: monospace;,resize: none;,overflow: hidden;,height: 100%;,text-align: left;,},.blocklyHtmlTextAreaInputOverflowedY {,overflow-y: scroll;,}".split(",")),o.fieldRegistry.register("field_multilinetext",o.FieldMultilineInput),o.FieldNumber=function(e,r,l,c,p,_){this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,o.FieldNumber.superClass_.constructor.call(this,e,p,_),_||this.setConstraints(r,l,c)},o.utils.object.inherits(o.FieldNumber,o.FieldTextInput),o.FieldNumber.prototype.DEFAULT_VALUE=0,o.FieldNumber.fromJson=function(e){return new o.FieldNumber(e.value,void 0,void 0,void 0,void 0,e)},o.FieldNumber.prototype.SERIALIZABLE=!0,o.FieldNumber.prototype.configure_=function(e){o.FieldNumber.superClass_.configure_.call(this,e),this.setMinInternal_(e.min),this.setMaxInternal_(e.max),this.setPrecisionInternal_(e.precision)},o.FieldNumber.prototype.setConstraints=function(e,r,l){this.setMinInternal_(e),this.setMaxInternal_(r),this.setPrecisionInternal_(l),this.setValue(this.getValue())},o.FieldNumber.prototype.setMin=function(e){this.setMinInternal_(e),this.setValue(this.getValue())},o.FieldNumber.prototype.setMinInternal_=function(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))},o.FieldNumber.prototype.getMin=function(){return this.min_},o.FieldNumber.prototype.setMax=function(e){this.setMaxInternal_(e),this.setValue(this.getValue())},o.FieldNumber.prototype.setMaxInternal_=function(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))},o.FieldNumber.prototype.getMax=function(){return this.max_},o.FieldNumber.prototype.setPrecision=function(e){this.setPrecisionInternal_(e),this.setValue(this.getValue())},o.FieldNumber.prototype.setPrecisionInternal_=function(e){this.precision_=Number(e)||0;var r=String(this.precision_);-1!=r.indexOf("e")&&(r=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));var l=r.indexOf(".");this.decimalPlaces_=-1==l?e?0:null:r.length-l-1},o.FieldNumber.prototype.getPrecision=function(){return this.precision_},o.FieldNumber.prototype.doClassValidation_=function(e){return null===e||(e=(e=(e=(e=String(e)).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!=this.decimalPlaces_&&(e=Number(e.toFixed(this.decimalPlaces_))),e)},o.FieldNumber.prototype.widgetCreate_=function(){var e=o.FieldNumber.superClass_.widgetCreate_.call(this);return-1/0<this.min_&&o.utils.aria.setState(e,o.utils.aria.State.VALUEMIN,this.min_),1/0>this.max_&&o.utils.aria.setState(e,o.utils.aria.State.VALUEMAX,this.max_),e},o.fieldRegistry.register("field_number",o.FieldNumber),o.FieldVariable=function(e,r,l,c,p){this.menuGenerator_=o.FieldVariable.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new o.utils.Size(0,0),p&&this.configure_(p),r&&this.setValidator(r),p||this.setTypes_(l,c)},o.utils.object.inherits(o.FieldVariable,o.FieldDropdown),o.FieldVariable.fromJson=function(e){var r=o.utils.replaceMessageReferences(e.variable);return new o.FieldVariable(r,void 0,void 0,void 0,e)},o.FieldVariable.prototype.SERIALIZABLE=!0,o.FieldVariable.prototype.configure_=function(e){o.FieldVariable.superClass_.configure_.call(this,e),this.setTypes_(e.variableTypes,e.defaultType)},o.FieldVariable.prototype.initModel=function(){if(!this.variable_){var e=o.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,null,this.defaultVariableName,this.defaultType_);this.doValueUpdate_(e.getId())}},o.FieldVariable.prototype.shouldAddBorderRect_=function(){return o.FieldVariable.superClass_.shouldAddBorderRect_.call(this)&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!=this.sourceBlock_.type)},o.FieldVariable.prototype.fromXml=function(e){var r=e.getAttribute("id"),l=e.textContent,c=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(r=o.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,r,l,c),null!=c&&c!==r.type)throw Error("Serialized variable type with id '"+r.getId()+"' had type "+r.type+", and does not match variable field that references it: "+o.Xml.domToText(e)+".");this.setValue(r.getId())},o.FieldVariable.prototype.toXml=function(e){return this.initModel(),e.id=this.variable_.getId(),e.textContent=this.variable_.name,this.variable_.type&&e.setAttribute("variabletype",this.variable_.type),e},o.FieldVariable.prototype.setSourceBlock=function(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");o.FieldVariable.superClass_.setSourceBlock.call(this,e)},o.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},o.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},o.FieldVariable.prototype.getVariable=function(){return this.variable_},o.FieldVariable.prototype.getValidator=function(){return this.variable_?this.validator_:null},o.FieldVariable.prototype.doClassValidation_=function(e){if(null===e)return null;var r=o.Variables.getVariable(this.sourceBlock_.workspace,e);return r?this.typeIsAllowed_(r=r.type)?e:(console.warn("Variable type doesn't match this field!  Type was "+r),null):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)},o.FieldVariable.prototype.doValueUpdate_=function(e){this.variable_=o.Variables.getVariable(this.sourceBlock_.workspace,e),o.FieldVariable.superClass_.doValueUpdate_.call(this,e)},o.FieldVariable.prototype.typeIsAllowed_=function(e){var r=this.getVariableTypes_();if(!r)return!0;for(var l=0;l<r.length;l++)if(e==r[l])return!0;return!1},o.FieldVariable.prototype.getVariableTypes_=function(){var e=this.variableTypes;if(null===e&&this.sourceBlock_&&this.sourceBlock_.workspace)return this.sourceBlock_.workspace.getVariableTypes();if(0==(e=e||[""]).length)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e},o.FieldVariable.prototype.setTypes_=function(e,r){if(r=r||"",null==e||null==e)e=null;else{if(!Array.isArray(e))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");for(var l=!1,c=0;c<e.length;c++)e[c]==r&&(l=!0);if(!l)throw Error("Invalid default type '"+r+"' in the definition of a FieldVariable")}this.defaultType_=r,this.variableTypes=e},o.FieldVariable.prototype.refreshVariableName=function(){this.forceRerender()},o.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var e=this.getText(),r=[];if(this.sourceBlock_&&this.sourceBlock_.workspace)for(var l=this.getVariableTypes_(),c=0;c<l.length;c++){var p=this.sourceBlock_.workspace.getVariablesOfType(l[c]);r=r.concat(p)}for(r.sort(o.VariableModel.compareByName),l=[],c=0;c<r.length;c++)l[c]=[r[c].name,r[c].getId()];return l.push([o.Msg.RENAME_VARIABLE,o.RENAME_VARIABLE_ID]),o.Msg.DELETE_VARIABLE&&l.push([o.Msg.DELETE_VARIABLE.replace("%1",e),o.DELETE_VARIABLE_ID]),l},o.FieldVariable.prototype.onItemSelected_=function(e,r){if(e=r.getValue(),this.sourceBlock_&&this.sourceBlock_.workspace){if(e==o.RENAME_VARIABLE_ID)return void o.Variables.renameVariable(this.sourceBlock_.workspace,this.variable_);if(e==o.DELETE_VARIABLE_ID)return void this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId())}this.setValue(e)},o.FieldVariable.prototype.referencesVariables=function(){return!0},o.fieldRegistry.register("field_variable",o.FieldVariable),o.utils.svgPaths={},o.utils.svgPaths.point=function(e,r){return" "+e+","+r+" "},o.utils.svgPaths.curve=function(e,r){return" "+e+r.join("")},o.utils.svgPaths.moveTo=function(e,r){return" M "+e+","+r+" "},o.utils.svgPaths.moveBy=function(e,r){return" m "+e+","+r+" "},o.utils.svgPaths.lineTo=function(e,r){return" l "+e+","+r+" "},o.utils.svgPaths.line=function(e){return" l"+e.join("")},o.utils.svgPaths.lineOnAxis=function(e,r){return" "+e+" "+r+" "},o.utils.svgPaths.arc=function(e,r,l,c){return e+" "+l+" "+l+" "+r+c},o.blockRendering.ConstantProvider=function(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.CORNER_RADIUS=8,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=o.utils.svgPaths.moveBy(0,0),this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_TEXT_BASELINE_CENTER=!o.utils.userAgent.IE&&!o.utils.userAgent.EDGE,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2),this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2}},o.blockRendering.ConstantProvider.prototype.init=function(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()},o.blockRendering.ConstantProvider.prototype.setTheme=function(e){this.blockStyles=Object.create(null);var l,r=e.blockStyles;for(l in r)this.blockStyles[l]=this.validatedBlockStyle_(r[l]);this.setDynamicProperties_(e)},o.blockRendering.ConstantProvider.prototype.setDynamicProperties_=function(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=null!=e.startHats?e.startHats:this.ADD_START_HATS},o.blockRendering.ConstantProvider.prototype.setFontConstants_=function(e){this.FIELD_TEXT_FONTFAMILY=e.fontStyle&&null!=e.fontStyle.family?e.fontStyle.family:this.FIELD_TEXT_FONTFAMILY,this.FIELD_TEXT_FONTWEIGHT=e.fontStyle&&null!=e.fontStyle.weight?e.fontStyle.weight:this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTSIZE=e.fontStyle&&null!=e.fontStyle.size?e.fontStyle.size:this.FIELD_TEXT_FONTSIZE,e=o.utils.dom.measureFontMetrics("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline},o.blockRendering.ConstantProvider.prototype.setComponentConstants_=function(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY},o.blockRendering.ConstantProvider.prototype.getBlockStyleForColour=function(e){var r="auto_"+e;return this.blockStyles[r]||(this.blockStyles[r]=this.createBlockStyle_(e)),{style:this.blockStyles[r],name:r}},o.blockRendering.ConstantProvider.prototype.getBlockStyle=function(e){return this.blockStyles[e||""]||(e&&0==e.indexOf("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))},o.blockRendering.ConstantProvider.prototype.createBlockStyle_=function(e){return this.validatedBlockStyle_({colourPrimary:e})},o.blockRendering.ConstantProvider.prototype.validatedBlockStyle_=function(e){var r={};return e&&o.utils.object.mixin(r,e),e=o.utils.parseBlockColour(r.colourPrimary||"#000"),r.colourPrimary=e.hex,r.colourSecondary=r.colourSecondary?o.utils.parseBlockColour(r.colourSecondary).hex:this.generateSecondaryColour_(r.colourPrimary),r.colourTertiary=r.colourTertiary?o.utils.parseBlockColour(r.colourTertiary).hex:this.generateTertiaryColour_(r.colourPrimary),r.hat=r.hat||"",r},o.blockRendering.ConstantProvider.prototype.generateSecondaryColour_=function(e){return o.utils.colour.blend("#fff",e,.6)||e},o.blockRendering.ConstantProvider.prototype.generateTertiaryColour_=function(e){return o.utils.colour.blend("#fff",e,.3)||e},o.blockRendering.ConstantProvider.prototype.dispose=function(){this.embossFilter_&&o.utils.dom.removeNode(this.embossFilter_),this.disabledPattern_&&o.utils.dom.removeNode(this.disabledPattern_),this.debugFilter_&&o.utils.dom.removeNode(this.debugFilter_),this.cssNode_=null},o.blockRendering.ConstantProvider.prototype.makeJaggedTeeth=function(){var e=this.JAGGED_TEETH_HEIGHT,r=this.JAGGED_TEETH_WIDTH;return{height:e,width:r,path:o.utils.svgPaths.line([o.utils.svgPaths.point(r,e/4),o.utils.svgPaths.point(2*-r,e/2),o.utils.svgPaths.point(r,e/4)])}},o.blockRendering.ConstantProvider.prototype.makeStartHat=function(){var e=this.START_HAT_HEIGHT,r=this.START_HAT_WIDTH;return{height:e,width:r,path:o.utils.svgPaths.curve("c",[o.utils.svgPaths.point(30,-e),o.utils.svgPaths.point(70,-e),o.utils.svgPaths.point(r,0)])}},o.blockRendering.ConstantProvider.prototype.makePuzzleTab=function(){function e(_){var v=-(_=_?-1:1),b=l/2,w=b+2.5,F=b+.5,X=o.utils.svgPaths.point(-r,_*b);return b=o.utils.svgPaths.point(r,_*b),o.utils.svgPaths.curve("c",[o.utils.svgPaths.point(0,_*w),o.utils.svgPaths.point(-r,v*F),X])+o.utils.svgPaths.curve("s",[o.utils.svgPaths.point(r,2.5*v),b])}var r=this.TAB_WIDTH,l=this.TAB_HEIGHT,c=e(!0),p=e(!1);return{type:this.SHAPES.PUZZLE,width:r,height:l,pathDown:p,pathUp:c}},o.blockRendering.ConstantProvider.prototype.makeNotch=function(){function e(v){return o.utils.svgPaths.line([o.utils.svgPaths.point(v*c,l),o.utils.svgPaths.point(3*v,0),o.utils.svgPaths.point(v*c,-l)])}var r=this.NOTCH_WIDTH,l=this.NOTCH_HEIGHT,c=(r-3)/2,p=e(1),_=e(-1);return{type:this.SHAPES.NOTCH,width:r,height:l,pathLeft:p,pathRight:_}},o.blockRendering.ConstantProvider.prototype.makeInsideCorners=function(){var e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:o.utils.svgPaths.arc("a","0 0,0",e,o.utils.svgPaths.point(-e,e)),pathBottom:o.utils.svgPaths.arc("a","0 0,0",e,o.utils.svgPaths.point(e,e))}},o.blockRendering.ConstantProvider.prototype.makeOutsideCorners=function(){var e=this.CORNER_RADIUS,r=o.utils.svgPaths.moveBy(0,e)+o.utils.svgPaths.arc("a","0 0,1",e,o.utils.svgPaths.point(e,-e)),l=o.utils.svgPaths.arc("a","0 0,1",e,o.utils.svgPaths.point(e,e)),c=o.utils.svgPaths.arc("a","0 0,1",e,o.utils.svgPaths.point(-e,-e));return{topLeft:r,topRight:l,bottomRight:o.utils.svgPaths.arc("a","0 0,1",e,o.utils.svgPaths.point(-e,e)),bottomLeft:c,rightHeight:e}},o.blockRendering.ConstantProvider.prototype.shapeFor=function(e){switch(e.type){case o.connectionTypes.INPUT_VALUE:case o.connectionTypes.OUTPUT_VALUE:return this.PUZZLE_TAB;case o.connectionTypes.PREVIOUS_STATEMENT:case o.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}},o.blockRendering.ConstantProvider.prototype.createDom=function(e,r,l){this.injectCSS_(r,l),e=o.utils.dom.createSvgElement(o.utils.Svg.DEFS,{},e),r=o.utils.dom.createSvgElement(o.utils.Svg.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},e),o.utils.dom.createSvgElement(o.utils.Svg.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},r),l=o.utils.dom.createSvgElement(o.utils.Svg.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},r),o.utils.dom.createSvgElement(o.utils.Svg.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},l),o.utils.dom.createSvgElement(o.utils.Svg.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},r),o.utils.dom.createSvgElement(o.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},r),this.embossFilterId=r.id,this.embossFilter_=r,r=o.utils.dom.createSvgElement(o.utils.Svg.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},e),o.utils.dom.createSvgElement(o.utils.Svg.RECT,{width:10,height:10,fill:"#aaa"},r),o.utils.dom.createSvgElement(o.utils.Svg.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},r),this.disabledPatternId=r.id,this.disabledPattern_=r,o.blockRendering.Debug&&(e=o.utils.dom.createSvgElement(o.utils.Svg.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),r=o.utils.dom.createSvgElement(o.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},e),o.utils.dom.createSvgElement(o.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),o.utils.dom.createSvgElement(o.utils.Svg.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),o.utils.dom.createSvgElement(o.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter_=e)},o.blockRendering.ConstantProvider.prototype.injectCSS_=function(e,r){r=this.getCSS_(r),e="blockly-renderer-style-"+e,this.cssNode_=document.getElementById(e);var l=r.join("\n");this.cssNode_?this.cssNode_.firstChild.textContent=l:((r=document.createElement("style")).id=e,e=document.createTextNode(l),r.appendChild(e),document.head.insertBefore(r,document.head.firstChild),this.cssNode_=r)},o.blockRendering.ConstantProvider.prototype.getCSS_=function(e){return[e+" .blocklyText, ",e+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",e+" .blocklyText {","fill: #fff;","}",e+" .blocklyNonEditableText>rect,",e+" .blocklyEditableText>rect {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","fill-opacity: .6;","stroke: none;","}",e+" .blocklyNonEditableText>text,",e+" .blocklyEditableText>text {","fill: #000;","}",e+" .blocklyFlyoutLabelText {","fill: #000;","}",e+" .blocklyText.blocklyBubbleText {","fill: #000;","}",e+" .blocklyEditableText:not(.editing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",e+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","}",e+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",e+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",e+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",e+" .blocklyReplaceable .blocklyPathLight,",e+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",e+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},o.blockRendering.Types={NONE:0,FIELD:1,HAT:2,ICON:4,SPACER:8,BETWEEN_ROW_SPACER:16,IN_ROW_SPACER:32,EXTERNAL_VALUE_INPUT:64,INPUT:128,INLINE_INPUT:256,STATEMENT_INPUT:512,CONNECTION:1024,PREVIOUS_CONNECTION:2048,NEXT_CONNECTION:4096,OUTPUT_CONNECTION:8192,CORNER:16384,LEFT_SQUARE_CORNER:32768,LEFT_ROUND_CORNER:65536,RIGHT_SQUARE_CORNER:131072,RIGHT_ROUND_CORNER:262144,JAGGED_EDGE:524288,ROW:1048576,TOP_ROW:2097152,BOTTOM_ROW:4194304,INPUT_ROW:8388608},o.blockRendering.Types.LEFT_CORNER=o.blockRendering.Types.LEFT_SQUARE_CORNER|o.blockRendering.Types.LEFT_ROUND_CORNER,o.blockRendering.Types.RIGHT_CORNER=o.blockRendering.Types.RIGHT_SQUARE_CORNER|o.blockRendering.Types.RIGHT_ROUND_CORNER,o.blockRendering.Types.nextTypeValue_=16777216,o.blockRendering.Types.getType=function(e){return Object.prototype.hasOwnProperty.call(o.blockRendering.Types,e)||(o.blockRendering.Types[e]=o.blockRendering.Types.nextTypeValue_,o.blockRendering.Types.nextTypeValue_<<=1),o.blockRendering.Types[e]},o.blockRendering.Types.isField=function(e){return e.type&o.blockRendering.Types.FIELD},o.blockRendering.Types.isHat=function(e){return e.type&o.blockRendering.Types.HAT},o.blockRendering.Types.isIcon=function(e){return e.type&o.blockRendering.Types.ICON},o.blockRendering.Types.isSpacer=function(e){return e.type&o.blockRendering.Types.SPACER},o.blockRendering.Types.isInRowSpacer=function(e){return e.type&o.blockRendering.Types.IN_ROW_SPACER},o.blockRendering.Types.isInput=function(e){return e.type&o.blockRendering.Types.INPUT},o.blockRendering.Types.isExternalInput=function(e){return e.type&o.blockRendering.Types.EXTERNAL_VALUE_INPUT},o.blockRendering.Types.isInlineInput=function(e){return e.type&o.blockRendering.Types.INLINE_INPUT},o.blockRendering.Types.isStatementInput=function(e){return e.type&o.blockRendering.Types.STATEMENT_INPUT},o.blockRendering.Types.isPreviousConnection=function(e){return e.type&o.blockRendering.Types.PREVIOUS_CONNECTION},o.blockRendering.Types.isNextConnection=function(e){return e.type&o.blockRendering.Types.NEXT_CONNECTION},o.blockRendering.Types.isPreviousOrNextConnection=function(e){return e.type&(o.blockRendering.Types.PREVIOUS_CONNECTION|o.blockRendering.Types.NEXT_CONNECTION)},o.blockRendering.Types.isLeftRoundedCorner=function(e){return e.type&o.blockRendering.Types.LEFT_ROUND_CORNER},o.blockRendering.Types.isRightRoundedCorner=function(e){return e.type&o.blockRendering.Types.RIGHT_ROUND_CORNER},o.blockRendering.Types.isLeftSquareCorner=function(e){return e.type&o.blockRendering.Types.LEFT_SQUARE_CORNER},o.blockRendering.Types.isRightSquareCorner=function(e){return e.type&o.blockRendering.Types.RIGHT_SQUARE_CORNER},o.blockRendering.Types.isCorner=function(e){return e.type&o.blockRendering.Types.CORNER},o.blockRendering.Types.isJaggedEdge=function(e){return e.type&o.blockRendering.Types.JAGGED_EDGE},o.blockRendering.Types.isRow=function(e){return e.type&o.blockRendering.Types.ROW},o.blockRendering.Types.isBetweenRowSpacer=function(e){return e.type&o.blockRendering.Types.BETWEEN_ROW_SPACER},o.blockRendering.Types.isTopRow=function(e){return e.type&o.blockRendering.Types.TOP_ROW},o.blockRendering.Types.isBottomRow=function(e){return e.type&o.blockRendering.Types.BOTTOM_ROW},o.blockRendering.Types.isTopOrBottomRow=function(e){return e.type&(o.blockRendering.Types.TOP_ROW|o.blockRendering.Types.BOTTOM_ROW)},o.blockRendering.Types.isInputRow=function(e){return e.type&o.blockRendering.Types.INPUT_ROW},o.blockRendering.Measurable=function(e){this.height=this.width=0,this.type=o.blockRendering.Types.NONE,this.centerline=this.xPos=0,this.constants_=e,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},o.blockRendering.Connection=function(e,r){o.blockRendering.Connection.superClass_.constructor.call(this,e),this.connectionModel=r,this.shape=this.constants_.shapeFor(r),this.isDynamicShape=!!this.shape.isDynamic,this.type|=o.blockRendering.Types.CONNECTION},o.utils.object.inherits(o.blockRendering.Connection,o.blockRendering.Measurable),o.blockRendering.OutputConnection=function(e,r){o.blockRendering.OutputConnection.superClass_.constructor.call(this,e,r),this.type|=o.blockRendering.Types.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=0},o.utils.object.inherits(o.blockRendering.OutputConnection,o.blockRendering.Connection),o.blockRendering.PreviousConnection=function(e,r){o.blockRendering.PreviousConnection.superClass_.constructor.call(this,e,r),this.type|=o.blockRendering.Types.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},o.utils.object.inherits(o.blockRendering.PreviousConnection,o.blockRendering.Connection),o.blockRendering.NextConnection=function(e,r){o.blockRendering.NextConnection.superClass_.constructor.call(this,e,r),this.type|=o.blockRendering.Types.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},o.utils.object.inherits(o.blockRendering.NextConnection,o.blockRendering.Connection),o.blockRendering.InputConnection=function(e,r){o.blockRendering.InputConnection.superClass_.constructor.call(this,e,r.connection),this.type|=o.blockRendering.Types.INPUT,this.input=r,this.align=r.align,(this.connectedBlock=r.connection&&r.connection.targetBlock()?r.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0,this.connectionOffsetY=this.connectionOffsetX=0},o.utils.object.inherits(o.blockRendering.InputConnection,o.blockRendering.Connection),o.blockRendering.InlineInput=function(e,r){o.blockRendering.InlineInput.superClass_.constructor.call(this,e,r),this.type|=o.blockRendering.Types.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY=this.isDynamicShape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=this.isDynamicShape?this.shape.connectionOffsetX(this.connectionWidth):0},o.utils.object.inherits(o.blockRendering.InlineInput,o.blockRendering.InputConnection),o.blockRendering.StatementInput=function(e,r){o.blockRendering.StatementInput.superClass_.constructor.call(this,e,r),this.type|=o.blockRendering.Types.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width},o.utils.object.inherits(o.blockRendering.StatementInput,o.blockRendering.InputConnection),o.blockRendering.ExternalValueInput=function(e,r){o.blockRendering.ExternalValueInput.superClass_.constructor.call(this,e,r),this.type|=o.blockRendering.Types.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width},o.utils.object.inherits(o.blockRendering.ExternalValueInput,o.blockRendering.InputConnection),o.blockRendering.Icon=function(e,r){o.blockRendering.Icon.superClass_.constructor.call(this,e),this.icon=r,this.isVisible=r.isVisible(),this.type|=o.blockRendering.Types.ICON,e=r.getCorrectedSize(),this.height=e.height,this.width=e.width},o.utils.object.inherits(o.blockRendering.Icon,o.blockRendering.Measurable),o.blockRendering.JaggedEdge=function(e){o.blockRendering.JaggedEdge.superClass_.constructor.call(this,e),this.type|=o.blockRendering.Types.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width},o.utils.object.inherits(o.blockRendering.JaggedEdge,o.blockRendering.Measurable),o.blockRendering.Field=function(e,r,l){o.blockRendering.Field.superClass_.constructor.call(this,e),this.field=r,this.isEditable=r.EDITABLE,this.flipRtl=r.getFlipRtl(),this.type|=o.blockRendering.Types.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width,this.parentInput=l},o.utils.object.inherits(o.blockRendering.Field,o.blockRendering.Measurable),o.blockRendering.Hat=function(e){o.blockRendering.Hat.superClass_.constructor.call(this,e),this.type|=o.blockRendering.Types.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height},o.utils.object.inherits(o.blockRendering.Hat,o.blockRendering.Measurable),o.blockRendering.SquareCorner=function(e,r){o.blockRendering.SquareCorner.superClass_.constructor.call(this,e),this.type=(r&&"left"!=r?o.blockRendering.Types.RIGHT_SQUARE_CORNER:o.blockRendering.Types.LEFT_SQUARE_CORNER)|o.blockRendering.Types.CORNER,this.width=this.height=this.constants_.NO_PADDING},o.utils.object.inherits(o.blockRendering.SquareCorner,o.blockRendering.Measurable),o.blockRendering.RoundCorner=function(e,r){o.blockRendering.RoundCorner.superClass_.constructor.call(this,e),this.type=(r&&"left"!=r?o.blockRendering.Types.RIGHT_ROUND_CORNER:o.blockRendering.Types.LEFT_ROUND_CORNER)|o.blockRendering.Types.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2},o.utils.object.inherits(o.blockRendering.RoundCorner,o.blockRendering.Measurable),o.blockRendering.InRowSpacer=function(e,r){o.blockRendering.InRowSpacer.superClass_.constructor.call(this,e),this.type=this.type|o.blockRendering.Types.SPACER|o.blockRendering.Types.IN_ROW_SPACER,this.width=r,this.height=this.constants_.SPACER_DEFAULT_HEIGHT},o.utils.object.inherits(o.blockRendering.InRowSpacer,o.blockRendering.Measurable),o.blockRendering.Row=function(e){this.type=o.blockRendering.Types.ROW,this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=this.hasStatement=this.hasExternalInput=!1,this.constants_=e,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT,this.align=null},o.blockRendering.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},o.blockRendering.Row.prototype.getLastInput=function(){for(var r,e=this.elements.length-1;r=this.elements[e];e--)if(o.blockRendering.Types.isInput(r))return r;return null},o.blockRendering.Row.prototype.startsWithElemSpacer=function(){return!0},o.blockRendering.Row.prototype.endsWithElemSpacer=function(){return!0},o.blockRendering.Row.prototype.getFirstSpacer=function(){for(var r,e=0;r=this.elements[e];e++)if(o.blockRendering.Types.isSpacer(r))return r;return null},o.blockRendering.Row.prototype.getLastSpacer=function(){for(var r,e=this.elements.length-1;r=this.elements[e];e--)if(o.blockRendering.Types.isSpacer(r))return r;return null},o.blockRendering.TopRow=function(e){o.blockRendering.TopRow.superClass_.constructor.call(this,e),this.type|=o.blockRendering.Types.TOP_ROW,this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null},o.utils.object.inherits(o.blockRendering.TopRow,o.blockRendering.Row),o.blockRendering.TopRow.prototype.hasLeftSquareCorner=function(e){var r=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,l=e.getPreviousBlock();return!!e.outputConnection||r||!!l&&l.getNextBlock()==e},o.blockRendering.TopRow.prototype.hasRightSquareCorner=function(e){return!0},o.blockRendering.TopRow.prototype.measure=function(){for(var p,e=0,r=0,l=0,c=0;p=this.elements[c];c++)r+=p.width,o.blockRendering.Types.isSpacer(p)||(o.blockRendering.Types.isHat(p)?l=Math.max(l,p.ascenderHeight):e=Math.max(e,p.height));this.width=Math.max(this.minWidth,r),this.height=Math.max(this.minHeight,e)+l,this.capline=this.ascenderHeight=l,this.widthWithConnectedBlocks=this.width},o.blockRendering.TopRow.prototype.startsWithElemSpacer=function(){return!1},o.blockRendering.TopRow.prototype.endsWithElemSpacer=function(){return!1},o.blockRendering.BottomRow=function(e){o.blockRendering.BottomRow.superClass_.constructor.call(this,e),this.type|=o.blockRendering.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0},o.utils.object.inherits(o.blockRendering.BottomRow,o.blockRendering.Row),o.blockRendering.BottomRow.prototype.hasLeftSquareCorner=function(e){return!!e.outputConnection||!!e.getNextBlock()},o.blockRendering.BottomRow.prototype.hasRightSquareCorner=function(e){return!0},o.blockRendering.BottomRow.prototype.measure=function(){for(var p,e=0,r=0,l=0,c=0;p=this.elements[c];c++)r+=p.width,o.blockRendering.Types.isSpacer(p)||(o.blockRendering.Types.isNextConnection(p)?l=Math.max(l,p.height):e=Math.max(e,p.height));this.width=Math.max(this.minWidth,r),this.height=Math.max(this.minHeight,e)+l,this.descenderHeight=l,this.widthWithConnectedBlocks=this.width},o.blockRendering.BottomRow.prototype.startsWithElemSpacer=function(){return!1},o.blockRendering.BottomRow.prototype.endsWithElemSpacer=function(){return!1},o.blockRendering.SpacerRow=function(e,r,l){o.blockRendering.SpacerRow.superClass_.constructor.call(this,e),this.type=this.type|o.blockRendering.Types.SPACER|o.blockRendering.Types.BETWEEN_ROW_SPACER,this.width=l,this.height=r,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new o.blockRendering.InRowSpacer(this.constants_,l)]},o.utils.object.inherits(o.blockRendering.SpacerRow,o.blockRendering.Row),o.blockRendering.SpacerRow.prototype.measure=function(){},o.blockRendering.InputRow=function(e){o.blockRendering.InputRow.superClass_.constructor.call(this,e),this.type|=o.blockRendering.Types.INPUT_ROW,this.connectedBlockWidths=0},o.utils.object.inherits(o.blockRendering.InputRow,o.blockRendering.Row),o.blockRendering.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var l,e=0,r=0;l=this.elements[r];r++)this.width+=l.width,o.blockRendering.Types.isInput(l)&&(o.blockRendering.Types.isStatementInput(l)?e+=l.connectedBlockWidth:o.blockRendering.Types.isExternalInput(l)&&0!=l.connectedBlockWidth&&(e+=l.connectedBlockWidth-l.connectionWidth)),o.blockRendering.Types.isSpacer(l)||(this.height=Math.max(this.height,l.height));this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e},o.blockRendering.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement},o.blockRendering.RenderInfo=function(e,r){this.block_=r,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.outputConnection=r.outputConnection?new o.blockRendering.OutputConnection(this.constants_,r.outputConnection):null,this.isInline=r.getInputsInline()&&!r.isCollapsed(),this.isCollapsed=r.isCollapsed(),this.isInsertionMarker=r.isInsertionMarker(),this.RTL=r.RTL,this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.topRow=new o.blockRendering.TopRow(this.constants_),this.bottomRow=new o.blockRendering.BottomRow(this.constants_),this.startY=this.startX=0},o.blockRendering.RenderInfo.prototype.getRenderer=function(){return this.renderer_},o.blockRendering.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},o.blockRendering.RenderInfo.prototype.createRows_=function(){this.populateTopRow_(),this.rows.push(this.topRow);var e=new o.blockRendering.InputRow(this.constants_);this.inputRows.push(e);for(var c,r=this.block_.getIcons(),l=0;c=r[l];l++){var p=new o.blockRendering.Icon(this.constants_,c);this.isCollapsed&&c.collapseHidden?this.hiddenIcons.push(p):e.elements.push(p)}for(c=null,l=0;r=this.block_.inputList[l];l++)if(r.isVisible()){for(this.shouldStartNewRow_(r,c)&&(this.rows.push(e),e=new o.blockRendering.InputRow(this.constants_),this.inputRows.push(e)),c=0;p=r.fieldRow[c];c++)e.elements.push(new o.blockRendering.Field(this.constants_,p,r));this.addInput_(r,e),c=r}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new o.blockRendering.JaggedEdge(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)},o.blockRendering.RenderInfo.prototype.populateTopRow_=function(){var e=!!this.block_.previousConnection,r=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e,l=this.topRow.hasLeftSquareCorner(this.block_)?o.blockRendering.SquareCorner:o.blockRendering.RoundCorner;this.topRow.elements.push(new l(this.constants_)),r?(e=new o.blockRendering.Hat(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new o.blockRendering.PreviousConnection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.topRow.minHeight=this.block_.inputList.length&&this.block_.inputList[0].type==o.inputTypes.STATEMENT&&!this.block_.isCollapsed()?this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.constants_.TOP_ROW_MIN_HEIGHT,l=this.topRow.hasRightSquareCorner(this.block_)?o.blockRendering.SquareCorner:o.blockRendering.RoundCorner,this.topRow.elements.push(new l(this.constants_,"right"))},o.blockRendering.RenderInfo.prototype.populateBottomRow_=function(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==o.inputTypes.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new o.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new o.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new o.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new o.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new o.blockRendering.RoundCorner(this.constants_,"right"))},o.blockRendering.RenderInfo.prototype.addInput_=function(e,r){this.isInline&&e.type==o.inputTypes.VALUE?(r.elements.push(new o.blockRendering.InlineInput(this.constants_,e)),r.hasInlineInput=!0):e.type==o.inputTypes.STATEMENT?(r.elements.push(new o.blockRendering.StatementInput(this.constants_,e)),r.hasStatement=!0):e.type==o.inputTypes.VALUE?(r.elements.push(new o.blockRendering.ExternalValueInput(this.constants_,e)),r.hasExternalInput=!0):e.type==o.inputTypes.DUMMY&&(r.minHeight=Math.max(r.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),r.hasDummyInput=!0),null==r.align&&(r.align=e.align)},o.blockRendering.RenderInfo.prototype.shouldStartNewRow_=function(e,r){return!(!r||e.type!=o.inputTypes.STATEMENT&&r.type!=o.inputTypes.STATEMENT&&(e.type!=o.inputTypes.VALUE&&e.type!=o.inputTypes.DUMMY||this.isInline))},o.blockRendering.RenderInfo.prototype.addElemSpacing_=function(){for(var r,e=0;r=this.rows[e];e++){var l=r.elements;if(r.elements=[],r.startsWithElemSpacer()&&r.elements.push(new o.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,l[0]))),l.length){for(var c=0;c<l.length-1;c++){r.elements.push(l[c]);var p=this.getInRowSpacing_(l[c],l[c+1]);r.elements.push(new o.blockRendering.InRowSpacer(this.constants_,p))}r.elements.push(l[l.length-1]),r.endsWithElemSpacer()&&r.elements.push(new o.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(l[l.length-1],null)))}}},o.blockRendering.RenderInfo.prototype.getInRowSpacing_=function(e,r){if(!e&&r&&o.blockRendering.Types.isStatementInput(r))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&o.blockRendering.Types.isInput(e)&&!r){if(o.blockRendering.Types.isExternalInput(e))return this.constants_.NO_PADDING;if(o.blockRendering.Types.isInlineInput(e))return this.constants_.LARGE_PADDING;if(o.blockRendering.Types.isStatementInput(e))return this.constants_.NO_PADDING}return e&&o.blockRendering.Types.isLeftSquareCorner(e)&&r&&(o.blockRendering.Types.isPreviousConnection(r)||o.blockRendering.Types.isNextConnection(r))?r.notchOffset:e&&o.blockRendering.Types.isLeftRoundedCorner(e)&&r&&(o.blockRendering.Types.isPreviousConnection(r)||o.blockRendering.Types.isNextConnection(r))?r.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},o.blockRendering.RenderInfo.prototype.computeBounds_=function(){for(var p,e=0,r=0,l=0,c=0;p=this.rows[c];c++){if(p.measure(),r=Math.max(r,p.width),p.hasStatement){var _=p.getLastInput();e=Math.max(e,p.width-_.width)}l=Math.max(l,p.widthWithConnectedBlocks)}for(this.statementEdge=e,this.width=r,c=0;p=this.rows[c];c++)p.hasStatement&&(p.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(r,l),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)},o.blockRendering.RenderInfo.prototype.alignRowElements_=function(){for(var r,e=0;r=this.rows[e];e++)if(r.hasStatement)this.alignStatementRow_(r);else{var l=r.width;0<(l=this.getDesiredRowWidth_(r)-l)&&this.addAlignmentPadding_(r,l),o.blockRendering.Types.isTopOrBottomRow(r)&&(r.widthWithConnectedBlocks=r.width)}},o.blockRendering.RenderInfo.prototype.getDesiredRowWidth_=function(e){return this.width-this.startX},o.blockRendering.RenderInfo.prototype.addAlignmentPadding_=function(e,r){var l=e.getFirstSpacer(),c=e.getLastSpacer();(e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=r),e.align==o.constants.ALIGN.LEFT?c.width+=r:e.align==o.constants.ALIGN.CENTRE?(l.width+=r/2,c.width+=r/2):e.align==o.constants.ALIGN.RIGHT?l.width+=r:c.width+=r,e.width+=r},o.blockRendering.RenderInfo.prototype.alignStatementRow_=function(e){var r=e.getLastInput(),l=e.width-r.width,c=this.statementEdge;0<(l=c-l)&&this.addAlignmentPadding_(e,l),l=e.width,c=this.getDesiredRowWidth_(e),r.width+=c-l,r.height=Math.max(r.height,e.height),e.width+=c-l,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)},o.blockRendering.RenderInfo.prototype.addRowSpacing_=function(){var e=this.rows;this.rows=[];for(var r=0;r<e.length;r++)this.rows.push(e[r]),r!=e.length-1&&this.rows.push(this.makeSpacerRow_(e[r],e[r+1]))},o.blockRendering.RenderInfo.prototype.makeSpacerRow_=function(e,r){var l=this.getSpacerRowHeight_(e,r),c=this.getSpacerRowWidth_(e,r);return l=new o.blockRendering.SpacerRow(this.constants_,l,c),e.hasStatement&&(l.followsStatement=!0),r.hasStatement&&(l.precedesStatement=!0),l},o.blockRendering.RenderInfo.prototype.getSpacerRowWidth_=function(e,r){return this.width-this.startX},o.blockRendering.RenderInfo.prototype.getSpacerRowHeight_=function(e,r){return this.constants_.MEDIUM_PADDING},o.blockRendering.RenderInfo.prototype.getElemCenterline_=function(e,r){return o.blockRendering.Types.isSpacer(r)?e.yPos+r.height/2:o.blockRendering.Types.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,o.blockRendering.Types.isNextConnection(r)?e+r.height/2:e-r.height/2):o.blockRendering.Types.isTopRow(e)?o.blockRendering.Types.isHat(r)?e.capline-r.height/2:e.capline+r.height/2:e.yPos+e.height/2},o.blockRendering.RenderInfo.prototype.recordElemPositions_=function(e){for(var c,r=e.xPos,l=0;c=e.elements[l];l++)o.blockRendering.Types.isSpacer(c)&&(c.height=e.height),c.xPos=r,c.centerline=this.getElemCenterline_(e,c),r+=c.width},o.blockRendering.RenderInfo.prototype.finalize_=function(){for(var c,e=0,r=0,l=0;c=this.rows[l];l++)c.yPos=r,c.xPos=this.startX,r+=c.height,e=Math.max(e,c.widthWithConnectedBlocks),this.recordElemPositions_(c);this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.widthWithChildren=e+this.startX,this.height=r,this.startY=this.topRow.capline,this.bottomRow.baseline=r-this.bottomRow.descenderHeight},o.blockRendering.Debug=function(e){this.debugElements_=[],this.svgRoot_=null,this.constants_=e},o.blockRendering.Debug.config={rowSpacers:!0,elemSpacers:!0,rows:!0,elems:!0,connections:!0,blockBounds:!0,connectedBlockBounds:!0,render:!0},o.blockRendering.Debug.prototype.clearElems=function(){for(var r,e=0;r=this.debugElements_[e];e++)o.utils.dom.removeNode(r);this.debugElements_=[]},o.blockRendering.Debug.prototype.drawSpacerRow=function(e,r,l){if(o.blockRendering.Debug.config.rowSpacers){var c=Math.abs(e.height),p=0>e.height;p&&(r-=c),this.debugElements_.push(o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"rowSpacerRect blockRenderDebug",x:l?-(e.xPos+e.width):e.xPos,y:r,width:e.width,height:c,stroke:p?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},o.blockRendering.Debug.prototype.drawSpacerElem=function(e,r,l){if(o.blockRendering.Debug.config.elemSpacers){r=Math.abs(e.width);var c=0>e.width,p=c?e.xPos-r:e.xPos;l&&(p=-(p+r)),this.debugElements_.push(o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"elemSpacerRect blockRenderDebug",x:p,y:e.centerline-e.height/2,width:r,height:e.height,stroke:"pink",fill:c?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},o.blockRendering.Debug.prototype.drawRenderedElem=function(e,r){if(o.blockRendering.Debug.config.elems){var l=e.xPos;r&&(l=-(l+e.width)),this.debugElements_.push(o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:l,y:r=e.centerline-e.height/2,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),o.blockRendering.Types.isField(e)&&e.field instanceof o.FieldLabel&&this.debugElements_.push(o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:l,y:r+this.constants_.FIELD_TEXT_BASELINE,width:e.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}o.blockRendering.Types.isInput(e)&&o.blockRendering.Debug.config.connections&&this.drawConnection(e.connectionModel)},o.blockRendering.Debug.prototype.drawConnection=function(e){if(o.blockRendering.Debug.config.connections){if(e.type==o.connectionTypes.INPUT_VALUE)var r=4,l="magenta",c="none";else e.type==o.connectionTypes.OUTPUT_VALUE?(r=2,c=l="magenta"):e.type==o.connectionTypes.NEXT_STATEMENT?(r=4,l="goldenrod",c="none"):e.type==o.connectionTypes.PREVIOUS_STATEMENT&&(r=2,c=l="goldenrod");this.debugElements_.push(o.utils.dom.createSvgElement(o.utils.Svg.CIRCLE,{class:"blockRenderDebug",cx:e.offsetInBlock_.x,cy:e.offsetInBlock_.y,r,fill:c,stroke:l},this.svgRoot_))}},o.blockRendering.Debug.prototype.drawRenderedRow=function(e,r,l){o.blockRendering.Debug.config.rows&&(this.debugElements_.push(o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"elemRenderingRect blockRenderDebug",x:l?-(e.xPos+e.width):e.xPos,y:e.yPos,width:e.width,height:e.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),o.blockRendering.Types.isTopOrBottomRow(e)||o.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"connectedBlockWidth blockRenderDebug",x:l?-(e.xPos+e.widthWithConnectedBlocks):e.xPos,y:e.yPos,width:e.widthWithConnectedBlocks,height:e.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))},o.blockRendering.Debug.prototype.drawRowWithElements=function(e,r,l){for(var c=0,p=e.elements.length;c<p;c++){var _=e.elements[c];_?o.blockRendering.Types.isSpacer(_)?this.drawSpacerElem(_,e.height,l):this.drawRenderedElem(_,l):console.warn("A row has an undefined or null element.",e,_)}this.drawRenderedRow(e,r,l)},o.blockRendering.Debug.prototype.drawBoundingBox=function(e){if(o.blockRendering.Debug.config.blockBounds){var r=e.RTL?-e.width:0;this.debugElements_.push(o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blockBoundingBox blockRenderDebug",x:r,y:0,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),o.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blockRenderDebug",x:r=e.RTL?-e.widthWithChildren:0,y:0,width:e.widthWithChildren,height:e.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_))}},o.blockRendering.Debug.prototype.drawDebug=function(e,r){this.clearElems(),this.svgRoot_=e.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);for(var p,l=0,c=0;p=r.rows[c];c++)o.blockRendering.Types.isBetweenRowSpacer(p)?this.drawSpacerRow(p,l,r.RTL):this.drawRowWithElements(p,l,r.RTL),l+=p.height;e.previousConnection&&this.drawConnection(e.previousConnection),e.nextConnection&&this.drawConnection(e.nextConnection),e.outputConnection&&this.drawConnection(e.outputConnection),r.rightSide&&this.drawRenderedElem(r.rightSide,r.RTL),this.drawBoundingBox(r),this.drawRender(e.pathObject.svgPath)},o.blockRendering.Debug.prototype.drawRender=function(e){o.blockRendering.Debug.config.render&&(e.setAttribute("filter","url(#"+this.constants_.debugFilterId+")"),setTimeout(function(){e.setAttribute("filter","")},100))},o.blockRendering.Drawer=function(e,r){this.block_=e,this.info_=r,this.topLeft_=e.getRelativeToSurfaceXY(),this.inlinePath_=this.outlinePath_="",this.constants_=r.getRenderer().getConstants()},o.blockRendering.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),o.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},o.blockRendering.Drawer.prototype.recordSizeOnBlock_=function(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren},o.blockRendering.Drawer.prototype.hideHiddenIcons_=function(){for(var r,e=0;r=this.info_.hiddenIcons[e];e++)r.icon.iconGroup_.setAttribute("display","none")},o.blockRendering.Drawer.prototype.drawOutline_=function(){this.drawTop_();for(var e=1;e<this.info_.rows.length-1;e++){var r=this.info_.rows[e];r.hasJaggedEdge?this.drawJaggedEdge_(r):r.hasStatement?this.drawStatementInput_(r):r.hasExternalInput?this.drawValueInput_(r):this.drawRightSideRow_(r)}this.drawBottom_(),this.drawLeft_()},o.blockRendering.Drawer.prototype.drawTop_=function(){var e=this.info_.topRow,r=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=o.utils.svgPaths.moveBy(e.xPos,this.info_.startY);for(var c,l=0;c=r[l];l++)o.blockRendering.Types.isLeftRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:o.blockRendering.Types.isRightRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:o.blockRendering.Types.isPreviousConnection(c)?this.outlinePath_+=c.shape.pathLeft:o.blockRendering.Types.isHat(c)?this.outlinePath_+=this.constants_.START_HAT.path:o.blockRendering.Types.isSpacer(c)&&(this.outlinePath_+=o.utils.svgPaths.lineOnAxis("h",c.width));this.outlinePath_+=o.utils.svgPaths.lineOnAxis("v",e.height)},o.blockRendering.Drawer.prototype.drawJaggedEdge_=function(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+o.utils.svgPaths.lineOnAxis("v",e.height-this.constants_.JAGGED_TEETH.height)},o.blockRendering.Drawer.prototype.drawValueInput_=function(e){var r=e.getLastInput();this.positionExternalValueConnection_(e);var l="function"==typeof r.shape.pathDown?r.shape.pathDown(r.height):r.shape.pathDown;this.outlinePath_+=o.utils.svgPaths.lineOnAxis("H",r.xPos+r.width)+l+o.utils.svgPaths.lineOnAxis("v",e.height-r.connectionHeight)},o.blockRendering.Drawer.prototype.drawStatementInput_=function(e){var r=e.getLastInput(),l=r.xPos+r.notchOffset+r.shape.width;r=r.shape.pathRight+o.utils.svgPaths.lineOnAxis("h",-(r.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var c=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=o.utils.svgPaths.lineOnAxis("H",l)+r+o.utils.svgPaths.lineOnAxis("v",c)+this.constants_.INSIDE_CORNERS.pathBottom+o.utils.svgPaths.lineOnAxis("H",e.xPos+e.width),this.positionStatementInputConnection_(e)},o.blockRendering.Drawer.prototype.drawRightSideRow_=function(e){this.outlinePath_+=o.utils.svgPaths.lineOnAxis("V",e.yPos+e.height)},o.blockRendering.Drawer.prototype.drawBottom_=function(){var e=this.info_.bottomRow,r=e.elements;this.positionNextConnection_();for(var _,l=0,c="",p=r.length-1;_=r[p];p--)o.blockRendering.Types.isNextConnection(_)?c+=_.shape.pathRight:o.blockRendering.Types.isLeftSquareCorner(_)?c+=o.utils.svgPaths.lineOnAxis("H",e.xPos):o.blockRendering.Types.isLeftRoundedCorner(_)?c+=this.constants_.OUTSIDE_CORNERS.bottomLeft:o.blockRendering.Types.isRightRoundedCorner(_)?(c+=this.constants_.OUTSIDE_CORNERS.bottomRight,l=this.constants_.OUTSIDE_CORNERS.rightHeight):o.blockRendering.Types.isSpacer(_)&&(c+=o.utils.svgPaths.lineOnAxis("h",-1*_.width));this.outlinePath_+=o.utils.svgPaths.lineOnAxis("V",e.baseline-l),this.outlinePath_+=c},o.blockRendering.Drawer.prototype.drawLeft_=function(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){var r=e.connectionOffsetY+e.height;e="function"==typeof e.shape.pathUp?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=o.utils.svgPaths.lineOnAxis("V",r)+e}this.outlinePath_+="z"},o.blockRendering.Drawer.prototype.drawInternals_=function(){for(var r,e=0;r=this.info_.rows[e];e++)for(var c,l=0;c=r.elements[l];l++)o.blockRendering.Types.isInlineInput(c)?this.drawInlineInput_(c):(o.blockRendering.Types.isIcon(c)||o.blockRendering.Types.isField(c))&&this.layoutField_(c)},o.blockRendering.Drawer.prototype.layoutField_=function(e){if(o.blockRendering.Types.isField(e))var r=e.field.getSvgRoot();else o.blockRendering.Types.isIcon(e)&&(r=e.icon.iconGroup_);var l=e.centerline-e.height/2,c=e.xPos,p="";this.info_.RTL&&(c=-(c+e.width),e.flipRtl&&(c+=e.width,p="scale(-1 1)")),o.blockRendering.Types.isIcon(e)?(r.setAttribute("display","block"),r.setAttribute("transform","translate("+c+","+l+")"),e.icon.computeIconLocation()):r.setAttribute("transform","translate("+c+","+l+")"+p),this.info_.isInsertionMarker&&r.setAttribute("display","none")},o.blockRendering.Drawer.prototype.drawInlineInput_=function(e){var r=e.width,l=e.height,c=e.connectionOffsetY,p=e.connectionHeight+c;this.inlinePath_+=o.utils.svgPaths.moveTo(e.xPos+e.connectionWidth,e.centerline-l/2)+o.utils.svgPaths.lineOnAxis("v",c)+e.shape.pathDown+o.utils.svgPaths.lineOnAxis("v",l-p)+o.utils.svgPaths.lineOnAxis("h",r-e.connectionWidth)+o.utils.svgPaths.lineOnAxis("v",-l)+"z",this.positionInlineInputConnection_(e)},o.blockRendering.Drawer.prototype.positionInlineInputConnection_=function(e){if(e.connectionModel){var l=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(l*=-1),e.connectionModel.setOffsetInBlock(l,e.centerline-e.height/2+e.connectionOffsetY)}},o.blockRendering.Drawer.prototype.positionStatementInputConnection_=function(e){var r=e.getLastInput();if(r.connectionModel){var l=e.xPos+e.statementEdge+r.notchOffset;this.info_.RTL&&(l*=-1),r.connectionModel.setOffsetInBlock(l,e.yPos)}},o.blockRendering.Drawer.prototype.positionExternalValueConnection_=function(e){var r=e.getLastInput();if(r.connectionModel){var l=e.xPos+e.width;this.info_.RTL&&(l*=-1),r.connectionModel.setOffsetInBlock(l,e.yPos)}},o.blockRendering.Drawer.prototype.positionPreviousConnection_=function(){var e=this.info_.topRow;if(e.connection){var r=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-r:r,0)}},o.blockRendering.Drawer.prototype.positionNextConnection_=function(){var e=this.info_.bottomRow;if(e.connection){var r=e.connection,l=r.xPos;r.connectionModel.setOffsetInBlock(this.info_.RTL?-l:l,e.baseline)}},o.blockRendering.Drawer.prototype.positionOutputConnection_=function(){if(this.info_.outputConnection){var e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}},o.Events.MarkerMove=function(e,r,l,c){var p=e?e.workspace.id:void 0;c&&c.getType()==o.ASTNode.types.WORKSPACE&&(p=c.getLocation().id),o.Events.MarkerMove.superClass_.constructor.call(this,p),this.blockId=e?e.id:null,this.oldNode=l,this.newNode=c,this.isCursor=r},o.utils.object.inherits(o.Events.MarkerMove,o.Events.UiBase),o.Events.MarkerMove.prototype.type=o.Events.MARKER_MOVE,o.Events.MarkerMove.prototype.toJson=function(){var e=o.Events.MarkerMove.superClass_.toJson.call(this);return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e},o.Events.MarkerMove.prototype.fromJson=function(e){o.Events.MarkerMove.superClass_.fromJson.call(this,e),this.isCursor=e.isCursor,this.blockId=e.blockId,this.oldNode=e.oldNode,this.newNode=e.newNode},o.registry.register(o.registry.Type.EVENT,o.Events.MARKER_MOVE,o.Events.MarkerMove),o.blockRendering.MarkerSvg=function(e,r,l){this.workspace_=e,this.marker_=l,this.parent_=null,this.constants_=r,this.currentMarkerSvg=null,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=l.colour||e},o.blockRendering.MarkerSvg.CURSOR_CLASS="blocklyCursor",o.blockRendering.MarkerSvg.MARKER_CLASS="blocklyMarker",o.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER=.75,o.blockRendering.MarkerSvg.prototype.getSvgRoot=function(){return this.svgGroup_},o.blockRendering.MarkerSvg.prototype.getMarker=function(){return this.marker_},o.blockRendering.MarkerSvg.prototype.isCursor=function(){return"cursor"==this.marker_.type},o.blockRendering.MarkerSvg.prototype.createDom=function(){var e=this.isCursor()?o.blockRendering.MarkerSvg.CURSOR_CLASS:o.blockRendering.MarkerSvg.MARKER_CLASS;return this.svgGroup_=o.utils.dom.createSvgElement(o.utils.Svg.G,{class:e},null),this.createDomInternal_(),this.svgGroup_},o.blockRendering.MarkerSvg.prototype.setParent_=function(e){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent_=e},o.blockRendering.MarkerSvg.prototype.draw=function(e,r){if(r){this.constants_=this.workspace_.getRenderer().getConstants();var l=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker_.colour||l,this.applyColour_(r),this.showAtLocation_(r),this.fireMarkerEvent_(e,r),void 0!==(e=this.currentMarkerSvg.childNodes[0])&&e.beginElement&&e.beginElement()}else this.hide()},o.blockRendering.MarkerSvg.prototype.showAtLocation_=function(e){var r=e.getLocation().type;e.getType()==o.ASTNode.types.BLOCK?this.showWithBlock_(e):e.getType()==o.ASTNode.types.OUTPUT?this.showWithOutput_(e):r==o.connectionTypes.INPUT_VALUE?this.showWithInput_(e):r==o.connectionTypes.NEXT_STATEMENT?this.showWithNext_(e):e.getType()==o.ASTNode.types.PREVIOUS?this.showWithPrevious_(e):e.getType()==o.ASTNode.types.FIELD?this.showWithField_(e):e.getType()==o.ASTNode.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()==o.ASTNode.types.STACK&&this.showWithStack_(e)},o.blockRendering.MarkerSvg.prototype.showWithBlockPrevOutput_=function(e){var r=(e=e.getSourceBlock()).width,l=e.height,c=l*o.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER,p=this.constants_.CURSOR_BLOCK_PADDING;if(e.previousConnection){var _=this.constants_.shapeFor(e.previousConnection);this.positionPrevious_(r,p,c,_)}else e.outputConnection?(_=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(r,l,_)):this.positionBlock_(r,p,c);this.setParent_(e),this.showCurrent_()},o.blockRendering.MarkerSvg.prototype.showWithBlock_=function(e){this.showWithBlockPrevOutput_(e)},o.blockRendering.MarkerSvg.prototype.showWithPrevious_=function(e){this.showWithBlockPrevOutput_(e)},o.blockRendering.MarkerSvg.prototype.showWithOutput_=function(e){this.showWithBlockPrevOutput_(e)},o.blockRendering.MarkerSvg.prototype.showWithCoordinates_=function(e){var r=e.getWsCoordinate();e=r.x,this.workspace_.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,r=r.y,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace_),this.showCurrent_()},o.blockRendering.MarkerSvg.prototype.showWithField_=function(e){var r=(e=e.getLocation()).getSize().width,l=e.getSize().height;this.positionRect_(0,0,r,l),this.setParent_(e),this.showCurrent_()},o.blockRendering.MarkerSvg.prototype.showWithInput_=function(e){var r=(e=e.getLocation()).getSourceBlock();this.positionInput_(e),this.setParent_(r),this.showCurrent_()},o.blockRendering.MarkerSvg.prototype.showWithNext_=function(e){var r=e.getLocation();e=r.getSourceBlock();var l=0;r=r.getOffsetInBlock().y;var c=e.getHeightWidth().width;this.workspace_.RTL&&(l=-c),this.positionLine_(l,r,c),this.setParent_(e),this.showCurrent_()},o.blockRendering.MarkerSvg.prototype.showWithStack_=function(e){var r=(e=e.getLocation()).getHeightWidth(),l=r.width+this.constants_.CURSOR_STACK_PADDING,c=-this.constants_.CURSOR_STACK_PADDING/2,_=c;this.workspace_.RTL&&(_=-(l+c)),this.positionRect_(_,-this.constants_.CURSOR_STACK_PADDING/2,l,r=r.height+this.constants_.CURSOR_STACK_PADDING),this.setParent_(e),this.showCurrent_()},o.blockRendering.MarkerSvg.prototype.showCurrent_=function(){this.hide(),this.currentMarkerSvg.style.display=""},o.blockRendering.MarkerSvg.prototype.positionBlock_=function(e,r,l){e=o.utils.svgPaths.moveBy(-r,l)+o.utils.svgPaths.lineOnAxis("V",-r)+o.utils.svgPaths.lineOnAxis("H",e+2*r)+o.utils.svgPaths.lineOnAxis("V",l),this.markerBlock_.setAttribute("d",e),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},o.blockRendering.MarkerSvg.prototype.positionInput_=function(e){var r=e.getOffsetInBlock().x,l=e.getOffsetInBlock().y;e=o.utils.svgPaths.moveTo(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+r+","+l+")"+(this.workspace_.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_},o.blockRendering.MarkerSvg.prototype.positionLine_=function(e,r,l){this.markerSvgLine_.setAttribute("x",e),this.markerSvgLine_.setAttribute("y",r),this.markerSvgLine_.setAttribute("width",l),this.currentMarkerSvg=this.markerSvgLine_},o.blockRendering.MarkerSvg.prototype.positionOutput_=function(e,r,l){e=o.utils.svgPaths.moveBy(e,0)+o.utils.svgPaths.lineOnAxis("h",-(e-l.width))+o.utils.svgPaths.lineOnAxis("v",this.constants_.TAB_OFFSET_FROM_TOP)+l.pathDown+o.utils.svgPaths.lineOnAxis("V",r)+o.utils.svgPaths.lineOnAxis("H",e),this.markerBlock_.setAttribute("d",e),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},o.blockRendering.MarkerSvg.prototype.positionPrevious_=function(e,r,l,c){e=o.utils.svgPaths.moveBy(-r,l)+o.utils.svgPaths.lineOnAxis("V",-r)+o.utils.svgPaths.lineOnAxis("H",this.constants_.NOTCH_OFFSET_LEFT)+c.pathLeft+o.utils.svgPaths.lineOnAxis("H",e+2*r)+o.utils.svgPaths.lineOnAxis("V",l),this.markerBlock_.setAttribute("d",e),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},o.blockRendering.MarkerSvg.prototype.positionRect_=function(e,r,l,c){this.markerSvgRect_.setAttribute("x",e),this.markerSvgRect_.setAttribute("y",r),this.markerSvgRect_.setAttribute("width",l),this.markerSvgRect_.setAttribute("height",c),this.currentMarkerSvg=this.markerSvgRect_},o.blockRendering.MarkerSvg.prototype.flipRtl_=function(e){e.setAttribute("transform","scale(-1 1)")},o.blockRendering.MarkerSvg.prototype.hide=function(){this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"},o.blockRendering.MarkerSvg.prototype.fireMarkerEvent_=function(e,r){var l=r.getSourceBlock();e=new(o.Events.get(o.Events.MARKER_MOVE))(l,this.isCursor(),e,r),o.Events.fire(e)},o.blockRendering.MarkerSvg.prototype.getBlinkProperties_=function(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}},o.blockRendering.MarkerSvg.prototype.createDomInternal_=function(){if(this.markerSvg_=o.utils.dom.createSvgElement(o.utils.Svg.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=o.utils.dom.createSvgElement(o.utils.Svg.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var e=this.getBlinkProperties_();o.utils.dom.createSvgElement(o.utils.Svg.ANIMATE,e,this.markerSvgLine_),o.utils.dom.createSvgElement(o.utils.Svg.ANIMATE,e,this.markerInput_),e.attributeName="stroke",o.utils.dom.createSvgElement(o.utils.Svg.ANIMATE,e,this.markerBlock_)}return this.markerSvg_},o.blockRendering.MarkerSvg.prototype.applyColour_=function(e){this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(this.markerSvgLine_.firstChild.setAttribute("values",e=this.colour_+";transparent;transparent;"),this.markerInput_.firstChild.setAttribute("values",e),this.markerBlock_.firstChild.setAttribute("values",e))},o.blockRendering.MarkerSvg.prototype.dispose=function(){this.svgGroup_&&o.utils.dom.removeNode(this.svgGroup_)},o.blockRendering.PathObject=function(e,r,l){this.constants=l,this.svgRoot=e,this.svgPath=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.style=r,this.markerSvg=this.cursorSvg=null},o.blockRendering.PathObject.prototype.setPath=function(e){this.svgPath.setAttribute("d",e)},o.blockRendering.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)")},o.blockRendering.PathObject.prototype.setCursorSvg=function(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null},o.blockRendering.PathObject.prototype.setMarkerSvg=function(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null},o.blockRendering.PathObject.prototype.applyColour=function(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())},o.blockRendering.PathObject.prototype.setStyle=function(e){this.style=e},o.blockRendering.PathObject.prototype.setClass_=function(e,r){r?o.utils.dom.addClass(this.svgRoot,e):o.utils.dom.removeClass(this.svgRoot,e)},o.blockRendering.PathObject.prototype.updateHighlighted=function(e){this.svgPath.setAttribute("filter",e?"url(#"+this.constants.embossFilterId+")":"none")},o.blockRendering.PathObject.prototype.updateShadow_=function(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},o.blockRendering.PathObject.prototype.updateDisabled_=function(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")},o.blockRendering.PathObject.prototype.updateSelected=function(e){this.setClass_("blocklySelected",e)},o.blockRendering.PathObject.prototype.updateDraggingDelete=function(e){this.setClass_("blocklyDraggingDelete",e)},o.blockRendering.PathObject.prototype.updateInsertionMarker=function(e){this.setClass_("blocklyInsertionMarker",e)},o.blockRendering.PathObject.prototype.updateMovable=function(e){this.setClass_("blocklyDraggable",e)},o.blockRendering.PathObject.prototype.updateReplacementFade=function(e){this.setClass_("blocklyReplaceable",e)},o.blockRendering.PathObject.prototype.updateShapeForInputHighlight=function(e,r){},o.blockRendering.Renderer=function(e){this.name=e,this.overrides=this.constants_=null},o.blockRendering.Renderer.prototype.getClassName=function(){return this.name+"-renderer"},o.blockRendering.Renderer.prototype.init=function(e,r){this.constants_=this.makeConstants_(),r&&(this.overrides=r,o.utils.object.mixin(this.constants_,r)),this.constants_.setTheme(e),this.constants_.init()},o.blockRendering.Renderer.prototype.createDom=function(e,r){this.constants_.createDom(e,this.name+"-"+r.name,"."+this.getClassName()+"."+r.getClassName())},o.blockRendering.Renderer.prototype.refreshDom=function(e,r){var l=this.getConstants();l.dispose(),this.constants_=this.makeConstants_(),this.overrides&&o.utils.object.mixin(this.constants_,this.overrides),this.constants_.randomIdentifier=l.randomIdentifier,this.constants_.setTheme(r),this.constants_.init(),this.createDom(e,r)},o.blockRendering.Renderer.prototype.dispose=function(){this.constants_&&this.constants_.dispose()},o.blockRendering.Renderer.prototype.makeConstants_=function(){return new o.blockRendering.ConstantProvider},o.blockRendering.Renderer.prototype.makeRenderInfo_=function(e){return new o.blockRendering.RenderInfo(this,e)},o.blockRendering.Renderer.prototype.makeDrawer_=function(e,r){return new o.blockRendering.Drawer(e,r)},o.blockRendering.Renderer.prototype.makeDebugger_=function(){if(!o.blockRendering.Debug)throw Error("Missing require for Blockly.blockRendering.Debug");return new o.blockRendering.Debug(this.getConstants())},o.blockRendering.Renderer.prototype.makeMarkerDrawer=function(e,r){return new o.blockRendering.MarkerSvg(e,this.getConstants(),r)},o.blockRendering.Renderer.prototype.makePathObject=function(e,r){return new o.blockRendering.PathObject(e,r,this.constants_)},o.blockRendering.Renderer.prototype.getConstants=function(){return this.constants_},o.blockRendering.Renderer.prototype.shouldHighlightConnection=function(e){return!0},o.blockRendering.Renderer.prototype.orphanCanConnectAtEnd=function(e,r,l){return!!o.Connection.getConnectionForOrphanedConnection(e,l===o.connectionTypes.OUTPUT_VALUE?r.outputConnection:r.previousConnection)},o.blockRendering.Renderer.prototype.getConnectionPreviewMethod=function(e,r,l){return r.type==o.connectionTypes.OUTPUT_VALUE||r.type==o.connectionTypes.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(l,e.targetBlock(),r.type)?o.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:o.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:o.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER},o.blockRendering.Renderer.prototype.render=function(e){o.blockRendering.useDebugger&&!e.renderingDebugger&&(e.renderingDebugger=this.makeDebugger_());var r=this.makeRenderInfo_(e);r.measure(),this.makeDrawer_(e,r).draw()},o.geras={},o.geras.ConstantProvider=function(){o.geras.ConstantProvider.superClass_.constructor.call(this),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2},o.utils.object.inherits(o.geras.ConstantProvider,o.blockRendering.ConstantProvider),o.geras.ConstantProvider.prototype.getCSS_=function(e){return o.geras.ConstantProvider.superClass_.getCSS_.call(this,e).concat([e+" .blocklyInsertionMarker>.blocklyPathLight,",e+" .blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"])},o.geras.Highlighter=function(e){this.info_=e,this.inlineSteps_=this.steps_="",this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH},o.geras.Highlighter.prototype.getPath=function(){return this.steps_+"\n"+this.inlineSteps_},o.geras.Highlighter.prototype.drawTopCorner=function(e){this.steps_+=o.utils.svgPaths.moveBy(e.xPos,this.info_.startY);for(var l,r=0;l=e.elements[r];r++)o.blockRendering.Types.isLeftSquareCorner(l)?this.steps_+=this.highlightConstants_.START_POINT:o.blockRendering.Types.isLeftRoundedCorner(l)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):o.blockRendering.Types.isPreviousConnection(l)?this.steps_+=this.notchPaths_.pathLeft:o.blockRendering.Types.isHat(l)?this.steps_+=this.startPaths_.path(this.RTL_):o.blockRendering.Types.isSpacer(l)&&0!=l.width&&(this.steps_+=o.utils.svgPaths.lineOnAxis("H",l.xPos+l.width-this.highlightOffset_));this.steps_+=o.utils.svgPaths.lineOnAxis("H",e.xPos+e.width-this.highlightOffset_)},o.geras.Highlighter.prototype.drawJaggedEdge_=function(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+o.utils.svgPaths.lineOnAxis("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset_))},o.geras.Highlighter.prototype.drawValueInput=function(e){var r=e.getLastInput();if(this.RTL_){var l=e.height-r.connectionHeight;this.steps_+=o.utils.svgPaths.moveTo(r.xPos+r.width-this.highlightOffset_,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+o.utils.svgPaths.lineOnAxis("v",l)}else this.steps_+=o.utils.svgPaths.moveTo(r.xPos+r.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)},o.geras.Highlighter.prototype.drawStatementInput=function(e){var r=e.getLastInput();if(this.RTL_){var l=e.height-2*this.insideCornerPaths_.height;this.steps_+=o.utils.svgPaths.moveTo(r.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+o.utils.svgPaths.lineOnAxis("v",l)+this.insideCornerPaths_.pathBottom(this.RTL_)+o.utils.svgPaths.lineTo(e.width-r.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=o.utils.svgPaths.moveTo(r.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+o.utils.svgPaths.lineTo(e.width-r.xPos-this.insideCornerPaths_.width,0)},o.geras.Highlighter.prototype.drawRightSideRow=function(e){var r=e.xPos+e.width-this.highlightOffset_;e.followsStatement&&(this.steps_+=o.utils.svgPaths.lineOnAxis("H",r)),this.RTL_&&(this.steps_+=o.utils.svgPaths.lineOnAxis("H",r),e.height>this.highlightOffset_&&(this.steps_+=o.utils.svgPaths.lineOnAxis("V",e.yPos+e.height-this.highlightOffset_)))},o.geras.Highlighter.prototype.drawBottomRow=function(e){if(this.RTL_)this.steps_+=o.utils.svgPaths.lineOnAxis("V",e.baseline-this.highlightOffset_);else{var r=this.info_.bottomRow.elements[0];o.blockRendering.Types.isLeftSquareCorner(r)?this.steps_+=o.utils.svgPaths.moveTo(e.xPos+this.highlightOffset_,e.baseline-this.highlightOffset_):o.blockRendering.Types.isLeftRoundedCorner(r)&&(this.steps_+=o.utils.svgPaths.moveTo(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}},o.geras.Highlighter.prototype.drawLeft=function(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=o.utils.svgPaths.moveTo(this.info_.startX,e):(this.steps_+=o.utils.svgPaths.moveTo(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=o.utils.svgPaths.lineOnAxis("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(o.blockRendering.Types.isLeftRoundedCorner((e=this.info_.topRow).elements[0])?this.steps_+=o.utils.svgPaths.lineOnAxis("V",this.outsideCornerPaths_.height):this.steps_+=o.utils.svgPaths.lineOnAxis("V",e.capline+this.highlightOffset_))},o.geras.Highlighter.prototype.drawInlineInput=function(e){var r=this.highlightOffset_,l=e.xPos+e.connectionWidth,c=e.centerline-e.height/2,p=e.width-e.connectionWidth,_=c+r;this.RTL_?(c=e.connectionOffsetY-r,e=e.height-(e.connectionOffsetY+e.connectionHeight)+r,this.inlineSteps_+=o.utils.svgPaths.moveTo(l-r,_)+o.utils.svgPaths.lineOnAxis("v",c)+this.puzzleTabPaths_.pathDown(this.RTL_)+o.utils.svgPaths.lineOnAxis("v",e)+o.utils.svgPaths.lineOnAxis("h",p)):this.inlineSteps_+=o.utils.svgPaths.moveTo(e.xPos+e.width+r,_)+o.utils.svgPaths.lineOnAxis("v",e.height)+o.utils.svgPaths.lineOnAxis("h",-p)+o.utils.svgPaths.moveTo(l,c+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)},o.geras.InlineInput=function(e,r){o.geras.InlineInput.superClass_.constructor.call(this,e,r),this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)},o.utils.object.inherits(o.geras.InlineInput,o.blockRendering.InlineInput),o.geras.StatementInput=function(e,r){o.geras.StatementInput.superClass_.constructor.call(this,e,r),this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)},o.utils.object.inherits(o.geras.StatementInput,o.blockRendering.StatementInput),o.geras.RenderInfo=function(e,r){o.geras.RenderInfo.superClass_.constructor.call(this,e,r)},o.utils.object.inherits(o.geras.RenderInfo,o.blockRendering.RenderInfo),o.geras.RenderInfo.prototype.getRenderer=function(){return this.renderer_},o.geras.RenderInfo.prototype.populateBottomRow_=function(){o.geras.RenderInfo.superClass_.populateBottomRow_.call(this),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==o.inputTypes.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)},o.geras.RenderInfo.prototype.addInput_=function(e,r){this.isInline&&e.type==o.inputTypes.VALUE?(r.elements.push(new o.geras.InlineInput(this.constants_,e)),r.hasInlineInput=!0):e.type==o.inputTypes.STATEMENT?(r.elements.push(new o.geras.StatementInput(this.constants_,e)),r.hasStatement=!0):e.type==o.inputTypes.VALUE?(r.elements.push(new o.blockRendering.ExternalValueInput(this.constants_,e)),r.hasExternalInput=!0):e.type==o.inputTypes.DUMMY&&(r.minHeight=Math.max(r.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),r.hasDummyInput=!0),this.isInline||null!=r.align||(r.align=e.align)},o.geras.RenderInfo.prototype.addElemSpacing_=function(){for(var l,e=!1,r=0;l=this.rows[r];r++)l.hasExternalInput&&(e=!0);for(r=0;l=this.rows[r];r++){var c=l.elements;if(l.elements=[],l.startsWithElemSpacer()&&l.elements.push(new o.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,c[0]))),c.length){for(var p=0;p<c.length-1;p++){l.elements.push(c[p]);var _=this.getInRowSpacing_(c[p],c[p+1]);l.elements.push(new o.blockRendering.InRowSpacer(this.constants_,_))}l.elements.push(c[c.length-1]),l.endsWithElemSpacer()&&(_=this.getInRowSpacing_(c[c.length-1],null),e&&l.hasDummyInput&&(_+=this.constants_.TAB_WIDTH),l.elements.push(new o.blockRendering.InRowSpacer(this.constants_,_)))}}},o.geras.RenderInfo.prototype.getInRowSpacing_=function(e,r){if(!e)return r&&o.blockRendering.Types.isField(r)&&r.isEditable?this.constants_.MEDIUM_PADDING:r&&o.blockRendering.Types.isInlineInput(r)?this.constants_.MEDIUM_LARGE_PADDING:r&&o.blockRendering.Types.isStatementInput(r)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!o.blockRendering.Types.isInput(e)&&(!r||o.blockRendering.Types.isStatementInput(r)))return o.blockRendering.Types.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:o.blockRendering.Types.isIcon(e)?2*this.constants_.LARGE_PADDING+1:o.blockRendering.Types.isHat(e)?this.constants_.NO_PADDING:o.blockRendering.Types.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:o.blockRendering.Types.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:o.blockRendering.Types.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(o.blockRendering.Types.isInput(e)&&!r){if(o.blockRendering.Types.isExternalInput(e))return this.constants_.NO_PADDING;if(o.blockRendering.Types.isInlineInput(e))return this.constants_.LARGE_PADDING;if(o.blockRendering.Types.isStatementInput(e))return this.constants_.NO_PADDING}if(!o.blockRendering.Types.isInput(e)&&r&&o.blockRendering.Types.isInput(r)){if(o.blockRendering.Types.isField(e)&&e.isEditable){if(o.blockRendering.Types.isInlineInput(r)||o.blockRendering.Types.isExternalInput(r))return this.constants_.SMALL_PADDING}else{if(o.blockRendering.Types.isInlineInput(r)||o.blockRendering.Types.isExternalInput(r))return this.constants_.MEDIUM_LARGE_PADDING;if(o.blockRendering.Types.isStatementInput(r))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(o.blockRendering.Types.isIcon(e)&&r&&!o.blockRendering.Types.isInput(r))return this.constants_.LARGE_PADDING;if(o.blockRendering.Types.isInlineInput(e)&&r&&o.blockRendering.Types.isField(r))return r.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(o.blockRendering.Types.isLeftSquareCorner(e)&&r){if(o.blockRendering.Types.isHat(r))return this.constants_.NO_PADDING;if(o.blockRendering.Types.isPreviousConnection(r))return r.notchOffset;if(o.blockRendering.Types.isNextConnection(r))return r.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(o.blockRendering.Types.isLeftRoundedCorner(e)&&r){if(o.blockRendering.Types.isPreviousConnection(r))return r.notchOffset-this.constants_.CORNER_RADIUS;if(o.blockRendering.Types.isNextConnection(r))return r.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return o.blockRendering.Types.isField(e)&&r&&o.blockRendering.Types.isField(r)&&e.isEditable==r.isEditable||r&&o.blockRendering.Types.isJaggedEdge(r)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},o.geras.RenderInfo.prototype.getSpacerRowHeight_=function(e,r){return o.blockRendering.Types.isTopRow(e)&&o.blockRendering.Types.isBottomRow(r)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:o.blockRendering.Types.isTopRow(e)||o.blockRendering.Types.isBottomRow(r)?this.constants_.NO_PADDING:e.hasExternalInput&&r.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&r.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&r.hasStatement||!e.hasStatement&&r.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},o.geras.RenderInfo.prototype.getElemCenterline_=function(e,r){if(o.blockRendering.Types.isSpacer(r))return e.yPos+r.height/2;if(o.blockRendering.Types.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,o.blockRendering.Types.isNextConnection(r)?e+r.height/2:e-r.height/2;if(o.blockRendering.Types.isTopRow(e))return o.blockRendering.Types.isHat(r)?e.capline-r.height/2:e.capline+r.height/2;var l=e.yPos;return o.blockRendering.Types.isField(r)||o.blockRendering.Types.isIcon(r)?(l+=r.height/2,(e.hasInlineInput||e.hasStatement)&&r.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(l+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):l=o.blockRendering.Types.isInlineInput(r)?l+r.height/2:l+e.height/2,l},o.geras.RenderInfo.prototype.alignRowElements_=function(){if(this.isInline){for(var c,e=0,r=null,l=this.rows.length-1;c=this.rows[l];l--)c.nextRightEdge=e,o.blockRendering.Types.isInputRow(c)&&(c.hasStatement&&this.alignStatementRow_(c),r&&r.hasStatement&&c.width<r.width?c.nextRightEdge=r.width:e=c.width,r=c);for(l=e=0;c=this.rows[l];l++)c.hasStatement?e=this.getDesiredRowWidth_(c):o.blockRendering.Types.isSpacer(c)?c.width=Math.max(e,c.nextRightEdge):(0<(e=Math.max(e,c.nextRightEdge)-c.width)&&this.addAlignmentPadding_(c,e),e=c.width)}else o.geras.RenderInfo.superClass_.alignRowElements_.call(this)},o.geras.RenderInfo.prototype.getDesiredRowWidth_=function(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:o.geras.RenderInfo.superClass_.getDesiredRowWidth_.call(this,e)},o.geras.RenderInfo.prototype.finalize_=function(){for(var c,e=0,r=0,l=0;c=this.rows[l];l++){c.yPos=r,c.xPos=this.startX,r+=c.height,e=Math.max(e,c.widthWithConnectedBlocks);var p=r-this.topRow.ascenderHeight;c==this.bottomRow&&p<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=p=this.constants_.MIN_BLOCK_HEIGHT-p,r+=p),this.recordElemPositions_(c)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=r-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=r+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline},o.geras.Drawer=function(e,r){o.geras.Drawer.superClass_.constructor.call(this,e,r),this.highlighter_=new o.geras.Highlighter(r)},o.utils.object.inherits(o.geras.Drawer,o.blockRendering.Drawer),o.geras.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();var e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),o.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},o.geras.Drawer.prototype.drawTop_=function(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),o.geras.Drawer.superClass_.drawTop_.call(this)},o.geras.Drawer.prototype.drawJaggedEdge_=function(e){this.highlighter_.drawJaggedEdge_(e),o.geras.Drawer.superClass_.drawJaggedEdge_.call(this,e)},o.geras.Drawer.prototype.drawValueInput_=function(e){this.highlighter_.drawValueInput(e),o.geras.Drawer.superClass_.drawValueInput_.call(this,e)},o.geras.Drawer.prototype.drawStatementInput_=function(e){this.highlighter_.drawStatementInput(e),o.geras.Drawer.superClass_.drawStatementInput_.call(this,e)},o.geras.Drawer.prototype.drawRightSideRow_=function(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=o.utils.svgPaths.lineOnAxis("H",e.xPos+e.width)+o.utils.svgPaths.lineOnAxis("V",e.yPos+e.height)},o.geras.Drawer.prototype.drawBottom_=function(){this.highlighter_.drawBottomRow(this.info_.bottomRow),o.geras.Drawer.superClass_.drawBottom_.call(this)},o.geras.Drawer.prototype.drawLeft_=function(){this.highlighter_.drawLeft(),o.geras.Drawer.superClass_.drawLeft_.call(this)},o.geras.Drawer.prototype.drawInlineInput_=function(e){this.highlighter_.drawInlineInput(e),o.geras.Drawer.superClass_.drawInlineInput_.call(this,e)},o.geras.Drawer.prototype.positionInlineInputConnection_=function(e){if(e.connectionModel){var l=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(l*=-1),e.connectionModel.setOffsetInBlock(l,e.centerline-e.height/2+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}},o.geras.Drawer.prototype.positionStatementInputConnection_=function(e){var r=e.getLastInput();if(r.connectionModel){var l=e.xPos+e.statementEdge+r.notchOffset;r.connectionModel.setOffsetInBlock(l=this.info_.RTL?-1*l:l+this.constants_.DARK_PATH_OFFSET,e.yPos+this.constants_.DARK_PATH_OFFSET)}},o.geras.Drawer.prototype.positionExternalValueConnection_=function(e){var r=e.getLastInput();if(r.connectionModel){var l=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(l*=-1),r.connectionModel.setOffsetInBlock(l,e.yPos)}},o.geras.Drawer.prototype.positionNextConnection_=function(){var e=this.info_.bottomRow;if(e.connection){var r=e.connection,l=r.xPos;r.connectionModel.setOffsetInBlock((this.info_.RTL?-l:l)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}},o.geras.HighlightConstantProvider=function(e){this.constantProvider=e,this.OFFSET=.5,this.START_POINT=o.utils.svgPaths.moveBy(this.OFFSET,this.OFFSET)},o.geras.HighlightConstantProvider.prototype.init=function(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()},o.geras.HighlightConstantProvider.prototype.makeInsideCorner=function(){var e=this.constantProvider.CORNER_RADIUS,r=this.OFFSET,l=(1-Math.SQRT1_2)*(e+r)-r,c=o.utils.svgPaths.moveBy(l,l)+o.utils.svgPaths.arc("a","0 0,0",e,o.utils.svgPaths.point(-l-r,e-l)),p=o.utils.svgPaths.arc("a","0 0,0",e+r,o.utils.svgPaths.point(e+r,e+r)),_=o.utils.svgPaths.moveBy(l,-l)+o.utils.svgPaths.arc("a","0 0,0",e+r,o.utils.svgPaths.point(e-l,l+r));return{width:e+r,height:e,pathTop:function(v){return v?c:""},pathBottom:function(v){return v?p:_}}},o.geras.HighlightConstantProvider.prototype.makeOutsideCorner=function(){var e=this.constantProvider.CORNER_RADIUS,r=this.OFFSET,l=(1-Math.SQRT1_2)*(e-r)+r,c=o.utils.svgPaths.moveBy(l,l)+o.utils.svgPaths.arc("a","0 0,1",e-r,o.utils.svgPaths.point(e-l,-l+r)),p=o.utils.svgPaths.moveBy(r,e)+o.utils.svgPaths.arc("a","0 0,1",e-r,o.utils.svgPaths.point(e,-e+r)),_=-l,v=o.utils.svgPaths.moveBy(l,_)+o.utils.svgPaths.arc("a","0 0,1",e-r,o.utils.svgPaths.point(-l+r,-_-e));return{height:e,topLeft:function(b){return b?c:p},bottomLeft:function(){return v}}},o.geras.HighlightConstantProvider.prototype.makePuzzleTab=function(){var e=this.constantProvider.TAB_WIDTH,r=this.constantProvider.TAB_HEIGHT,l=o.utils.svgPaths.moveBy(-2,3.4-r)+o.utils.svgPaths.lineTo(-.45*e,-2.1),c=o.utils.svgPaths.lineOnAxis("v",2.5)+o.utils.svgPaths.moveBy(.97*-e,2.5)+o.utils.svgPaths.curve("q",[o.utils.svgPaths.point(.05*-e,10),o.utils.svgPaths.point(.3*e,9.5)])+o.utils.svgPaths.moveBy(.67*e,-1.9)+o.utils.svgPaths.lineOnAxis("v",2.5),p=o.utils.svgPaths.lineOnAxis("v",-1.5)+o.utils.svgPaths.moveBy(-.92*e,-.5)+o.utils.svgPaths.curve("q",[o.utils.svgPaths.point(-.19*e,-5.5),o.utils.svgPaths.point(0,-11)])+o.utils.svgPaths.moveBy(.92*e,1),_=o.utils.svgPaths.moveBy(-5,r-.7)+o.utils.svgPaths.lineTo(.46*e,-2.1);return{width:e,height:r,pathUp:function(v){return v?l:p},pathDown:function(v){return v?c:_}}},o.geras.HighlightConstantProvider.prototype.makeNotch=function(){return{pathLeft:o.utils.svgPaths.lineOnAxis("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}},o.geras.HighlightConstantProvider.prototype.makeJaggedTeeth=function(){return{pathLeft:o.utils.svgPaths.lineTo(5.1,2.6)+o.utils.svgPaths.moveBy(-10.2,6.8)+o.utils.svgPaths.lineTo(5.1,2.6),height:12,width:10.2}},o.geras.HighlightConstantProvider.prototype.makeStartHat=function(){var e=this.constantProvider.START_HAT.height,r=o.utils.svgPaths.moveBy(25,-8.7)+o.utils.svgPaths.curve("c",[o.utils.svgPaths.point(29.7,-6.2),o.utils.svgPaths.point(57.2,-.5),o.utils.svgPaths.point(75,8.7)]),l=o.utils.svgPaths.curve("c",[o.utils.svgPaths.point(17.8,-9.2),o.utils.svgPaths.point(45.3,-14.9),o.utils.svgPaths.point(75,-8.7)])+o.utils.svgPaths.moveTo(100.5,e+.5);return{path:function(c){return c?r:l}}},o.geras.PathObject=function(e,r,l){this.constants=l,this.svgRoot=e,this.svgPathDark=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot),this.svgPath=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.svgPathLight=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyPathLight"},this.svgRoot),this.colourDark="#000000",this.style=r},o.utils.object.inherits(o.geras.PathObject,o.blockRendering.PathObject),o.geras.PathObject.prototype.setPath=function(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)},o.geras.PathObject.prototype.setHighlightPath=function(e){this.svgPathLight.setAttribute("d",e)},o.geras.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")},o.geras.PathObject.prototype.applyColour=function(e){this.svgPathLight.style.display="",this.svgPathDark.style.display="",this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),o.geras.PathObject.superClass_.applyColour.call(this,e),this.svgPath.setAttribute("stroke","none")},o.geras.PathObject.prototype.setStyle=function(e){this.style=e,this.colourDark=o.utils.colour.blend("#000",this.style.colourPrimary,.2)||this.colourDark},o.geras.PathObject.prototype.updateHighlighted=function(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")},o.geras.PathObject.prototype.updateShadow_=function(e){e&&(this.svgPathLight.style.display="none",this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},o.geras.PathObject.prototype.updateDisabled_=function(e){o.geras.PathObject.superClass_.updateDisabled_.call(this,e),e&&this.svgPath.setAttribute("stroke","none")},o.geras.Renderer=function(e){o.geras.Renderer.superClass_.constructor.call(this,e),this.highlightConstants_=null},o.utils.object.inherits(o.geras.Renderer,o.blockRendering.Renderer),o.geras.Renderer.prototype.init=function(e,r){o.geras.Renderer.superClass_.init.call(this,e,r),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()},o.geras.Renderer.prototype.refreshDom=function(e,r){o.geras.Renderer.superClass_.refreshDom.call(this,e,r),this.getHighlightConstants().init()},o.geras.Renderer.prototype.makeConstants_=function(){return new o.geras.ConstantProvider},o.geras.Renderer.prototype.makeRenderInfo_=function(e){return new o.geras.RenderInfo(this,e)},o.geras.Renderer.prototype.makeDrawer_=function(e,r){return new o.geras.Drawer(e,r)},o.geras.Renderer.prototype.makePathObject=function(e,r){return new o.geras.PathObject(e,r,this.getConstants())},o.geras.Renderer.prototype.makeHighlightConstants_=function(){return new o.geras.HighlightConstantProvider(this.getConstants())},o.geras.Renderer.prototype.getHighlightConstants=function(){return this.highlightConstants_},o.blockRendering.register("geras",o.geras.Renderer),o.thrasos={},o.thrasos.RenderInfo=function(e,r){o.thrasos.RenderInfo.superClass_.constructor.call(this,e,r)},o.utils.object.inherits(o.thrasos.RenderInfo,o.blockRendering.RenderInfo),o.thrasos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},o.thrasos.RenderInfo.prototype.addElemSpacing_=function(){for(var l,e=!1,r=0;l=this.rows[r];r++)l.hasExternalInput&&(e=!0);for(r=0;l=this.rows[r];r++){var c=l.elements;l.elements=[],l.startsWithElemSpacer()&&l.elements.push(new o.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,c[0])));for(var p=0;p<c.length-1;p++){l.elements.push(c[p]);var _=this.getInRowSpacing_(c[p],c[p+1]);l.elements.push(new o.blockRendering.InRowSpacer(this.constants_,_))}l.elements.push(c[c.length-1]),l.endsWithElemSpacer()&&(_=this.getInRowSpacing_(c[c.length-1],null),e&&l.hasDummyInput&&(_+=this.constants_.TAB_WIDTH),l.elements.push(new o.blockRendering.InRowSpacer(this.constants_,_)))}},o.thrasos.RenderInfo.prototype.getInRowSpacing_=function(e,r){if(!e)return r&&o.blockRendering.Types.isField(r)&&r.isEditable?this.constants_.MEDIUM_PADDING:r&&o.blockRendering.Types.isInlineInput(r)?this.constants_.MEDIUM_LARGE_PADDING:r&&o.blockRendering.Types.isStatementInput(r)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!o.blockRendering.Types.isInput(e)&&!r)return o.blockRendering.Types.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:o.blockRendering.Types.isIcon(e)?2*this.constants_.LARGE_PADDING+1:o.blockRendering.Types.isHat(e)?this.constants_.NO_PADDING:o.blockRendering.Types.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:o.blockRendering.Types.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:o.blockRendering.Types.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(o.blockRendering.Types.isInput(e)&&!r){if(o.blockRendering.Types.isExternalInput(e))return this.constants_.NO_PADDING;if(o.blockRendering.Types.isInlineInput(e))return this.constants_.LARGE_PADDING;if(o.blockRendering.Types.isStatementInput(e))return this.constants_.NO_PADDING}if(!o.blockRendering.Types.isInput(e)&&r&&o.blockRendering.Types.isInput(r)){if(o.blockRendering.Types.isField(e)&&e.isEditable){if(o.blockRendering.Types.isInlineInput(r)||o.blockRendering.Types.isExternalInput(r))return this.constants_.SMALL_PADDING}else{if(o.blockRendering.Types.isInlineInput(r)||o.blockRendering.Types.isExternalInput(r))return this.constants_.MEDIUM_LARGE_PADDING;if(o.blockRendering.Types.isStatementInput(r))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(o.blockRendering.Types.isIcon(e)&&r&&!o.blockRendering.Types.isInput(r))return this.constants_.LARGE_PADDING;if(o.blockRendering.Types.isInlineInput(e)&&r&&o.blockRendering.Types.isField(r))return r.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(o.blockRendering.Types.isLeftSquareCorner(e)&&r){if(o.blockRendering.Types.isHat(r))return this.constants_.NO_PADDING;if(o.blockRendering.Types.isPreviousConnection(r)||o.blockRendering.Types.isNextConnection(r))return r.notchOffset}return o.blockRendering.Types.isLeftRoundedCorner(e)&&r?r.notchOffset-this.constants_.CORNER_RADIUS:o.blockRendering.Types.isField(e)&&r&&o.blockRendering.Types.isField(r)&&e.isEditable==r.isEditable||r&&o.blockRendering.Types.isJaggedEdge(r)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},o.thrasos.RenderInfo.prototype.getSpacerRowHeight_=function(e,r){return o.blockRendering.Types.isTopRow(e)&&o.blockRendering.Types.isBottomRow(r)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:o.blockRendering.Types.isTopRow(e)||o.blockRendering.Types.isBottomRow(r)?this.constants_.NO_PADDING:e.hasExternalInput&&r.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&r.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&r.hasStatement||e.hasDummyInput||r.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},o.thrasos.RenderInfo.prototype.getElemCenterline_=function(e,r){if(o.blockRendering.Types.isSpacer(r))return e.yPos+r.height/2;if(o.blockRendering.Types.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,o.blockRendering.Types.isNextConnection(r)?e+r.height/2:e-r.height/2;if(o.blockRendering.Types.isTopRow(e))return o.blockRendering.Types.isHat(r)?e.capline-r.height/2:e.capline+r.height/2;var l=e.yPos;return o.blockRendering.Types.isField(r)&&e.hasStatement?l+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+r.height/2):l+e.height/2},o.thrasos.RenderInfo.prototype.finalize_=function(){for(var c,e=0,r=0,l=0;c=this.rows[l];l++){c.yPos=r,c.xPos=this.startX,r+=c.height,e=Math.max(e,c.widthWithConnectedBlocks);var p=r-this.topRow.ascenderHeight;c==this.bottomRow&&p<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=p=this.constants_.MIN_BLOCK_HEIGHT-p,r+=p),this.recordElemPositions_(c)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.bottomRow.baseline=r-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=r,this.startY=this.topRow.capline},o.thrasos.Renderer=function(e){o.thrasos.Renderer.superClass_.constructor.call(this,e)},o.utils.object.inherits(o.thrasos.Renderer,o.blockRendering.Renderer),o.thrasos.Renderer.prototype.makeRenderInfo_=function(e){return new o.thrasos.RenderInfo(this,e)},o.blockRendering.register("thrasos",o.thrasos.Renderer),o.zelos={},o.zelos.ConstantProvider=function(){o.zelos.ConstantProvider.superClass_.constructor.call(this),this.SMALL_PADDING=this.GRID_UNIT=4,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TAB_OFFSET_FROM_TOP=0,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.replacementGlowFilter_=null},o.utils.object.inherits(o.zelos.ConstantProvider,o.blockRendering.ConstantProvider),o.zelos.ConstantProvider.prototype.setFontConstants_=function(e){o.zelos.ConstantProvider.superClass_.setFontConstants_.call(this,e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING},o.zelos.ConstantProvider.prototype.init=function(){o.zelos.ConstantProvider.superClass_.init.call(this),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth},o.zelos.ConstantProvider.prototype.setDynamicProperties_=function(e){o.zelos.ConstantProvider.superClass_.setDynamicProperties_.call(this,e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var r=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=r&&!isNaN(r)?r:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE},o.zelos.ConstantProvider.prototype.dispose=function(){o.zelos.ConstantProvider.superClass_.dispose.call(this),this.selectedGlowFilter_&&o.utils.dom.removeNode(this.selectedGlowFilter_),this.replacementGlowFilter_&&o.utils.dom.removeNode(this.replacementGlowFilter_)},o.zelos.ConstantProvider.prototype.makeStartHat=function(){var e=this.START_HAT_HEIGHT,r=this.START_HAT_WIDTH;return{height:e,width:r,path:o.utils.svgPaths.curve("c",[o.utils.svgPaths.point(25,-e),o.utils.svgPaths.point(71,-e),o.utils.svgPaths.point(r,0)])}},o.zelos.ConstantProvider.prototype.makeHexagonal=function(){function e(l,c,p){var _=l/2;return o.utils.svgPaths.lineTo(-(p=p?-1:1)*(_=_>r?r:_),l=(c?-1:1)*l/2)+o.utils.svgPaths.lineTo(p*_,l)}var r=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function(l){return(l/=2)>r?r:l},height:function(l){return l},connectionOffsetY:function(l){return l/2},connectionOffsetX:function(l){return-l},pathDown:function(l){return e(l,!1,!1)},pathUp:function(l){return e(l,!0,!1)},pathRightDown:function(l){return e(l,!1,!0)},pathRightUp:function(l){return e(l,!1,!0)}}},o.zelos.ConstantProvider.prototype.makeRounded=function(){function e(c,p,_){var v=c>l?c-l:0;return o.utils.svgPaths.arc("a","0 0,1",c=(c>l?l:c)/2,o.utils.svgPaths.point((p?-1:1)*c,(p?-1:1)*c))+o.utils.svgPaths.lineOnAxis("v",(_?1:-1)*v)+o.utils.svgPaths.arc("a","0 0,1",c,o.utils.svgPaths.point((p?1:-1)*c,(p?-1:1)*c))}var r=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,l=2*r;return{type:this.SHAPES.ROUND,isDynamic:!0,width:function(c){return(c/=2)>r?r:c},height:function(c){return c},connectionOffsetY:function(c){return c/2},connectionOffsetX:function(c){return-c},pathDown:function(c){return e(c,!1,!1)},pathUp:function(c){return e(c,!0,!1)},pathRightDown:function(c){return e(c,!1,!0)},pathRightUp:function(c){return e(c,!1,!0)}}},o.zelos.ConstantProvider.prototype.makeSquared=function(){function e(l,c,p){return l-=2*r,o.utils.svgPaths.arc("a","0 0,1",r,o.utils.svgPaths.point((c?-1:1)*r,(c?-1:1)*r))+o.utils.svgPaths.lineOnAxis("v",(p?1:-1)*l)+o.utils.svgPaths.arc("a","0 0,1",r,o.utils.svgPaths.point((c?1:-1)*r,(c?-1:1)*r))}var r=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function(l){return r},height:function(l){return l},connectionOffsetY:function(l){return l/2},connectionOffsetX:function(l){return-l},pathDown:function(l){return e(l,!1,!1)},pathUp:function(l){return e(l,!0,!1)},pathRightDown:function(l){return e(l,!1,!0)},pathRightUp:function(l){return e(l,!1,!0)}}},o.zelos.ConstantProvider.prototype.shapeFor=function(e){var r=e.getCheck();switch(!r&&e.targetConnection&&(r=e.targetConnection.getCheck()),e.type){case o.connectionTypes.INPUT_VALUE:case o.connectionTypes.OUTPUT_VALUE:if(null!=(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return r&&-1!=r.indexOf("Boolean")?this.HEXAGONAL:(r&&-1!=r.indexOf("Number")||r&&r.indexOf("String"),this.ROUNDED);case o.connectionTypes.PREVIOUS_STATEMENT:case o.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}},o.zelos.ConstantProvider.prototype.makeNotch=function(){function e(F){return o.utils.svgPaths.curve("c",[o.utils.svgPaths.point(F*p/2,0),o.utils.svgPaths.point(F*p*3/4,v/2),o.utils.svgPaths.point(F*p,v)])+o.utils.svgPaths.line([o.utils.svgPaths.point(F*p,_)])+o.utils.svgPaths.curve("c",[o.utils.svgPaths.point(F*p/4,v/2),o.utils.svgPaths.point(F*p/2,v),o.utils.svgPaths.point(F*p,v)])+o.utils.svgPaths.lineOnAxis("h",F*c)+o.utils.svgPaths.curve("c",[o.utils.svgPaths.point(F*p/2,0),o.utils.svgPaths.point(F*p*3/4,-v/2),o.utils.svgPaths.point(F*p,-v)])+o.utils.svgPaths.line([o.utils.svgPaths.point(F*p,-_)])+o.utils.svgPaths.curve("c",[o.utils.svgPaths.point(F*p/4,-v/2),o.utils.svgPaths.point(F*p/2,-v),o.utils.svgPaths.point(F*p,-v)])}var r=this.NOTCH_WIDTH,l=this.NOTCH_HEIGHT,c=r/3,p=c/3,_=l/2,v=_/2,b=e(1),w=e(-1);return{type:this.SHAPES.NOTCH,width:r,height:l,pathLeft:b,pathRight:w}},o.zelos.ConstantProvider.prototype.makeInsideCorners=function(){var e=this.CORNER_RADIUS,r=o.utils.svgPaths.arc("a","0 0,0",e,o.utils.svgPaths.point(-e,e)),l=o.utils.svgPaths.arc("a","0 0,1",e,o.utils.svgPaths.point(-e,e));return{width:e,height:e,pathTop:r,pathBottom:o.utils.svgPaths.arc("a","0 0,0",e,o.utils.svgPaths.point(e,e)),rightWidth:e,rightHeight:e,pathTopRight:l,pathBottomRight:o.utils.svgPaths.arc("a","0 0,1",e,o.utils.svgPaths.point(e,e))}},o.zelos.ConstantProvider.prototype.generateSecondaryColour_=function(e){return o.utils.colour.blend("#000",e,.15)||e},o.zelos.ConstantProvider.prototype.generateTertiaryColour_=function(e){return o.utils.colour.blend("#000",e,.25)||e},o.zelos.ConstantProvider.prototype.createDom=function(e,r,l){o.zelos.ConstantProvider.superClass_.createDom.call(this,e,r,l),e=o.utils.dom.createSvgElement(o.utils.Svg.DEFS,{},e),r=o.utils.dom.createSvgElement(o.utils.Svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),o.utils.dom.createSvgElement(o.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},r),l=o.utils.dom.createSvgElement(o.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},r),o.utils.dom.createSvgElement(o.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},l),o.utils.dom.createSvgElement(o.utils.Svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},r),o.utils.dom.createSvgElement(o.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},r),this.selectedGlowFilterId=r.id,this.selectedGlowFilter_=r,e=o.utils.dom.createSvgElement(o.utils.Svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),o.utils.dom.createSvgElement(o.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),r=o.utils.dom.createSvgElement(o.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},e),o.utils.dom.createSvgElement(o.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),o.utils.dom.createSvgElement(o.utils.Svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),o.utils.dom.createSvgElement(o.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),o.utils.dom.createSvgElement(o.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter_=e},o.zelos.ConstantProvider.prototype.getCSS_=function(e){return[e+" .blocklyText,",e+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",e+" .blocklyText {","fill: #fff;","}",e+" .blocklyNonEditableText>rect:not(.blocklyDropdownRect),",e+" .blocklyEditableText>rect:not(.blocklyDropdownRect) {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","}",e+" .blocklyNonEditableText>text,",e+" .blocklyEditableText>text,",e+" .blocklyNonEditableText>g>text,",e+" .blocklyEditableText>g>text {","fill: #575E75;","}",e+" .blocklyFlyoutLabelText {","fill: #575E75;","}",e+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",e+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>rect,",e+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",e+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","color: #575E75;","}",e+" .blocklyDropdownText {","fill: #fff !important;","}",e+".blocklyWidgetDiv .goog-menuitem,",e+".blocklyDropDownDiv .goog-menuitem {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","}",e+".blocklyDropDownDiv .goog-menuitem-content {","color: #fff;","}",e+" .blocklyHighlightedConnectionPath {","stroke: "+this.SELECTED_GLOW_COLOUR+";","}",e+" .blocklyDisabled > .blocklyOutlinePath {","fill: url(#blocklyDisabledPattern"+this.randomIdentifier+")","}",e+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},o.zelos.TopRow=function(e){o.zelos.TopRow.superClass_.constructor.call(this,e)},o.utils.object.inherits(o.zelos.TopRow,o.blockRendering.TopRow),o.zelos.TopRow.prototype.endsWithElemSpacer=function(){return!1},o.zelos.TopRow.prototype.hasLeftSquareCorner=function(e){return!!e.outputConnection||(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection},o.zelos.TopRow.prototype.hasRightSquareCorner=function(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection},o.zelos.BottomRow=function(e){o.zelos.BottomRow.superClass_.constructor.call(this,e)},o.utils.object.inherits(o.zelos.BottomRow,o.blockRendering.BottomRow),o.zelos.BottomRow.prototype.endsWithElemSpacer=function(){return!1},o.zelos.BottomRow.prototype.hasLeftSquareCorner=function(e){return!!e.outputConnection},o.zelos.BottomRow.prototype.hasRightSquareCorner=function(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection},o.zelos.RightConnectionShape=function(e){o.zelos.RightConnectionShape.superClass_.constructor.call(this,e),this.type|=o.blockRendering.Types.getType("RIGHT_CONNECTION"),this.width=this.height=0},o.utils.object.inherits(o.zelos.RightConnectionShape,o.blockRendering.Measurable),o.zelos.RenderInfo=function(e,r){o.zelos.RenderInfo.superClass_.constructor.call(this,e,r),this.topRow=new o.zelos.TopRow(this.constants_),this.bottomRow=new o.zelos.BottomRow(this.constants_),this.isInline=!0,this.isMultiRow=!r.getInputsInline()||r.isCollapsed(),this.hasStatementInput=0<r.statementInputCount,this.rightSide=this.outputConnection?new o.zelos.RightConnectionShape(this.constants_):null},o.utils.object.inherits(o.zelos.RenderInfo,o.blockRendering.RenderInfo),o.zelos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},o.zelos.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},o.zelos.RenderInfo.prototype.shouldStartNewRow_=function(e,r){return!!r&&(e.type==o.inputTypes.STATEMENT||r.type==o.inputTypes.STATEMENT||(e.type==o.inputTypes.VALUE||e.type==o.inputTypes.DUMMY)&&(!this.isInline||this.isMultiRow))},o.zelos.RenderInfo.prototype.getDesiredRowWidth_=function(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):o.zelos.RenderInfo.superClass_.getDesiredRowWidth_.call(this,e)},o.zelos.RenderInfo.prototype.getInRowSpacing_=function(e,r){return e&&r||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&r&&o.blockRendering.Types.isStatementInput(r)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&o.blockRendering.Types.isLeftRoundedCorner(e)&&r&&(o.blockRendering.Types.isPreviousConnection(r)||o.blockRendering.Types.isNextConnection(r))?r.notchOffset-this.constants_.CORNER_RADIUS:e&&o.blockRendering.Types.isLeftSquareCorner(e)&&r&&o.blockRendering.Types.isHat(r)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING},o.zelos.RenderInfo.prototype.getSpacerRowHeight_=function(e,r){if(o.blockRendering.Types.isTopRow(e)&&o.blockRendering.Types.isBottomRow(r))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;var l=o.blockRendering.Types.isInputRow(e)&&e.hasStatement,c=o.blockRendering.Types.isInputRow(r)&&r.hasStatement;return c||l?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),c&&l?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):o.blockRendering.Types.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):o.blockRendering.Types.isBottomRow(r)?this.outputConnection?!r.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},o.zelos.RenderInfo.prototype.getSpacerRowWidth_=function(e,r){var l=this.width-this.startX;return o.blockRendering.Types.isInputRow(e)&&e.hasStatement||o.blockRendering.Types.isInputRow(r)&&r.hasStatement?Math.max(l,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):l},o.zelos.RenderInfo.prototype.getElemCenterline_=function(e,r){if(e.hasStatement&&!o.blockRendering.Types.isSpacer(r)&&!o.blockRendering.Types.isStatementInput(r))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(o.blockRendering.Types.isInlineInput(r)){var l=r.connectedBlock;if(l&&l.outputConnection&&l.nextConnection)return e.yPos+l.height/2}return o.zelos.RenderInfo.superClass_.getElemCenterline_.call(this,e,r)},o.zelos.RenderInfo.prototype.addInput_=function(e,r){e.type==o.inputTypes.DUMMY&&r.hasDummyInput&&r.align==o.constants.ALIGN.LEFT&&e.align==o.constants.ALIGN.RIGHT&&(r.rightAlignedDummyInput=e),o.zelos.RenderInfo.superClass_.addInput_.call(this,e,r)},o.zelos.RenderInfo.prototype.addAlignmentPadding_=function(e,r){if(e.rightAlignedDummyInput){for(var l,p,c=0;(p=e.elements[c])&&(o.blockRendering.Types.isSpacer(p)&&(l=p),!o.blockRendering.Types.isField(p)||p.parentInput!=e.rightAlignedDummyInput);c++);if(l)return l.width+=r,void(e.width+=r)}o.zelos.RenderInfo.superClass_.addAlignmentPadding_.call(this,e,r)},o.zelos.RenderInfo.prototype.adjustXPosition_=function(){for(var e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,r=e,l=2;l<this.rows.length-1;l+=2){var c=this.rows[l-1],p=this.rows[l],_=this.rows[l+1];if(c=2==l?!!this.topRow.hasPreviousConnection:!!c.followsStatement,_=l+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!_.precedesStatement,o.blockRendering.Types.isInputRow(p)&&p.hasStatement)p.measure(),r=p.width-p.getLastInput().width+e;else if(c&&(2==l||_)&&o.blockRendering.Types.isInputRow(p)&&!p.hasStatement){_=p.xPos,c=null;for(var b,v=0;b=p.elements[v];v++)o.blockRendering.Types.isSpacer(b)&&(c=b),!(c&&(o.blockRendering.Types.isField(b)||o.blockRendering.Types.isInput(b))&&_<r)||o.blockRendering.Types.isField(b)&&(b.field instanceof o.FieldLabel||b.field instanceof o.FieldImage)||(c.width+=r-_),_+=b.width}}},o.zelos.RenderInfo.prototype.finalizeOutputConnection_=function(){if(this.outputConnection&&this.outputConnection.isDynamicShape){for(var l,e=0,r=0;l=this.rows[r];r++)l.yPos=e,e+=l.height;this.height=e,e=this.outputConnection.shape.height(r=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height),r=this.outputConnection.shape.width(r),this.outputConnection.height=e,this.outputConnection.width=r,this.outputConnection.startX=r,this.outputConnection.connectionOffsetY=this.outputConnection.shape.connectionOffsetY(e),this.outputConnection.connectionOffsetX=this.outputConnection.shape.connectionOffsetX(r),l=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(l=r,this.rightSide.height=e,this.rightSide.width=l,this.rightSide.centerline=e/2,this.rightSide.xPos=this.width+l),this.startX=r,this.width+=r+l,this.widthWithChildren+=r+l}},o.zelos.RenderInfo.prototype.finalizeHorizontalAlignment_=function(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var l,e=0,r=0;l=this.rows[r];r++)if(o.blockRendering.Types.isInputRow(l)){e=l.elements[l.elements.length-2];var c=this.getNegativeSpacing_(l.elements[1]),p=this.getNegativeSpacing_(e),_=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-(e=c+p)<_&&(c=(e=this.width-_)/2,p=e/2),l.elements.unshift(new o.blockRendering.InRowSpacer(this.constants_,-c)),l.elements.push(new o.blockRendering.InRowSpacer(this.constants_,-p))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,r=0;l=this.rows[r];r++)o.blockRendering.Types.isTopOrBottomRow(l)&&(l.elements[1].width-=e,l.elements[1].widthWithConnectedBlocks-=e),l.width-=e,l.widthWithConnectedBlocks-=e}},o.zelos.RenderInfo.prototype.getNegativeSpacing_=function(e){if(!e)return 0;var r=this.outputConnection.width,l=this.outputConnection.shape.type,c=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)return l===c.SHAPES.ROUND?r-(l=this.height/2>(l=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH)?l:this.height/2)*(1-Math.sin(Math.acos((l-this.constants_.SMALL_PADDING)/l))):0;if(o.blockRendering.Types.isInlineInput(e)){var p=e.connectedBlock;return e=p?p.pathObject.outputShapeType:e.shape.type,p&&p.outputConnection&&(p.statementInputCount||p.nextConnection)||l==c.SHAPES.HEXAGONAL&&l!=e?0:r-this.constants_.SHAPE_IN_SHAPE_PADDING[l][e]}return o.blockRendering.Types.isField(e)?l==c.SHAPES.ROUND&&e.field instanceof o.FieldTextInput?r-2.75*c.GRID_UNIT:r-this.constants_.SHAPE_IN_SHAPE_PADDING[l][0]:o.blockRendering.Types.isIcon(e)?this.constants_.SMALL_PADDING:0},o.zelos.RenderInfo.prototype.finalizeVerticalAlignment_=function(){if(!this.outputConnection)for(var e=2;e<this.rows.length-1;e+=2){var r=this.rows[e-1],l=this.rows[e],c=this.rows[e+1],p=2==e,_=e+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!c.precedesStatement;if(p?this.topRow.hasPreviousConnection:r.followsStatement){var v=3==l.elements.length&&(l.elements[1].field instanceof o.FieldLabel||l.elements[1].field instanceof o.FieldImage);if(!p&&v)r.height-=this.constants_.SMALL_PADDING,c.height-=this.constants_.SMALL_PADDING,l.height-=this.constants_.MEDIUM_PADDING;else if(p||_){if(_){for(p=!1,_=0;v=l.elements[_];_++)if(o.blockRendering.Types.isInlineInput(v)&&v.connectedBlock&&!v.connectedBlock.isShadow()&&40<=v.connectedBlock.getHeightWidth().height){p=!0;break}p&&(r.height-=this.constants_.SMALL_PADDING,c.height-=this.constants_.SMALL_PADDING)}}else r.height+=this.constants_.SMALL_PADDING}}},o.zelos.RenderInfo.prototype.finalize_=function(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),o.zelos.RenderInfo.superClass_.finalize_.call(this),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)},o.zelos.Drawer=function(e,r){o.zelos.Drawer.superClass_.constructor.call(this,e,r)},o.utils.object.inherits(o.zelos.Drawer,o.blockRendering.Drawer),o.zelos.Drawer.prototype.draw=function(){var e=this.block_.pathObject;e.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),o.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()},o.zelos.Drawer.prototype.drawOutline_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):o.zelos.Drawer.superClass_.drawOutline_.call(this)},o.zelos.Drawer.prototype.drawLeft_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():o.zelos.Drawer.superClass_.drawLeft_.call(this)},o.zelos.Drawer.prototype.drawRightSideRow_=function(e){if(!(0>=e.height))if(e.precedesStatement||e.followsStatement){var r=this.constants_.INSIDE_CORNERS.rightHeight;this.outlinePath_+=(e.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<(r=e.height-(e.precedesStatement?r:0))?o.utils.svgPaths.lineOnAxis("V",e.yPos+r):"")+(e.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=o.utils.svgPaths.lineOnAxis("V",e.yPos+e.height)},o.zelos.Drawer.prototype.drawRightDynamicConnection_=function(){this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)},o.zelos.Drawer.prototype.drawLeftDynamicConnection_=function(){this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"},o.zelos.Drawer.prototype.drawFlatTop_=function(){var e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=o.utils.svgPaths.moveBy(e.xPos,this.info_.startY),this.outlinePath_+=o.utils.svgPaths.lineOnAxis("h",e.width)},o.zelos.Drawer.prototype.drawFlatBottom_=function(){var e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=o.utils.svgPaths.lineOnAxis("V",e.baseline),this.outlinePath_+=o.utils.svgPaths.lineOnAxis("h",-e.width)},o.zelos.Drawer.prototype.drawInlineInput_=function(e){this.positionInlineInputConnection_(e);var r=e.input.name;if(!e.connectedBlock&&!this.info_.isInsertionMarker){var l=e.width-2*e.connectionWidth;e=o.utils.svgPaths.moveTo(e.xPos+e.connectionWidth,e.centerline-e.height/2)+o.utils.svgPaths.lineOnAxis("h",l)+e.shape.pathRightDown(e.height)+o.utils.svgPaths.lineOnAxis("h",-l)+e.shape.pathUp(e.height)+"z",this.block_.pathObject.setOutlinePath(r,e)}},o.zelos.Drawer.prototype.drawStatementInput_=function(e){var r=e.getLastInput(),l=r.xPos+r.notchOffset+r.shape.width,c=r.shape.pathRight+o.utils.svgPaths.lineOnAxis("h",-(r.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,p=e.height-2*this.constants_.INSIDE_CORNERS.height;r=this.constants_.INSIDE_CORNERS.pathBottom+o.utils.svgPaths.lineOnAxis("h",r.notchOffset-this.constants_.INSIDE_CORNERS.width)+(r.connectedBottomNextConnection?"":r.shape.pathLeft),this.outlinePath_+=o.utils.svgPaths.lineOnAxis("H",l)+c+o.utils.svgPaths.lineOnAxis("v",p)+r+o.utils.svgPaths.lineOnAxis("H",e.xPos+e.width),this.positionStatementInputConnection_(e)},o.zelos.MarkerSvg=function(e,r,l){o.zelos.MarkerSvg.superClass_.constructor.call(this,e,r,l)},o.utils.object.inherits(o.zelos.MarkerSvg,o.blockRendering.MarkerSvg),o.zelos.MarkerSvg.prototype.showWithInputOutput_=function(e){var r=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle_(e.x,e.y),this.setParent_(r),this.showCurrent_()},o.zelos.MarkerSvg.prototype.showWithOutput_=function(e){this.showWithInputOutput_(e)},o.zelos.MarkerSvg.prototype.showWithInput_=function(e){this.showWithInputOutput_(e)},o.zelos.MarkerSvg.prototype.showWithBlock_=function(e){var r=(e=e.getLocation()).getHeightWidth();this.positionRect_(0,0,r.width,r.height),this.setParent_(e),this.showCurrent_()},o.zelos.MarkerSvg.prototype.positionCircle_=function(e,r){this.markerCircle_.setAttribute("cx",e),this.markerCircle_.setAttribute("cy",r),this.currentMarkerSvg=this.markerCircle_},o.zelos.MarkerSvg.prototype.hide=function(){o.zelos.MarkerSvg.superClass_.hide.call(this),this.markerCircle_.style.display="none"},o.zelos.MarkerSvg.prototype.createDomInternal_=function(){if(o.zelos.MarkerSvg.superClass_.createDomInternal_.call(this),this.markerCircle_=o.utils.dom.createSvgElement(o.utils.Svg.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var e=this.getBlinkProperties_();o.utils.dom.createSvgElement(o.utils.Svg.ANIMATE,e,this.markerCircle_)}return this.markerSvg_},o.zelos.MarkerSvg.prototype.applyColour_=function(e){o.zelos.MarkerSvg.superClass_.applyColour_.call(this,e),this.markerCircle_.setAttribute("fill",this.colour_),this.markerCircle_.setAttribute("stroke",this.colour_),this.isCursor()&&this.markerCircle_.firstChild.setAttribute("values",this.colour_+";transparent;transparent;")},o.zelos.PathObject=function(e,r,l){o.zelos.PathObject.superClass_.constructor.call(this,e,r,l),this.constants=l,this.svgPathSelected_=null,this.outlines_=Object.create(null),this.outputShapeType=this.remainingOutlines_=null},o.utils.object.inherits(o.zelos.PathObject,o.blockRendering.PathObject),o.zelos.PathObject.prototype.setPath=function(e){o.zelos.PathObject.superClass_.setPath.call(this,e),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",e)},o.zelos.PathObject.prototype.applyColour=function(e){for(var r in o.zelos.PathObject.superClass_.applyColour.call(this,e),e.isShadow()&&e.getParent()&&this.svgPath.setAttribute("stroke",e.getParent().style.colourTertiary),this.outlines_)this.outlines_[r].setAttribute("fill",this.style.colourTertiary)},o.zelos.PathObject.prototype.flipRTL=function(){for(var e in o.zelos.PathObject.superClass_.flipRTL.call(this),this.outlines_)this.outlines_[e].setAttribute("transform","scale(-1 1)")},o.zelos.PathObject.prototype.updateSelected=function(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)},o.zelos.PathObject.prototype.updateReplacementFade=function(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")},o.zelos.PathObject.prototype.updateShapeForInputHighlight=function(e,r){e=e.getParentInput().name,(e=this.getOutlinePath_(e))&&(r?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))},o.zelos.PathObject.prototype.beginDrawing=function(){for(var e in this.remainingOutlines_=Object.create(null),this.outlines_)this.remainingOutlines_[e]=1},o.zelos.PathObject.prototype.endDrawing=function(){if(this.remainingOutlines_)for(var e in this.remainingOutlines_)this.removeOutlinePath_(e);this.remainingOutlines_=null},o.zelos.PathObject.prototype.setOutlinePath=function(e,r){(e=this.getOutlinePath_(e)).setAttribute("d",r),e.setAttribute("fill",this.style.colourTertiary)},o.zelos.PathObject.prototype.getOutlinePath_=function(e){return this.outlines_[e]||(this.outlines_[e]=o.utils.dom.createSvgElement(o.utils.Svg.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines_&&delete this.remainingOutlines_[e],this.outlines_[e]},o.zelos.PathObject.prototype.removeOutlinePath_=function(e){this.outlines_[e].parentNode.removeChild(this.outlines_[e]),delete this.outlines_[e]},o.zelos.Renderer=function(e){o.zelos.Renderer.superClass_.constructor.call(this,e)},o.utils.object.inherits(o.zelos.Renderer,o.blockRendering.Renderer),o.zelos.Renderer.prototype.makeConstants_=function(){return new o.zelos.ConstantProvider},o.zelos.Renderer.prototype.makeRenderInfo_=function(e){return new o.zelos.RenderInfo(this,e)},o.zelos.Renderer.prototype.makeDrawer_=function(e,r){return new o.zelos.Drawer(e,r)},o.zelos.Renderer.prototype.makeMarkerDrawer=function(e,r){return new o.zelos.MarkerSvg(e,this.getConstants(),r)},o.zelos.Renderer.prototype.makePathObject=function(e,r){return new o.zelos.PathObject(e,r,this.getConstants())},o.zelos.Renderer.prototype.shouldHighlightConnection=function(e){return e.type!=o.connectionTypes.INPUT_VALUE&&e.type!==o.connectionTypes.OUTPUT_VALUE},o.zelos.Renderer.prototype.getConnectionPreviewMethod=function(e,r,l){return r.type==o.connectionTypes.OUTPUT_VALUE?e.isConnected()?o.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:o.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:o.zelos.Renderer.superClass_.getConnectionPreviewMethod(e,r,l)},o.blockRendering.register("zelos",o.zelos.Renderer),o.Themes.Dark=o.Theme.defineTheme("dark",{base:o.Themes.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"blackBackground",toolboxForegroundColour:"#fff",flyoutBackgroundColour:"#252526",flyoutForegroundColour:"#ccc",flyoutOpacity:1,scrollbarColour:"#797979",insertionMarkerColour:"#fff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0",blackBackground:"#333"}}),o.Themes.Deuteranopia={},o.Themes.Deuteranopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#f2a72c",colourSecondary:"#f1c172",colourTertiary:"#da921c"},list_blocks:{colourPrimary:"#7d65ab",colourSecondary:"#a88be0",colourTertiary:"#66518e"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#795a07",colourSecondary:"#ac8726",colourTertiary:"#c4a03f"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"},variable_dynamic_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"}},o.Themes.Deuteranopia.categoryStyles={colour_category:{colour:"#f2a72c"},list_category:{colour:"#7d65ab"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#795a07"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#47025a"},variable_dynamic_category:{colour:"#47025a"}},o.Themes.Deuteranopia=new o.Theme("deuteranopia",o.Themes.Deuteranopia.defaultBlockStyles,o.Themes.Deuteranopia.categoryStyles),o.Themes.HighContrast={},o.Themes.HighContrast.defaultBlockStyles={colour_blocks:{colourPrimary:"#a52714",colourSecondary:"#FB9B8C",colourTertiary:"#FBE1DD"},list_blocks:{colourPrimary:"#4a148c",colourSecondary:"#AD7BE9",colourTertiary:"#CDB6E9"},logic_blocks:{colourPrimary:"#01579b",colourSecondary:"#64C7FF",colourTertiary:"#C5EAFF"},loop_blocks:{colourPrimary:"#33691e",colourSecondary:"#9AFF78",colourTertiary:"#E1FFD7"},math_blocks:{colourPrimary:"#1a237e",colourSecondary:"#8A9EFF",colourTertiary:"#DCE2FF"},procedure_blocks:{colourPrimary:"#006064",colourSecondary:"#77E6EE",colourTertiary:"#CFECEE"},text_blocks:{colourPrimary:"#004d40",colourSecondary:"#5ae27c",colourTertiary:"#D2FFDD"},variable_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},variable_dynamic_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},hat_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB",hat:"cap"}},o.Themes.HighContrast.categoryStyles={colour_category:{colour:"#a52714"},list_category:{colour:"#4a148c"},logic_category:{colour:"#01579b"},loop_category:{colour:"#33691e"},math_category:{colour:"#1a237e"},procedure_category:{colour:"#006064"},text_category:{colour:"#004d40"},variable_category:{colour:"#880e4f"},variable_dynamic_category:{colour:"#880e4f"}},o.Themes.HighContrast=new o.Theme("highcontrast",o.Themes.HighContrast.defaultBlockStyles,o.Themes.HighContrast.categoryStyles),o.Themes.HighContrast.setComponentStyle("selectedGlowColour","#000000"),o.Themes.HighContrast.setComponentStyle("selectedGlowSize",1),o.Themes.HighContrast.setComponentStyle("replacementGlowColour","#000000"),o.Themes.HighContrast.setFontStyle({family:null,weight:null,size:16}),o.Themes.Tritanopia={},o.Themes.Tritanopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#05427f",colourSecondary:"#2974c0",colourTertiary:"#2d74bb"},list_blocks:{colourPrimary:"#b69ce8",colourSecondary:"#ccbaef",colourTertiary:"#9176c5"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#aa1846",colourSecondary:"#d36185",colourTertiary:"#7c1636"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"},variable_dynamic_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"}},o.Themes.Tritanopia.categoryStyles={colour_category:{colour:"#05427f"},list_category:{colour:"#b69ce8"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#aa1846"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#4b2d84"},variable_dynamic_category:{colour:"#4b2d84"}},o.Themes.Tritanopia=new o.Theme("tritanopia",o.Themes.Tritanopia.defaultBlockStyles,o.Themes.Tritanopia.categoryStyles),o.requires={},o}.apply(J,[]))&&(ce.exports=L)},813:function(ce,J,G){var L,o;L=[G(517)],void 0!==(o=function(e){"use strict";return e.Blocks={},e.Blocks}.apply(J,L))&&(ce.exports=o)},517:function(ce,J,G){var L,o;L=[G(761)],void 0!==(o=function(e){"use strict";return e.Blocks.colour={},e.Constants={},e.Constants.Colour={},e.Constants.Colour.HUE=20,e.defineBlocksWithJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),e.Constants.Lists={},e.Constants.Lists.HUE=260,e.defineBlocksWithJsonArray([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),e.Blocks.lists_create_with={init:function(){this.setHelpUrl(e.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new e.Mutator(["lists_create_with_item"])),this.setTooltip(e.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("items",this.itemCount_),r},domToMutation:function(r){this.itemCount_=parseInt(r.getAttribute("items"),10),this.updateShape_()},decompose:function(r){var l=r.newBlock("lists_create_with_container");l.initSvg();for(var c=l.getInput("STACK").connection,p=0;p<this.itemCount_;p++){var _=r.newBlock("lists_create_with_item");_.initSvg(),c.connect(_.previousConnection),c=_.nextConnection}return l},compose:function(r){var l=r.getInputTargetBlock("STACK");for(r=[];l&&!l.isInsertionMarker();)r.push(l.valueConnection_),l=l.nextConnection&&l.nextConnection.targetBlock();for(l=0;l<this.itemCount_;l++){var c=this.getInput("ADD"+l).connection.targetConnection;c&&-1==r.indexOf(c)&&c.disconnect()}for(this.itemCount_=r.length,this.updateShape_(),l=0;l<this.itemCount_;l++)e.Mutator.reconnect(r[l],this,"ADD"+l)},saveConnections:function(r){r=r.getInputTargetBlock("STACK");for(var l=0;r;){var c=this.getInput("ADD"+l);r.valueConnection_=c&&c.connection.targetConnection,l++,r=r.nextConnection&&r.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(e.Msg.LISTS_CREATE_EMPTY_TITLE);for(var r=0;r<this.itemCount_;r++)if(!this.getInput("ADD"+r)){var l=this.appendValueInput("ADD"+r).setAlign(e.ALIGN_RIGHT);0==r&&l.appendField(e.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(;this.getInput("ADD"+r);)this.removeInput("ADD"+r),r++}},e.Blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},e.Blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(e.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},e.Blocks.lists_indexOf={init:function(){var r=[[e.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[e.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(e.Msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new e.FieldDropdown(r),"END"),this.setInputsInline(!0);var l=this;this.setTooltip(function(){return e.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",l.workspace.options.oneBasedIndex?"0":"-1")})}},e.Blocks.lists_getIndex={init:function(){var r=[[e.Msg.LISTS_GET_INDEX_GET,"GET"],[e.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[e.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[e.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[e.Msg.LISTS_GET_INDEX_LAST,"LAST"],[e.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(e.Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),r=new e.FieldDropdown(r,function(c){c="REMOVE"==c,this.getSourceBlock().updateStatement_(c)}),this.appendValueInput("VALUE").setCheck("Array").appendField(e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(r,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),e.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var l=this;this.setTooltip(function(){var c=l.getFieldValue("MODE"),p=l.getFieldValue("WHERE"),_="";switch(c+" "+p){case"GET FROM_START":case"GET FROM_END":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":_=e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"==p||"FROM_END"==p)&&(_+="  "+("FROM_START"==p?e.Msg.LISTS_INDEX_FROM_START_TOOLTIP:e.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",l.workspace.options.oneBasedIndex?"#1":"#0")),_})},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");r.setAttribute("statement",!this.outputConnection);var l=this.getInput("AT").type==e.INPUT_VALUE;return r.setAttribute("at",l),r},domToMutation:function(r){var l="true"==r.getAttribute("statement");this.updateStatement_(l),r="false"!=r.getAttribute("at"),this.updateAt_(r)},updateStatement_:function(r){r!=!this.outputConnection&&(this.unplug(!0,!0),r?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(r){this.removeInput("AT"),this.removeInput("ORDINAL",!0),r?(this.appendValueInput("AT").setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var l=new e.FieldDropdown(this.WHERE_OPTIONS,function(c){var p="FROM_START"==c||"FROM_END"==c;if(p!=r){var _=this.getSourceBlock();return _.updateAt_(p),_.setFieldValue(c,"WHERE"),null}});this.getInput("AT").appendField(l,"WHERE"),e.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},e.Blocks.lists_setIndex={init:function(){var r=[[e.Msg.LISTS_SET_INDEX_SET,"SET"],[e.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[e.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[e.Msg.LISTS_GET_INDEX_LAST,"LAST"],[e.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(e.Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new e.FieldDropdown(r),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(e.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(e.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var l=this;this.setTooltip(function(){var c=l.getFieldValue("MODE"),p=l.getFieldValue("WHERE"),_="";switch(c+" "+p){case"SET FROM_START":case"SET FROM_END":_=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":_=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":_=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":_=e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":_=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":_=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":_=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":_=e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"==p||"FROM_END"==p)&&(_+="  "+e.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",l.workspace.options.oneBasedIndex?"#1":"#0")),_})},mutationToDom:function(){var r=e.utils.xml.createElement("mutation"),l=this.getInput("AT").type==e.INPUT_VALUE;return r.setAttribute("at",l),r},domToMutation:function(r){r="false"!=r.getAttribute("at"),this.updateAt_(r)},updateAt_:function(r){this.removeInput("AT"),this.removeInput("ORDINAL",!0),r?(this.appendValueInput("AT").setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var l=new e.FieldDropdown(this.WHERE_OPTIONS,function(c){var p="FROM_START"==c||"FROM_END"==c;if(p!=r){var _=this.getSourceBlock();return _.updateAt_(p),_.setFieldValue(c,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(l,"WHERE")}},e.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[e.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[e.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[e.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[e.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(e.Msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),e.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(e.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var r=e.utils.xml.createElement("mutation"),l=this.getInput("AT1").type==e.INPUT_VALUE;return r.setAttribute("at1",l),l=this.getInput("AT2").type==e.INPUT_VALUE,r.setAttribute("at2",l),r},domToMutation:function(r){var l="true"==r.getAttribute("at1");r="true"==r.getAttribute("at2"),this.updateAt_(1,l),this.updateAt_(2,r)},updateAt_:function(r,l){this.removeInput("AT"+r),this.removeInput("ORDINAL"+r,!0),l?(this.appendValueInput("AT"+r).setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+r).appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+r);var c=new e.FieldDropdown(this["WHERE_OPTIONS_"+r],function(p){var _="FROM_START"==p||"FROM_END"==p;if(_!=l){var v=this.getSourceBlock();return v.updateAt_(r,_),v.setFieldValue(p,"WHERE"+r),null}});this.getInput("AT"+r).appendField(c,"WHERE"+r),1==r&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),e.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},e.Blocks.lists_sort={init:function(){this.jsonInit({message0:e.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[e.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[e.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[e.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[e.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[e.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:e.Msg.LISTS_SORT_TOOLTIP,helpUrl:e.Msg.LISTS_SORT_HELPURL})}},e.Blocks.lists_split={init:function(){var r=this,l=new e.FieldDropdown([[e.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[e.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(c){r.updateType_(c)});this.setHelpUrl(e.Msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(l,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(e.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(function(){var c=r.getFieldValue("MODE");if("SPLIT"==c)return e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"==c)return e.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+c)})},updateType_:function(r){if(this.getFieldValue("MODE")!=r){var l=this.getInput("INPUT").connection;l.setShadowDom(null);var c=l.targetBlock();c&&(l.disconnect(),c.isShadow()?c.dispose():this.bumpNeighbours())}"SPLIT"==r?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("mode",this.getFieldValue("MODE")),r},domToMutation:function(r){this.updateType_(r.getAttribute("mode"))}},e.Blocks.logic={},e.Constants.Logic={},e.Constants.Logic.HUE=210,e.defineBlocksWithJsonArray([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]}]),e.defineBlocksWithJsonArray([{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),e.Constants.Logic.TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"},e.Extensions.register("logic_op_tooltip",e.Extensions.buildTooltipForDropdown("OP",e.Constants.Logic.TOOLTIPS_BY_OP)),e.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var r=e.utils.xml.createElement("mutation");return this.elseifCount_&&r.setAttribute("elseif",this.elseifCount_),this.elseCount_&&r.setAttribute("else",1),r},domToMutation:function(r){this.elseifCount_=parseInt(r.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(r.getAttribute("else"),10)||0,this.rebuildShape_()},decompose:function(r){var l=r.newBlock("controls_if_if");l.initSvg();for(var c=l.nextConnection,p=1;p<=this.elseifCount_;p++){var _=r.newBlock("controls_if_elseif");_.initSvg(),c.connect(_.previousConnection),c=_.nextConnection}return this.elseCount_&&((r=r.newBlock("controls_if_else")).initSvg(),c.connect(r.previousConnection)),l},compose:function(r){r=r.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;for(var l=[null],c=[null],p=null;r&&!r.isInsertionMarker();){switch(r.type){case"controls_if_elseif":this.elseifCount_++,l.push(r.valueConnection_),c.push(r.statementConnection_);break;case"controls_if_else":this.elseCount_++,p=r.statementConnection_;break;default:throw TypeError("Unknown block type: "+r.type)}r=r.nextConnection&&r.nextConnection.targetBlock()}this.updateShape_(),this.reconnectChildBlocks_(l,c,p)},saveConnections:function(r){r=r.nextConnection.targetBlock();for(var l=1;r;){switch(r.type){case"controls_if_elseif":var c=this.getInput("IF"+l),p=this.getInput("DO"+l);r.valueConnection_=c&&c.connection.targetConnection,r.statementConnection_=p&&p.connection.targetConnection,l++;break;case"controls_if_else":p=this.getInput("ELSE"),r.statementConnection_=p&&p.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+r.type)}r=r.nextConnection&&r.nextConnection.targetBlock()}},rebuildShape_:function(){var r=[null],l=[null],c=null;this.getInput("ELSE")&&(c=this.getInput("ELSE").connection.targetConnection);for(var p=1;this.getInput("IF"+p);){var _=this.getInput("IF"+p),v=this.getInput("DO"+p);r.push(_.connection.targetConnection),l.push(v.connection.targetConnection),p++}this.updateShape_(),this.reconnectChildBlocks_(r,l,c)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var r=1;this.getInput("IF"+r);)this.removeInput("IF"+r),this.removeInput("DO"+r),r++;for(r=1;r<=this.elseifCount_;r++)this.appendValueInput("IF"+r).setCheck("Boolean").appendField(e.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+r).appendField(e.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(e.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(r,l,c){for(var p=1;p<=this.elseifCount_;p++)e.Mutator.reconnect(r[p],this,"IF"+p),e.Mutator.reconnect(l[p],this,"DO"+p);e.Mutator.reconnect(c,this,"ELSE")}},e.Extensions.registerMutator("controls_if_mutator",e.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]),e.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?e.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?e.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?e.Msg.CONTROLS_IF_TOOLTIP_4:"":e.Msg.CONTROLS_IF_TOOLTIP_1}.bind(this))},e.Extensions.register("controls_if_tooltip",e.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION),e.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN={onchange:function(r){this.prevBlocks_||(this.prevBlocks_=[null,null]);var l=this.getInputTargetBlock("A"),c=this.getInputTargetBlock("B");l&&c&&!this.workspace.connectionChecker.doTypeChecks(l.outputConnection,c.outputConnection)&&(e.Events.setGroup(r.group),(r=this.prevBlocks_[0])!==l&&(l.unplug(),!r||r.isDisposed()||r.isShadow()||this.getInput("A").connection.connect(r.outputConnection)),(l=this.prevBlocks_[1])!==c&&(c.unplug(),!l||l.isDisposed()||l.isShadow()||this.getInput("B").connection.connect(l.outputConnection)),this.bumpNeighbours(),e.Events.setGroup(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},e.Constants.Logic.LOGIC_COMPARE_EXTENSION=function(){this.mixin(e.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN)},e.Extensions.register("logic_compare",e.Constants.Logic.LOGIC_COMPARE_EXTENSION),e.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(r){var l=this.getInputTargetBlock("THEN"),c=this.getInputTargetBlock("ELSE"),p=this.outputConnection.targetConnection;if((l||c)&&p)for(var _=0;2>_;_++){var v=1==_?l:c;v&&!v.workspace.connectionChecker.doTypeChecks(v.outputConnection,p)&&(e.Events.setGroup(r.group),p===this.prevParentConnection_?(this.unplug(),p.getSourceBlock().bumpNeighbours()):(v.unplug(),v.bumpNeighbours()),e.Events.setGroup(!1))}this.prevParentConnection_=p}},e.Extensions.registerMixin("logic_ternary",e.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN),e.Blocks.loops={},e.Constants.Loops={},e.Constants.Loops.HUE=120,e.defineBlocksWithJsonArray([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),e.Constants.Loops.WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"},e.Extensions.register("controls_whileUntil_tooltip",e.Extensions.buildTooltipForDropdown("MODE",e.Constants.Loops.WHILE_UNTIL_TOOLTIPS)),e.Constants.Loops.BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"},e.Extensions.register("controls_flow_tooltip",e.Extensions.buildTooltipForDropdown("FLOW",e.Constants.Loops.BREAK_CONTINUE_TOOLTIPS)),e.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(r){if(!this.isInFlyout){var l=this.getField("VAR").getVariable(),c=l.name;if(!this.isCollapsed()&&null!=c){var p={enabled:!0};p.text=e.Msg.VARIABLES_SET_CREATE_GET.replace("%1",c),l=e.Variables.generateVariableFieldDom(l),(c=e.utils.xml.createElement("block")).setAttribute("type","variables_get"),c.appendChild(l),p.callback=e.ContextMenu.callbackFactory(this,c),r.push(p)}}}},e.Extensions.registerMixin("contextMenu_newGetVariableBlock",e.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),e.Extensions.register("controls_for_tooltip",e.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),e.Extensions.register("controls_forEach_tooltip",e.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"],suppressPrefixSuffix:!0,getSurroundLoop:function(r){do{if(-1!=e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.indexOf(r.type))return r;r=r.getSurroundParent()}while(r);return null},onchange:function(r){if(this.workspace.isDragging&&!this.workspace.isDragging()&&r.type==e.Events.BLOCK_MOVE){var l=e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(this);if(this.setWarningText(l?null:e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){var c=e.Events.getGroup();e.Events.setGroup(r.group),this.setEnabled(l),e.Events.setGroup(c)}}}},e.Extensions.registerMixin("controls_flow_in_loop_check",e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),e.Blocks.math={},e.Constants.Math={},e.Constants.Math.HUE=230,e.defineBlocksWithJsonArray([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),e.Constants.Math.TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"},e.Extensions.register("math_op_tooltip",e.Extensions.buildTooltipForDropdown("OP",e.Constants.Math.TOOLTIPS_BY_OP)),e.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var r=e.utils.xml.createElement("mutation"),l="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");return r.setAttribute("divisor_input",l),r},domToMutation:function(r){r="true"==r.getAttribute("divisor_input"),this.updateShape_(r)},updateShape_:function(r){var l=this.getInput("DIVISOR");r?l||this.appendValueInput("DIVISOR").setCheck("Number"):l&&this.removeInput("DIVISOR")}},e.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator(function(r){r="DIVISIBLE_BY"==r,this.getSourceBlock().updateShape_(r)})},e.Extensions.registerMutator("math_is_divisibleby_mutator",e.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN,e.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION),e.Extensions.register("math_change_tooltip",e.Extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),e.Constants.Math.LIST_MODES_MUTATOR_MIXIN={updateType_:function(r){this.outputConnection.setCheck("MODE"==r?"Array":"Number")},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("op",this.getFieldValue("OP")),r},domToMutation:function(r){this.updateType_(r.getAttribute("op"))}},e.Constants.Math.LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator(function(r){this.updateType_(r)}.bind(this))},e.Extensions.registerMutator("math_modes_of_list_mutator",e.Constants.Math.LIST_MODES_MUTATOR_MIXIN,e.Constants.Math.LIST_MODES_MUTATOR_EXTENSION),e.Blocks.procedures={},e.Blocks.procedures_defnoreturn={init:function(){var r=e.Procedures.findLegalName("",this);(r=new e.FieldTextInput(r,e.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(e.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(r,"NAME").appendField("","PARAMS"),this.setMutator(new e.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&e.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(e.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(e.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:function(r){this.hasStatements_!==r&&(r?(this.appendStatementInput("STACK").appendField(e.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=r)},updateParams_:function(){var r="";this.arguments_.length&&(r=e.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),e.Events.disable();try{this.setFieldValue(r,"PARAMS")}finally{e.Events.enable()}},mutationToDom:function(r){var l=e.utils.xml.createElement("mutation");r&&l.setAttribute("name",this.getFieldValue("NAME"));for(var c=0;c<this.argumentVarModels_.length;c++){var p=e.utils.xml.createElement("arg"),_=this.argumentVarModels_[c];p.setAttribute("name",_.name),p.setAttribute("varid",_.getId()),r&&this.paramIds_&&p.setAttribute("paramId",this.paramIds_[c]),l.appendChild(p)}return this.hasStatements_||l.setAttribute("statements","false"),l},domToMutation:function(r){this.arguments_=[],this.argumentVarModels_=[];for(var c,l=0;c=r.childNodes[l];l++)if("arg"==c.nodeName.toLowerCase()){var p=c.getAttribute("name");c=c.getAttribute("varid")||c.getAttribute("varId"),this.arguments_.push(p),null!=(c=e.Variables.getOrCreateVariablePackage(this.workspace,c,p,""))?this.argumentVarModels_.push(c):console.log("Failed to create a variable with name "+p+", ignoring.")}this.updateParams_(),e.Procedures.mutateCallers(this),this.setStatements_("false"!==r.getAttribute("statements"))},decompose:function(r){var l=e.utils.xml.createElement("block");l.setAttribute("type","procedures_mutatorcontainer");var c=e.utils.xml.createElement("statement");c.setAttribute("name","STACK"),l.appendChild(c);for(var p=0;p<this.arguments_.length;p++){var _=e.utils.xml.createElement("block");_.setAttribute("type","procedures_mutatorarg");var v=e.utils.xml.createElement("field");v.setAttribute("name","NAME");var b=e.utils.xml.createTextNode(this.arguments_[p]);v.appendChild(b),_.appendChild(v),v=e.utils.xml.createElement("next"),_.appendChild(v),c.appendChild(_),c=v}return r=e.Xml.domToBlock(l,r),"procedures_defreturn"==this.type?r.setFieldValue(this.hasStatements_,"STATEMENTS"):r.removeInput("STATEMENT_INPUT"),e.Procedures.mutateCallers(this),r},compose:function(r){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var l=r.getInputTargetBlock("STACK");l&&!l.isInsertionMarker();){var c=l.getFieldValue("NAME");this.arguments_.push(c),c=this.workspace.getVariable(c,""),this.argumentVarModels_.push(c),this.paramIds_.push(l.id),l=l.nextConnection&&l.nextConnection.targetBlock()}this.updateParams_(),e.Procedures.mutateCallers(this),null!==(r=r.getFieldValue("STATEMENTS"))&&this.hasStatements_!=(r="TRUE"==r)&&(r?(this.setStatements_(!0),e.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(r=this.getInput("STACK").connection,(this.statementConnection_=r.targetConnection)&&((r=r.targetBlock()).unplug(),r.bumpNeighbours()),this.setStatements_(!1)))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(r,l){var c=this.workspace.getVariableById(r);if(""==c.type){c=c.name,l=this.workspace.getVariableById(l);for(var p=!1,_=0;_<this.argumentVarModels_.length;_++)this.argumentVarModels_[_].getId()==r&&(this.arguments_[_]=l.name,this.argumentVarModels_[_]=l,p=!0);p&&(this.displayRenamedVar_(c,l.name),e.Procedures.mutateCallers(this))}},updateVarName:function(r){for(var l=r.name,c=!1,p=0;p<this.argumentVarModels_.length;p++)if(this.argumentVarModels_[p].getId()==r.getId()){var _=this.arguments_[p];this.arguments_[p]=l,c=!0}c&&(this.displayRenamedVar_(_,l),e.Procedures.mutateCallers(this))},displayRenamedVar_:function(r,l){if(this.updateParams_(),this.mutator&&this.mutator.isVisible())for(var _,c=this.mutator.workspace_.getAllBlocks(!1),p=0;_=c[p];p++)"procedures_mutatorarg"==_.type&&e.Names.equals(r,_.getFieldValue("NAME"))&&_.setFieldValue(l,"NAME")},customContextMenu:function(r){if(!this.isInFlyout){var l={enabled:!0},c=this.getFieldValue("NAME");l.text=e.Msg.PROCEDURES_CREATE_DO.replace("%1",c);var p=e.utils.xml.createElement("mutation");for(p.setAttribute("name",c),c=0;c<this.arguments_.length;c++){var _=e.utils.xml.createElement("arg");_.setAttribute("name",this.arguments_[c]),p.appendChild(_)}if((c=e.utils.xml.createElement("block")).setAttribute("type",this.callType_),c.appendChild(p),l.callback=e.ContextMenu.callbackFactory(this,c),r.push(l),!this.isCollapsed())for(c=0;c<this.argumentVarModels_.length;c++)(l={enabled:!0}).text=e.Msg.VARIABLES_SET_CREATE_GET.replace("%1",(p=this.argumentVarModels_[c]).name),p=e.Variables.generateVariableFieldDom(p),(_=e.utils.xml.createElement("block")).setAttribute("type","variables_get"),_.appendChild(p),l.callback=e.ContextMenu.callbackFactory(this,_),r.push(l)}},callType_:"procedures_callnoreturn"},e.Blocks.procedures_defreturn={init:function(){var r=e.Procedures.findLegalName("",this);(r=new e.FieldTextInput(r,e.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(e.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(r,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(e.ALIGN_RIGHT).appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new e.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&e.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(e.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(e.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:e.Blocks.procedures_defnoreturn.setStatements_,updateParams_:e.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:e.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:e.Blocks.procedures_defnoreturn.domToMutation,decompose:e.Blocks.procedures_defnoreturn.decompose,compose:e.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:e.Blocks.procedures_defnoreturn.getVars,getVarModels:e.Blocks.procedures_defnoreturn.getVarModels,renameVarById:e.Blocks.procedures_defnoreturn.renameVarById,updateVarName:e.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:e.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:e.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"},e.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(e.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new e.FieldCheckbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},e.Blocks.procedures_mutatorarg={init:function(){var r=new e.FieldTextInput(e.Procedures.DEFAULT_ARG,this.validator_);r.oldShowEditorFn_=r.showEditor_,r.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(e.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(r,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,r.onFinishEditing_=this.deleteIntermediateVars_,r.createdVariables_=[],r.onFinishEditing_("x")},validator_:function(r){var l=this.getSourceBlock(),c=e.Mutator.findParentWs(l.workspace);if(!(r=r.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;for(var p=(l.workspace.targetWorkspace||l.workspace).getAllBlocks(!1),_=r.toLowerCase(),v=0;v<p.length;v++)if(p[v].id!=this.getSourceBlock().id){var b=p[v].getFieldValue("NAME");if(b&&b.toLowerCase()==_)return null}return l.isInFlyout||((l=c.getVariable(r,""))&&l.name!=r&&c.renameVariableById(l.getId(),r),l||(l=c.createVariable(r,""))&&this.createdVariables_&&this.createdVariables_.push(l)),r},deleteIntermediateVars_:function(r){var l=e.Mutator.findParentWs(this.getSourceBlock().workspace);if(l)for(var c=0;c<this.createdVariables_.length;c++){var p=this.createdVariables_[c];p.name!=r&&l.deleteVariableById(p.getId())}}},e.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(e.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(r,l){e.Names.equals(r,this.getProcedureCall())&&(this.setFieldValue(l,"NAME"),this.setTooltip((this.outputConnection?e.Msg.PROCEDURES_CALLRETURN_TOOLTIP:e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",l)))},setProcedureParameters_:function(r,l){var c=e.Procedures.getDefinition(this.getProcedureCall(),this.workspace),p=c&&c.mutator&&c.mutator.isVisible();if(p||(this.quarkConnections_={},this.quarkIds_=null),l)if(r.join("\n")==this.arguments_.join("\n"))this.quarkIds_=l;else{if(l.length!=r.length)throw RangeError("paramNames and paramIds must be the same length.");this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),c=this.rendered,this.rendered=!1;for(var _=0;_<this.arguments_.length;_++){var v=this.getInput("ARG"+_);v&&(this.quarkConnections_[this.quarkIds_[_]]=v=v.connection.targetConnection,p&&v&&-1==l.indexOf(this.quarkIds_[_])&&(v.disconnect(),v.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(r),this.argumentVarModels_=[],_=0;_<this.arguments_.length;_++)r=e.Variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[_],""),this.argumentVarModels_.push(r);if(this.updateShape_(),this.quarkIds_=l)for(_=0;_<this.arguments_.length;_++)(l=this.quarkIds_[_])in this.quarkConnections_&&(e.Mutator.reconnect(v=this.quarkConnections_[l],this,"ARG"+_)||delete this.quarkConnections_[l]);(this.rendered=c)&&this.render()}},updateShape_:function(){for(var r=0;r<this.arguments_.length;r++){var l=this.getField("ARGNAME"+r);if(l){e.Events.disable();try{l.setValue(this.arguments_[r])}finally{e.Events.enable()}}else l=new e.FieldLabel(this.arguments_[r]),this.appendValueInput("ARG"+r).setAlign(e.ALIGN_RIGHT).appendField(l,"ARGNAME"+r).init()}for(;this.getInput("ARG"+r);)this.removeInput("ARG"+r),r++;(r=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(r.appendField(e.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),r.init()):this.getField("WITH")&&r.removeField("WITH"))},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");r.setAttribute("name",this.getProcedureCall());for(var l=0;l<this.arguments_.length;l++){var c=e.utils.xml.createElement("arg");c.setAttribute("name",this.arguments_[l]),r.appendChild(c)}return r},domToMutation:function(r){var l=r.getAttribute("name");this.renameProcedure(this.getProcedureCall(),l),l=[];for(var _,c=[],p=0;_=r.childNodes[p];p++)"arg"==_.nodeName.toLowerCase()&&(l.push(_.getAttribute("name")),c.push(_.getAttribute("paramId")));this.setProcedureParameters_(l,c)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(r){if(this.workspace&&!this.workspace.isFlyout&&r.recordUndo)if(r.type==e.Events.BLOCK_CREATE&&-1!=r.ids.indexOf(this.id)){var l=this.getProcedureCall();if(!(l=e.Procedures.getDefinition(l,this.workspace))||l.type==this.defType_&&JSON.stringify(l.getVars())==JSON.stringify(this.arguments_)||(l=null),!l){e.Events.setGroup(r.group),r=e.utils.xml.createElement("xml"),(l=e.utils.xml.createElement("block")).setAttribute("type",this.defType_);var c=this.getRelativeToSurfaceXY(),p=c.y+2*e.SNAP_RADIUS;l.setAttribute("x",c.x+e.SNAP_RADIUS*(this.RTL?-1:1)),l.setAttribute("y",p),c=this.mutationToDom(),l.appendChild(c),(c=e.utils.xml.createElement("field")).setAttribute("name","NAME"),(p=this.getProcedureCall())||(p=e.Procedures.findLegalName("",this),this.renameProcedure("",p)),c.appendChild(e.utils.xml.createTextNode(p)),l.appendChild(c),r.appendChild(l),e.Xml.domToWorkspace(r,this.workspace),e.Events.setGroup(!1)}}else r.type==e.Events.BLOCK_DELETE?(l=this.getProcedureCall(),(l=e.Procedures.getDefinition(l,this.workspace))||(e.Events.setGroup(r.group),this.dispose(!0),e.Events.setGroup(!1))):r.type==e.Events.CHANGE&&"disabled"==r.element&&(l=this.getProcedureCall(),(l=e.Procedures.getDefinition(l,this.workspace))&&l.id==r.blockId&&((l=e.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),e.Events.setGroup(r.group),r.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),e.Events.setGroup(l)))},customContextMenu:function(r){if(this.workspace.isMovable()){var l={enabled:!0};l.text=e.Msg.PROCEDURES_HIGHLIGHT_DEF;var c=this.getProcedureCall(),p=this.workspace;l.callback=function(){var _=e.Procedures.getDefinition(c,p);_&&(p.centerOnBlock(_.id),_.select())},r.push(l)}},defType_:"procedures_defnoreturn"},e.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(e.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:e.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:e.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:e.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:e.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:e.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:e.Blocks.procedures_callnoreturn.domToMutation,getVars:e.Blocks.procedures_callnoreturn.getVars,getVarModels:e.Blocks.procedures_callnoreturn.getVarModels,onchange:e.Blocks.procedures_callnoreturn.onchange,customContextMenu:e.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"},e.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(e.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(e.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(e.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("value",Number(this.hasReturnValue_)),r},domToMutation:function(r){this.hasReturnValue_=1==r.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(r){if(this.workspace.isDragging&&!this.workspace.isDragging()){r=!1;var l=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(l.type)){r=!0;break}l=l.getSurroundParent()}while(l);r?("procedures_defnoreturn"==l.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=l.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(e.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText(e.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},e.Blocks.texts={},e.Constants.Text={},e.Constants.Text.HUE=160,e.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"\xb6"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),e.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[e.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[e.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[e.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[e.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[e.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[e.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(e.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),e.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(e.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(e.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var r=e.utils.xml.createElement("mutation"),l=this.getInput("AT1").type==e.INPUT_VALUE;return r.setAttribute("at1",l),l=this.getInput("AT2").type==e.INPUT_VALUE,r.setAttribute("at2",l),r},domToMutation:function(r){var l="true"==r.getAttribute("at1");r="true"==r.getAttribute("at2"),this.updateAt_(1,l),this.updateAt_(2,r)},updateAt_:function(r,l){this.removeInput("AT"+r),this.removeInput("ORDINAL"+r,!0),l?(this.appendValueInput("AT"+r).setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+r).appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+r),2==r&&e.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(e.Msg.TEXT_GET_SUBSTRING_TAIL));var c=new e.FieldDropdown(this["WHERE_OPTIONS_"+r],function(p){var _="FROM_START"==p||"FROM_END"==p;if(_!=l){var v=this.getSourceBlock();return v.updateAt_(r,_),v.setFieldValue(p,"WHERE"+r),null}});this.getInput("AT"+r).appendField(c,"WHERE"+r),1==r&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},e.Blocks.text_changeCase={init:function(){var r=[[e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(e.Msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new e.FieldDropdown(r),"CASE"),this.setOutput(!0,"String"),this.setTooltip(e.Msg.TEXT_CHANGECASE_TOOLTIP)}},e.Blocks.text_trim={init:function(){var r=[[e.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[e.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[e.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(e.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new e.FieldDropdown(r),"MODE"),this.setOutput(!0,"String"),this.setTooltip(e.Msg.TEXT_TRIM_TOOLTIP)}},e.Blocks.text_print={init:function(){this.jsonInit({message0:e.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:e.Msg.TEXT_PRINT_TOOLTIP,helpUrl:e.Msg.TEXT_PRINT_HELPURL})}},e.Blocks.text_prompt_ext={init:function(){var r=[[e.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[e.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(e.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");var l=this;r=new e.FieldDropdown(r,function(c){l.updateType_(c)}),this.appendValueInput("TEXT").appendField(r,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==l.getFieldValue("TYPE")?e.Msg.TEXT_PROMPT_TOOLTIP_TEXT:e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:function(r){this.outputConnection.setCheck("NUMBER"==r?"Number":"String")},mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("type",this.getFieldValue("TYPE")),r},domToMutation:function(r){this.updateType_(r.getAttribute("type"))}},e.Blocks.text_prompt={init:function(){this.mixin(e.Constants.Text.QUOTE_IMAGE_MIXIN);var r=[[e.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[e.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],l=this;this.setHelpUrl(e.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),r=new e.FieldDropdown(r,function(c){l.updateType_(c)}),this.appendDummyInput().appendField(r,"TYPE").appendField(this.newQuote_(!0)).appendField(new e.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==l.getFieldValue("TYPE")?e.Msg.TEXT_PROMPT_TOOLTIP_TEXT:e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:e.Blocks.text_prompt_ext.updateType_,mutationToDom:e.Blocks.text_prompt_ext.mutationToDom,domToMutation:e.Blocks.text_prompt_ext.domToMutation},e.Blocks.text_count={init:function(){this.jsonInit({message0:e.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:e.Msg.TEXT_COUNT_TOOLTIP,helpUrl:e.Msg.TEXT_COUNT_HELPURL})}},e.Blocks.text_replace={init:function(){this.jsonInit({message0:e.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:e.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:e.Msg.TEXT_REPLACE_HELPURL})}},e.Blocks.text_reverse={init:function(){this.jsonInit({message0:e.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:e.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:e.Msg.TEXT_REVERSE_HELPURL})}},e.Constants.Text.QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(r){for(var c,l=0;c=this.inputList[l];l++)for(var _,p=0;_=c.fieldRow[p];p++)if(r==_.name)return c.insertFieldAt(p,this.newQuote_(!0)),void c.insertFieldAt(p+2,this.newQuote_(!1));console.warn('field named "'+r+'" not found in '+this.toDevString())},newQuote_:function(r){return new e.FieldImage((r=this.RTL?!r:r)?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,r?"\u201c":"\u201d")}},e.Constants.Text.TEXT_QUOTES_EXTENSION=function(){this.mixin(e.Constants.Text.QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},e.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("items",this.itemCount_),r},domToMutation:function(r){this.itemCount_=parseInt(r.getAttribute("items"),10),this.updateShape_()},decompose:function(r){var l=r.newBlock("text_create_join_container");l.initSvg();for(var c=l.getInput("STACK").connection,p=0;p<this.itemCount_;p++){var _=r.newBlock("text_create_join_item");_.initSvg(),c.connect(_.previousConnection),c=_.nextConnection}return l},compose:function(r){var l=r.getInputTargetBlock("STACK");for(r=[];l&&!l.isInsertionMarker();)r.push(l.valueConnection_),l=l.nextConnection&&l.nextConnection.targetBlock();for(l=0;l<this.itemCount_;l++){var c=this.getInput("ADD"+l).connection.targetConnection;c&&-1==r.indexOf(c)&&c.disconnect()}for(this.itemCount_=r.length,this.updateShape_(),l=0;l<this.itemCount_;l++)e.Mutator.reconnect(r[l],this,"ADD"+l)},saveConnections:function(r){r=r.getInputTargetBlock("STACK");for(var l=0;r;){var c=this.getInput("ADD"+l);r.valueConnection_=c&&c.connection.targetConnection,l++,r=r.nextConnection&&r.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var r=0;r<this.itemCount_;r++)if(!this.getInput("ADD"+r)){var l=this.appendValueInput("ADD"+r).setAlign(e.ALIGN_RIGHT);0==r&&l.appendField(e.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(;this.getInput("ADD"+r);)this.removeInput("ADD"+r),r++}},e.Constants.Text.TEXT_JOIN_EXTENSION=function(){this.mixin(e.Constants.Text.QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new e.Mutator(["text_create_join_item"]))},e.Extensions.register("text_append_tooltip",e.Extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),e.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var r=this;this.setTooltip(function(){return e.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",r.workspace.options.oneBasedIndex?"0":"-1")})},e.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var r=e.utils.xml.createElement("mutation");return r.setAttribute("at",!!this.isAt_),r},domToMutation:function(r){r="false"!=r.getAttribute("at"),this.updateAt_(r)},updateAt_:function(r){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),r&&(this.appendValueInput("AT").setCheck("Number"),e.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(e.Msg.ORDINAL_NUMBER_SUFFIX)),e.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(e.Msg.TEXT_CHARAT_TAIL)),this.isAt_=r}},e.Constants.Text.TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator(function(l){(l="FROM_START"==l||"FROM_END"==l)!=this.isAt_&&this.getSourceBlock().updateAt_(l)}),this.updateAt_(!0);var r=this;this.setTooltip(function(){var l=r.getFieldValue("WHERE"),c=e.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"==l||"FROM_END"==l)&&(l="FROM_START"==l?e.Msg.LISTS_INDEX_FROM_START_TOOLTIP:e.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(c+="  "+l.replace("%1",r.workspace.options.oneBasedIndex?"#1":"#0")),c})},e.Extensions.register("text_indexOf_tooltip",e.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION),e.Extensions.register("text_quotes",e.Constants.Text.TEXT_QUOTES_EXTENSION),e.Extensions.registerMutator("text_join_mutator",e.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN,e.Constants.Text.TEXT_JOIN_EXTENSION),e.Extensions.registerMutator("text_charAt_mutator",e.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN,e.Constants.Text.TEXT_CHARAT_EXTENSION),e.Blocks.variables={},e.Constants.Variables={},e.Constants.Variables.HUE=330,e.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),e.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(r){if(this.isInFlyout)("variables_get"==this.type||"variables_get_reporter"==this.type)&&(l={text:e.Msg.RENAME_VARIABLE,enabled:!0,callback:e.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},_=this.getField("VAR").getText(),p={text:e.Msg.DELETE_VARIABLE.replace("%1",_),enabled:!0,callback:e.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},r.unshift(l),r.unshift(p));else{if("variables_get"==this.type)var l="variables_set",c=e.Msg.VARIABLES_GET_CREATE_SET;else l="variables_get",c=e.Msg.VARIABLES_SET_CREATE_GET;var p={enabled:0<this.workspace.remainingCapacity()},_=this.getField("VAR").getText();p.text=c.replace("%1",_),(c=e.utils.xml.createElement("field")).setAttribute("name","VAR"),c.appendChild(e.utils.xml.createTextNode(_)),(_=e.utils.xml.createElement("block")).setAttribute("type",l),_.appendChild(c),p.callback=e.ContextMenu.callbackFactory(this,_),r.push(p)}}},e.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY=function(r){return function(){var l=r.workspace,c=r.getField("VAR").getVariable();e.Variables.renameVariable(l,c)}},e.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY=function(r){return function(){var l=r.workspace,c=r.getField("VAR").getVariable();l.deleteVariableById(c.getId()),l.refreshToolboxSelection()}},e.Extensions.registerMixin("contextMenu_variableSetterGetter",e.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),e.Constants.VariablesDynamic={},e.Constants.VariablesDynamic.HUE=310,e.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),e.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(r){if(this.isInFlyout)("variables_get_dynamic"==this.type||"variables_get_reporter_dynamic"==this.type)&&(l={text:e.Msg.RENAME_VARIABLE,enabled:!0,callback:e.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},v=this.getField("VAR").getText(),_={text:e.Msg.DELETE_VARIABLE.replace("%1",v),enabled:!0,callback:e.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},r.unshift(l),r.unshift(_));else{var l=this.getFieldValue("VAR"),c=this.workspace.getVariableById(l).type;if("variables_get_dynamic"==this.type){l="variables_set_dynamic";var p=e.Msg.VARIABLES_GET_CREATE_SET}else l="variables_get_dynamic",p=e.Msg.VARIABLES_SET_CREATE_GET;var _={enabled:0<this.workspace.remainingCapacity()},v=this.getField("VAR").getText();_.text=p.replace("%1",v),(p=e.utils.xml.createElement("field")).setAttribute("name","VAR"),p.setAttribute("variabletype",c),p.appendChild(e.utils.xml.createTextNode(v)),(v=e.utils.xml.createElement("block")).setAttribute("type",l),v.appendChild(p),_.callback=e.ContextMenu.callbackFactory(this,v),r.push(_)}},onchange:function(r){r=this.getFieldValue("VAR"),r=e.Variables.getVariable(this.workspace,r),"variables_get_dynamic"==this.type?this.outputConnection.setCheck(r.type):this.getInput("VALUE").connection.setCheck(r.type)}},e.Constants.VariablesDynamic.RENAME_OPTION_CALLBACK_FACTORY=function(r){return function(){var l=r.workspace,c=r.getField("VAR").getVariable();e.Variables.renameVariable(l,c)}},e.Constants.VariablesDynamic.DELETE_OPTION_CALLBACK_FACTORY=function(r){return function(){var l=r.workspace,c=r.getField("VAR").getVariable();l.deleteVariableById(c.getId()),l.refreshToolboxSelection()}},e.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",e.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),e.Blocks}.apply(J,L))&&(ce.exports=o)},490:function(ce,J,G){var L,o;L=[G(215),G(841),G(813),G(610)],void 0!==(o=function(e,r,l,c){"use strict";return e.setLocale(r),e.Blocks=e.Blocks||{},Object.keys(l).forEach(function(p){e.Blocks[p]=l[p]}),e.JavaScript=c,e}.apply(J,L))&&(ce.exports=o)},215:function(ce,J,G){var L,o;L=[G(588)],void 0!==(o=function(e){"use strict";return e.setLocale=function(r){e.Msg=e.Msg||{},Object.keys(r).forEach(function(l){e.Msg[l]=r[l]})},e}.apply(J,L))&&(ce.exports=o)},389:function(ce,J,G){var L,o;L=[G(490)],void 0!==(o=function(e){"use strict";return e}.apply(J,L))&&(ce.exports=o)},610:function(ce,J,G){var L,o;L=[G(215),G(657)],void 0!==(o=function(e,r){"use strict";return e.JavaScript=r,r}.apply(J,L))&&(ce.exports=o)},657:function(ce,J,G){var L,o;L=[G(761)],void 0!==(o=function(e){"use strict";return e.JavaScript=new e.Generator("JavaScript"),e.JavaScript.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(e.utils.global).join(",")),e.JavaScript.ORDER_ATOMIC=0,e.JavaScript.ORDER_NEW=1.1,e.JavaScript.ORDER_MEMBER=1.2,e.JavaScript.ORDER_FUNCTION_CALL=2,e.JavaScript.ORDER_INCREMENT=3,e.JavaScript.ORDER_DECREMENT=3,e.JavaScript.ORDER_BITWISE_NOT=4.1,e.JavaScript.ORDER_UNARY_PLUS=4.2,e.JavaScript.ORDER_UNARY_NEGATION=4.3,e.JavaScript.ORDER_LOGICAL_NOT=4.4,e.JavaScript.ORDER_TYPEOF=4.5,e.JavaScript.ORDER_VOID=4.6,e.JavaScript.ORDER_DELETE=4.7,e.JavaScript.ORDER_AWAIT=4.8,e.JavaScript.ORDER_EXPONENTIATION=5,e.JavaScript.ORDER_MULTIPLICATION=5.1,e.JavaScript.ORDER_DIVISION=5.2,e.JavaScript.ORDER_MODULUS=5.3,e.JavaScript.ORDER_SUBTRACTION=6.1,e.JavaScript.ORDER_ADDITION=6.2,e.JavaScript.ORDER_BITWISE_SHIFT=7,e.JavaScript.ORDER_RELATIONAL=8,e.JavaScript.ORDER_IN=8,e.JavaScript.ORDER_INSTANCEOF=8,e.JavaScript.ORDER_EQUALITY=9,e.JavaScript.ORDER_BITWISE_AND=10,e.JavaScript.ORDER_BITWISE_XOR=11,e.JavaScript.ORDER_BITWISE_OR=12,e.JavaScript.ORDER_LOGICAL_AND=13,e.JavaScript.ORDER_LOGICAL_OR=14,e.JavaScript.ORDER_CONDITIONAL=15,e.JavaScript.ORDER_ASSIGNMENT=16,e.JavaScript.ORDER_YIELD=17,e.JavaScript.ORDER_COMMA=18,e.JavaScript.ORDER_NONE=99,e.JavaScript.ORDER_OVERRIDES=[[e.JavaScript.ORDER_FUNCTION_CALL,e.JavaScript.ORDER_MEMBER],[e.JavaScript.ORDER_FUNCTION_CALL,e.JavaScript.ORDER_FUNCTION_CALL],[e.JavaScript.ORDER_MEMBER,e.JavaScript.ORDER_MEMBER],[e.JavaScript.ORDER_MEMBER,e.JavaScript.ORDER_FUNCTION_CALL],[e.JavaScript.ORDER_LOGICAL_NOT,e.JavaScript.ORDER_LOGICAL_NOT],[e.JavaScript.ORDER_MULTIPLICATION,e.JavaScript.ORDER_MULTIPLICATION],[e.JavaScript.ORDER_ADDITION,e.JavaScript.ORDER_ADDITION],[e.JavaScript.ORDER_LOGICAL_AND,e.JavaScript.ORDER_LOGICAL_AND],[e.JavaScript.ORDER_LOGICAL_OR,e.JavaScript.ORDER_LOGICAL_OR]],e.JavaScript.isInitialized=!1,e.JavaScript.init=function(r){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new e.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(r.getVariableMap()),this.nameDB_.populateVariables(r),this.nameDB_.populateProcedures(r);for(var l=[],c=e.Variables.allDeveloperVariables(r),p=0;p<c.length;p++)l.push(this.nameDB_.getName(c[p],e.Names.DEVELOPER_VARIABLE_TYPE));for(r=e.Variables.allUsedVarModels(r),p=0;p<r.length;p++)l.push(this.nameDB_.getName(r[p].getId(),e.VARIABLE_CATEGORY_NAME));l.length&&(this.definitions_.variables="var "+l.join(", ")+";"),this.isInitialized=!0},e.JavaScript.finish=function(r){var l=e.utils.object.values(this.definitions_);return r=Object.getPrototypeOf(this).finish.call(this,r),this.isInitialized=!1,this.nameDB_.reset(),l.join("\n\n")+"\n\n\n"+r},e.JavaScript.scrubNakedValue=function(r){return r+";\n"},e.JavaScript.quote_=function(r){return"'"+(r=r.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},e.JavaScript.multiline_quote_=function(r){return r.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")},e.JavaScript.scrub_=function(r,l,c){var p="";if(!r.outputConnection||!r.outputConnection.targetConnection){var _=r.getCommentText();_&&(_=e.utils.string.wrap(_,this.COMMENT_WRAP-3),p+=this.prefixLines(_+"\n","// "));for(var v=0;v<r.inputList.length;v++)r.inputList[v].type==e.inputTypes.VALUE&&(_=r.inputList[v].connection.targetBlock())&&(_=this.allNestedComments(_))&&(p+=this.prefixLines(_,"// "))}return r=r.nextConnection&&r.nextConnection.targetBlock(),p+l+(c?"":this.blockToCode(r))},e.JavaScript.getAdjusted=function(r,l,c,p,_){c=c||0,_=_||this.ORDER_NONE,r.workspace.options.oneBasedIndex&&c--;var v=r.workspace.options.oneBasedIndex?"1":"0";if(r=0<c?this.valueToCode(r,l,this.ORDER_ADDITION)||v:0>c?this.valueToCode(r,l,this.ORDER_SUBTRACTION)||v:p?this.valueToCode(r,l,this.ORDER_UNARY_NEGATION)||v:this.valueToCode(r,l,_)||v,e.isNumber(r))r=Number(r)+c,p&&(r=-r);else{if(0<c){r=r+" + "+c;var b=this.ORDER_ADDITION}else 0>c&&(r=r+" - "+-c,b=this.ORDER_SUBTRACTION);p&&(r=c?"-("+r+")":"-"+r,b=this.ORDER_UNARY_NEGATION),b=Math.floor(b),_=Math.floor(_),b&&_>=b&&(r="("+r+")")}return r},e.JavaScript.colour={},e.JavaScript.colour_picker=function(r){return[e.JavaScript.quote_(r.getFieldValue("COLOUR")),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.colour_random=function(r){return[e.JavaScript.provideFunction_("colourRandom",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.colour_rgb=function(r){var l=e.JavaScript.valueToCode(r,"RED",e.JavaScript.ORDER_NONE)||0,c=e.JavaScript.valueToCode(r,"GREEN",e.JavaScript.ORDER_NONE)||0;return r=e.JavaScript.valueToCode(r,"BLUE",e.JavaScript.ORDER_NONE)||0,[e.JavaScript.provideFunction_("colourRgb",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+l+", "+c+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.colour_blend=function(r){var l=e.JavaScript.valueToCode(r,"COLOUR1",e.JavaScript.ORDER_NONE)||"'#000000'",c=e.JavaScript.valueToCode(r,"COLOUR2",e.JavaScript.ORDER_NONE)||"'#000000'";return r=e.JavaScript.valueToCode(r,"RATIO",e.JavaScript.ORDER_NONE)||.5,[e.JavaScript.provideFunction_("colourBlend",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+l+", "+c+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists={},e.JavaScript.lists_create_empty=function(r){return["[]",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.lists_create_with=function(r){for(var l=Array(r.itemCount_),c=0;c<r.itemCount_;c++)l[c]=e.JavaScript.valueToCode(r,"ADD"+c,e.JavaScript.ORDER_NONE)||"null";return["["+l.join(", ")+"]",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.lists_repeat=function(r){return[e.JavaScript.provideFunction_("listsRepeat",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+(e.JavaScript.valueToCode(r,"ITEM",e.JavaScript.ORDER_NONE)||"null")+", "+(r=e.JavaScript.valueToCode(r,"NUM",e.JavaScript.ORDER_NONE)||"0")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_length=function(r){return[(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+".length",e.JavaScript.ORDER_MEMBER]},e.JavaScript.lists_isEmpty=function(r){return["!"+(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+".length",e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.lists_indexOf=function(r){var l="FIRST"==r.getFieldValue("END")?"indexOf":"lastIndexOf",c=e.JavaScript.valueToCode(r,"FIND",e.JavaScript.ORDER_NONE)||"''";return l=(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"[]")+"."+l+"("+c+")",r.workspace.options.oneBasedIndex?[l+" + 1",e.JavaScript.ORDER_ADDITION]:[l,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_getIndex=function(r){var l=r.getFieldValue("MODE")||"GET",c=r.getFieldValue("WHERE")||"FROM_START",p=e.JavaScript.valueToCode(r,"VALUE","RANDOM"==c?e.JavaScript.ORDER_NONE:e.JavaScript.ORDER_MEMBER)||"[]";switch(c){case"FIRST":if("GET"==l)return[p+"[0]",e.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==l)return[p+".shift()",e.JavaScript.ORDER_MEMBER];if("REMOVE"==l)return p+".shift();\n";break;case"LAST":if("GET"==l)return[p+".slice(-1)[0]",e.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==l)return[p+".pop()",e.JavaScript.ORDER_MEMBER];if("REMOVE"==l)return p+".pop();\n";break;case"FROM_START":if(r=e.JavaScript.getAdjusted(r,"AT"),"GET"==l)return[p+"["+r+"]",e.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==l)return[p+".splice("+r+", 1)[0]",e.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==l)return p+".splice("+r+", 1);\n";break;case"FROM_END":if(r=e.JavaScript.getAdjusted(r,"AT",1,!0),"GET"==l)return[p+".slice("+r+")[0]",e.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==l)return[p+".splice("+r+", 1)[0]",e.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==l)return p+".splice("+r+", 1);";break;case"RANDOM":if(p=e.JavaScript.provideFunction_("listsGetRandomItem",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+p+", "+("GET"!=l)+")","GET"==l||"GET_REMOVE"==l)return[p,e.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==l)return p+";\n"}throw Error("Unhandled combination (lists_getIndex).")},e.JavaScript.lists_setIndex=function(r){function l(){if(c.match(/^\w+$/))return"";var b=e.JavaScript.nameDB_.getDistinctName("tmpList",e.VARIABLE_CATEGORY_NAME),w="var "+b+" = "+c+";\n";return c=b,w}var c=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",p=r.getFieldValue("MODE")||"GET",_=r.getFieldValue("WHERE")||"FROM_START",v=e.JavaScript.valueToCode(r,"TO",e.JavaScript.ORDER_ASSIGNMENT)||"null";switch(_){case"FIRST":if("SET"==p)return c+"[0] = "+v+";\n";if("INSERT"==p)return c+".unshift("+v+");\n";break;case"LAST":if("SET"==p)return(r=l())+(c+"[")+c+".length - 1] = "+v+";\n";if("INSERT"==p)return c+".push("+v+");\n";break;case"FROM_START":if(_=e.JavaScript.getAdjusted(r,"AT"),"SET"==p)return c+"["+_+"] = "+v+";\n";if("INSERT"==p)return c+".splice("+_+", 0, "+v+");\n";break;case"FROM_END":if(_=e.JavaScript.getAdjusted(r,"AT",1,!1,e.JavaScript.ORDER_SUBTRACTION),r=l(),"SET"==p)return r+(c+"[")+c+".length - "+_+"] = "+v+";\n";if("INSERT"==p)return r+(c+".splice(")+c+".length - "+_+", 0, "+v+");\n";break;case"RANDOM":if(r=l(),r+="var "+(_=e.JavaScript.nameDB_.getDistinctName("tmpX",e.VARIABLE_CATEGORY_NAME))+" = Math.floor(Math.random() * "+c+".length);\n","SET"==p)return r+(c+"[")+_+"] = "+v+";\n";if("INSERT"==p)return r+(c+".splice(")+_+", 0, "+v+");\n"}throw Error("Unhandled combination (lists_setIndex).")},e.JavaScript.lists.getIndex_=function(r,l,c){return"FIRST"==l?"0":"FROM_END"==l?r+".length - 1 - "+c:"LAST"==l?r+".length - 1":c},e.JavaScript.lists_getSublist=function(r){var l=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",c=r.getFieldValue("WHERE1"),p=r.getFieldValue("WHERE2");if("FIRST"==c&&"LAST"==p)l+=".slice(0)";else if(l.match(/^\w+$/)||"FROM_END"!=c&&"FROM_START"==p){switch(c){case"FROM_START":var _=e.JavaScript.getAdjusted(r,"AT1");break;case"FROM_END":_=l+".length - "+(_=e.JavaScript.getAdjusted(r,"AT1",1,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":_="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(p){case"FROM_START":r=e.JavaScript.getAdjusted(r,"AT2",1);break;case"FROM_END":r=l+".length - "+(r=e.JavaScript.getAdjusted(r,"AT2",0,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"LAST":r=l+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}l=l+".slice("+_+", "+r+")"}else{_=e.JavaScript.getAdjusted(r,"AT1"),r=e.JavaScript.getAdjusted(r,"AT2");var v=e.JavaScript.lists.getIndex_,b={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};l=e.JavaScript.provideFunction_("subsequence"+b[c]+b[p],["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==c||"FROM_START"==c?", at1":"")+("FROM_END"==p||"FROM_START"==p?", at2":"")+") {","  var start = "+v("sequence",c,"at1")+";","  var end = "+v("sequence",p,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+l+("FROM_END"==c||"FROM_START"==c?", "+_:"")+("FROM_END"==p||"FROM_START"==p?", "+r:"")+")"}return[l,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_sort=function(r){var l=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_FUNCTION_CALL)||"[]",c="1"===r.getFieldValue("DIRECTION")?1:-1;return r=r.getFieldValue("TYPE"),[l+".slice().sort("+e.JavaScript.provideFunction_("listsGetSortCompare",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+r+'", '+c+"))",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_split=function(r){var l=e.JavaScript.valueToCode(r,"INPUT",e.JavaScript.ORDER_MEMBER),c=e.JavaScript.valueToCode(r,"DELIM",e.JavaScript.ORDER_NONE)||"''";if("SPLIT"==(r=r.getFieldValue("MODE")))l||(l="''"),r="split";else{if("JOIN"!=r)throw Error("Unknown mode: "+r);l||(l="[]"),r="join"}return[l+"."+r+"("+c+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.lists_reverse=function(r){return[(e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.logic={},e.JavaScript.controls_if=function(r){var l=0,c="";e.JavaScript.STATEMENT_PREFIX&&(c+=e.JavaScript.injectId(e.JavaScript.STATEMENT_PREFIX,r));do{var p=e.JavaScript.valueToCode(r,"IF"+l,e.JavaScript.ORDER_NONE)||"false",_=e.JavaScript.statementToCode(r,"DO"+l);e.JavaScript.STATEMENT_SUFFIX&&(_=e.JavaScript.prefixLines(e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r),e.JavaScript.INDENT)+_),c+=(0<l?" else ":"")+"if ("+p+") {\n"+_+"}",++l}while(r.getInput("IF"+l));return(r.getInput("ELSE")||e.JavaScript.STATEMENT_SUFFIX)&&(_=e.JavaScript.statementToCode(r,"ELSE"),e.JavaScript.STATEMENT_SUFFIX&&(_=e.JavaScript.prefixLines(e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r),e.JavaScript.INDENT)+_),c+=" else {\n"+_+"}"),c+"\n"},e.JavaScript.controls_ifelse=e.JavaScript.controls_if,e.JavaScript.logic_compare=function(r){var l={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[r.getFieldValue("OP")],c="=="==l||"!="==l?e.JavaScript.ORDER_EQUALITY:e.JavaScript.ORDER_RELATIONAL;return[(e.JavaScript.valueToCode(r,"A",c)||"0")+" "+l+" "+(r=e.JavaScript.valueToCode(r,"B",c)||"0"),c]},e.JavaScript.logic_operation=function(r){var l="AND"==r.getFieldValue("OP")?"&&":"||",c="&&"==l?e.JavaScript.ORDER_LOGICAL_AND:e.JavaScript.ORDER_LOGICAL_OR,p=e.JavaScript.valueToCode(r,"A",c);if(r=e.JavaScript.valueToCode(r,"B",c),p||r){var _="&&"==l?"true":"false";p||(p=_),r||(r=_)}else r=p="false";return[p+" "+l+" "+r,c]},e.JavaScript.logic_negate=function(r){var l=e.JavaScript.ORDER_LOGICAL_NOT;return["!"+(e.JavaScript.valueToCode(r,"BOOL",l)||"true"),l]},e.JavaScript.logic_boolean=function(r){return["TRUE"==r.getFieldValue("BOOL")?"true":"false",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.logic_null=function(r){return["null",e.JavaScript.ORDER_ATOMIC]},e.JavaScript.logic_ternary=function(r){return[(e.JavaScript.valueToCode(r,"IF",e.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+(e.JavaScript.valueToCode(r,"THEN",e.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(r=e.JavaScript.valueToCode(r,"ELSE",e.JavaScript.ORDER_CONDITIONAL)||"null"),e.JavaScript.ORDER_CONDITIONAL]},e.JavaScript.loops={},e.JavaScript.controls_repeat_ext=function(r){var l=r.getField("TIMES")?String(Number(r.getFieldValue("TIMES"))):e.JavaScript.valueToCode(r,"TIMES",e.JavaScript.ORDER_ASSIGNMENT)||"0",c=e.JavaScript.statementToCode(r,"DO");c=e.JavaScript.addLoopTrap(c,r),r="";var p=e.JavaScript.nameDB_.getDistinctName("count",e.VARIABLE_CATEGORY_NAME),_=l;return l.match(/^\w+$/)||e.isNumber(l)||(r+="var "+(_=e.JavaScript.nameDB_.getDistinctName("repeat_end",e.VARIABLE_CATEGORY_NAME))+" = "+l+";\n"),r+"for (var "+p+" = 0; "+p+" < "+_+"; "+p+"++) {\n"+c+"}\n"},e.JavaScript.controls_repeat=e.JavaScript.controls_repeat_ext,e.JavaScript.controls_whileUntil=function(r){var l="UNTIL"==r.getFieldValue("MODE"),c=e.JavaScript.valueToCode(r,"BOOL",l?e.JavaScript.ORDER_LOGICAL_NOT:e.JavaScript.ORDER_NONE)||"false",p=e.JavaScript.statementToCode(r,"DO");return l&&(c="!"+c),"while ("+c+") {\n"+(p=e.JavaScript.addLoopTrap(p,r))+"}\n"},e.JavaScript.controls_for=function(r){var l=e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME),c=e.JavaScript.valueToCode(r,"FROM",e.JavaScript.ORDER_ASSIGNMENT)||"0",p=e.JavaScript.valueToCode(r,"TO",e.JavaScript.ORDER_ASSIGNMENT)||"0",_=e.JavaScript.valueToCode(r,"BY",e.JavaScript.ORDER_ASSIGNMENT)||"1",v=e.JavaScript.statementToCode(r,"DO");if(v=e.JavaScript.addLoopTrap(v,r),e.isNumber(c)&&e.isNumber(p)&&e.isNumber(_)){var b=Number(c)<=Number(p);r="for ("+l+" = "+c+"; "+l+(b?" <= ":" >= ")+p+"; "+l,r=(1==(l=Math.abs(Number(_)))?r+(b?"++":"--"):r+(b?" += ":" -= ")+l)+") {\n"+v+"}\n"}else r="",b=c,c.match(/^\w+$/)||e.isNumber(c)||(r+="var "+(b=e.JavaScript.nameDB_.getDistinctName(l+"_start",e.VARIABLE_CATEGORY_NAME))+" = "+c+";\n"),c=p,p.match(/^\w+$/)||e.isNumber(p)||(r+="var "+(c=e.JavaScript.nameDB_.getDistinctName(l+"_end",e.VARIABLE_CATEGORY_NAME))+" = "+p+";\n"),r+="var "+(p=e.JavaScript.nameDB_.getDistinctName(l+"_inc",e.VARIABLE_CATEGORY_NAME))+" = ",r=(r=e.isNumber(_)?r+(Math.abs(_)+";\n"):r+"Math.abs("+_+");\n")+"if ("+b+" > "+c+") {\n"+(e.JavaScript.INDENT+p)+" = -"+p+";\n",r+="}\n",r+="for ("+l+" = "+b+"; "+p+" >= 0 ? "+l+" <= "+c+" : "+l+" >= "+c+"; "+l+" += "+p+") {\n"+v+"}\n";return r},e.JavaScript.controls_forEach=function(r){var l=e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME),c=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_ASSIGNMENT)||"[]",p=e.JavaScript.statementToCode(r,"DO");p=e.JavaScript.addLoopTrap(p,r),r="";var _=c;return c.match(/^\w+$/)||(r+="var "+(_=e.JavaScript.nameDB_.getDistinctName(l+"_list",e.VARIABLE_CATEGORY_NAME))+" = "+c+";\n"),r+"for (var "+(c=e.JavaScript.nameDB_.getDistinctName(l+"_index",e.VARIABLE_CATEGORY_NAME))+" in "+_+") {\n"+(p=e.JavaScript.INDENT+l+" = "+_+"["+c+"];\n"+p)+"}\n"},e.JavaScript.controls_flow_statements=function(r){var l="";if(e.JavaScript.STATEMENT_PREFIX&&(l+=e.JavaScript.injectId(e.JavaScript.STATEMENT_PREFIX,r)),e.JavaScript.STATEMENT_SUFFIX&&(l+=e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r)),e.JavaScript.STATEMENT_PREFIX){var c=e.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(r);c&&!c.suppressPrefixSuffix&&(l+=e.JavaScript.injectId(e.JavaScript.STATEMENT_PREFIX,c))}switch(r.getFieldValue("FLOW")){case"BREAK":return l+"break;\n";case"CONTINUE":return l+"continue;\n"}throw Error("Unknown flow statement.")},e.JavaScript.math={},e.JavaScript.math_number=function(r){return[r=Number(r.getFieldValue("NUM")),0<=r?e.JavaScript.ORDER_ATOMIC:e.JavaScript.ORDER_UNARY_NEGATION]},e.JavaScript.math_arithmetic=function(r){var l={ADD:[" + ",e.JavaScript.ORDER_ADDITION],MINUS:[" - ",e.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",e.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",e.JavaScript.ORDER_DIVISION],POWER:[null,e.JavaScript.ORDER_NONE]}[r.getFieldValue("OP")],c=l[0],p=e.JavaScript.valueToCode(r,"A",l=l[1])||"0";return r=e.JavaScript.valueToCode(r,"B",l)||"0",c?[p+c+r,l]:["Math.pow("+p+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_single=function(r){var l=r.getFieldValue("OP");if("NEG"==l)return"-"==(r=e.JavaScript.valueToCode(r,"NUM",e.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(r=" "+r),["-"+r,e.JavaScript.ORDER_UNARY_NEGATION];switch(r="SIN"==l||"COS"==l||"TAN"==l?e.JavaScript.valueToCode(r,"NUM",e.JavaScript.ORDER_DIVISION)||"0":e.JavaScript.valueToCode(r,"NUM",e.JavaScript.ORDER_NONE)||"0",l){case"ABS":var c="Math.abs("+r+")";break;case"ROOT":c="Math.sqrt("+r+")";break;case"LN":c="Math.log("+r+")";break;case"EXP":c="Math.exp("+r+")";break;case"POW10":c="Math.pow(10,"+r+")";break;case"ROUND":c="Math.round("+r+")";break;case"ROUNDUP":c="Math.ceil("+r+")";break;case"ROUNDDOWN":c="Math.floor("+r+")";break;case"SIN":c="Math.sin("+r+" / 180 * Math.PI)";break;case"COS":c="Math.cos("+r+" / 180 * Math.PI)";break;case"TAN":c="Math.tan("+r+" / 180 * Math.PI)"}if(c)return[c,e.JavaScript.ORDER_FUNCTION_CALL];switch(l){case"LOG10":c="Math.log("+r+") / Math.log(10)";break;case"ASIN":c="Math.asin("+r+") / Math.PI * 180";break;case"ACOS":c="Math.acos("+r+") / Math.PI * 180";break;case"ATAN":c="Math.atan("+r+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+l)}return[c,e.JavaScript.ORDER_DIVISION]},e.JavaScript.math_constant=function(r){return{PI:["Math.PI",e.JavaScript.ORDER_MEMBER],E:["Math.E",e.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",e.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",e.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",e.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",e.JavaScript.ORDER_ATOMIC]}[r.getFieldValue("CONSTANT")]},e.JavaScript.math_number_property=function(r){var l=e.JavaScript.valueToCode(r,"NUMBER_TO_CHECK",e.JavaScript.ORDER_MODULUS)||"0",c=r.getFieldValue("PROPERTY");if("PRIME"==c)return[e.JavaScript.provideFunction_("mathIsPrime",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+l+")",e.JavaScript.ORDER_FUNCTION_CALL];switch(c){case"EVEN":var p=l+" % 2 == 0";break;case"ODD":p=l+" % 2 == 1";break;case"WHOLE":p=l+" % 1 == 0";break;case"POSITIVE":p=l+" > 0";break;case"NEGATIVE":p=l+" < 0";break;case"DIVISIBLE_BY":p=l+" % "+(r=e.JavaScript.valueToCode(r,"DIVISOR",e.JavaScript.ORDER_MODULUS)||"0")+" == 0"}return[p,e.JavaScript.ORDER_EQUALITY]},e.JavaScript.math_change=function(r){var l=e.JavaScript.valueToCode(r,"DELTA",e.JavaScript.ORDER_ADDITION)||"0";return(r=e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME))+" = (typeof "+r+" == 'number' ? "+r+" : 0) + "+l+";\n"},e.JavaScript.math_round=e.JavaScript.math_single,e.JavaScript.math_trig=e.JavaScript.math_single,e.JavaScript.math_on_list=function(r){var l=r.getFieldValue("OP");switch(l){case"SUM":r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_MEMBER)||"[]",r+=".reduce(function(x, y) {return x + y;})";break;case"MIN":r="Math.min.apply(null, "+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"MAX":r="Math.max.apply(null, "+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"AVERAGE":r=(l=e.JavaScript.provideFunction_("mathMean",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":r=(l=e.JavaScript.provideFunction_("mathMedian",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":r=(l=e.JavaScript.provideFunction_("mathModes",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":r=(l=e.JavaScript.provideFunction_("mathStandardDeviation",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":r=(l=e.JavaScript.provideFunction_("mathRandomList",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(r=e.JavaScript.valueToCode(r,"LIST",e.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+l)}return[r,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_modulo=function(r){return[(e.JavaScript.valueToCode(r,"DIVIDEND",e.JavaScript.ORDER_MODULUS)||"0")+" % "+(r=e.JavaScript.valueToCode(r,"DIVISOR",e.JavaScript.ORDER_MODULUS)||"0"),e.JavaScript.ORDER_MODULUS]},e.JavaScript.math_constrain=function(r){return["Math.min(Math.max("+(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_NONE)||"0")+", "+(e.JavaScript.valueToCode(r,"LOW",e.JavaScript.ORDER_NONE)||"0")+"), "+(r=e.JavaScript.valueToCode(r,"HIGH",e.JavaScript.ORDER_NONE)||"Infinity")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_random_int=function(r){var l=e.JavaScript.valueToCode(r,"FROM",e.JavaScript.ORDER_NONE)||"0";return r=e.JavaScript.valueToCode(r,"TO",e.JavaScript.ORDER_NONE)||"0",[e.JavaScript.provideFunction_("mathRandomInt",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+l+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_random_float=function(r){return["Math.random()",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.math_atan2=function(r){var l=e.JavaScript.valueToCode(r,"X",e.JavaScript.ORDER_NONE)||"0";return["Math.atan2("+(e.JavaScript.valueToCode(r,"Y",e.JavaScript.ORDER_NONE)||"0")+", "+l+") / Math.PI * 180",e.JavaScript.ORDER_DIVISION]},e.JavaScript.procedures={},e.JavaScript.procedures_defreturn=function(r){var l=e.JavaScript.nameDB_.getName(r.getFieldValue("NAME"),e.PROCEDURE_CATEGORY_NAME),c="";e.JavaScript.STATEMENT_PREFIX&&(c+=e.JavaScript.injectId(e.JavaScript.STATEMENT_PREFIX,r)),e.JavaScript.STATEMENT_SUFFIX&&(c+=e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r)),c&&(c=e.JavaScript.prefixLines(c,e.JavaScript.INDENT));var p="";e.JavaScript.INFINITE_LOOP_TRAP&&(p=e.JavaScript.prefixLines(e.JavaScript.injectId(e.JavaScript.INFINITE_LOOP_TRAP,r),e.JavaScript.INDENT));var _=e.JavaScript.statementToCode(r,"STACK"),v=e.JavaScript.valueToCode(r,"RETURN",e.JavaScript.ORDER_NONE)||"",b="";_&&v&&(b=c),v&&(v=e.JavaScript.INDENT+"return "+v+";\n");for(var w=[],F=r.getVars(),X=0;X<F.length;X++)w[X]=e.JavaScript.nameDB_.getName(F[X],e.VARIABLE_CATEGORY_NAME);return c="function "+l+"("+w.join(", ")+") {\n"+c+p+_+b+v+"}",c=e.JavaScript.scrub_(r,c),e.JavaScript.definitions_["%"+l]=c,null},e.JavaScript.procedures_defnoreturn=e.JavaScript.procedures_defreturn,e.JavaScript.procedures_callreturn=function(r){for(var l=e.JavaScript.nameDB_.getName(r.getFieldValue("NAME"),e.PROCEDURE_CATEGORY_NAME),c=[],p=r.getVars(),_=0;_<p.length;_++)c[_]=e.JavaScript.valueToCode(r,"ARG"+_,e.JavaScript.ORDER_NONE)||"null";return[l+"("+c.join(", ")+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.procedures_callnoreturn=function(r){return e.JavaScript.procedures_callreturn(r)[0]+";\n"},e.JavaScript.procedures_ifreturn=function(r){var l="if ("+(e.JavaScript.valueToCode(r,"CONDITION",e.JavaScript.ORDER_NONE)||"false")+") {\n";return e.JavaScript.STATEMENT_SUFFIX&&(l+=e.JavaScript.prefixLines(e.JavaScript.injectId(e.JavaScript.STATEMENT_SUFFIX,r),e.JavaScript.INDENT)),r.hasReturnValue_?(r=e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_NONE)||"null",l+=e.JavaScript.INDENT+"return "+r+";\n"):l+=e.JavaScript.INDENT+"return;\n",l+"}\n"},e.JavaScript.texts={},e.JavaScript.text=function(r){return[e.JavaScript.quote_(r.getFieldValue("TEXT")),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.text_multiline=function(r){var l=-1!=(r=e.JavaScript.multiline_quote_(r.getFieldValue("TEXT"))).indexOf("+")?e.JavaScript.ORDER_ADDITION:e.JavaScript.ORDER_ATOMIC;return[r,l]},e.JavaScript.text.forceString_=function(r){return e.JavaScript.text.forceString_.strRegExp.test(r)?[r,e.JavaScript.ORDER_ATOMIC]:["String("+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,e.JavaScript.text_join=function(r){switch(r.itemCount_){case 0:return["''",e.JavaScript.ORDER_ATOMIC];case 1:return r=e.JavaScript.valueToCode(r,"ADD0",e.JavaScript.ORDER_NONE)||"''",e.JavaScript.text.forceString_(r);case 2:var l=e.JavaScript.valueToCode(r,"ADD0",e.JavaScript.ORDER_NONE)||"''";return r=e.JavaScript.valueToCode(r,"ADD1",e.JavaScript.ORDER_NONE)||"''",[r=e.JavaScript.text.forceString_(l)[0]+" + "+e.JavaScript.text.forceString_(r)[0],e.JavaScript.ORDER_ADDITION];default:l=Array(r.itemCount_);for(var c=0;c<r.itemCount_;c++)l[c]=e.JavaScript.valueToCode(r,"ADD"+c,e.JavaScript.ORDER_NONE)||"''";return[r="["+l.join(",")+"].join('')",e.JavaScript.ORDER_FUNCTION_CALL]}},e.JavaScript.text_append=function(r){var l=e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME);return r=e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''",l+" += "+e.JavaScript.text.forceString_(r)[0]+";\n"},e.JavaScript.text_length=function(r){return[(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+".length",e.JavaScript.ORDER_MEMBER]},e.JavaScript.text_isEmpty=function(r){return["!"+(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+".length",e.JavaScript.ORDER_LOGICAL_NOT]},e.JavaScript.text_indexOf=function(r){var l="FIRST"==r.getFieldValue("END")?"indexOf":"lastIndexOf",c=e.JavaScript.valueToCode(r,"FIND",e.JavaScript.ORDER_NONE)||"''";return l=(e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_MEMBER)||"''")+"."+l+"("+c+")",r.workspace.options.oneBasedIndex?[l+" + 1",e.JavaScript.ORDER_ADDITION]:[l,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_charAt=function(r){var l=r.getFieldValue("WHERE")||"FROM_START",c=e.JavaScript.valueToCode(r,"VALUE","RANDOM"==l?e.JavaScript.ORDER_NONE:e.JavaScript.ORDER_MEMBER)||"''";switch(l){case"FIRST":return[c+".charAt(0)",e.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[c+".slice(-1)",e.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[c+".charAt("+(r=e.JavaScript.getAdjusted(r,"AT"))+")",e.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[c+".slice("+(r=e.JavaScript.getAdjusted(r,"AT",1,!0))+").charAt(0)",e.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[e.JavaScript.provideFunction_("textRandomLetter",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+c+")",e.JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},e.JavaScript.text.getIndex_=function(r,l,c){return"FIRST"==l?"0":"FROM_END"==l?r+".length - 1 - "+c:"LAST"==l?r+".length - 1":c},e.JavaScript.text_getSubstring=function(r){var l=r.getFieldValue("WHERE1"),c=r.getFieldValue("WHERE2"),p="FROM_END"!=l&&"LAST"!=l&&"FROM_END"!=c&&"LAST"!=c,_=e.JavaScript.valueToCode(r,"STRING",p?e.JavaScript.ORDER_MEMBER:e.JavaScript.ORDER_NONE)||"''";if("FIRST"==l&&"LAST"==c)return[_,e.JavaScript.ORDER_NONE];if(_.match(/^'?\w+'?$/)||p){switch(l){case"FROM_START":p=e.JavaScript.getAdjusted(r,"AT1");break;case"FROM_END":p=_+".length - "+(p=e.JavaScript.getAdjusted(r,"AT1",1,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":p="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(c){case"FROM_START":r=e.JavaScript.getAdjusted(r,"AT2",1);break;case"FROM_END":r=_+".length - "+(r=e.JavaScript.getAdjusted(r,"AT2",0,!1,e.JavaScript.ORDER_SUBTRACTION));break;case"LAST":r=_+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}l=_+".slice("+p+", "+r+")"}else{p=e.JavaScript.getAdjusted(r,"AT1"),r=e.JavaScript.getAdjusted(r,"AT2");var v=e.JavaScript.text.getIndex_,b={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};l=e.JavaScript.provideFunction_("subsequence"+b[l]+b[c],["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==l||"FROM_START"==l?", at1":"")+("FROM_END"==c||"FROM_START"==c?", at2":"")+") {","  var start = "+v("sequence",l,"at1")+";","  var end = "+v("sequence",c,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+_+("FROM_END"==l||"FROM_START"==l?", "+p:"")+("FROM_END"==c||"FROM_START"==c?", "+r:"")+")"}return[l,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_changeCase=function(r){var l={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[r.getFieldValue("CASE")];return r=e.JavaScript.valueToCode(r,"TEXT",l?e.JavaScript.ORDER_MEMBER:e.JavaScript.ORDER_NONE)||"''",[l?r+l:e.JavaScript.provideFunction_("textToTitleCase",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_trim=function(r){var l={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[r.getFieldValue("MODE")];return[(e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_MEMBER)||"''")+l,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_print=function(r){return"window.alert("+(e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''")+");\n"},e.JavaScript.text_prompt_ext=function(r){var l="window.prompt("+(r.getField("TEXT")?e.JavaScript.quote_(r.getFieldValue("TEXT")):e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"==r.getFieldValue("TYPE")&&(l="Number("+l+")"),[l,e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_prompt=e.JavaScript.text_prompt_ext,e.JavaScript.text_count=function(r){var l=e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''";return r=e.JavaScript.valueToCode(r,"SUB",e.JavaScript.ORDER_NONE)||"''",[e.JavaScript.provideFunction_("textCount",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+l+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_replace=function(r){var l=e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_NONE)||"''",c=e.JavaScript.valueToCode(r,"FROM",e.JavaScript.ORDER_NONE)||"''";return r=e.JavaScript.valueToCode(r,"TO",e.JavaScript.ORDER_NONE)||"''",[e.JavaScript.provideFunction_("textReplace",["function "+e.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+l+", "+c+", "+r+")",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.text_reverse=function(r){return[(e.JavaScript.valueToCode(r,"TEXT",e.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",e.JavaScript.ORDER_FUNCTION_CALL]},e.JavaScript.variables={},e.JavaScript.variables_get=function(r){return[e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME),e.JavaScript.ORDER_ATOMIC]},e.JavaScript.variables_set=function(r){var l=e.JavaScript.valueToCode(r,"VALUE",e.JavaScript.ORDER_ASSIGNMENT)||"0";return e.JavaScript.nameDB_.getName(r.getFieldValue("VAR"),e.VARIABLE_CATEGORY_NAME)+" = "+l+";\n"},e.JavaScript.variablesDynamic={},e.JavaScript.variables_get_dynamic=e.JavaScript.variables_get,e.JavaScript.variables_set_dynamic=e.JavaScript.variables_set,e.JavaScript}.apply(J,L))&&(ce.exports=o)},841:function(ce,J,G){var L,o;L=[G(215)],void 0!==(o=function(e){return(e={Msg:{}}).Msg.ADD_COMMENT="Add Comment",e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_VARIABLE="Delete the '%1' variable",e.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.DUPLICATE_COMMENT="Duplicate Comment",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.HELP="Help",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.IOS_CANCEL="Cancel",e.Msg.IOS_ERROR="Error",e.Msg.IOS_OK="OK",e.Msg.IOS_PROCEDURES_ADD_INPUT="+ Add Input",e.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Allow statements",e.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="This function has duplicate inputs.",e.Msg.IOS_PROCEDURES_INPUTS="INPUTS",e.Msg.IOS_VARIABLES_ADD_BUTTON="Add",e.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Add Variable",e.Msg.IOS_VARIABLES_DELETE_BUTTON="Delete",e.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="You can't use an empty variable name.",e.Msg.IOS_VARIABLES_RENAME_BUTTON="Rename",e.Msg.IOS_VARIABLES_VARIABLE_NAME="Variable name",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",e.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",e.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_DIVISION_SYMBOL="\xf7",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",e.Msg.NEW_NUMBER_VARIABLE="Create number variable...",e.Msg.NEW_STRING_VARIABLE="Create string variable...",e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CREATE_DO="Create '%1'",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.REDO="Redo",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TITLE="to %1 append text %2",e.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TITLE="in text %1 %2",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TODAY="Today",e.Msg.UNDO="Undo",e.Msg.UNNAMED_KEY="unnamed",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",e.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_HUE="230",e.Msg.LOOPS_HUE="120",e.Msg.LISTS_HUE="260",e.Msg.LOGIC_HUE="210",e.Msg.VARIABLES_HUE="330",e.Msg.TEXTS_HUE="160",e.Msg.PROCEDURES_HUE="290",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_DYNAMIC_HUE="310",e.Msg}.apply(J,L))&&(ce.exports=o)},382:(ce,J,G)=>{"use strict";function N(i){return"function"==typeof i}function L(i){const n=i(s=>{Error.call(s),s.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const o=L(i=>function(n){i(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((s,a)=>`${a+1}) ${s.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function e(i,t){if(i){const n=i.indexOf(t);0<=n&&i.splice(n,1)}}class r{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const u of n)u.remove(this);else n.remove(this);const{initialTeardown:s}=this;if(N(s))try{s()}catch(u){t=u instanceof o?u.errors:[u]}const{_teardowns:a}=this;if(a){this._teardowns=null;for(const u of a)try{p(u)}catch(h){t=null!=t?t:[],h instanceof o?t=[...t,...h.errors]:t.push(h)}}if(t)throw new o(t)}}add(t){var n;if(t&&t!==this)if(this.closed)p(t);else{if(t instanceof r){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&e(n,t)}remove(t){const{_teardowns:n}=this;n&&e(n,t),t instanceof r&&t._removeParent(this)}}r.EMPTY=(()=>{const i=new r;return i.closed=!0,i})();const l=r.EMPTY;function c(i){return i instanceof r||i&&"closed"in i&&N(i.remove)&&N(i.add)&&N(i.unsubscribe)}function p(i){N(i)?i():i.unsubscribe()}const _={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},v={setTimeout(...i){const{delegate:t}=v;return((null==t?void 0:t.setTimeout)||setTimeout)(...i)},clearTimeout(i){const{delegate:t}=v;return((null==t?void 0:t.clearTimeout)||clearTimeout)(i)},delegate:void 0};function b(i){v.setTimeout(()=>{const{onUnhandledError:t}=_;if(!t)throw i;t(i)})}function w(){}const F=Ve("C",void 0,void 0);function Ve(i,t,n){return{kind:i,value:t,error:n}}let It=null;function vn(i){if(_.useDeprecatedSynchronousErrorHandling){const t=!It;if(t&&(It={errorThrown:!1,error:null}),i(),t){const{errorThrown:n,error:s}=It;if(It=null,n)throw s}}else i()}class is extends r{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,c(t)&&t.add(this)):this.destination=LR}static create(t,n,s){return new os(t,n,s)}next(t){this.isStopped?vc(Ve("N",t,void 0),this):this._next(t)}error(t){this.isStopped?vc(Ve("E",void 0,t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?vc(F,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class os extends is{constructor(t,n,s){let a;if(super(),N(t))a=t;else if(t){let u;({next:a,error:n,complete:s}=t),this&&_.useDeprecatedNextContext?(u=Object.create(t),u.unsubscribe=()=>this.unsubscribe()):u=t,a=null==a?void 0:a.bind(u),n=null==n?void 0:n.bind(u),s=null==s?void 0:s.bind(u)}this.destination={next:a?Tc(a):w,error:Tc(null!=n?n:bg),complete:s?Tc(s):w}}}function Tc(i,t){return(...n)=>{try{i(...n)}catch(s){_.useDeprecatedSynchronousErrorHandling?function(i){_.useDeprecatedSynchronousErrorHandling&&It&&(It.errorThrown=!0,It.error=i)}(s):b(s)}}}function bg(i){throw i}function vc(i,t){const{onStoppedNotification:n}=_;n&&v.setTimeout(()=>n(i,t))}const LR={closed:!0,next:w,error:bg,complete:w},yc="function"==typeof Symbol&&Symbol.observable||"@@observable";function Li(i){return i}let Be=(()=>{class i{constructor(n){n&&(this._subscribe=n)}lift(n){const s=new i;return s.source=this,s.operator=n,s}subscribe(n,s,a){const u=function(i){return i&&i instanceof is||function(i){return i&&N(i.next)&&N(i.error)&&N(i.complete)}(i)&&c(i)}(n)?n:new os(n,s,a);return vn(()=>{const{operator:h,source:d}=this;u.add(h?h.call(u,d):d?this._subscribe(u):this._trySubscribe(u))}),u}_trySubscribe(n){try{return this._subscribe(n)}catch(s){n.error(s)}}forEach(n,s){return new(s=Ig(s))((a,u)=>{let h;h=this.subscribe(d=>{try{n(d)}catch(f){u(f),null==h||h.unsubscribe()}},u,a)})}_subscribe(n){var s;return null===(s=this.source)||void 0===s?void 0:s.subscribe(n)}[yc](){return this}pipe(...n){return function(i){return 0===i.length?Li:1===i.length?i[0]:function(n){return i.reduce((s,a)=>a(s),n)}}(n)(this)}toPromise(n){return new(n=Ig(n))((s,a)=>{let u;this.subscribe(h=>u=h,h=>a(h),()=>s(u))})}}return i.create=t=>new i(t),i})();function Ig(i){var t;return null!==(t=null!=i?i:_.Promise)&&void 0!==t?t:Promise}const FR=L(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let yn=(()=>{class i extends Be{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const s=new Rg(this,this);return s.operator=n,s}_throwIfClosed(){if(this.closed)throw new FR}next(n){vn(()=>{if(this._throwIfClosed(),!this.isStopped){const s=this.observers.slice();for(const a of s)a.next(n)}})}error(n){vn(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:s}=this;for(;s.length;)s.shift().error(n)}})}complete(){vn(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:s,isStopped:a,observers:u}=this;return s||a?l:(u.push(n),new r(()=>e(u,n)))}_checkFinalizedStatuses(n){const{hasError:s,thrownError:a,isStopped:u}=this;s?n.error(a):u&&n.complete()}asObservable(){const n=new Be;return n.source=this,n}}return i.create=(t,n)=>new Rg(t,n),i})();class Rg extends yn{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,s;null===(s=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===s||s.call(n,t)}error(t){var n,s;null===(s=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===s||s.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,s;return null!==(s=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==s?s:l}}function Dg(i){return N(null==i?void 0:i.lift)}function Ze(i){return t=>{if(Dg(t))return t.lift(function(n){try{return i(n,this)}catch(s){this.error(s)}});throw new TypeError("Unable to lift unknown Observable type")}}class Je extends is{constructor(t,n,s,a,u){super(t),this.onFinalize=u,this._next=n?function(h){try{n(h)}catch(d){t.error(d)}}:super._next,this._error=a?function(h){try{a(h)}catch(d){t.error(d)}finally{this.unsubscribe()}}:super._error,this._complete=s?function(){try{s()}catch(h){t.error(h)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}function De(i,t){return Ze((n,s)=>{let a=0;n.subscribe(new Je(s,u=>{s.next(i.call(t,u,a++))}))})}function oo(i){return this instanceof oo?(this.v=i,this):new oo(i)}function UR(i,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,s=n.apply(i,t||[]),u=[];return a={},h("next"),h("throw"),h("return"),a[Symbol.asyncIterator]=function(){return this},a;function h(T){s[T]&&(a[T]=function(y){return new Promise(function(C,I){u.push([T,y,C,I])>1||d(T,y)})})}function d(T,y){try{!function(T){T.value instanceof oo?Promise.resolve(T.value.v).then(g,m):E(u[0][2],T)}(s[T](y))}catch(C){E(u[0][3],C)}}function g(T){d("next",T)}function m(T){d("throw",T)}function E(T,y){T(y),u.shift(),u.length&&d(u[0][0],u[0][1])}}function HR(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=i[Symbol.asyncIterator];return t?t.call(i):(i=function(i){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&i[t],s=0;if(n)return n.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(u){n[u]=i[u]&&function(h){return new Promise(function(d,f){!function(u,h,d,f){Promise.resolve(f).then(function(g){u({value:g,done:d})},h)}(d,f,(h=i[u](h)).done,h.value)})}}}const Og=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function Ng(i){return N(null==i?void 0:i.then)}function kg(i){return N(i[yc])}function Lg(i){return Symbol.asyncIterator&&N(null==i?void 0:i[Symbol.asyncIterator])}function Pg(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const xg="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Fg(i){return N(null==i?void 0:i[xg])}function Vg(i){return UR(this,arguments,function*(){const n=i.getReader();try{for(;;){const{value:s,done:a}=yield oo(n.read());if(a)return yield oo(void 0);yield yield oo(s)}}finally{n.releaseLock()}})}function Bg(i){return N(null==i?void 0:i.getReader)}function Cn(i){if(i instanceof Be)return i;if(null!=i){if(kg(i))return function(i){return new Be(t=>{const n=i[yc]();if(N(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(Og(i))return function(i){return new Be(t=>{for(let n=0;n<i.length&&!t.closed;n++)t.next(i[n]);t.complete()})}(i);if(Ng(i))return function(i){return new Be(t=>{i.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,b)})}(i);if(Lg(i))return Ug(i);if(Fg(i))return function(i){return new Be(t=>{for(const n of i)if(t.next(n),t.closed)return;t.complete()})}(i);if(Bg(i))return function(i){return Ug(Vg(i))}(i)}throw Pg(i)}function Ug(i){return new Be(t=>{(function(i,t){var n,s,a,u;return function(i,t,n,s){return new(n||(n=Promise))(function(u,h){function d(m){try{g(s.next(m))}catch(E){h(E)}}function f(m){try{g(s.throw(m))}catch(E){h(E)}}function g(m){m.done?u(m.value):function(u){return u instanceof n?u:new n(function(h){h(u)})}(m.value).then(d,f)}g((s=s.apply(i,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=HR(i);!(s=yield n.next()).done;)if(t.next(s.value),t.closed)return}catch(h){a={error:h}}finally{try{s&&!s.done&&(u=n.return)&&(yield u.call(n))}finally{if(a)throw a.error}}t.complete()})})(i,t).catch(n=>t.error(n))})}function ci(i,t,n,s=0,a=!1){const u=t.schedule(function(){n(),a?i.add(this.schedule(null,s)):this.unsubscribe()},s);if(i.add(u),!a)return u}function rt(i,t,n=1/0){return N(t)?rt((s,a)=>De((u,h)=>t(s,u,a,h))(Cn(i(s,a))),n):("number"==typeof t&&(n=t),Ze((s,a)=>function(i,t,n,s,a,u,h,d){const f=[];let g=0,m=0,E=!1;const T=()=>{E&&!f.length&&!g&&t.complete()},y=I=>g<s?C(I):f.push(I),C=I=>{g++;let S=!1;Cn(n(I,m++)).subscribe(new Je(t,D=>{t.next(D)},()=>{S=!0},void 0,()=>{if(S)try{for(g--;f.length&&g<s;){const D=f.shift();C(D)}T()}catch(D){t.error(D)}}))};return i.subscribe(new Je(t,y,()=>{E=!0,T()})),()=>{}}(s,a,i,n)))}function rs(i=1/0){return rt(Li,i)}const hi=new Be(i=>i.complete());function bc(i){return i[i.length-1]}function Hg(i){return N(bc(i))?i.pop():void 0}function ss(i){return function(i){return i&&N(i.schedule)}(bc(i))?i.pop():void 0}function Gg(i,t=0){return Ze((n,s)=>{n.subscribe(new Je(s,a=>ci(s,i,()=>s.next(a),t),()=>ci(s,i,()=>s.complete(),t),a=>ci(s,i,()=>s.error(a),t)))})}function Wg(i,t=0){return Ze((n,s)=>{s.add(i.schedule(()=>n.subscribe(s),t))})}function jg(i,t){if(!i)throw new Error("Iterable cannot be null");return new Be(n=>{ci(n,t,()=>{const s=i[Symbol.asyncIterator]();ci(n,t,()=>{s.next().then(a=>{a.done?n.complete():n.next(a.value)})},0,!0)})})}function st(i,t){return t?function(i,t){if(null!=i){if(kg(i))return function(i,t){return Cn(i).pipe(Wg(t),Gg(t))}(i,t);if(Og(i))return function(i,t){return new Be(n=>{let s=0;return t.schedule(function(){s===i.length?n.complete():(n.next(i[s++]),n.closed||this.schedule())})})}(i,t);if(Ng(i))return function(i,t){return Cn(i).pipe(Wg(t),Gg(t))}(i,t);if(Lg(i))return jg(i,t);if(Fg(i))return function(i,t){return new Be(n=>{let s;return ci(n,t,()=>{s=i[xg](),ci(n,t,()=>{let a,u;try{({value:a,done:u}=s.next())}catch(h){return void n.error(h)}u?n.complete():n.next(a)},0,!0)}),()=>N(null==s?void 0:s.return)&&s.return()})}(i,t);if(Bg(i))return function(i,t){return jg(Vg(i),t)}(i,t)}throw Pg(i)}(i,t):Cn(i)}function Ga(i){return i<=0?()=>hi:Ze((t,n)=>{let s=0;t.subscribe(new Je(n,a=>{++s<=i&&(n.next(a),i<=s&&n.complete())}))})}function Sc(i,t,...n){return!0===t?(i(),null):!1===t?null:t(...n).pipe(Ga(1)).subscribe(()=>i())}function ye(i){for(let t in i)if(i[t]===ye)return t;throw Error("Could not find renamed property on target object.")}function Ic(i,t){for(const n in t)t.hasOwnProperty(n)&&!i.hasOwnProperty(n)&&(i[n]=t[n])}function he(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(he).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const t=i.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function Rc(i,t){return null==i||""===i?null===t?"":t:null==t||""===t?i:i+" "+t}const lD=ye({__forward_ref__:ye});function Ie(i){return i.__forward_ref__=Ie,i.toString=function(){return he(this())},i}function W(i){return Xg(i)?i():i}function Xg(i){return"function"==typeof i&&i.hasOwnProperty(lD)&&i.__forward_ref__===Ie}class ro extends Error{constructor(t,n){super(function(i,t){return`${i?`NG0${i}: `:""}${t}`}(t,n)),this.code=t}}function re(i){return"string"==typeof i?i:null==i?"":String(i)}function Rt(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():re(i)}function Wa(i,t){const n=t?` in ${t}`:"";throw new ro("201",`No provider for ${Rt(i)} found${n}`)}function Wt(i,t){null==i&&function(i,t,n,s){throw new Error(`ASSERTION ERROR: ${i}`+(null==s?"":` [Expected=> ${n} ${s} ${t} <=Actual]`))}(t,i,null,"!=")}function ee(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function et(i){return{providers:i.providers||[],imports:i.imports||[]}}function pi(i){return zg(i,ja)||zg(i,Yg)}function zg(i,t){return i.hasOwnProperty(t)?i[t]:null}function Kg(i){return i&&(i.hasOwnProperty(Ac)||i.hasOwnProperty(gD))?i[Ac]:null}const ja=ye({\u0275prov:ye}),Ac=ye({\u0275inj:ye}),Yg=ye({ngInjectableDef:ye}),gD=ye({ngInjectorDef:ye});var z=(()=>((z=z||{})[z.Default=0]="Default",z[z.Host=1]="Host",z[z.Self=2]="Self",z[z.SkipSelf=4]="SkipSelf",z[z.Optional=8]="Optional",z))();let wc;function Pi(i){const t=wc;return wc=i,t}function Jg(i,t,n){const s=pi(i);return s&&"root"==s.providedIn?void 0===s.value?s.value=s.factory():s.value:n&z.Optional?null:void 0!==t?t:void Wa(he(i),"Injector")}function xi(i){return{toString:i}.toString()}var tn=(()=>((tn=tn||{})[tn.OnPush=0]="OnPush",tn[tn.Default=1]="Default",tn))(),Ft=(()=>{return(i=Ft||(Ft={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Ft;var i})();const mD="undefined"!=typeof globalThis&&globalThis,ED="undefined"!=typeof window&&window,TD="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ee=mD||"undefined"!=typeof global&&global||ED||TD,Go={},be=[],Xa=ye({\u0275cmp:ye}),Mc=ye({\u0275dir:ye}),Oc=ye({\u0275pipe:ye}),$g=ye({\u0275mod:ye}),fi=ye({\u0275fac:ye}),as=ye({__NG_ELEMENT_ID__:ye});let vD=0;function so(i){return xi(()=>{const n={},s={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===tn.OnPush,directiveDefs:null,pipeDefs:null,selectors:i.selectors||be,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Ft.Emulated,id:"c",styles:i.styles||be,_:null,setInput:null,schemas:i.schemas||null,tView:null},a=i.directives,u=i.features,h=i.pipes;return s.id+=vD++,s.inputs=e_(i.inputs,n),s.outputs=e_(i.outputs),u&&u.forEach(d=>d(s)),s.directiveDefs=a?()=>("function"==typeof a?a():a).map(qg):null,s.pipeDefs=h?()=>("function"==typeof h?h():h).map(Qg):null,s})}function qg(i){return gt(i)||function(i){return i[Mc]||null}(i)}function Qg(i){return function(i){return i[Oc]||null}(i)}const Zg={};function pt(i){return xi(()=>{const t={type:i.type,bootstrap:i.bootstrap||be,declarations:i.declarations||be,imports:i.imports||be,exports:i.exports||be,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&(Zg[i.id]=i.type),t})}function e_(i,t){if(null==i)return Go;const n={};for(const s in i)if(i.hasOwnProperty(s)){let a=i[s],u=a;Array.isArray(a)&&(u=a[1],a=a[0]),n[a]=s,t&&(t[a]=u)}return n}const $=so;function gt(i){return i[Xa]||null}function nn(i,t){const n=i[$g]||null;if(!n&&!0===t)throw new Error(`Type ${he(i)} does not have '\u0275mod' property.`);return n}function Wn(i){return Array.isArray(i)&&"object"==typeof i[1]}function Sn(i){return Array.isArray(i)&&!0===i[1]}function Lc(i){return 0!=(8&i.flags)}function Ja(i){return 2==(2&i.flags)}function $a(i){return 1==(1&i.flags)}function In(i){return null!==i.template}function RD(i){return 0!=(512&i[2])}function ho(i,t){return i.hasOwnProperty(fi)?i[fi]:null}class n_{constructor(t,n,s){this.previousValue=t,this.currentValue=n,this.firstChange=s}isFirstChange(){return this.firstChange}}function mt(){return i_}function i_(i){return i.type.prototype.ngOnChanges&&(i.setInput=MD),wD}function wD(){const i=r_(this),t=null==i?void 0:i.current;if(t){const n=i.previous;if(n===Go)i.previous=t;else for(let s in t)n[s]=t[s];i.current=null,this.ngOnChanges(t)}}function MD(i,t,n,s){const a=r_(i)||function(i,t){return i[o_]=t}(i,{previous:Go,current:null}),u=a.current||(a.current={}),h=a.previous,d=this.declaredInputs[n],f=h[d];u[d]=new n_(f&&f.currentValue,t,h===Go),i[s]=t}mt.ngInherit=!0;const o_="__ngSimpleChanges__";function r_(i){return i[o_]||null}let Fc;function Ge(i){return!!i.listen}const l_={createRenderer:(i,t)=>void 0!==Fc?Fc:"undefined"!=typeof document?document:void 0};function $e(i){for(;Array.isArray(i);)i=i[0];return i}function sn(i,t){return $e(t[i.index])}function Bc(i,t){return i.data[t]}function Xt(i,t){const n=t[i];return Wn(n)?n:n[0]}function u_(i){return 4==(4&i[2])}function Uc(i){return 128==(128&i[2])}function Vi(i,t){return null==t?null:i[t]}function c_(i){i[18]=0}function Hc(i,t){i[5]+=t;let n=i,s=i[3];for(;null!==s&&(1===t&&1===n[5]||-1===t&&0===n[5]);)s[5]+=t,n=s,s=s[3]}const te={lFrame:E_(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function h_(){return te.bindingsEnabled}function O(){return te.lFrame.lView}function _e(){return te.lFrame.tView}function tt(){let i=d_();for(;null!==i&&64===i.type;)i=i.parent;return i}function d_(){return te.lFrame.currentTNode}function jn(i,t){const n=te.lFrame;n.currentTNode=i,n.isParent=t}function Gc(){return te.lFrame.isParent}function Wc(){te.lFrame.isParent=!1}function Qa(){return te.isInCheckNoChangesMode}function Za(i){te.isInCheckNoChangesMode=i}function Yo(){return te.lFrame.bindingIndex++}function zD(i,t){const n=te.lFrame;n.bindingIndex=n.bindingRootIndex=i,jc(t)}function jc(i){te.lFrame.currentDirectiveIndex=i}function g_(){return te.lFrame.currentQueryIndex}function zc(i){te.lFrame.currentQueryIndex=i}function YD(i){const t=i[1];return 2===t.type?t.declTNode:1===t.type?i[6]:null}function __(i,t,n){if(n&z.SkipSelf){let a=t,u=i;for(;!(a=a.parent,null!==a||n&z.Host||(a=YD(u),null===a||(u=u[15],10&a.type))););if(null===a)return!1;t=a,i=u}const s=te.lFrame=m_();return s.currentTNode=t,s.lView=i,!0}function el(i){const t=m_(),n=i[1];te.lFrame=t,t.currentTNode=n.firstChild,t.lView=i,t.tView=n,t.contextLView=i,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function m_(){const i=te.lFrame,t=null===i?null:i.child;return null===t?E_(i):t}function E_(i){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=t),t}function T_(){const i=te.lFrame;return te.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const v_=T_;function tl(){const i=T_();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function At(){return te.lFrame.selectedIndex}function Bi(i){te.lFrame.selectedIndex=i}function We(){const i=te.lFrame;return Bc(i.tView,i.selectedIndex)}function nl(i,t){for(let n=t.directiveStart,s=t.directiveEnd;n<s;n++){const u=i.data[n].type.prototype,{ngAfterContentInit:h,ngAfterContentChecked:d,ngAfterViewInit:f,ngAfterViewChecked:g,ngOnDestroy:m}=u;h&&(i.contentHooks||(i.contentHooks=[])).push(-n,h),d&&((i.contentHooks||(i.contentHooks=[])).push(n,d),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(n,d)),f&&(i.viewHooks||(i.viewHooks=[])).push(-n,f),g&&((i.viewHooks||(i.viewHooks=[])).push(n,g),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(n,g)),null!=m&&(i.destroyHooks||(i.destroyHooks=[])).push(n,m)}}function il(i,t,n){y_(i,t,3,n)}function ol(i,t,n,s){(3&i[2])===n&&y_(i,t,n,s)}function Kc(i,t){let n=i[2];(3&n)===t&&(n&=2047,n+=1,i[2]=n)}function y_(i,t,n,s){const u=null!=s?s:-1,h=t.length-1;let d=0;for(let f=void 0!==s?65535&i[18]:0;f<h;f++)if("number"==typeof t[f+1]){if(d=t[f],null!=s&&d>=s)break}else t[f]<0&&(i[18]+=65536),(d<u||-1==u)&&(iA(i,n,t,f),i[18]=(4294901760&i[18])+f+2),f++}function iA(i,t,n,s){const a=n[s]<0,u=n[s+1],d=i[a?-n[s]:n[s]];if(a){if(i[2]>>11<i[18]>>16&&(3&i[2])===t){i[2]+=2048;try{u.call(d)}finally{}}}else try{u.call(d)}finally{}}class ds{constructor(t,n,s){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=s}}function rl(i,t,n){const s=Ge(i);let a=0;for(;a<n.length;){const u=n[a];if("number"==typeof u){if(0!==u)break;a++;const h=n[a++],d=n[a++],f=n[a++];s?i.setAttribute(t,d,f,h):t.setAttributeNS(h,d,f)}else{const h=u,d=n[++a];Jc(h)?s&&i.setProperty(t,h,d):s?i.setAttribute(t,h,d):t.setAttribute(h,d),a++}}return a}function C_(i){return 3===i||4===i||6===i}function Jc(i){return 64===i.charCodeAt(0)}function sl(i,t){if(null!==t&&0!==t.length)if(null===i||0===i.length)i=t.slice();else{let n=-1;for(let s=0;s<t.length;s++){const a=t[s];"number"==typeof a?n=a:0===n||b_(i,n,a,null,-1===n||2===n?t[++s]:null)}}return i}function b_(i,t,n,s,a){let u=0,h=i.length;if(-1===t)h=-1;else for(;u<i.length;){const d=i[u++];if("number"==typeof d){if(d===t){h=-1;break}if(d>t){h=u-1;break}}}for(;u<i.length;){const d=i[u];if("number"==typeof d)break;if(d===n){if(null===s)return void(null!==a&&(i[u+1]=a));if(s===i[u+1])return void(i[u+2]=a)}u++,null!==s&&u++,null!==a&&u++}-1!==h&&(i.splice(h,0,t),u=h+1),i.splice(u++,0,n),null!==s&&i.splice(u++,0,s),null!==a&&i.splice(u++,0,a)}function S_(i){return-1!==i}function Jo(i){return 32767&i}function $o(i,t){let n=function(i){return i>>16}(i),s=t;for(;n>0;)s=s[15],n--;return s}let $c=!0;function al(i){const t=$c;return $c=i,t}let uA=0;function fs(i,t){const n=Qc(i,t);if(-1!==n)return n;const s=t[1];s.firstCreatePass&&(i.injectorIndex=t.length,qc(s.data,i),qc(t,null),qc(s.blueprint,null));const a=ll(i,t),u=i.injectorIndex;if(S_(a)){const h=Jo(a),d=$o(a,t),f=d[1].data;for(let g=0;g<8;g++)t[u+g]=d[h+g]|f[h+g]}return t[u+8]=a,u}function qc(i,t){i.push(0,0,0,0,0,0,0,0,t)}function Qc(i,t){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===t[i.injectorIndex+8]?-1:i.injectorIndex}function ll(i,t){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let n=0,s=null,a=t;for(;null!==a;){const u=a[1],h=u.type;if(s=2===h?u.declTNode:1===h?a[6]:null,null===s)return-1;if(n++,a=a[15],-1!==s.injectorIndex)return s.injectorIndex|n<<16}return-1}function ul(i,t,n){!function(i,t,n){let s;"string"==typeof n?s=n.charCodeAt(0)||0:n.hasOwnProperty(as)&&(s=n[as]),null==s&&(s=n[as]=uA++);const a=255&s;t.data[i+(a>>5)]|=1<<a}(i,t,n)}function D_(i,t,n){if(n&z.Optional)return i;Wa(t,"NodeInjector")}function A_(i,t,n,s){if(n&z.Optional&&void 0===s&&(s=null),0==(n&(z.Self|z.Host))){const a=i[9],u=Pi(void 0);try{return a?a.get(t,s,n&z.Optional):Jg(t,s,n&z.Optional)}finally{Pi(u)}}return D_(s,t,n)}function w_(i,t,n,s=z.Default,a){if(null!==i){const u=function(i){if("string"==typeof i)return i.charCodeAt(0)||0;const t=i.hasOwnProperty(as)?i[as]:void 0;return"number"==typeof t?t>=0?255&t:dA:t}(n);if("function"==typeof u){if(!__(t,i,s))return s&z.Host?D_(a,n,s):A_(t,n,s,a);try{const h=u(s);if(null!=h||s&z.Optional)return h;Wa(n)}finally{v_()}}else if("number"==typeof u){let h=null,d=Qc(i,t),f=-1,g=s&z.Host?t[16][6]:null;for((-1===d||s&z.SkipSelf)&&(f=-1===d?ll(i,t):t[d+8],-1!==f&&N_(s,!1)?(h=t[1],d=Jo(f),t=$o(f,t)):d=-1);-1!==d;){const m=t[1];if(O_(u,d,m.data)){const E=pA(d,t,n,h,s,g);if(E!==M_)return E}f=t[d+8],-1!==f&&N_(s,t[1].data[d+8]===g)&&O_(u,d,t)?(h=m,d=Jo(f),t=$o(f,t)):d=-1}}}return A_(t,n,s,a)}const M_={};function dA(){return new qo(tt(),O())}function pA(i,t,n,s,a,u){const h=t[1],d=h.data[i+8],m=cl(d,h,n,null==s?Ja(d)&&$c:s!=h&&0!=(3&d.type),a&z.Host&&u===d);return null!==m?gs(t,h,m,d):M_}function cl(i,t,n,s,a){const u=i.providerIndexes,h=t.data,d=1048575&u,f=i.directiveStart,m=u>>20,T=a?d+m:i.directiveEnd;for(let y=s?d:d+m;y<T;y++){const C=h[y];if(y<f&&n===C||y>=f&&C.type===n)return y}if(a){const y=h[f];if(y&&In(y)&&y.type===n)return f}return null}function gs(i,t,n,s){let a=i[n];const u=t.data;if(function(i){return i instanceof ds}(a)){const h=a;h.resolving&&function(i,t){throw new ro("200",`Circular dependency in DI detected for ${i}`)}(Rt(u[n]));const d=al(h.canSeeViewProviders);h.resolving=!0;const f=h.injectImpl?Pi(h.injectImpl):null;__(i,s,z.Default);try{a=i[n]=h.factory(void 0,u,i,s),t.firstCreatePass&&n>=s.directiveStart&&function(i,t,n){const{ngOnChanges:s,ngOnInit:a,ngDoCheck:u}=t.type.prototype;if(s){const h=i_(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(i,h),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(i,h)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-i,a),u&&((n.preOrderHooks||(n.preOrderHooks=[])).push(i,u),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(i,u))}(n,u[n],t)}finally{null!==f&&Pi(f),al(d),h.resolving=!1,v_()}}return a}function O_(i,t,n){return!!(n[t+(i>>5)]&1<<i)}function N_(i,t){return!(i&z.Self||i&z.Host&&t)}class qo{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,s){return w_(this._tNode,this._lView,t,s,n)}}function Zc(i){return Xg(i)?()=>{const t=Zc(W(i));return t&&t()}:ho(i)}const er="__parameters__";function po(i,t,n){return xi(()=>{const s=function(i){return function(...n){if(i){const s=i(...n);for(const a in s)this[a]=s[a]}}}(t);function a(...u){if(this instanceof a)return s.apply(this,u),this;const h=new a(...u);return d.annotation=h,d;function d(f,g,m){const E=f.hasOwnProperty(er)?f[er]:Object.defineProperty(f,er,{value:[]})[er];for(;E.length<=m;)E.push(null);return(E[m]=E[m]||[]).push(h),f}}return n&&(a.prototype=Object.create(n.prototype)),a.prototype.ngMetadataName=i,a.annotationCls=a,a})}class K{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=ee({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const mA=new K("AnalyzeForEntryComponents");function an(i,t){void 0===t&&(t=i);for(let n=0;n<i.length;n++){let s=i[n];Array.isArray(s)?(t===i&&(t=i.slice(0,n)),an(s,t)):t!==i&&t.push(s)}return t}function Xn(i,t){i.forEach(n=>Array.isArray(n)?Xn(n,t):t(n))}function hl(i,t,n){t>=i.length?i.push(n):i.splice(t,0,n)}function fo(i,t){return t>=i.length-1?i.pop():i.splice(t,1)[0]}function Hi(i,t){const n=[];for(let s=0;s<i;s++)n.push(t);return n}function zt(i,t,n){let s=nr(i,t);return s>=0?i[1|s]=n:(s=~s,function(i,t,n,s){let a=i.length;if(a==t)i.push(n,s);else if(1===a)i.push(s,i[0]),i[0]=n;else{for(a--,i.push(i[a-1],i[a]);a>t;)i[a]=i[a-2],a--;i[t]=n,i[t+1]=s}}(i,s,t,n)),s}function nh(i,t){const n=nr(i,t);if(n>=0)return i[1|n]}function nr(i,t){return function(i,t,n){let s=0,a=i.length>>n;for(;a!==s;){const u=s+(a-s>>1),h=i[u<<n];if(t===h)return u<<n;h>t?a=u:s=u+1}return~(a<<n)}(i,t,1)}const vs={},oh="__NG_DI_FLAG__",ir="ngTempTokenPath",DA=/\n/gm,rh="__source",sh=ye({provide:String,useValue:ye});let ys;function or(i){const t=ys;return ys=i,t}function wA(i,t=z.Default){if(void 0===ys)throw new Error("inject() must be called from an injection context");return null===ys?Jg(i,void 0,t):ys.get(i,t&z.Optional?null:void 0,t)}function P(i,t=z.Default){return(wc||wA)(W(i),t)}function go(i){const t=[];for(let n=0;n<i.length;n++){const s=W(i[n]);if(Array.isArray(s)){if(0===s.length)throw new Error("Arguments array must have arguments.");let a,u=z.Default;for(let h=0;h<s.length;h++){const d=s[h],f=MA(d);"number"==typeof f?-1===f?a=d.token:u|=f:a=d}t.push(P(a,u))}else t.push(P(s))}return t}function Cs(i,t){return i[oh]=t,i.prototype[oh]=t,i}function MA(i){return i[oh]}function V_(i,t,n,s){const a=i[ir];throw t[rh]&&a.unshift(t[rh]),i.message=function(i,t,n,s=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.substr(2):i;let a=he(t);if(Array.isArray(t))a=t.map(he).join(" -> ");else if("object"==typeof t){let u=[];for(let h in t)if(t.hasOwnProperty(h)){let d=t[h];u.push(h+":"+("string"==typeof d?JSON.stringify(d):he(d)))}a=`{${u.join(", ")}}`}return`${n}${s?"("+s+")":""}[${a}]: ${i.replace(DA,"\n  ")}`}("\n"+i.message,a,n,s),i.ngTokenPath=a,i[ir]=null,i}const rr=Cs(po("Inject",i=>({token:i})),-1),Ut=Cs(po("Optional"),8),Gi=Cs(po("SkipSelf"),4);const im="__ngContext__";function Et(i,t){i[im]=t}function _h(i){const t=function(i){return i[im]||null}(i);return t?Array.isArray(t)?t:t.lView:null}function El(i){return i.ngOriginalError}function bw(i,...t){i.error(...t)}class mo{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t),s=this._findContext(t),a=(i=t)&&i.ngErrorLogger||bw;var i;a(this._console,"ERROR",t),n&&a(this._console,"ORIGINAL ERROR",n),s&&a(this._console,"ERROR CONTEXT",s)}_findContext(t){return t?t.ngDebugContext||this._findContext(El(t)):null}_findOriginalError(t){let n=t&&El(t);for(;n&&El(n);)n=El(n);return n||null}}const dm=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Ee))();function Yn(i){return i instanceof Function?i():i}var Yt=(()=>((Yt=Yt||{})[Yt.Important=1]="Important",Yt[Yt.DashCase=2]="DashCase",Yt))();function Th(i,t){return undefined(i,t)}function As(i){const t=i[3];return Sn(t)?t[3]:t}function vh(i){return mm(i[13])}function yh(i){return mm(i[4])}function mm(i){for(;null!==i&&!Sn(i);)i=i[4];return i}function ur(i,t,n,s,a){if(null!=s){let u,h=!1;Sn(s)?u=s:Wn(s)&&(h=!0,s=s[0]);const d=$e(s);0===i&&null!==n?null==a?bm(t,n,d):Eo(t,n,d,a||null,!0):1===i&&null!==n?Eo(t,n,d,a||null,!0):2===i?function(i,t,n){const s=vl(i,t);s&&function(i,t,n,s){Ge(i)?i.removeChild(t,n,s):t.removeChild(n)}(i,s,t,n)}(t,d,h):3===i&&t.destroyNode(d),null!=u&&function(i,t,n,s,a){const u=n[7];u!==$e(n)&&ur(t,i,s,u,a);for(let d=10;d<n.length;d++){const f=n[d];ws(f[1],f,i,t,s,u)}}(t,i,u,n,a)}}function bh(i,t,n){return Ge(i)?i.createElement(t,n):null===n?i.createElement(t):i.createElementNS(n,t)}function Tm(i,t){const n=i[9],s=n.indexOf(t),a=t[3];1024&t[2]&&(t[2]&=-1025,Hc(a,-1)),n.splice(s,1)}function Sh(i,t){if(i.length<=10)return;const n=10+t,s=i[n];if(s){const a=s[17];null!==a&&a!==i&&Tm(a,s),t>0&&(i[n-1][4]=s[4]);const u=fo(i,10+t);!function(i,t){ws(i,t,t[11],2,null,null),t[0]=null,t[6]=null}(s[1],s);const h=u[19];null!==h&&h.detachView(u[1]),s[3]=null,s[4]=null,s[2]&=-129}return s}function vm(i,t){if(!(256&t[2])){const n=t[11];Ge(n)&&n.destroyNode&&ws(i,t,n,3,null,null),function(i){let t=i[13];if(!t)return Ih(i[1],i);for(;t;){let n=null;if(Wn(t))n=t[13];else{const s=t[10];s&&(n=s)}if(!n){for(;t&&!t[4]&&t!==i;)Wn(t)&&Ih(t[1],t),t=t[3];null===t&&(t=i),Wn(t)&&Ih(t[1],t),n=t&&t[4]}t=n}}(t)}}function Ih(i,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(i,t){let n;if(null!=i&&null!=(n=i.destroyHooks))for(let s=0;s<n.length;s+=2){const a=t[n[s]];if(!(a instanceof ds)){const u=n[s+1];if(Array.isArray(u))for(let h=0;h<u.length;h+=2){const d=a[u[h]],f=u[h+1];try{f.call(d)}finally{}}else try{u.call(a)}finally{}}}}(i,t),function(i,t){const n=i.cleanup,s=t[7];let a=-1;if(null!==n)for(let u=0;u<n.length-1;u+=2)if("string"==typeof n[u]){const h=n[u+1],d="function"==typeof h?h(t):$e(t[h]),f=s[a=n[u+2]],g=n[u+3];"boolean"==typeof g?d.removeEventListener(n[u],f,g):g>=0?s[a=g]():s[a=-g].unsubscribe(),u+=2}else{const h=s[a=n[u+1]];n[u].call(h)}if(null!==s){for(let u=a+1;u<s.length;u++)s[u]();t[7]=null}}(i,t),1===t[1].type&&Ge(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&Sn(t[3])){n!==t[3]&&Tm(n,t);const s=t[19];null!==s&&s.detachView(i)}}}function ym(i,t,n){return function(i,t,n){let s=t;for(;null!==s&&40&s.type;)s=(t=s).parent;if(null===s)return n[0];if(2&s.flags){const a=i.data[s.directiveStart].encapsulation;if(a===Ft.None||a===Ft.Emulated)return null}return sn(s,n)}(i,t.parent,n)}function Eo(i,t,n,s,a){Ge(i)?i.insertBefore(t,n,s,a):t.insertBefore(n,s,a)}function bm(i,t,n){Ge(i)?i.appendChild(t,n):t.appendChild(n)}function Sm(i,t,n,s,a){null!==s?Eo(i,t,n,s,a):bm(i,t,n)}function vl(i,t){return Ge(i)?i.parentNode(t):t.parentNode}function Im(i,t,n){return Dm(i,t,n)}let Dm=function(i,t,n){return 40&i.type?sn(i,n):null};function yl(i,t,n,s){const a=ym(i,s,t),u=t[11],d=Im(s.parent||t[6],s,t);if(null!=a)if(Array.isArray(n))for(let f=0;f<n.length;f++)Sm(u,a,n[f],d,!1);else Sm(u,a,n,d,!1)}function Cl(i,t){if(null!==t){const n=t.type;if(3&n)return sn(t,i);if(4&n)return Dh(-1,i[t.index]);if(8&n){const s=t.child;if(null!==s)return Cl(i,s);{const a=i[t.index];return Sn(a)?Dh(-1,a):$e(a)}}if(32&n)return Th(t,i)()||$e(i[t.index]);{const s=wm(i,t);return null!==s?Array.isArray(s)?s[0]:Cl(As(i[16]),s):Cl(i,t.next)}}return null}function wm(i,t){return null!==t?i[16][6].projection[t.projection]:null}function Dh(i,t){const n=10+i+1;if(n<t.length){const s=t[n],a=s[1].firstChild;if(null!==a)return Cl(s,a)}return t[7]}function Ah(i,t,n,s,a,u,h){for(;null!=n;){const d=s[n.index],f=n.type;if(h&&0===t&&(d&&Et($e(d),s),n.flags|=4),64!=(64&n.flags))if(8&f)Ah(i,t,n.child,s,a,u,!1),ur(t,i,a,d,u);else if(32&f){const g=Th(n,s);let m;for(;m=g();)ur(t,i,a,m,u);ur(t,i,a,d,u)}else 16&f?Om(i,t,s,n,a,u):ur(t,i,a,d,u);n=h?n.projectionNext:n.next}}function ws(i,t,n,s,a,u){Ah(n,s,i.firstChild,t,a,u,!1)}function Om(i,t,n,s,a,u){const h=n[16],f=h[6].projection[s.projection];if(Array.isArray(f))for(let g=0;g<f.length;g++)ur(t,i,a,f[g],u);else Ah(i,t,f,h[3],a,u,!0)}function Nm(i,t,n){Ge(i)?i.setAttribute(t,"style",n):t.style.cssText=n}function wh(i,t,n){Ge(i)?""===n?i.removeAttribute(t,"class"):i.setAttribute(t,"class",n):t.className=n}function km(i,t,n){let s=i.length;for(;;){const a=i.indexOf(t,n);if(-1===a)return a;if(0===a||i.charCodeAt(a-1)<=32){const u=t.length;if(a+u===s||i.charCodeAt(a+u)<=32)return a}n=a+1}}const Lm="ng-template";function Jw(i,t,n){let s=0;for(;s<i.length;){let a=i[s++];if(n&&"class"===a){if(a=i[s],-1!==km(a.toLowerCase(),t,0))return!0}else if(1===a){for(;s<i.length&&"string"==typeof(a=i[s++]);)if(a.toLowerCase()===t)return!0;return!1}}return!1}function Pm(i){return 4===i.type&&i.value!==Lm}function $w(i,t,n){return t===(4!==i.type||n?i.value:Lm)}function qw(i,t,n){let s=4;const a=i.attrs||[],u=function(i){for(let t=0;t<i.length;t++)if(C_(i[t]))return t;return i.length}(a);let h=!1;for(let d=0;d<t.length;d++){const f=t[d];if("number"!=typeof f){if(!h)if(4&s){if(s=2|1&s,""!==f&&!$w(i,f,n)||""===f&&1===t.length){if(Dn(s))return!1;h=!0}}else{const g=8&s?f:t[++d];if(8&s&&null!==i.attrs){if(!Jw(i.attrs,g,n)){if(Dn(s))return!1;h=!0}continue}const E=Qw(8&s?"class":f,a,Pm(i),n);if(-1===E){if(Dn(s))return!1;h=!0;continue}if(""!==g){let T;T=E>u?"":a[E+1].toLowerCase();const y=8&s?T:null;if(y&&-1!==km(y,g,0)||2&s&&g!==T){if(Dn(s))return!1;h=!0}}}}else{if(!h&&!Dn(s)&&!Dn(f))return!1;if(h&&Dn(f))continue;h=!1,s=f|1&s}}return Dn(s)||h}function Dn(i){return 0==(1&i)}function Qw(i,t,n,s){if(null===t)return-1;let a=0;if(s||!n){let u=!1;for(;a<t.length;){const h=t[a];if(h===i)return a;if(3===h||6===h)u=!0;else{if(1===h||2===h){let d=t[++a];for(;"string"==typeof d;)d=t[++a];continue}if(4===h)break;if(0===h){a+=4;continue}}a+=u?1:2}return-1}return function(i,t){let n=i.indexOf(4);if(n>-1)for(n++;n<i.length;){const s=i[n];if("number"==typeof s)return-1;if(s===t)return n;n++}return-1}(t,i)}function xm(i,t,n=!1){for(let s=0;s<t.length;s++)if(qw(i,t[s],n))return!0;return!1}function nM(i,t){e:for(let n=0;n<t.length;n++){const s=t[n];if(i.length===s.length){for(let a=0;a<i.length;a++)if(i[a]!==s[a])continue e;return!0}}return!1}function Fm(i,t){return i?":not("+t.trim()+")":t}function iM(i){let t=i[0],n=1,s=2,a="",u=!1;for(;n<i.length;){let h=i[n];if("string"==typeof h)if(2&s){const d=i[++n];a+="["+h+(d.length>0?'="'+d+'"':"")+"]"}else 8&s?a+="."+h:4&s&&(a+=" "+h);else""!==a&&!Dn(h)&&(t+=Fm(u,a),a=""),s=h,u=u||!Dn(s);n++}return""!==a&&(t+=Fm(u,a)),t}const se={};function Jn(i){Vm(_e(),O(),At()+i,Qa())}function Vm(i,t,n,s){if(!s)if(3==(3&t[2])){const u=i.preOrderCheckHooks;null!==u&&il(t,u,n)}else{const u=i.preOrderHooks;null!==u&&ol(t,u,0,n)}Bi(n)}function bl(i,t){return i<<17|t<<2}function An(i){return i>>17&32767}function Mh(i){return 2|i}function mi(i){return(131068&i)>>2}function Oh(i,t){return-131069&i|t<<2}function Nh(i){return 1|i}function Ym(i,t){const n=i.contentQueries;if(null!==n)for(let s=0;s<n.length;s+=2){const a=n[s],u=n[s+1];if(-1!==u){const h=i.data[u];zc(a),h.contentQueries(2,t[u],u)}}}function Ms(i,t,n,s,a,u,h,d,f,g){const m=t.blueprint.slice();return m[0]=a,m[2]=140|s,c_(m),m[3]=m[15]=i,m[8]=n,m[10]=h||i&&i[10],m[11]=d||i&&i[11],m[12]=f||i&&i[12]||null,m[9]=g||i&&i[9]||null,m[6]=u,m[16]=2==t.type?i[16]:m,m}function cr(i,t,n,s,a){let u=i.data[t];if(null===u)u=function(i,t,n,s,a){const u=d_(),h=Gc(),f=i.data[t]=function(i,t,n,s,a,u){return{type:n,index:s,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:a,attrs:u,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,h?u:u&&u.parent,n,t,s,a);return null===i.firstChild&&(i.firstChild=f),null!==u&&(h?null==u.child&&null!==f.parent&&(u.child=f):null===u.next&&(u.next=f)),f}(i,t,n,s,a),te.lFrame.inI18n&&(u.flags|=64);else if(64&u.type){u.type=n,u.value=s,u.attrs=a;const h=function(){const i=te.lFrame,t=i.currentTNode;return i.isParent?t:t.parent}();u.injectorIndex=null===h?-1:h.injectorIndex}return jn(u,!0),u}function hr(i,t,n,s){if(0===n)return-1;const a=t.length;for(let u=0;u<n;u++)t.push(s),i.blueprint.push(s),i.data.push(null);return a}function Os(i,t,n){el(t);try{const s=i.viewQuery;null!==s&&Yh(1,s,n);const a=i.template;null!==a&&Jm(i,t,a,1,n),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&Ym(i,t),i.staticViewQueries&&Yh(2,i.viewQuery,n);const u=i.components;null!==u&&function(i,t){for(let n=0;n<t.length;n++)xM(i,t[n])}(t,u)}catch(s){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),s}finally{t[2]&=-5,tl()}}function dr(i,t,n,s){const a=t[2];if(256==(256&a))return;el(t);const u=Qa();try{c_(t),function(i){te.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==n&&Jm(i,t,n,2,s);const h=3==(3&a);if(!u)if(h){const g=i.preOrderCheckHooks;null!==g&&il(t,g,null)}else{const g=i.preOrderHooks;null!==g&&ol(t,g,0,null),Kc(t,0)}if(function(i){for(let t=vh(i);null!==t;t=yh(t)){if(!t[2])continue;const n=t[9];for(let s=0;s<n.length;s++){const a=n[s],u=a[3];0==(1024&a[2])&&Hc(u,1),a[2]|=1024}}}(t),function(i){for(let t=vh(i);null!==t;t=yh(t))for(let n=10;n<t.length;n++){const s=t[n],a=s[1];Uc(s)&&dr(a,s,a.template,s[8])}}(t),null!==i.contentQueries&&Ym(i,t),!u)if(h){const g=i.contentCheckHooks;null!==g&&il(t,g)}else{const g=i.contentHooks;null!==g&&ol(t,g,1),Kc(t,1)}!function(i,t){const n=i.hostBindingOpCodes;if(null!==n)try{for(let s=0;s<n.length;s++){const a=n[s];if(a<0)Bi(~a);else{const u=a,h=n[++s],d=n[++s];zD(h,u),d(2,t[u])}}}finally{Bi(-1)}}(i,t);const d=i.components;null!==d&&function(i,t){for(let n=0;n<t.length;n++)PM(i,t[n])}(t,d);const f=i.viewQuery;if(null!==f&&Yh(2,f,s),!u)if(h){const g=i.viewCheckHooks;null!==g&&il(t,g)}else{const g=i.viewHooks;null!==g&&ol(t,g,2),Kc(t,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),u||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Hc(t[3],-1))}finally{tl()}}function _M(i,t,n,s){const a=t[10],u=!Qa(),h=u_(t);try{u&&!h&&a.begin&&a.begin(),h&&Os(i,t,s),dr(i,t,n,s)}finally{u&&!h&&a.end&&a.end()}}function Jm(i,t,n,s,a){const u=At(),h=2&s;try{Bi(-1),h&&t.length>20&&Vm(i,t,20,Qa()),n(s,a)}finally{Bi(u)}}function Uh(i,t,n){!h_()||(function(i,t,n,s){const a=n.directiveStart,u=n.directiveEnd;i.firstCreatePass||fs(n,t),Et(s,t);const h=n.initialInputs;for(let d=a;d<u;d++){const f=i.data[d],g=In(f);g&&MM(t,n,f);const m=gs(t,i,d,n);Et(m,t),null!==h&&OM(0,d-a,m,f,0,h),g&&(Xt(n.index,t)[8]=m)}}(i,t,n,sn(n,t)),128==(128&n.flags)&&function(i,t,n){const s=n.directiveStart,a=n.directiveEnd,h=n.index,d=te.lFrame.currentDirectiveIndex;try{Bi(h);for(let f=s;f<a;f++){const g=i.data[f],m=t[f];jc(f),(null!==g.hostBindings||0!==g.hostVars||null!==g.hostAttrs)&&oE(g,m)}}finally{Bi(-1),jc(d)}}(i,t,n))}function Hh(i,t,n=sn){const s=t.localNames;if(null!==s){let a=t.index+1;for(let u=0;u<s.length;u+=2){const h=s[u+1],d=-1===h?n(t,i):i[h];i[a++]=d}}}function qm(i){const t=i.tView;return null===t||t.incompleteFirstPass?i.tView=Rl(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):t}function Rl(i,t,n,s,a,u,h,d,f,g){const m=20+s,E=m+a,T=function(i,t){const n=[];for(let s=0;s<t;s++)n.push(s<i?null:se);return n}(m,E),y="function"==typeof g?g():g;return T[1]={type:i,blueprint:T,template:n,queries:null,viewQuery:d,declTNode:t,data:T.slice().fill(null,m),bindingStartIndex:m,expandoStartIndex:E,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof u?u():u,pipeRegistry:"function"==typeof h?h():h,firstChild:null,schemas:f,consts:y,incompleteFirstPass:!1}}function eE(i,t,n,s){const a=cE(t);null===n?a.push(s):(a.push(n),i.firstCreatePass&&hE(i).push(s,a.length-1))}function tE(i,t,n){for(let s in i)if(i.hasOwnProperty(s)){const a=i[s];(n=null===n?{}:n).hasOwnProperty(s)?n[s].push(t,a):n[s]=[t,a]}return n}function Gh(i,t,n,s){let a=!1;if(h_()){const u=function(i,t,n){const s=i.directiveRegistry;let a=null;if(s)for(let u=0;u<s.length;u++){const h=s[u];xm(n,h.selectors,!1)&&(a||(a=[]),ul(fs(n,t),i,h.type),In(h)?(rE(i,n),a.unshift(h)):a.push(h))}return a}(i,t,n),h=null===s?null:{"":-1};if(null!==u){a=!0,sE(n,i.data.length,u.length);for(let m=0;m<u.length;m++){const E=u[m];E.providersResolver&&E.providersResolver(E)}let d=!1,f=!1,g=hr(i,t,u.length,null);for(let m=0;m<u.length;m++){const E=u[m];n.mergedAttrs=sl(n.mergedAttrs,E.hostAttrs),aE(i,n,t,g,E),wM(g,E,h),null!==E.contentQueries&&(n.flags|=8),(null!==E.hostBindings||null!==E.hostAttrs||0!==E.hostVars)&&(n.flags|=128);const T=E.type.prototype;!d&&(T.ngOnChanges||T.ngOnInit||T.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(n.index),d=!0),!f&&(T.ngOnChanges||T.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(n.index),f=!0),g++}!function(i,t){const s=t.directiveEnd,a=i.data,u=t.attrs,h=[];let d=null,f=null;for(let g=t.directiveStart;g<s;g++){const m=a[g],E=m.inputs,T=null===u||Pm(t)?null:NM(E,u);h.push(T),d=tE(E,g,d),f=tE(m.outputs,g,f)}null!==d&&(d.hasOwnProperty("class")&&(t.flags|=16),d.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=h,t.inputs=d,t.outputs=f}(i,n)}h&&function(i,t,n){if(t){const s=i.localNames=[];for(let a=0;a<t.length;a+=2){const u=n[t[a+1]];if(null==u)throw new ro("301",`Export of name '${t[a+1]}' not found!`);s.push(t[a],u)}}}(n,s,h)}return n.mergedAttrs=sl(n.mergedAttrs,n.attrs),a}function iE(i,t,n,s,a,u){const h=u.hostBindings;if(h){let d=i.hostBindingOpCodes;null===d&&(d=i.hostBindingOpCodes=[]);const f=~t.index;(function(i){let t=i.length;for(;t>0;){const n=i[--t];if("number"==typeof n&&n<0)return n}return 0})(d)!=f&&d.push(f),d.push(s,a,h)}}function oE(i,t){null!==i.hostBindings&&i.hostBindings(1,t)}function rE(i,t){t.flags|=2,(i.components||(i.components=[])).push(t.index)}function wM(i,t,n){if(n){if(t.exportAs)for(let s=0;s<t.exportAs.length;s++)n[t.exportAs[s]]=i;In(t)&&(n[""]=i)}}function sE(i,t,n){i.flags|=1,i.directiveStart=t,i.directiveEnd=t+n,i.providerIndexes=t}function aE(i,t,n,s,a){i.data[s]=a;const u=a.factory||(a.factory=ho(a.type)),h=new ds(u,In(a),null);i.blueprint[s]=h,n[s]=h,iE(i,t,0,s,hr(i,n,a.hostVars,se),a)}function MM(i,t,n){const s=sn(t,i),a=qm(n),u=i[10],h=Dl(i,Ms(i,a,null,n.onPush?64:16,s,t,u,u.createRenderer(s,n),null,null));i[t.index]=h}function $n(i,t,n,s,a,u){const h=sn(i,t);!function(i,t,n,s,a,u,h){if(null==u)Ge(i)?i.removeAttribute(t,a,n):t.removeAttribute(a);else{const d=null==h?re(u):h(u,s||"",a);Ge(i)?i.setAttribute(t,a,d,n):n?t.setAttributeNS(n,a,d):t.setAttribute(a,d)}}(t[11],h,u,i.value,n,s,a)}function OM(i,t,n,s,a,u){const h=u[t];if(null!==h){const d=s.setInput;for(let f=0;f<h.length;){const g=h[f++],m=h[f++],E=h[f++];null!==d?s.setInput(n,E,g,m):n[m]=E}}}function NM(i,t){let n=null,s=0;for(;s<t.length;){const a=t[s];if(0!==a)if(5!==a){if("number"==typeof a)break;i.hasOwnProperty(a)&&(null===n&&(n=[]),n.push(a,i[a],t[s+1])),s+=2}else s+=2;else s+=4}return n}function lE(i,t,n,s){return new Array(i,!0,!1,t,null,0,s,n,null,null)}function PM(i,t){const n=Xt(t,i);if(Uc(n)){const s=n[1];80&n[2]?dr(s,n,s.template,n[8]):n[5]>0&&jh(n)}}function jh(i){for(let s=vh(i);null!==s;s=yh(s))for(let a=10;a<s.length;a++){const u=s[a];if(1024&u[2]){const h=u[1];dr(h,u,h.template,u[8])}else u[5]>0&&jh(u)}const n=i[1].components;if(null!==n)for(let s=0;s<n.length;s++){const a=Xt(n[s],i);Uc(a)&&a[5]>0&&jh(a)}}function xM(i,t){const n=Xt(t,i),s=n[1];(function(i,t){for(let n=t.length;n<i.blueprint.length;n++)t.push(i.blueprint[n])})(s,n),Os(s,n,n[8])}function Dl(i,t){return i[13]?i[14][4]=t:i[13]=t,i[14]=t,t}function Xh(i){for(;i;){i[2]|=64;const t=As(i);if(RD(i)&&!t)return i;i=t}return null}function Kh(i,t,n){const s=t[10];s.begin&&s.begin();try{dr(i,t,i.template,n)}catch(a){throw pE(t,a),a}finally{s.end&&s.end()}}function uE(i){!function(i){for(let t=0;t<i.components.length;t++){const n=i.components[t],s=_h(n),a=s[1];_M(a,s,a.template,n)}}(i[8])}function Yh(i,t,n){zc(0),t(i,n)}const HM=(()=>Promise.resolve(null))();function cE(i){return i[7]||(i[7]=[])}function hE(i){return i.cleanup||(i.cleanup=[])}function pE(i,t){const n=i[9],s=n?n.get(mo,null):null;s&&s.handleError(t)}function fE(i,t,n,s,a){for(let u=0;u<n.length;){const h=n[u++],d=n[u++],f=t[h],g=i.data[h];null!==g.setInput?g.setInput(f,a,s,d):f[d]=a}}function Al(i,t,n){let s=n?i.styles:null,a=n?i.classes:null,u=0;if(null!==t)for(let h=0;h<t.length;h++){const d=t[h];"number"==typeof d?u=d:1==u?a=Rc(a,d):2==u&&(s=Rc(s,d+": "+t[++h]+";"))}n?i.styles=s:i.stylesWithoutHost=s,n?i.classes=a:i.classesWithoutHost=a}const Ns=new K("INJECTOR",-1);class gE{get(t,n=vs){if(n===vs){const s=new Error(`NullInjectorError: No provider for ${he(t)}!`);throw s.name="NullInjectorError",s}return n}}const ks=new K("Set Injector scope."),Ls={},jM={};let Jh;function _E(){return void 0===Jh&&(Jh=new gE),Jh}function mE(i,t=null,n=null,s){return new zM(i,n,t||_E(),s)}class zM{constructor(t,n,s,a=null){this.parent=s,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const u=[];n&&Xn(n,d=>this.processProvider(d,t,n)),Xn([t],d=>this.processInjectorType(d,[],u)),this.records.set(Ns,pr(void 0,this));const h=this.records.get(ks);this.scope=null!=h?h.value:null,this.source=a||("object"==typeof t?null:he(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,n=vs,s=z.Default){this.assertNotDestroyed();const a=or(this),u=Pi(void 0);try{if(!(s&z.SkipSelf)){let d=this.records.get(t);if(void 0===d){const f=("function"==typeof(i=t)||"object"==typeof i&&i instanceof K)&&pi(t);d=f&&this.injectableDefInScope(f)?pr($h(t),Ls):null,this.records.set(t,d)}if(null!=d)return this.hydrate(t,d)}return(s&z.Self?_E():this.parent).get(t,n=s&z.Optional&&n===vs?null:n)}catch(h){if("NullInjectorError"===h.name){if((h[ir]=h[ir]||[]).unshift(he(t)),a)throw h;return V_(h,t,"R3InjectorError",this.source)}throw h}finally{Pi(u),or(a)}var i}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((s,a)=>t.push(he(a))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,n,s){if(!(t=W(t)))return!1;let a=Kg(t);const u=null==a&&t.ngModule||void 0,h=void 0===u?t:u,d=-1!==s.indexOf(h);if(void 0!==u&&(a=Kg(u)),null==a)return!1;if(null!=a.imports&&!d){let m;s.push(h);try{Xn(a.imports,E=>{this.processInjectorType(E,n,s)&&(void 0===m&&(m=[]),m.push(E))})}finally{}if(void 0!==m)for(let E=0;E<m.length;E++){const{ngModule:T,providers:y}=m[E];Xn(y,C=>this.processProvider(C,T,y||be))}}this.injectorDefTypes.add(h);const f=ho(h)||(()=>new h);this.records.set(h,pr(f,Ls));const g=a.providers;if(null!=g&&!d){const m=t;Xn(g,E=>this.processProvider(E,m,g))}return void 0!==u&&void 0!==t.providers}processProvider(t,n,s){let a=fr(t=W(t))?t:W(t&&t.provide);const u=(i=t,TE(i)?pr(void 0,i.useValue):pr(EE(i),Ls));var i;if(fr(t)||!0!==t.multi)this.records.get(a);else{let h=this.records.get(a);h||(h=pr(void 0,Ls,!0),h.factory=()=>go(h.multi),this.records.set(a,h)),a=t,h.multi.push(t)}this.records.set(a,u)}hydrate(t,n){return n.value===Ls&&(n.value=jM,n.value=n.factory()),"object"==typeof n.value&&n.value&&null!==(i=n.value)&&"object"==typeof i&&"function"==typeof i.ngOnDestroy&&this.onDestroy.add(n.value),n.value;var i}injectableDefInScope(t){if(!t.providedIn)return!1;const n=W(t.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function $h(i){const t=pi(i),n=null!==t?t.factory:ho(i);if(null!==n)return n;if(i instanceof K)throw new Error(`Token ${he(i)} is missing a \u0275prov definition.`);if(i instanceof Function)return function(i){const t=i.length;if(t>0){const s=Hi(t,"?");throw new Error(`Can't resolve all parameters for ${he(i)}: (${s.join(", ")}).`)}const n=function(i){const t=i&&(i[ja]||i[Yg]);if(t){const n=function(i){if(i.hasOwnProperty("name"))return i.name;const t=(""+i).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(i);return null!==n?()=>n.factory(i):()=>new i}(i);throw new Error("unreachable")}function EE(i,t,n){let s;if(fr(i)){const a=W(i);return ho(a)||$h(a)}if(TE(i))s=()=>W(i.useValue);else if(function(i){return!(!i||!i.useFactory)}(i))s=()=>i.useFactory(...go(i.deps||[]));else if(function(i){return!(!i||!i.useExisting)}(i))s=()=>P(W(i.useExisting));else{const a=W(i&&(i.useClass||i.provide));if(!function(i){return!!i.deps}(i))return ho(a)||$h(a);s=()=>new a(...go(i.deps))}return s}function pr(i,t,n=!1){return{factory:i,value:t,multi:n?[]:void 0}}function TE(i){return null!==i&&"object"==typeof i&&sh in i}function fr(i){return"function"==typeof i}const vE=function(i,t,n){return function(i,t=null,n=null,s){const a=mE(i,t,n,s);return a._resolveInjectorDefTypes(),a}({name:n},t,i,n)};let Ce=(()=>{class i{static create(n,s){return Array.isArray(n)?vE(n,s,""):vE(n.providers,n.parent,n.name||"")}}return i.THROW_IF_NOT_FOUND=vs,i.NULL=new gE,i.\u0275prov=ee({token:i,providedIn:"any",factory:()=>P(Ns)}),i.__NG_ELEMENT_ID__=-1,i})();function pO(i,t){nl(_h(i)[1],tt())}function we(i){let t=function(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),n=!0;const s=[i];for(;t;){let a;if(In(i))a=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");a=t.\u0275dir}if(a){if(n){s.push(a);const h=i;h.inputs=nd(i.inputs),h.declaredInputs=nd(i.declaredInputs),h.outputs=nd(i.outputs);const d=a.hostBindings;d&&mO(i,d);const f=a.viewQuery,g=a.contentQueries;if(f&&gO(i,f),g&&_O(i,g),Ic(i.inputs,a.inputs),Ic(i.declaredInputs,a.declaredInputs),Ic(i.outputs,a.outputs),In(a)&&a.data.animation){const m=i.data;m.animation=(m.animation||[]).concat(a.data.animation)}}const u=a.features;if(u)for(let h=0;h<u.length;h++){const d=u[h];d&&d.ngInherit&&d(i),d===we&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(i){let t=0,n=null;for(let s=i.length-1;s>=0;s--){const a=i[s];a.hostVars=t+=a.hostVars,a.hostAttrs=sl(a.hostAttrs,n=sl(n,a.hostAttrs))}}(s)}function nd(i){return i===Go?{}:i===be?[]:i}function gO(i,t){const n=i.viewQuery;i.viewQuery=n?(s,a)=>{t(s,a),n(s,a)}:t}function _O(i,t){const n=i.contentQueries;i.contentQueries=n?(s,a,u)=>{t(s,a,u),n(s,a,u)}:t}function mO(i,t){const n=i.hostBindings;i.hostBindings=n?(s,a)=>{t(s,a),n(s,a)}:t}let wl=null;function gr(){if(!wl){const i=Ee.Symbol;if(i&&i.iterator)wl=i.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<t.length;++n){const s=t[n];"entries"!==s&&"size"!==s&&Map.prototype[s]===Map.prototype.entries&&(wl=s)}}}return wl}function xs(i){return!!id(i)&&(Array.isArray(i)||!(i instanceof Map)&&gr()in i)}function id(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function Tt(i,t,n){return!Object.is(i[t],n)&&(i[t]=n,!0)}function cn(i,t,n,s){const a=O();return Tt(a,Yo(),t)&&(_e(),$n(We(),a,i,t,n,s)),cn}function M(i,t=z.Default){const n=O();return null===n?P(i,t):w_(tt(),n,W(i),t)}function ld(){throw new Error("invalid")}function Qn(i,t,n){const s=O();return Tt(s,Yo(),t)&&function(i,t,n,s,a,u,h,d){const f=sn(t,n);let m,g=t.inputs;!d&&null!=g&&(m=g[s])?(fE(i,n,m,s,a),Ja(t)&&function(i,t){const n=Xt(t,i);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(s=function(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(s),a=null!=h?h(a,t.value||"",s):a,Ge(u)?u.setProperty(f,s,a):Jc(s)||(f.setProperty?f.setProperty(s,a):f[s]=a))}(_e(),We(),s,i,t,s[11],n,!1),Qn}function ud(i,t,n,s,a){const h=a?"class":"style";fE(i,n,t.inputs[h],h,s)}function Mt(i,t,n,s){const a=O(),u=_e(),h=20+i,d=a[11],f=a[h]=bh(d,t,te.lFrame.currentNamespace),g=u.firstCreatePass?function(i,t,n,s,a,u,h){const d=t.consts,g=cr(t,i,2,a,Vi(d,u));return Gh(t,n,g,Vi(d,h)),null!==g.attrs&&Al(g,g.attrs,!1),null!==g.mergedAttrs&&Al(g,g.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,g),g}(h,u,a,0,t,n,s):u.data[h];jn(g,!0);const m=g.mergedAttrs;null!==m&&rl(d,f,m);const E=g.classes;null!==E&&wh(d,f,E);const T=g.styles;null!==T&&Nm(d,f,T),64!=(64&g.flags)&&yl(u,a,f,g),0===te.lFrame.elementDepthCount&&Et(f,a),te.lFrame.elementDepthCount++,$a(g)&&(Uh(u,a,g),function(i,t,n){if(Lc(t)){const a=t.directiveEnd;for(let u=t.directiveStart;u<a;u++){const h=i.data[u];h.contentQueries&&h.contentQueries(1,n[u],u)}}}(u,g,a)),null!==s&&Hh(a,g)}function Ot(){let i=tt();Gc()?Wc():(i=i.parent,jn(i,!1));const t=i;te.lFrame.elementDepthCount--;const n=_e();n.firstCreatePass&&(nl(n,i),Lc(i)&&n.queries.elementEnd(i)),null!=t.classesWithoutHost&&function(i){return 0!=(16&i.flags)}(t)&&ud(n,t,O(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(i){return 0!=(32&i.flags)}(t)&&ud(n,t,O(),t.stylesWithoutHost,!1)}function Mn(i,t,n,s){Mt(i,t,n,s),Ot()}function Vs(i){return!!i&&"function"==typeof i.then}const Nl=function(i){return!!i&&"function"==typeof i.subscribe};function lt(i,t,n,s){const a=O(),u=_e(),h=tt();return function(i,t,n,s,a,u,h,d){const f=$a(s),m=i.firstCreatePass&&hE(i),E=t[8],T=cE(t);let y=!0;if(3&s.type||d){const S=sn(s,t),D=d?d(S):S,R=T.length,k=d?x=>d($e(x[s.index])):s.index;if(Ge(n)){let x=null;if(!d&&f&&(x=function(i,t,n,s){const a=i.cleanup;if(null!=a)for(let u=0;u<a.length-1;u+=2){const h=a[u];if(h===n&&a[u+1]===s){const d=t[7],f=a[u+2];return d.length>f?d[f]:null}"string"==typeof h&&(u+=2)}return null}(i,t,a,s.index)),null!==x)(x.__ngLastListenerFn__||x).__ngNextListenerFn__=u,x.__ngLastListenerFn__=u,y=!1;else{u=cd(s,t,E,u,!1);const Q=n.listen(D,a,u);T.push(u,Q),m&&m.push(a,k,R,R+1)}}else u=cd(s,t,E,u,!0),D.addEventListener(a,u,h),T.push(u),m&&m.push(a,k,R,h)}else u=cd(s,t,E,u,!1);const C=s.outputs;let I;if(y&&null!==C&&(I=C[a])){const S=I.length;if(S)for(let D=0;D<S;D+=2){const ve=t[I[D]][I[D+1]].subscribe(u),Se=T.length;T.push(u,ve),m&&m.push(a,s.index,Se,-(Se+1))}}}(u,a,a[11],h,i,t,!!n,s),lt}function cT(i,t,n,s){try{return!1!==n(s)}catch(a){return pE(i,a),!1}}function cd(i,t,n,s,a){return function u(h){if(h===Function)return s;const d=2&i.flags?Xt(i.index,t):t;0==(32&t[2])&&Xh(d);let f=cT(t,0,s,h),g=u.__ngNextListenerFn__;for(;g;)f=cT(t,0,g,h)&&f,g=g.__ngNextListenerFn__;return a&&!1===f&&(h.preventDefault(),h.returnValue=!1),f}}function eN(i,t){let n=null;const s=function(i){const t=i.attrs;if(null!=t){const n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(i);for(let a=0;a<t.length;a++){const u=t[a];if("*"!==u){if(null===s?xm(i,u,!0):nM(s,u))return a}else n=a}return n}function CT(i,t,n,s,a){const u=i[n+1],h=null===t;let d=s?An(u):mi(u),f=!1;for(;0!==d&&(!1===f||h);){const m=i[d+1];iN(i[d],t)&&(f=!0,i[d+1]=s?Nh(m):Mh(m)),d=s?An(m):mi(m)}f&&(i[n+1]=s?Mh(u):Nh(u))}function iN(i,t){return null===i||null==t||(Array.isArray(i)?i[1]:i)===t||!(!Array.isArray(i)||"string"!=typeof t)&&nr(i,t)>=0}function Xi(i,t){return function(i,t,n,s){const a=O(),u=_e(),h=function(i){const t=te.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+i,n}(2);u.firstUpdatePass&&function(i,t,n,s){const a=i.data;if(null===a[n+1]){const u=a[At()],h=function(i,t){return t>=i.expandoStartIndex}(i,n);(function(i,t){return 0!=(i.flags&(t?16:32))})(u,s)&&null===t&&!h&&(t=!1),t=function(i,t,n,s){const a=function(i){const t=te.lFrame.currentDirectiveIndex;return-1===t?null:i[t]}(i);let u=s?t.residualClasses:t.residualStyles;if(null===a)0===(s?t.classBindings:t.styleBindings)&&(n=Bs(n=dd(null,i,t,n,s),t.attrs,s),u=null);else{const h=t.directiveStylingLast;if(-1===h||i[h]!==a)if(n=dd(a,i,t,n,s),null===u){let f=function(i,t,n){const s=n?t.classBindings:t.styleBindings;if(0!==mi(s))return i[An(s)]}(i,t,s);void 0!==f&&Array.isArray(f)&&(f=dd(null,i,t,f[1],s),f=Bs(f,t.attrs,s),function(i,t,n,s){i[An(n?t.classBindings:t.styleBindings)]=s}(i,t,s,f))}else u=function(i,t,n){let s;const a=t.directiveEnd;for(let u=1+t.directiveStylingLast;u<a;u++)s=Bs(s,i[u].hostAttrs,n);return Bs(s,t.attrs,n)}(i,t,s)}return void 0!==u&&(s?t.residualClasses=u:t.residualStyles=u),n}(a,u,t,s),function(i,t,n,s,a,u){let h=u?t.classBindings:t.styleBindings,d=An(h),f=mi(h);i[s]=n;let m,g=!1;if(Array.isArray(n)){const E=n;m=E[1],(null===m||nr(E,m)>0)&&(g=!0)}else m=n;if(a)if(0!==f){const T=An(i[d+1]);i[s+1]=bl(T,d),0!==T&&(i[T+1]=Oh(i[T+1],s)),i[d+1]=function(i,t){return 131071&i|t<<17}(i[d+1],s)}else i[s+1]=bl(d,0),0!==d&&(i[d+1]=Oh(i[d+1],s)),d=s;else i[s+1]=bl(f,0),0===d?d=s:i[f+1]=Oh(i[f+1],s),f=s;g&&(i[s+1]=Mh(i[s+1])),CT(i,m,s,!0),CT(i,m,s,!1),function(i,t,n,s,a){const u=a?i.residualClasses:i.residualStyles;null!=u&&"string"==typeof t&&nr(u,t)>=0&&(n[s+1]=Nh(n[s+1]))}(t,m,i,s,u),h=bl(d,f),u?t.classBindings=h:t.styleBindings=h}(a,u,t,n,h,s)}}(u,i,h,s),t!==se&&Tt(a,h,t)&&function(i,t,n,s,a,u,h,d){if(!(3&t.type))return;const f=i.data,g=f[d+1];kl(function(i){return 1==(1&i)}(g)?LT(f,t,n,a,mi(g),h):void 0)||(kl(u)||function(i){return 2==(2&i)}(g)&&(u=LT(f,null,n,a,d,h)),function(i,t,n,s,a){const u=Ge(i);if(t)a?u?i.addClass(n,s):n.classList.add(s):u?i.removeClass(n,s):n.classList.remove(s);else{let h=-1===s.indexOf("-")?void 0:Yt.DashCase;if(null==a)u?i.removeStyle(n,s,h):n.style.removeProperty(s);else{const d="string"==typeof a&&a.endsWith("!important");d&&(a=a.slice(0,-10),h|=Yt.Important),u?i.setStyle(n,s,a,h):n.style.setProperty(s,a,d?"important":"")}}}(s,h,function(i,t){return $e(t[i])}(At(),n),a,u))}(u,u.data[At()],a,a[11],i,a[h+1]=function(i,t){return null==i||("string"==typeof t?i+=t:"object"==typeof i&&(i=he(function(i){return i instanceof class{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?i.changingThisBreaksApplicationSecurity:i}(i)))),i}(t,n),s,h)}(i,t,null,!0),Xi}function dd(i,t,n,s,a){let u=null;const h=n.directiveEnd;let d=n.directiveStylingLast;for(-1===d?d=n.directiveStart:d++;d<h&&(u=t[d],s=Bs(s,u.hostAttrs,a),u!==i);)d++;return null!==i&&(n.directiveStylingLast=d),s}function Bs(i,t,n){const s=n?1:2;let a=-1;if(null!==t)for(let u=0;u<t.length;u++){const h=t[u];"number"==typeof h?a=h:a===s&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),zt(i,h,!!n||t[++u]))}return void 0===i?null:i}function LT(i,t,n,s,a,u){const h=null===t;let d;for(;a>0;){const f=i[a],g=Array.isArray(f),m=g?f[1]:f,E=null===m;let T=n[a+1];T===se&&(T=E?be:void 0);let y=E?nh(T,s):m===s?T:void 0;if(g&&!kl(y)&&(y=nh(f,s)),kl(y)&&(d=y,h))return d;const C=i[a+1];a=h?An(C):mi(C)}if(null!==t){let f=u?t.residualClasses:t.residualStyles;null!=f&&(d=nh(f,s))}return d}function kl(i){return void 0!==i}function ti(i,t=""){const n=O(),s=_e(),a=i+20,u=s.firstCreatePass?cr(s,a,1,t,null):s.data[a],h=n[a]=function(i,t){return Ge(i)?i.createText(t):i.createTextNode(t)}(n[11],t);yl(s,n,h,u),jn(u,!1)}const vo=void 0;var VN=["en",[["a","p"],["AM","PM"],vo],[["AM","PM"],vo,vo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],vo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],vo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",vo,"{1} 'at' {0}",vo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(i){const n=Math.floor(Math.abs(i)),s=i.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===s?1:5}];let Dr={};function tv(i){return i in Dr||(Dr[i]=Ee.ng&&Ee.ng.common&&Ee.ng.common.locales&&Ee.ng.common.locales[i]),Dr[i]}var B=(()=>((B=B||{})[B.LocaleId=0]="LocaleId",B[B.DayPeriodsFormat=1]="DayPeriodsFormat",B[B.DayPeriodsStandalone=2]="DayPeriodsStandalone",B[B.DaysFormat=3]="DaysFormat",B[B.DaysStandalone=4]="DaysStandalone",B[B.MonthsFormat=5]="MonthsFormat",B[B.MonthsStandalone=6]="MonthsStandalone",B[B.Eras=7]="Eras",B[B.FirstDayOfWeek=8]="FirstDayOfWeek",B[B.WeekendRange=9]="WeekendRange",B[B.DateFormat=10]="DateFormat",B[B.TimeFormat=11]="TimeFormat",B[B.DateTimeFormat=12]="DateTimeFormat",B[B.NumberSymbols=13]="NumberSymbols",B[B.NumberFormats=14]="NumberFormats",B[B.CurrencyCode=15]="CurrencyCode",B[B.CurrencySymbol=16]="CurrencySymbol",B[B.CurrencyName=17]="CurrencyName",B[B.Currencies=18]="Currencies",B[B.Directionality=19]="Directionality",B[B.PluralCase=20]="PluralCase",B[B.ExtraData=21]="ExtraData",B))();const Ll="en-US";let nv=Ll;function Ed(i,t,n,s,a){if(i=W(i),Array.isArray(i))for(let u=0;u<i.length;u++)Ed(i[u],t,n,s,a);else{const u=_e(),h=O();let d=fr(i)?i:W(i.provide),f=EE(i);const g=tt(),m=1048575&g.providerIndexes,E=g.directiveStart,T=g.providerIndexes>>20;if(fr(i)||!i.multi){const y=new ds(f,a,M),C=vd(d,t,a?m:m+T,E);-1===C?(ul(fs(g,h),u,d),Td(u,i,t.length),t.push(d),g.directiveStart++,g.directiveEnd++,a&&(g.providerIndexes+=1048576),n.push(y),h.push(y)):(n[C]=y,h[C]=y)}else{const y=vd(d,t,m+T,E),C=vd(d,t,m,m+T),I=y>=0&&n[y],S=C>=0&&n[C];if(a&&!S||!a&&!I){ul(fs(g,h),u,d);const D=function(i,t,n,s,a){const u=new ds(i,n,M);return u.multi=[],u.index=t,u.componentProviders=0,Rv(u,a,s&&!n),u}(a?xk:Pk,n.length,a,s,f);!a&&S&&(n[C].providerFactory=D),Td(u,i,t.length,0),t.push(d),g.directiveStart++,g.directiveEnd++,a&&(g.providerIndexes+=1048576),n.push(D),h.push(D)}else Td(u,i,y>-1?y:C,Rv(n[a?C:y],f,!a&&s));!a&&s&&S&&n[C].componentProviders++}}}function Td(i,t,n,s){const a=fr(t);if(a||function(i){return!!i.useClass}(t)){const h=(t.useClass||t).prototype.ngOnDestroy;if(h){const d=i.destroyHooks||(i.destroyHooks=[]);if(!a&&t.multi){const f=d.indexOf(n);-1===f?d.push(n,[s,h]):d[f+1].push(s,h)}else d.push(n,h)}}}function Rv(i,t,n){return n&&i.componentProviders++,i.multi.push(t)-1}function vd(i,t,n,s){for(let a=n;a<s;a++)if(t[a]===i)return a;return-1}function Pk(i,t,n,s){return yd(this.multi,[])}function xk(i,t,n,s){const a=this.multi;let u;if(this.providerFactory){const h=this.providerFactory.componentProviders,d=gs(n,n[1],this.providerFactory.index,s);u=d.slice(0,h),yd(a,u);for(let f=h;f<d.length;f++)u.push(d[f])}else u=[],yd(a,u);return u}function yd(i,t){for(let n=0;n<i.length;n++)t.push((0,i[n])());return t}function Le(i,t=[]){return n=>{n.providersResolver=(s,a)=>function(i,t,n){const s=_e();if(s.firstCreatePass){const a=In(i);Ed(n,s.data,s.blueprint,a,!0),Ed(t,s.data,s.blueprint,a,!1)}}(s,a?a(i):i,t)}}class Dv{}const wv="ngComponent";class Bk{resolveComponentFactory(t){throw function(i){const t=Error(`No component factory found for ${he(i)}. Did you add it to @NgModule.entryComponents?`);return t[wv]=i,t}(t)}}let yo=(()=>{class i{}return i.NULL=new Bk,i})();function Bl(...i){}function wr(i,t){return new Xe(sn(i,t))}const Gk=function(){return wr(tt(),O())};let Xe=(()=>{class i{constructor(n){this.nativeElement=n}}return i.__NG_ELEMENT_ID__=Gk,i})();function Mv(i){return i instanceof Xe?i.nativeElement:i}class Co{}let yi=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>jk(),i})();const jk=function(){const i=O(),n=Xt(tt().index,i);return function(i){return i[11]}(Wn(n)?n:i)};let bd=(()=>{class i{}return i.\u0275prov=ee({token:i,providedIn:"root",factory:()=>null}),i})();class zi{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Ov=new zi("13.0.0"),Mr={};function Ul(i,t,n,s,a=!1){for(;null!==n;){const u=t[n.index];if(null!==u&&s.push($e(u)),Sn(u))for(let d=10;d<u.length;d++){const f=u[d],g=f[1].firstChild;null!==g&&Ul(f[1],f,g,s)}const h=n.type;if(8&h)Ul(i,t,n.child,s);else if(32&h){const d=Th(n,t);let f;for(;f=d();)s.push(f)}else if(16&h){const d=wm(t,n);if(Array.isArray(d))s.push(...d);else{const f=As(t[16]);Ul(f[1],f,d,s,!0)}}n=a?n.projectionNext:n.next}return s}class js{constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,n=t[1];return Ul(n,t,n.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Sn(t)){const n=t[8],s=n?n.indexOf(this):-1;s>-1&&(Sh(t,s),fo(n,s))}this._attachedToViewContainer=!1}vm(this._lView[1],this._lView)}onDestroy(t){eE(this._lView[1],this._lView,null,t)}markForCheck(){Xh(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Kh(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(i,t,n){Za(!0);try{Kh(i,t,n)}finally{Za(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var t;this._appRef=null,ws(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class Kk extends js{constructor(t){super(t),this._view=t}detectChanges(){uE(this._view)}checkNoChanges(){!function(i){Za(!0);try{uE(i)}finally{Za(!1)}}(this._view)}get context(){return null}}class Nv extends yo{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=gt(t);return new Sd(n,this.ngModule)}}function kv(i){const t=[];for(let n in i)i.hasOwnProperty(n)&&t.push({propName:i[n],templateName:n});return t}const Jk=new K("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>dm});class Sd extends Dv{constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=t.selectors.map(iM).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return kv(this.componentDef.inputs)}get outputs(){return kv(this.componentDef.outputs)}create(t,n,s,a){const u=(a=a||this.ngModule)?function(i,t){return{get:(n,s,a)=>{const u=i.get(n,Mr,a);return u!==Mr||s===Mr?u:t.get(n,s,a)}}}(t,a.injector):t,h=u.get(Co,l_),d=u.get(bd,null),f=h.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",m=s?function(i,t,n){if(Ge(i))return i.selectRootElement(t,n===Ft.ShadowDom);let s="string"==typeof t?i.querySelector(t):t;return s.textContent="",s}(f,s,this.componentDef.encapsulation):bh(h.createRenderer(null,this.componentDef),g,function(i){const t=i.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(g)),E=this.componentDef.onPush?576:528,T=function(i,t){return{components:[],scheduler:i||dm,clean:HM,playerHandler:t||null,flags:0}}(),y=Rl(0,null,null,1,0,null,null,null,null,null),C=Ms(null,y,T,E,null,null,h,f,d,u);let I,S;el(C);try{const D=function(i,t,n,s,a,u){const h=n[1];n[20]=i;const f=cr(h,20,2,"#host",null),g=f.mergedAttrs=t.hostAttrs;null!==g&&(Al(f,g,!0),null!==i&&(rl(a,i,g),null!==f.classes&&wh(a,i,f.classes),null!==f.styles&&Nm(a,i,f.styles)));const m=s.createRenderer(i,t),E=Ms(n,qm(t),null,t.onPush?64:16,n[20],f,s,m,u||null,null);return h.firstCreatePass&&(ul(fs(f,n),h,t.type),rE(h,f),sE(f,n.length,1)),Dl(n,E),n[20]=E}(m,this.componentDef,C,h,f);if(m)if(s)rl(f,m,["ng-version",Ov.full]);else{const{attrs:R,classes:k}=function(i){const t=[],n=[];let s=1,a=2;for(;s<i.length;){let u=i[s];if("string"==typeof u)2===a?""!==u&&t.push(u,i[++s]):8===a&&n.push(u);else{if(!Dn(a))break;a=u}s++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);R&&rl(f,m,R),k&&k.length>0&&wh(f,m,k.join(" "))}if(S=Bc(y,20),void 0!==n){const R=S.projection=[];for(let k=0;k<this.ngContentSelectors.length;k++){const x=n[k];R.push(null!=x?Array.from(x):null)}}I=function(i,t,n,s,a){const u=n[1],h=function(i,t,n){const s=tt();i.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),aE(i,s,t,hr(i,t,1,null),n));const a=gs(t,i,s.directiveStart,s);Et(a,t);const u=sn(s,t);return u&&Et(u,t),a}(u,n,t);if(s.components.push(h),i[8]=h,a&&a.forEach(f=>f(h,t)),t.contentQueries){const f=tt();t.contentQueries(1,h,f.directiveStart)}const d=tt();return!u.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Bi(d.index),iE(n[1],d,0,d.directiveStart,d.directiveEnd,t),oE(t,h)),h}(D,this.componentDef,C,T,[pO]),Os(y,C,null)}finally{tl()}return new Qk(this.componentType,I,wr(S,C),C,S)}}class Qk extends class{}{constructor(t,n,s,a,u){super(),this.location=s,this._rootLView=a,this._tNode=u,this.instance=n,this.hostView=this.changeDetectorRef=new Kk(a),this.componentType=t}get injector(){return new qo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class ni{}class Lv{}const Or=new Map;class xv extends ni{constructor(t,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Nv(this);const s=nn(t);this._bootstrapComponents=Yn(s.bootstrap),this._r3Injector=mE(t,n,[{provide:ni,useValue:this},{provide:yo,useValue:this.componentFactoryResolver}],he(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,n=Ce.THROW_IF_NOT_FOUND,s=z.Default){return t===Ce||t===ni||t===Ns?this:this._r3Injector.get(t,n,s)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Rd extends Lv{constructor(t){super(),this.moduleType=t,null!==nn(t)&&function(i){const t=new Set;!function n(s){const a=nn(s,!0),u=a.id;null!==u&&(function(i,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${i} - ${he(t)} vs ${he(t.name)}`)}(u,Or.get(u),s),Or.set(u,s));const h=Yn(a.imports);for(const d of h)t.has(d)||(t.add(d),n(d))}(i)}(t)}create(t){return new xv(this.moduleType,t)}}function Dd(i){return t=>{setTimeout(i,void 0,t)}}const Me=class extends yn{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,s){var f,g,m;let a=t,u=n||(()=>null),h=s;if(t&&"object"==typeof t){const E=t;a=null==(f=E.next)?void 0:f.bind(E),u=null==(g=E.error)?void 0:g.bind(E),h=null==(m=E.complete)?void 0:m.bind(E)}this.__isAsync&&(u=Dd(u),a&&(a=Dd(a)),h&&(h=Dd(h)));const d=super.subscribe({next:a,error:u,complete:h});return t instanceof r&&t.add(d),d}};function v0(){return this._results[gr()]()}class Hl{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=gr(),s=Hl.prototype;s[n]||(s[n]=v0)}get changes(){return this._changes||(this._changes=new Me)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const s=this;s.dirty=!1;const a=an(t);(this._changesDetected=!function(i,t,n){if(i.length!==t.length)return!1;for(let s=0;s<i.length;s++){let a=i[s],u=t[s];if(n&&(a=n(a),u=n(u)),u!==a)return!1}return!0}(s._results,a,n))&&(s._results=a,s.length=a.length,s.last=a[this.length-1],s.first=a[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;const C0=function(){return Gl(tt(),O())};let Ci=(()=>{class i{}return i.__NG_ELEMENT_ID__=C0,i})();const b0=Ci,S0=class extends b0{constructor(t,n,s){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=s}createEmbeddedView(t){const n=this._declarationTContainer.tViews,s=Ms(this._declarationLView,n,t,16,null,n.declTNode,null,null,null,null);s[17]=this._declarationLView[this._declarationTContainer.index];const u=this._declarationLView[19];return null!==u&&(s[19]=u.createEmbeddedView(n)),Os(n,s,t),new js(s)}};function Gl(i,t){return 4&i.type?new S0(t,i,wr(i,t)):null}const D0=function(){return jv(tt(),O())};let kn=(()=>{class i{}return i.__NG_ELEMENT_ID__=D0,i})();const w0=kn,Gv=class extends w0{constructor(t,n,s){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=s}get element(){return wr(this._hostTNode,this._hostLView)}get injector(){return new qo(this._hostTNode,this._hostLView)}get parentInjector(){const t=ll(this._hostTNode,this._hostLView);if(S_(t)){const n=$o(t,this._hostLView),s=Jo(t);return new qo(n[1].data[s+8],n)}return new qo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=Wv(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,n,s){const a=t.createEmbeddedView(n||{});return this.insert(a,s),a}createComponent(t,n,s,a,u){const h=t&&!("function"==typeof t);let d;if(h)d=n;else{const E=n||{};d=E.index,s=E.injector,a=E.projectableNodes,u=E.ngModuleRef}const f=h?t:new Sd(gt(t)),g=s||this.parentInjector;if(!u&&null==f.ngModule&&g){const E=g.get(ni,null);E&&(u=E)}const m=f.create(g,a,void 0,u);return this.insert(m.hostView,d),m}insert(t,n){const s=t._lView,a=s[1];if(Sn(s[3])){const m=this.indexOf(t);if(-1!==m)this.detach(m);else{const E=s[3],T=new Gv(E,E[6],E[3]);T.detach(T.indexOf(t))}}const u=this._adjustIndex(n),h=this._lContainer;!function(i,t,n,s){const a=10+s,u=n.length;s>0&&(n[a-1][4]=t),s<u-10?(t[4]=n[a],hl(n,10+s,t)):(n.push(t),t[4]=null),t[3]=n;const h=t[17];null!==h&&n!==h&&function(i,t){const n=i[9];t[16]!==t[3][3][16]&&(i[2]=!0),null===n?i[9]=[t]:n.push(t)}(h,t);const d=t[19];null!==d&&d.insertView(i),t[2]|=128}(a,s,h,u);const d=Dh(u,h),f=s[11],g=vl(f,h[7]);return null!==g&&function(i,t,n,s,a,u){s[0]=a,s[6]=t,ws(i,s,n,1,a,u)}(a,h[6],f,s,g,d),t.attachToViewContainerRef(),hl(Ad(h),u,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=Wv(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),s=Sh(this._lContainer,n);s&&(fo(Ad(this._lContainer),n),vm(s[1],s))}detach(t){const n=this._adjustIndex(t,-1),s=Sh(this._lContainer,n);return s&&null!=fo(Ad(this._lContainer),n)?new js(s):null}_adjustIndex(t,n=0){return null==t?this.length+n:t}};function Wv(i){return i[8]}function Ad(i){return i[8]||(i[8]=[])}function jv(i,t){let n;const s=t[i.index];if(Sn(s))n=s;else{let a;if(8&i.type)a=$e(s);else{const u=t[11];a=u.createComment("");const h=sn(i,t);Eo(u,vl(u,h),a,function(i,t){return Ge(i)?i.nextSibling(t):t.nextSibling}(u,h),!1)}t[i.index]=n=lE(s,t,a,i),Dl(t,n)}return new Gv(n,i,t)}class wd{constructor(t){this.queryList=t,this.matches=null}clone(){return new wd(this.queryList)}setDirty(){this.queryList.setDirty()}}class Md{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const s=null!==t.contentQueries?t.contentQueries[0]:n.length,a=[];for(let u=0;u<s;u++){const h=n.getByIndex(u);a.push(this.queries[h.indexInDeclarationView].clone())}return new Md(a)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==Jv(t,n).matches&&this.queries[n].setDirty()}}class Xv{constructor(t,n,s=null){this.predicate=t,this.flags=n,this.read=s}}class Od{constructor(t=[]){this.queries=t}elementStart(t,n){for(let s=0;s<this.queries.length;s++)this.queries[s].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let s=0;s<this.length;s++){const a=null!==n?n.length:0,u=this.getByIndex(s).embeddedTView(t,a);u&&(u.indexInDeclarationView=s,null!==n?n.push(u):n=[u])}return null!==n?new Od(n):null}template(t,n){for(let s=0;s<this.queries.length;s++)this.queries[s].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Nd{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new Nd(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let s=t.parent;for(;null!==s&&8&s.type&&s.index!==n;)s=s.parent;return n===(null!==s?s.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const s=this.metadata.predicate;if(Array.isArray(s))for(let a=0;a<s.length;a++){const u=s[a];this.matchTNodeWithReadOption(t,n,N0(n,u)),this.matchTNodeWithReadOption(t,n,cl(n,t,u,!1,!1))}else s===Ci?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,cl(n,t,s,!1,!1))}matchTNodeWithReadOption(t,n,s){if(null!==s){const a=this.metadata.read;if(null!==a)if(a===Xe||a===kn||a===Ci&&4&n.type)this.addMatch(n.index,-2);else{const u=cl(n,t,a,!1,!1);null!==u&&this.addMatch(n.index,u)}else this.addMatch(n.index,s)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function N0(i,t){const n=i.localNames;if(null!==n)for(let s=0;s<n.length;s+=2)if(n[s]===t)return n[s+1];return null}function L0(i,t,n,s){return-1===n?function(i,t){return 11&i.type?wr(i,t):4&i.type?Gl(i,t):null}(t,i):-2===n?function(i,t,n){return n===Xe?wr(t,i):n===Ci?Gl(t,i):n===kn?jv(t,i):void 0}(i,t,s):gs(i,i[1],n,t)}function zv(i,t,n,s){const a=t[19].queries[s];if(null===a.matches){const u=i.data,h=n.matches,d=[];for(let f=0;f<h.length;f+=2){const g=h[f];d.push(g<0?null:L0(t,u[g],h[f+1],n.metadata.read))}a.matches=d}return a.matches}function kd(i,t,n,s){const a=i.queries.getByIndex(n),u=a.matches;if(null!==u){const h=zv(i,t,a,n);for(let d=0;d<u.length;d+=2){const f=u[d];if(f>0)s.push(h[d/2]);else{const g=u[d+1],m=t[-f];for(let E=10;E<m.length;E++){const T=m[E];T[17]===T[3]&&kd(T[1],T,g,s)}if(null!==m[9]){const E=m[9];for(let T=0;T<E.length;T++){const y=E[T];kd(y[1],y,g,s)}}}}}return s}function Ks(i){const t=O(),n=_e(),s=g_();zc(s+1);const a=Jv(n,s);if(i.dirty&&u_(t)===(2==(2&a.metadata.flags))){if(null===a.matches)i.reset([]);else{const u=a.crossesNgTemplate?kd(n,t,s,[]):zv(n,t,a,s);i.reset(u,Mv),i.notifyOnChanges()}return!0}return!1}function Ld(i,t,n){const s=_e();s.firstCreatePass&&(function(i,t,n){null===i.queries&&(i.queries=new Od),i.queries.track(new Nd(t,n))}(s,new Xv(i,t,n),-1),2==(2&t)&&(s.staticViewQueries=!0)),function(i,t,n){const s=new Hl(4==(4&n));eE(i,t,s,s.destroy),null===t[19]&&(t[19]=new Md),t[19].queries.push(new wd(s))}(s,O(),t)}function Jv(i,t){return i.queries.getByIndex(t)}const $s=new K("Application Initializer");let kr=(()=>{class i{constructor(n){this.appInits=n,this.resolve=Bl,this.reject=Bl,this.initialized=!1,this.done=!1,this.donePromise=new Promise((s,a)=>{this.resolve=s,this.reject=a})}runInitializers(){if(this.initialized)return;const n=[],s=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let a=0;a<this.appInits.length;a++){const u=this.appInits[a]();if(Vs(u))n.push(u);else if(Nl(u)){const h=new Promise((d,f)=>{u.subscribe({complete:d,error:f})});n.push(h)}}Promise.all(n).then(()=>{s()}).catch(a=>{this.reject(a)}),0===n.length&&s(),this.initialized=!0}}return i.\u0275fac=function(n){return new(n||i)(P($s,8))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();const qs=new K("AppId"),hL={provide:qs,useFactory:function(){return`${Hd()}${Hd()}${Hd()}`},deps:[]};function Hd(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const py=new K("Platform Initializer"),Xl=new K("Platform ID"),fy=new K("appBootstrapListener");let zl=(()=>{class i{log(n){console.log(n)}warn(n){console.warn(n)}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();const bi=new K("LocaleId"),gy=new K("DefaultCurrencyCode");class pL{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}const Gd=function(i){return new Rd(i)},fL=Gd,gL=function(i){return Promise.resolve(Gd(i))},my=function(i){const t=Gd(i),s=Yn(nn(i).declarations).reduce((a,u)=>{const h=gt(u);return h&&a.push(new Sd(h)),a},[]);return new pL(t,s)},_L=my,mL=function(i){return Promise.resolve(my(i))};let Kl=(()=>{class i{constructor(){this.compileModuleSync=fL,this.compileModuleAsync=gL,this.compileModuleAndAllComponentsSync=_L,this.compileModuleAndAllComponentsAsync=mL}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();const vL=(()=>Promise.resolve(0))();function Wd(i){"undefined"==typeof Zone?vL.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class Oe{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:s=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Me(!1),this.onMicrotaskEmpty=new Me(!1),this.onStable=new Me(!1),this.onError=new Me(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const a=this;a._nesting=0,a._outer=a._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!s&&n,a.shouldCoalesceRunChangeDetection=s,a.lastRequestAnimationFrameId=-1,a.nativeRequestAnimationFrame=function(){let i=Ee.requestAnimationFrame,t=Ee.cancelAnimationFrame;if("undefined"!=typeof Zone&&i&&t){const n=i[Zone.__symbol__("OriginalDelegate")];n&&(i=n);const s=t[Zone.__symbol__("OriginalDelegate")];s&&(t=s)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(i){const t=()=>{!function(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(Ee,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,Xd(i),i.isCheckStableRunning=!0,jd(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),Xd(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,s,a,u,h,d)=>{try{return Ey(i),n.invokeTask(a,u,h,d)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===u.type||i.shouldCoalesceRunChangeDetection)&&t(),Ty(i)}},onInvoke:(n,s,a,u,h,d,f)=>{try{return Ey(i),n.invoke(a,u,h,d,f)}finally{i.shouldCoalesceRunChangeDetection&&t(),Ty(i)}},onHasTask:(n,s,a,u)=>{n.hasTask(a,u),s===a&&("microTask"==u.change?(i._hasPendingMicrotasks=u.microTask,Xd(i),jd(i)):"macroTask"==u.change&&(i.hasPendingMacrotasks=u.macroTask))},onHandleError:(n,s,a,u)=>(n.handleError(a,u),i.runOutsideAngular(()=>i.onError.emit(u)),!1)})}(a)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Oe.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Oe.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,n,s){return this._inner.run(t,n,s)}runTask(t,n,s,a){const u=this._inner,h=u.scheduleEventTask("NgZoneEvent: "+a,t,CL,Bl,Bl);try{return u.runTask(h,n,s)}finally{u.cancelTask(h)}}runGuarded(t,n,s){return this._inner.runGuarded(t,n,s)}runOutsideAngular(t){return this._outer.run(t)}}const CL={};function jd(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function Xd(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function Ey(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function Ty(i){i._nesting--,jd(i)}class IL{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Me,this.onMicrotaskEmpty=new Me,this.onStable=new Me,this.onError=new Me}run(t,n,s){return t.apply(n,s)}runGuarded(t,n,s){return t.apply(n,s)}runOutsideAngular(t){return t()}runTask(t,n,s,a){return t.apply(n,s)}}let zd=(()=>{class i{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Oe.assertNotInAngularZone(),Wd(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Wd(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(s=>!s.updateCb||!s.updateCb(n)||(clearTimeout(s.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,s,a){let u=-1;s&&s>0&&(u=setTimeout(()=>{this._callbacks=this._callbacks.filter(h=>h.timeoutId!==u),n(this._didWork,this.getPendingTasks())},s)),this._callbacks.push({doneCb:n,timeoutId:u,updateCb:a})}whenStable(n,s,a){if(a&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,s,a),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,s,a){return[]}}return i.\u0275fac=function(n){return new(n||i)(P(Oe))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})(),vy=(()=>{class i{constructor(){this._applications=new Map,Kd.addToWindow(this)}registerApplication(n,s){this._applications.set(n,s)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,s=!0){return Kd.findTestabilityInTree(this,n,s)}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();class RL{addToWindow(t){}findTestabilityInTree(t,n,s){return null}}let Kd=new RL,yy=!0,Cy=!1;function Yd(){return Cy=!0,yy}let Ln;const by=new K("AllowMultipleToken");class Jd{constructor(t,n){this.name=t,this.token=n}}function Sy(i,t,n=[]){const s=`Platform: ${t}`,a=new K(s);return(u=[])=>{let h=Iy();if(!h||h.injector.get(by,!1))if(i)i(n.concat(u).concat({provide:a,useValue:!0}));else{const d=n.concat(u).concat({provide:a,useValue:!0},{provide:ks,useValue:"platform"});!function(i){if(Ln&&!Ln.destroyed&&!Ln.injector.get(by,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ln=i.get(Ry);const t=i.get(py,null);t&&t.forEach(n=>n())}(Ce.create({providers:d,name:s}))}return function(i){const t=Iy();if(!t)throw new Error("No platform exists!");if(!t.injector.get(i,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(a)}}function Iy(){return Ln&&!Ln.destroyed?Ln:null}let Ry=(()=>{class i{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,s){const d=function(i,t){let n;return n="noop"===i?new IL:("zone.js"===i?void 0:i)||new Oe({enableLongStackTrace:Yd(),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(s?s.ngZone:void 0,{ngZoneEventCoalescing:s&&s.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:s&&s.ngZoneRunCoalescing||!1}),f=[{provide:Oe,useValue:d}];return d.run(()=>{const g=Ce.create({providers:f,parent:this.injector,name:n.moduleType.name}),m=n.create(g),E=m.injector.get(mo,null);if(!E)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return d.runOutsideAngular(()=>{const T=d.onError.subscribe({next:y=>{E.handleError(y)}});m.onDestroy(()=>{$d(this._modules,m),T.unsubscribe()})}),function(i,t,n){try{const s=n();return Vs(s)?s.catch(a=>{throw t.runOutsideAngular(()=>i.handleError(a)),a}):s}catch(s){throw t.runOutsideAngular(()=>i.handleError(s)),s}}(E,d,()=>{const T=m.injector.get(kr);return T.runInitializers(),T.donePromise.then(()=>(function(i){Wt(i,"Expected localeId to be defined"),"string"==typeof i&&(nv=i.toLowerCase().replace(/_/g,"-"))}(m.injector.get(bi,Ll)||Ll),this._moduleDoBootstrap(m),m))})})}bootstrapModule(n,s=[]){const a=Dy({},s);return function(i,t,n){const s=new Rd(n);return Promise.resolve(s)}(0,0,n).then(u=>this.bootstrapModuleFactory(u,a))}_moduleDoBootstrap(n){const s=n.injector.get(Lr);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(a=>s.bootstrap(a));else{if(!n.instance.ngDoBootstrap)throw new Error(`The module ${he(n.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);n.instance.ngDoBootstrap(s)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(n){return new(n||i)(P(Ce))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();function Dy(i,t){return Array.isArray(t)?t.reduce(Dy,i):U(U({},i),t)}let Lr=(()=>{class i{constructor(n,s,a,u,h){this._zone=n,this._injector=s,this._exceptionHandler=a,this._componentFactoryResolver=u,this._initStatus=h,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const d=new Be(g=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{g.next(this._stable),g.complete()})}),f=new Be(g=>{let m;this._zone.runOutsideAngular(()=>{m=this._zone.onStable.subscribe(()=>{Oe.assertNotInAngularZone(),Wd(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,g.next(!0))})})});const E=this._zone.onUnstable.subscribe(()=>{Oe.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{g.next(!1)}))});return()=>{m.unsubscribe(),E.unsubscribe()}});this.isStable=function(...i){const t=ss(i),n=function(i,t){return"number"==typeof bc(i)?i.pop():1/0}(i),s=i;return s.length?1===s.length?Cn(s[0]):rs(n)(st(s,t)):hi}(d,f.pipe(function(i={}){const{connector:t=(()=>new yn),resetOnError:n=!0,resetOnComplete:s=!0,resetOnRefCountZero:a=!0}=i;return u=>{let h=null,d=null,f=null,g=0,m=!1,E=!1;const T=()=>{null==d||d.unsubscribe(),d=null},y=()=>{T(),h=f=null,m=E=!1},C=()=>{const I=h;y(),null==I||I.unsubscribe()};return Ze((I,S)=>{g++,!E&&!m&&T();const D=f=null!=f?f:t();S.add(()=>{g--,0===g&&!E&&!m&&(d=Sc(C,a))}),D.subscribe(S),h||(h=new os({next:R=>D.next(R),error:R=>{E=!0,T(),d=Sc(y,n,R),D.error(R)},complete:()=>{m=!0,T(),d=Sc(y,s),D.complete()}}),st(I).subscribe(h))})(u)}}()))}bootstrap(n,s){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let a;a=n instanceof Dv?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(a.componentType);const u=function(i){return i.isBoundToModule}(a)?void 0:this._injector.get(ni),d=a.create(Ce.NULL,[],s||a.selector,u),f=d.location.nativeElement,g=d.injector.get(zd,null),m=g&&d.injector.get(vy);return g&&m&&m.registerApplication(f,g),d.onDestroy(()=>{this.detachView(d.hostView),$d(this.components,d),m&&m.unregisterApplication(f)}),this._loadComponent(d),d}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const s=n;this._views.push(s),s.attachToAppRef(this)}detachView(n){const s=n;$d(this._views,s),s.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(fy,[]).concat(this._bootstrapListeners).forEach(a=>a(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return i.\u0275fac=function(n){return new(n||i)(P(Oe),P(Ce),P(mo),P(yo),P(kr))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();function $d(i,t){const n=i.indexOf(t);n>-1&&i.splice(n,1)}const HL=function(i){return function(i,t,n){if(Ja(i)&&!n){const s=Xt(i.index,t);return new js(s,s)}return 47&i.type?new js(t[16],t):null}(tt(),O(),16==(16&i))};let Yl=(()=>{class i{}return i.__NG_ELEMENT_ID__=HL,i})();class Ly{constructor(){}supports(t){return xs(t)}create(t){return new eP(t)}}const ZL=(i,t)=>t;class eP{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||ZL}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,s=this._removalsHead,a=0,u=null;for(;n||s;){const h=!s||n&&n.currentIndex<xy(s,a,u)?n:s,d=xy(h,a,u),f=h.currentIndex;if(h===s)a--,s=s._nextRemoved;else if(n=n._next,null==h.previousIndex)a++;else{u||(u=[]);const g=d-a,m=f-a;if(g!=m){for(let T=0;T<g;T++){const y=T<u.length?u[T]:u[T]=0,C=y+T;m<=C&&C<g&&(u[T]=y+1)}u[h.previousIndex]=m-g}}d!==f&&t(h,d,f)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!xs(t))throw new Error(`Error trying to diff '${he(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let a,u,h,n=this._itHead,s=!1;if(Array.isArray(t)){this.length=t.length;for(let d=0;d<this.length;d++)u=t[d],h=this._trackByFn(d,u),null!==n&&Object.is(n.trackById,h)?(s&&(n=this._verifyReinsertion(n,u,h,d)),Object.is(n.item,u)||this._addIdentityChange(n,u)):(n=this._mismatch(n,u,h,d),s=!0),n=n._next}else a=0,function(i,t){if(Array.isArray(i))for(let n=0;n<i.length;n++)t(i[n]);else{const n=i[gr()]();let s;for(;!(s=n.next()).done;)t(s.value)}}(t,d=>{h=this._trackByFn(a,d),null!==n&&Object.is(n.trackById,h)?(s&&(n=this._verifyReinsertion(n,d,h,a)),Object.is(n.item,d)||this._addIdentityChange(n,d)):(n=this._mismatch(n,d,h,a),s=!0),n=n._next,a++}),this.length=a;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,s,a){let u;return null===t?u=this._itTail:(u=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(s,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,u,a)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(s,a))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,u,a)):t=this._addAfter(new tP(n,s),u,a),t}_verifyReinsertion(t,n,s,a){let u=null===this._unlinkedRecords?null:this._unlinkedRecords.get(s,null);return null!==u?t=this._reinsertAfter(u,t._prev,a):t.currentIndex!=a&&(t.currentIndex=a,this._addToMoves(t,a)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,s){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const a=t._prevRemoved,u=t._nextRemoved;return null===a?this._removalsHead=u:a._nextRemoved=u,null===u?this._removalsTail=a:u._prevRemoved=a,this._insertAfter(t,n,s),this._addToMoves(t,s),t}_moveAfter(t,n,s){return this._unlink(t),this._insertAfter(t,n,s),this._addToMoves(t,s),t}_addAfter(t,n,s){return this._insertAfter(t,n,s),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,s){const a=null===n?this._itHead:n._next;return t._next=a,t._prev=n,null===a?this._itTail=t:a._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new Py),this._linkedRecords.put(t),t.currentIndex=s,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,s=t._next;return null===n?this._itHead=s:n._next=s,null===s?this._itTail=n:s._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Py),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class tP{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class nP{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let s;for(s=this._head;null!==s;s=s._nextDup)if((null===n||n<=s.currentIndex)&&Object.is(s.trackById,t))return s;return null}remove(t){const n=t._prevDup,s=t._nextDup;return null===n?this._head=s:n._nextDup=s,null===s?this._tail=n:s._prevDup=n,null===this._head}}class Py{constructor(){this.map=new Map}put(t){const n=t.trackById;let s=this.map.get(n);s||(s=new nP,this.map.set(n,s)),s.add(t)}get(t,n){const a=this.map.get(t);return a?a.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function xy(i,t,n){const s=i.previousIndex;if(null===s)return s;let a=0;return n&&s<n.length&&(a=n[s]),s+t+a}class Fy{constructor(){}supports(t){return t instanceof Map||id(t)}create(){return new iP}}class iP{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||id(t)))throw new Error(`Error trying to diff '${he(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(s,a)=>{if(n&&n.key===a)this._maybeAddToChanges(n,s),this._appendAfter=n,n=n._next;else{const u=this._getOrCreateRecordForKey(a,s);n=this._insertBeforeOrAppend(n,u)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let s=n;null!==s;s=s._nextRemoved)s===this._mapHead&&(this._mapHead=null),this._records.delete(s.key),s._nextRemoved=s._next,s.previousValue=s.currentValue,s.currentValue=null,s._prev=null,s._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const s=t._prev;return n._next=t,n._prev=s,t._prev=n,s&&(s._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const a=this._records.get(t);this._maybeAddToChanges(a,n);const u=a._prev,h=a._next;return u&&(u._next=h),h&&(h._prev=u),a._next=null,a._prev=null,a}const s=new oP(t);return this._records.set(t,s),s.currentValue=n,this._addToAdditions(s),s}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(s=>n(t[s],s))}}class oP{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Vy(){return new Qs([new Ly])}let Qs=(()=>{class i{constructor(n){this.factories=n}static create(n,s){if(null!=s){const a=s.factories.slice();n=n.concat(a)}return new i(n)}static extend(n){return{provide:i,useFactory:s=>i.create(n,s||Vy()),deps:[[i,new Gi,new Ut]]}}find(n){const s=this.factories.find(a=>a.supports(n));if(null!=s)return s;throw new Error(`Cannot find a differ supporting object '${n}' of type '${function(i){return i.name||typeof i}(n)}'`)}}return i.\u0275prov=ee({token:i,providedIn:"root",factory:Vy}),i})();function By(){return new Pr([new Fy])}let Pr=(()=>{class i{constructor(n){this.factories=n}static create(n,s){if(s){const a=s.factories.slice();n=n.concat(a)}return new i(n)}static extend(n){return{provide:i,useFactory:s=>i.create(n,s||By()),deps:[[i,new Gi,new Ut]]}}find(n){const s=this.factories.find(a=>a.supports(n));if(s)return s;throw new Error(`Cannot find a differ supporting object '${n}'`)}}return i.\u0275prov=ee({token:i,providedIn:"root",factory:By}),i})();const sP=[new Fy],lP=new Qs([new Ly]),uP=new Pr(sP),cP=Sy(null,"core",[{provide:Xl,useValue:"unknown"},{provide:Ry,deps:[Ce]},{provide:vy,deps:[]},{provide:zl,deps:[]}]),gP=[{provide:Lr,useClass:Lr,deps:[Oe,Ce,mo,yo,kr]},{provide:Jk,deps:[Oe],useFactory:function(i){let t=[];return i.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(n){t.push(n)}}},{provide:kr,useClass:kr,deps:[[new Ut,$s]]},{provide:Kl,useClass:Kl,deps:[]},hL,{provide:Qs,useFactory:function(){return lP},deps:[]},{provide:Pr,useFactory:function(){return uP},deps:[]},{provide:bi,useFactory:function(i){return i||"undefined"!=typeof $localize&&$localize.locale||Ll},deps:[[new rr(bi),new Ut,new Gi]]},{provide:gy,useValue:"USD"}];let mP=(()=>{class i{constructor(n){}}return i.\u0275fac=function(n){return new(n||i)(P(Lr))},i.\u0275mod=pt({type:i}),i.\u0275inj=et({providers:gP}),i})(),lu=null;function ii(){return lu}const Pe=new K("DocumentToken");let Do=(()=>{class i{historyGo(n){throw new Error("Not implemented")}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ee({token:i,factory:function(){return P(bC)},providedIn:"platform"}),i})();const hF=new K("Location Initialized");let bC=(()=>{class i extends Do{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ii().getBaseHref(this._doc)}onPopState(n){const s=ii().getGlobalEventTarget(this._doc,"window");return s.addEventListener("popstate",n,!1),()=>s.removeEventListener("popstate",n)}onHashChange(n){const s=ii().getGlobalEventTarget(this._doc,"window");return s.addEventListener("hashchange",n,!1),()=>s.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,s,a){SC()?this._history.pushState(n,s,a):this.location.hash=a}replaceState(n,s,a){SC()?this._history.replaceState(n,s,a):this.location.hash=a}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return i.\u0275fac=function(n){return new(n||i)(P(Pe))},i.\u0275prov=ee({token:i,factory:function(){return new bC(P(Pe))},providedIn:"platform"}),i})();function SC(){return!!window.history.pushState}function Sp(i,t){if(0==i.length)return t;if(0==t.length)return i;let n=0;return i.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?i+t.substring(1):1==n?i+t:i+"/"+t}function IC(i){const t=i.match(/#|\?|$/),n=t&&t.index||i.length;return i.slice(0,n-("/"===i[n-1]?1:0))+i.slice(n)}function Ii(i){return i&&"?"!==i[0]?"?"+i:i}let Hr=(()=>{class i{historyGo(n){throw new Error("Not implemented")}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ee({token:i,factory:function(){return function(i){const t=P(Pe).location;return new RC(P(Do),t&&t.origin||"")}()},providedIn:"root"}),i})();const Ip=new K("appBaseHref");let RC=(()=>{class i extends Hr{constructor(n,s){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==s&&(s=this._platformLocation.getBaseHrefFromDOM()),null==s)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=s}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Sp(this._baseHref,n)}path(n=!1){const s=this._platformLocation.pathname+Ii(this._platformLocation.search),a=this._platformLocation.hash;return a&&n?`${s}${a}`:s}pushState(n,s,a,u){const h=this.prepareExternalUrl(a+Ii(u));this._platformLocation.pushState(n,s,h)}replaceState(n,s,a,u){const h=this.prepareExternalUrl(a+Ii(u));this._platformLocation.replaceState(n,s,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var s,a;null==(a=(s=this._platformLocation).historyGo)||a.call(s,n)}}return i.\u0275fac=function(n){return new(n||i)(P(Do),P(Ip,8))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})(),fF=(()=>{class i extends Hr{constructor(n,s){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=s&&(this._baseHref=s)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let s=this._platformLocation.hash;return null==s&&(s="#"),s.length>0?s.substring(1):s}prepareExternalUrl(n){const s=Sp(this._baseHref,n);return s.length>0?"#"+s:s}pushState(n,s,a,u){let h=this.prepareExternalUrl(a+Ii(u));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.pushState(n,s,h)}replaceState(n,s,a,u){let h=this.prepareExternalUrl(a+Ii(u));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.replaceState(n,s,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var s,a;null==(a=(s=this._platformLocation).historyGo)||a.call(s,n)}}return i.\u0275fac=function(n){return new(n||i)(P(Do),P(Ip,8))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})(),Rp=(()=>{class i{constructor(n,s){this._subject=new Me,this._urlChangeListeners=[],this._platformStrategy=n;const a=this._platformStrategy.getBaseHref();this._platformLocation=s,this._baseHref=IC(DC(a)),this._platformStrategy.onPopState(u=>{this._subject.emit({url:this.path(!0),pop:!0,state:u.state,type:u.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,s=""){return this.path()==this.normalize(n+Ii(s))}normalize(n){return i.stripTrailingSlash(function(i,t){return i&&t.startsWith(i)?t.substring(i.length):t}(this._baseHref,DC(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,s="",a=null){this._platformStrategy.pushState(a,"",n,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Ii(s)),a)}replaceState(n,s="",a=null){this._platformStrategy.replaceState(a,"",n,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Ii(s)),a)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var s,a;null==(a=(s=this._platformStrategy).historyGo)||a.call(s,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(s=>{this._notifyUrlChangeListeners(s.url,s.state)}))}_notifyUrlChangeListeners(n="",s){this._urlChangeListeners.forEach(a=>a(n,s))}subscribe(n,s,a){return this._subject.subscribe({next:n,error:s,complete:a})}}return i.normalizeQueryParams=Ii,i.joinWithSlash=Sp,i.stripTrailingSlash=IC,i.\u0275fac=function(n){return new(n||i)(P(Hr),P(Do))},i.\u0275prov=ee({token:i,factory:function(){return new Rp(P(Hr),P(Do))},providedIn:"root"}),i})();function DC(i){return i.replace(/\/index.html$/,"")}var qe=(()=>((qe=qe||{})[qe.Zero=0]="Zero",qe[qe.One=1]="One",qe[qe.Two=2]="Two",qe[qe.Few=3]="Few",qe[qe.Many=4]="Many",qe[qe.Other=5]="Other",qe))();const bF=function(i){return function(i){const t=function(i){return i.toLowerCase().replace(/_/g,"-")}(i);let n=tv(t);if(n)return n;const s=t.split("-")[0];if(n=tv(s),n)return n;if("en"===s)return VN;throw new Error(`Missing locale data for the locale "${i}".`)}(i)[B.PluralCase]};class Eu{}let QF=(()=>{class i extends Eu{constructor(n){super(),this.locale=n}getPluralCategory(n,s){switch(bF(s||this.locale)(n)){case qe.Zero:return"zero";case qe.One:return"one";case qe.Two:return"two";case qe.Few:return"few";case qe.Many:return"many";default:return"other"}}}return i.\u0275fac=function(n){return new(n||i)(P(bi))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})(),FC=(()=>{class i{constructor(n,s){this._viewContainer=n,this._context=new s1,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=s}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){VC("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){VC("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,s){return!0}}return i.\u0275fac=function(n){return new(n||i)(M(kn),M(Ci))},i.\u0275dir=$({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),i})();class s1{constructor(){this.$implicit=null,this.ngIf=null}}function VC(i,t){if(t&&!t.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${he(t)}'.`)}let GC=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({providers:[{provide:Eu,useClass:QF}]}),i})();const WC="browser";let x1=(()=>{class i{}return i.\u0275prov=ee({token:i,providedIn:"root",factory:()=>new F1(P(Pe),window)}),i})();class F1{constructor(t,n){this.document=t,this.window=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const n=function(i,t){const n=i.getElementById(t)||i.getElementsByName(t)[0];if(n)return n;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const s=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let a=s.currentNode;for(;a;){const u=a.shadowRoot;if(u){const h=u.getElementById(t)||u.querySelector(`[name="${t}"]`);if(h)return h}a=s.nextNode()}}return null}(this.document,t);n&&(this.scrollToElement(n),this.attemptFocus(n))}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=t)}}scrollToElement(t){const n=t.getBoundingClientRect(),s=n.left+this.window.pageXOffset,a=n.top+this.window.pageYOffset,u=this.offset();this.window.scrollTo(s-u[0],a-u[1])}attemptFocus(t){return t.focus(),this.document.activeElement===t}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=jC(this.window.history)||jC(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function jC(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class Bp extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var i;i=new Bp,lu||(lu=i)}onAndCancel(t,n,s){return t.addEventListener(n,s,!1),()=>{t.removeEventListener(n,s,!1)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=(da=da||document.querySelector("base"),da?da.getAttribute("href"):null);return null==n?null:function(i){Tu=Tu||document.createElement("a"),Tu.setAttribute("href",i);const t=Tu.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){da=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function(i,t){t=encodeURIComponent(t);for(const n of i.split(";")){const s=n.indexOf("="),[a,u]=-1==s?[n,""]:[n.slice(0,s),n.slice(s+1)];if(a.trim()===t)return decodeURIComponent(u)}return null}(document.cookie,t)}}let Tu,da=null;const XC=new K("TRANSITION_ID"),j1=[{provide:$s,useFactory:function(i,t,n){return()=>{n.get(kr).donePromise.then(()=>{const s=ii(),a=t.querySelectorAll(`style[ng-transition="${i}"]`);for(let u=0;u<a.length;u++)s.remove(a[u])})}},deps:[XC,Pe,Ce],multi:!0}];class Up{static init(){var i;i=new Up,Kd=i}addToWindow(t){Ee.getAngularTestability=(s,a=!0)=>{const u=t.findTestabilityInTree(s,a);if(null==u)throw new Error("Could not find testability for element.");return u},Ee.getAllAngularTestabilities=()=>t.getAllTestabilities(),Ee.getAllAngularRootElements=()=>t.getAllRootElements(),Ee.frameworkStabilizers||(Ee.frameworkStabilizers=[]),Ee.frameworkStabilizers.push(s=>{const a=Ee.getAllAngularTestabilities();let u=a.length,h=!1;const d=function(f){h=h||f,u--,0==u&&s(h)};a.forEach(function(f){f.whenStable(d)})})}findTestabilityInTree(t,n,s){if(null==n)return null;const a=t.getTestability(n);return null!=a?a:s?ii().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null}}let X1=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();const pa=new K("EventManagerPlugins");let yu=(()=>{class i{constructor(n,s){this._zone=s,this._eventNameToPlugin=new Map,n.forEach(a=>a.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,s,a){return this._findPluginFor(s).addEventListener(n,s,a)}addGlobalEventListener(n,s,a){return this._findPluginFor(s).addGlobalEventListener(n,s,a)}getZone(){return this._zone}_findPluginFor(n){const s=this._eventNameToPlugin.get(n);if(s)return s;const a=this._plugins;for(let u=0;u<a.length;u++){const h=a[u];if(h.supports(n))return this._eventNameToPlugin.set(n,h),h}throw new Error(`No event manager plugin found for event ${n}`)}}return i.\u0275fac=function(n){return new(n||i)(P(pa),P(Oe))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();class Hp{constructor(t){this._doc=t}addGlobalEventListener(t,n,s){const a=ii().getGlobalEventTarget(this._doc,t);if(!a)throw new Error(`Unsupported event target ${a} for event ${n}`);return this.addEventListener(a,n,s)}}let KC=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(n){const s=new Set;n.forEach(a=>{this._stylesSet.has(a)||(this._stylesSet.add(a),s.add(a))}),this.onStylesAdded(s)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})(),fa=(()=>{class i extends KC{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,s,a){n.forEach(u=>{const h=this._doc.createElement("style");h.textContent=u,a.push(s.appendChild(h))})}addHost(n){const s=[];this._addStylesToHost(this._stylesSet,n,s),this._hostNodes.set(n,s)}removeHost(n){const s=this._hostNodes.get(n);s&&s.forEach(YC),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((s,a)=>{this._addStylesToHost(n,a,s)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(YC))}}return i.\u0275fac=function(n){return new(n||i)(P(Pe))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();function YC(i){ii().remove(i)}const Gp={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Wp=/%COMP%/g;function Cu(i,t,n){for(let s=0;s<t.length;s++){let a=t[s];Array.isArray(a)?Cu(i,a,n):(a=a.replace(Wp,i),n.push(a))}return n}function qC(i){return t=>{if("__ngUnwrap__"===t)return i;!1===i(t)&&(t.preventDefault(),t.returnValue=!1)}}let bu=(()=>{class i{constructor(n,s,a){this.eventManager=n,this.sharedStylesHost=s,this.appId=a,this.rendererByCompId=new Map,this.defaultRenderer=new jp(n)}createRenderer(n,s){if(!n||!s)return this.defaultRenderer;switch(s.encapsulation){case Ft.Emulated:{let a=this.rendererByCompId.get(s.id);return a||(a=new sV(this.eventManager,this.sharedStylesHost,s,this.appId),this.rendererByCompId.set(s.id,a)),a.applyToHost(n),a}case 1:case Ft.ShadowDom:return new aV(this.eventManager,this.sharedStylesHost,n,s);default:if(!this.rendererByCompId.has(s.id)){const a=Cu(s.id,s.styles,[]);this.sharedStylesHost.addStyles(a),this.rendererByCompId.set(s.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(n){return new(n||i)(P(yu),P(fa),P(qs))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();class jp{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?document.createElementNS(Gp[n]||n,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,n){t.appendChild(n)}insertBefore(t,n,s){t&&t.insertBefore(n,s)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let s="string"==typeof t?document.querySelector(t):t;if(!s)throw new Error(`The selector "${t}" did not match any elements`);return n||(s.textContent=""),s}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,s,a){if(a){n=a+":"+n;const u=Gp[a];u?t.setAttributeNS(u,n,s):t.setAttribute(n,s)}else t.setAttribute(n,s)}removeAttribute(t,n,s){if(s){const a=Gp[s];a?t.removeAttributeNS(a,n):t.removeAttribute(`${s}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,s,a){a&(Yt.DashCase|Yt.Important)?t.style.setProperty(n,s,a&Yt.Important?"important":""):t.style[n]=s}removeStyle(t,n,s){s&Yt.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,s){t[n]=s}setValue(t,n){t.nodeValue=n}listen(t,n,s){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,n,qC(s)):this.eventManager.addEventListener(t,n,qC(s))}}class sV extends jp{constructor(t,n,s,a){super(t),this.component=s;const u=Cu(a+"-"+s.id,s.styles,[]);n.addStyles(u),this.contentAttr="_ngcontent-%COMP%".replace(Wp,a+"-"+s.id),this.hostAttr="_nghost-%COMP%".replace(Wp,a+"-"+s.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,n){const s=super.createElement(t,n);return super.setAttribute(s,this.contentAttr,""),s}}class aV extends jp{constructor(t,n,s,a){super(t),this.sharedStylesHost=n,this.hostEl=s,this.shadowRoot=s.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=Cu(a.id,a.styles,[]);for(let h=0;h<u.length;h++){const d=document.createElement("style");d.textContent=u[h],this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,s){return super.insertBefore(this.nodeOrShadowRoot(t),n,s)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let lV=(()=>{class i extends Hp{constructor(n){super(n)}supports(n){return!0}addEventListener(n,s,a){return n.addEventListener(s,a,!1),()=>this.removeEventListener(n,s,a)}removeEventListener(n,s,a){return n.removeEventListener(s,a)}}return i.\u0275fac=function(n){return new(n||i)(P(Pe))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();const eb=["alt","control","meta","shift"],gV={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},tb={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},_V={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let mV=(()=>{class i extends Hp{constructor(n){super(n)}supports(n){return null!=i.parseEventName(n)}addEventListener(n,s,a){const u=i.parseEventName(s),h=i.eventCallback(u.fullKey,a,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ii().onAndCancel(n,u.domEventName,h))}static parseEventName(n){const s=n.toLowerCase().split("."),a=s.shift();if(0===s.length||"keydown"!==a&&"keyup"!==a)return null;const u=i._normalizeKey(s.pop());let h="";if(eb.forEach(f=>{const g=s.indexOf(f);g>-1&&(s.splice(g,1),h+=f+".")}),h+=u,0!=s.length||0===u.length)return null;const d={};return d.domEventName=a,d.fullKey=h,d}static getEventFullKey(n){let s="",a=function(i){let t=i.key;if(null==t){if(t=i.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===i.location&&tb.hasOwnProperty(t)&&(t=tb[t]))}return gV[t]||t}(n);return a=a.toLowerCase()," "===a?a="space":"."===a&&(a="dot"),eb.forEach(u=>{u!=a&&_V[u](n)&&(s+=u+".")}),s+=a,s}static eventCallback(n,s,a){return u=>{i.getEventFullKey(u)===n&&a.runGuarded(()=>s(u))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return i.\u0275fac=function(n){return new(n||i)(P(Pe))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();const IV=Sy(cP,"browser",[{provide:Xl,useValue:WC},{provide:py,useValue:function(){Bp.makeCurrent(),Up.init()},multi:!0},{provide:Pe,useFactory:function(){return i=document,Fc=i,document;var i},deps:[]}]),RV=[[],{provide:ks,useValue:"root"},{provide:mo,useFactory:function(){return new mo},deps:[]},{provide:pa,useClass:lV,multi:!0,deps:[Pe,Oe,Xl]},{provide:pa,useClass:mV,multi:!0,deps:[Pe]},[],{provide:bu,useClass:bu,deps:[yu,fa,qs]},{provide:Co,useExisting:bu},{provide:KC,useExisting:fa},{provide:fa,useClass:fa,deps:[Pe]},{provide:zd,useClass:zd,deps:[Oe]},{provide:yu,useClass:yu,deps:[pa,Oe]},{provide:class{},useClass:X1,deps:[]},[]];let nb=(()=>{class i{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:i,providers:[{provide:qs,useValue:n.appId},{provide:XC,useExisting:qs},j1]}}}return i.\u0275fac=function(n){return new(n||i)(P(i,12))},i.\u0275mod=pt({type:i}),i.\u0275inj=et({providers:RV,imports:[GC,mP]}),i})();"undefined"!=typeof window&&window;const{isArray:LV}=Array,{getPrototypeOf:PV,prototype:xV,keys:FV}=Object;function ob(i){if(1===i.length){const t=i[0];if(LV(t))return{args:t,keys:null};if(function(i){return i&&"object"==typeof i&&PV(i)===xV}(t)){const n=FV(t);return{args:n.map(s=>t[s]),keys:n}}}return{args:i,keys:null}}const{isArray:BV}=Array;function rb(i){return De(t=>function(i,t){return BV(t)?i(...t):i(t)}(i,t))}function sb(i,t){return i.reduce((n,s,a)=>(n[s]=t[a],n),{})}let ab=(()=>{class i{constructor(n,s){this._renderer=n,this._elementRef=s,this.onChange=a=>{},this.onTouched=()=>{}}setProperty(n,s){this._renderer.setProperty(this._elementRef.nativeElement,n,s)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return i.\u0275fac=function(n){return new(n||i)(M(yi),M(Xe))},i.\u0275dir=$({type:i}),i})(),Ao=(()=>{class i extends ab{}return i.\u0275fac=function(){let t;return function(s){return(t||(t=function(i){return xi(()=>{const t=i.prototype.constructor,n=t[fi]||Zc(t),s=Object.prototype;let a=Object.getPrototypeOf(i.prototype).constructor;for(;a&&a!==s;){const u=a[fi]||Zc(a);if(u&&u!==n)return u;a=Object.getPrototypeOf(a)}return u=>new u})}(i)))(s||i)}}(),i.\u0275dir=$({type:i,features:[we]}),i})();const Hn=new K("NgValueAccessor"),WV={provide:Hn,useExisting:Ie(()=>Su),multi:!0},XV=new K("CompositionEventMode");let Su=(()=>{class i extends ab{constructor(n,s,a){super(n,s),this._compositionMode=a,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const i=ii()?ii().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(n){this.setProperty("value",null==n?"":n)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return i.\u0275fac=function(n){return new(n||i)(M(yi),M(Xe),M(XV,8))},i.\u0275dir=$({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,s){1&n&&lt("input",function(u){return s._handleInput(u.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(u){return s._compositionEnd(u.target.value)})},features:[Le([WV]),we]}),i})();const Ct=new K("NgValidators"),qi=new K("NgAsyncValidators");function Eb(i){return null!=i}function Tb(i){const t=Vs(i)?st(i):i;return Nl(t),t}function vb(i){let t={};return i.forEach(n=>{t=null!=n?U(U({},t),n):t}),0===Object.keys(t).length?null:t}function yb(i,t){return t.map(n=>n(i))}function Cb(i){return i.map(t=>function(i){return!i.validate}(t)?t:n=>t.validate(n))}function Jp(i){return null!=i?function(i){if(!i)return null;const t=i.filter(Eb);return 0==t.length?null:function(n){return vb(yb(n,t))}}(Cb(i)):null}function $p(i){return null!=i?function(i){if(!i)return null;const t=i.filter(Eb);return 0==t.length?null:function(n){return function(...i){const t=Hg(i),{args:n,keys:s}=ob(i),a=new Be(u=>{const{length:h}=n;if(!h)return void u.complete();const d=new Array(h);let f=h,g=h;for(let m=0;m<h;m++){let E=!1;Cn(n[m]).subscribe(new Je(u,T=>{E||(E=!0,g--),d[m]=T},()=>f--,void 0,()=>{(!f||!E)&&(g||u.next(s?sb(s,d):d),u.complete())}))}});return t?a.pipe(rb(t)):a}(yb(n,t).map(Tb)).pipe(De(vb))}}(Cb(i)):null}function Ib(i,t){return null===i?[t]:Array.isArray(i)?[...i,t]:[i,t]}function qp(i){return i?Array.isArray(i)?i:[i]:[]}function Iu(i,t){return Array.isArray(i)?i.includes(t):i===t}function Ab(i,t){const n=qp(t);return qp(i).forEach(a=>{Iu(n,a)||n.push(a)}),n}function wb(i,t){return qp(t).filter(n=>!Iu(i,n))}class Mb{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Jp(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=$p(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,n){return!!this.control&&this.control.hasError(t,n)}getError(t,n){return this.control?this.control.getError(t,n):null}}class Pt extends Mb{get formDirective(){return null}get path(){return null}}class Qi extends Mb{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let Nb=(()=>{class i extends class{constructor(t){this._cd=t}is(t){var n,s,a;return"submitted"===t?!!(null==(n=this._cd)?void 0:n.submitted):!!(null==(a=null==(s=this._cd)?void 0:s.control)?void 0:a[t])}}{constructor(n){super(n)}}return i.\u0275fac=function(n){return new(n||i)(M(Qi,2))},i.\u0275dir=$({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,s){2&n&&Xi("ng-untouched",s.is("untouched"))("ng-touched",s.is("touched"))("ng-pristine",s.is("pristine"))("ng-dirty",s.is("dirty"))("ng-valid",s.is("valid"))("ng-invalid",s.is("invalid"))("ng-pending",s.is("pending"))},features:[we]}),i})();function ga(i,t){(function(i,t){const n=function(i){return i._rawValidators}(i);null!==t.validator?i.setValidators(Ib(n,t.validator)):"function"==typeof n&&i.setValidators([n]);const s=function(i){return i._rawAsyncValidators}(i);null!==t.asyncValidator?i.setAsyncValidators(Ib(s,t.asyncValidator)):"function"==typeof s&&i.setAsyncValidators([s]);const a=()=>i.updateValueAndValidity();wu(t._rawValidators,a),wu(t._rawAsyncValidators,a)})(i,t),t.valueAccessor.writeValue(i.value),function(i,t){t.valueAccessor.registerOnChange(n=>{i._pendingValue=n,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&kb(i,t)})}(i,t),function(i,t){const n=(s,a)=>{t.valueAccessor.writeValue(s),a&&t.viewToModelUpdate(s)};i.registerOnChange(n),t._registerOnDestroy(()=>{i._unregisterOnChange(n)})}(i,t),function(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&kb(i,t),"submit"!==i.updateOn&&i.markAsTouched()})}(i,t),function(i,t){if(t.valueAccessor.setDisabledState){const n=s=>{t.valueAccessor.setDisabledState(s)};i.registerOnDisabledChange(n),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(n)})}}(i,t)}function wu(i,t){i.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(t)})}function kb(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function Ou(i,t){const n=i.indexOf(t);n>-1&&i.splice(n,1)}const _a="VALID",Nu="INVALID",Gr="PENDING",ma="DISABLED";function of(i){return(sf(i)?i.validators:i)||null}function xb(i){return Array.isArray(i)?Jp(i):i||null}function rf(i,t){return(sf(t)?t.asyncValidators:i)||null}function Fb(i){return Array.isArray(i)?$p(i):i||null}function sf(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}class af{constructor(t,n){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=xb(this._rawValidators),this._composedAsyncValidatorFn=Fb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===_a}get invalid(){return this.status===Nu}get pending(){return this.status==Gr}get disabled(){return this.status===ma}get enabled(){return this.status!==ma}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=xb(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=Fb(t)}addValidators(t){this.setValidators(Ab(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(Ab(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(wb(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(wb(t,this._rawAsyncValidators))}hasValidator(t){return Iu(this._rawValidators,t)}hasAsyncValidator(t){return Iu(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Gr,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=ma,this.errors=null,this._forEachChild(s=>{s.disable(dt(U({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(dt(U({},t),{skipPristineCheck:n})),this._onDisabledChange.forEach(s=>s(!0))}enable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=_a,this._forEachChild(s=>{s.enable(dt(U({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(dt(U({},t),{skipPristineCheck:n})),this._onDisabledChange.forEach(s=>s(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===_a||this.status===Gr)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ma:_a}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Gr,this._hasOwnPendingAsyncValidator=!0;const n=Tb(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(s=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(s,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,n={}){this.errors=t,this._updateControlsErrors(!1!==n.emitEvent)}get(t){return function(i,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;let s=i;return t.forEach(a=>{s=s instanceof lf?s.controls.hasOwnProperty(a)?s.controls[a]:null:s instanceof sB&&s.at(a)||null}),s}(this,t)}getError(t,n){const s=n?this.get(n):this;return s&&s.errors?s.errors[t]:null}hasError(t,n){return!!this.getError(t,n)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Me,this.statusChanges=new Me}_calculateStatus(){return this._allControlsDisabled()?ma:this.errors?Nu:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Gr)?Gr:this._anyControlsHaveStatus(Nu)?Nu:_a}_anyControlsHaveStatus(t){return this._anyControls(n=>n.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){sf(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class ku extends af{constructor(t=null,n,s){super(of(n),rf(s,n)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(t,n={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(s=>s(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(t,n={}){this.setValue(t,n)}reset(t=null,n={}){this._applyFormState(t),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Ou(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Ou(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class lf extends af{constructor(t,n,s){super(of(n),rf(s,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,n){return this.controls[t]?this.controls[t]:(this.controls[t]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(t,n,s={}){this.registerControl(t,n),this.updateValueAndValidity({emitEvent:s.emitEvent}),this._onCollectionChange()}removeControl(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(t,n,s={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],n&&this.registerControl(t,n),this.updateValueAndValidity({emitEvent:s.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,n={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(s=>{this._throwIfControlMissing(s),this.controls[s].setValue(t[s],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(Object.keys(t).forEach(s=>{this.controls[s]&&this.controls[s].patchValue(t[s],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t={},n={}){this._forEachChild((s,a)=>{s.reset(t[a],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(t,n,s)=>(t[s]=n instanceof ku?n.value:n.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(n,s)=>!!s._syncPendingControls()||n);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(n=>{const s=this.controls[n];s&&t(s,n)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const n of Object.keys(this.controls)){const s=this.controls[n];if(this.contains(n)&&t(s))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,n,s)=>((n.enabled||this.disabled)&&(t[s]=n.value),t))}_reduceChildren(t,n){let s=t;return this._forEachChild((a,u)=>{s=n(s,a,u)}),s}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((n,s)=>{if(void 0===t[s])throw new Error(`Must supply a value for form control with name: '${s}'.`)})}}class sB extends af{constructor(t,n,s){super(of(n),rf(s,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,n={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(t,n,s={}){this.controls.splice(t,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:s.emitEvent})}removeAt(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(t,n,s={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),n&&(this.controls.splice(t,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:s.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,n={}){this._checkAllValuesPresent(t),t.forEach((s,a)=>{this._throwIfControlMissing(a),this.at(a).setValue(s,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(t.forEach((s,a)=>{this.at(a)&&this.at(a).patchValue(s,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t=[],n={}){this._forEachChild((s,a)=>{s.reset(t[a],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(t=>t instanceof ku?t.value:t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((n,s)=>!!s._syncPendingControls()||n,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((n,s)=>{t(n,s)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(n=>n.enabled&&t(n))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((n,s)=>{if(void 0===t[s])throw new Error(`Must supply a value for form control at index: ${s}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const uB={provide:Qi,useExisting:Ie(()=>cf)},Ub=(()=>Promise.resolve(null))();let cf=(()=>{class i extends Qi{constructor(n,s,a,u){super(),this.control=new ku,this._registered=!1,this.update=new Me,this._parent=n,this._setValidators(s),this._setAsyncValidators(a),this.valueAccessor=function(i,t){if(!t)return null;let n,s,a;return Array.isArray(t),t.forEach(u=>{u.constructor===Su?n=u:function(i){return Object.getPrototypeOf(i.constructor)===Ao}(u)?s=u:a=u}),a||s||n||null}(0,u)}ngOnChanges(n){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in n&&this._updateDisabled(n),function(i,t){if(!i.hasOwnProperty("model"))return!1;const n=i.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(i,t){return[...t.path,i]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){ga(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){Ub.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1})})}_updateDisabled(n){const s=n.isDisabled.currentValue,a=""===s||s&&"false"!==s;Ub.then(()=>{a&&!this.control.disabled?this.control.disable():!a&&this.control.disabled&&this.control.enable()})}}return i.\u0275fac=function(n){return new(n||i)(M(Pt,9),M(Ct,10),M(qi,10),M(Hn,10))},i.\u0275dir=$({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Le([uB]),we,mt]}),i})(),Gb=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({}),i})(),LB=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({imports:[[Gb]]}),i})(),PB=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({imports:[LB]}),i})();function ae(...i){return st(i,ss(i))}class gn extends yn{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:s}=this;if(t)throw n;return this._throwIfClosed(),s}next(t){super.next(this._value=t)}}function aS(i,t,n){i?ci(n,i,t):t()}const Lu=L(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function mf(...i){return rs(1)(st(i,ss(i)))}function lS(i){return new Be(t=>{Cn(i()).subscribe(t)})}function uS(){return Ze((i,t)=>{let n=null;i._refCount++;const s=new Je(t,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(n=null);const a=i._connection,u=n;n=null,a&&(!u||a===u)&&a.unsubscribe(),t.unsubscribe()});i.subscribe(s),s.closed||(n=i.connect())})}class BB extends Be{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Dg(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new r;const n=this.getSubject();t.add(this.source.subscribe(new Je(n,void 0,()=>{this._teardown(),n.complete()},s=>{this._teardown(),n.error(s)},()=>this._teardown()))),t.closed&&(this._connection=null,t=r.EMPTY)}return t}refCount(){return uS()(this)}}function wo(i,t){return Ze((n,s)=>{let a=null,u=0,h=!1;const d=()=>h&&!a&&s.complete();n.subscribe(new Je(s,f=>{null==a||a.unsubscribe();let g=0;const m=u++;Cn(i(f,m)).subscribe(a=new Je(s,E=>s.next(t?t(f,E,m,g++):E),()=>{a=null,d()}))},()=>{h=!0,d()}))})}function HB(i,t,n,s,a){return(u,h)=>{let d=n,f=t,g=0;u.subscribe(new Je(h,m=>{const E=g++;f=d?i(f,m,E):(d=!0,m),s&&h.next(f)},a&&(()=>{d&&h.next(f),h.complete()})))}}function cS(i,t){return Ze(HB(i,t,arguments.length>=2,!0))}function Mo(i,t){return Ze((n,s)=>{let a=0;n.subscribe(new Je(s,u=>i.call(t,u,a++)&&s.next(u)))})}function Zi(i){return Ze((t,n)=>{let u,s=null,a=!1;s=t.subscribe(new Je(n,void 0,void 0,h=>{u=Cn(i(h,Zi(i)(t))),s?(s.unsubscribe(),s=null,u.subscribe(n)):a=!0})),a&&(s.unsubscribe(),s=null,u.subscribe(n))})}function Ta(i,t){return N(t)?rt(i,t,1):rt(i,1)}function Ef(i){return i<=0?()=>hi:Ze((t,n)=>{let s=[];t.subscribe(new Je(n,a=>{s.push(a),i<s.length&&s.shift()},()=>{for(const a of s)n.next(a);n.complete()},void 0,()=>{s=null}))})}function hS(i=GB){return Ze((t,n)=>{let s=!1;t.subscribe(new Je(n,a=>{s=!0,n.next(a)},()=>s?n.complete():n.error(i())))})}function GB(){return new Lu}function dS(i){return Ze((t,n)=>{let s=!1;t.subscribe(new Je(n,a=>{s=!0,n.next(a)},()=>{s||n.next(i),n.complete()}))})}function Wr(i,t){const n=arguments.length>=2;return s=>s.pipe(i?Mo((a,u)=>i(a,u,s)):Li,Ga(1),n?dS(t):hS(()=>new Lu))}function $t(i,t,n){const s=N(i)||t||n?{next:i,error:t,complete:n}:i;return s?Ze((a,u)=>{var h;null===(h=s.subscribe)||void 0===h||h.call(s);let d=!0;a.subscribe(new Je(u,f=>{var g;null===(g=s.next)||void 0===g||g.call(s,f),u.next(f)},()=>{var f;d=!1,null===(f=s.complete)||void 0===f||f.call(s),u.complete()},f=>{var g;d=!1,null===(g=s.error)||void 0===g||g.call(s,f),u.error(f)},()=>{var f,g;d&&(null===(f=s.unsubscribe)||void 0===f||f.call(s)),null===(g=s.finalize)||void 0===g||g.call(s)}))}):Li}class Ai{constructor(t,n){this.id=t,this.url=n}}class Tf extends Ai{constructor(t,n,s="imperative",a=null){super(t,n),this.navigationTrigger=s,this.restoredState=a}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class va extends Ai{constructor(t,n,s){super(t,n),this.urlAfterRedirects=s}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class pS extends Ai{constructor(t,n,s){super(t,n),this.reason=s}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class XB extends Ai{constructor(t,n,s){super(t,n),this.error=s}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class zB extends Ai{constructor(t,n,s,a){super(t,n),this.urlAfterRedirects=s,this.state=a}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class KB extends Ai{constructor(t,n,s,a){super(t,n),this.urlAfterRedirects=s,this.state=a}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class YB extends Ai{constructor(t,n,s,a,u){super(t,n),this.urlAfterRedirects=s,this.state=a,this.shouldActivate=u}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class JB extends Ai{constructor(t,n,s,a){super(t,n),this.urlAfterRedirects=s,this.state=a}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $B extends Ai{constructor(t,n,s,a){super(t,n),this.urlAfterRedirects=s,this.state=a}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fS{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class gS{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class qB{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class QB{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ZB{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class eU{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _S{constructor(t,n,s){this.routerEvent=t,this.position=n,this.anchor=s}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const pe="primary";class tU{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function jr(i){return new tU(i)}const mS="ngNavigationCancelingError";function vf(i){const t=Error("NavigationCancelingError: "+i);return t[mS]=!0,t}function iU(i,t,n){const s=n.path.split("/");if(s.length>i.length||"full"===n.pathMatch&&(t.hasChildren()||s.length<i.length))return null;const a={};for(let u=0;u<s.length;u++){const h=s[u],d=i[u];if(h.startsWith(":"))a[h.substring(1)]=d;else if(h!==d.path)return null}return{consumed:i.slice(0,s.length),posParams:a}}function oi(i,t){const n=i?Object.keys(i):void 0,s=t?Object.keys(t):void 0;if(!n||!s||n.length!=s.length)return!1;let a;for(let u=0;u<n.length;u++)if(a=n[u],!ES(i[a],t[a]))return!1;return!0}function ES(i,t){if(Array.isArray(i)&&Array.isArray(t)){if(i.length!==t.length)return!1;const n=[...i].sort(),s=[...t].sort();return n.every((a,u)=>s[u]===a)}return i===t}function TS(i){return Array.prototype.concat.apply([],i)}function vS(i){return i.length>0?i[i.length-1]:null}function ft(i,t){for(const n in i)i.hasOwnProperty(n)&&t(i[n],n)}function ri(i){return Nl(i)?i:Vs(i)?st(Promise.resolve(i)):ae(i)}const sU={exact:function bS(i,t,n){if(!No(i.segments,t.segments)||!Pu(i.segments,t.segments,n)||i.numberOfChildren!==t.numberOfChildren)return!1;for(const s in t.children)if(!i.children[s]||!bS(i.children[s],t.children[s],n))return!1;return!0},subset:SS},yS={exact:function(i,t){return oi(i,t)},subset:function(i,t){return Object.keys(t).length<=Object.keys(i).length&&Object.keys(t).every(n=>ES(i[n],t[n]))},ignored:()=>!0};function CS(i,t,n){return sU[n.paths](i.root,t.root,n.matrixParams)&&yS[n.queryParams](i.queryParams,t.queryParams)&&!("exact"===n.fragment&&i.fragment!==t.fragment)}function SS(i,t,n){return IS(i,t,t.segments,n)}function IS(i,t,n,s){if(i.segments.length>n.length){const a=i.segments.slice(0,n.length);return!(!No(a,n)||t.hasChildren()||!Pu(a,n,s))}if(i.segments.length===n.length){if(!No(i.segments,n)||!Pu(i.segments,n,s))return!1;for(const a in t.children)if(!i.children[a]||!SS(i.children[a],t.children[a],s))return!1;return!0}{const a=n.slice(0,i.segments.length),u=n.slice(i.segments.length);return!!(No(i.segments,a)&&Pu(i.segments,a,s)&&i.children[pe])&&IS(i.children[pe],t,u,s)}}function Pu(i,t,n){return t.every((s,a)=>yS[n](i[a].parameters,s.parameters))}class Oo{constructor(t,n,s){this.root=t,this.queryParams=n,this.fragment=s}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=jr(this.queryParams)),this._queryParamMap}toString(){return hU.serialize(this)}}class ge{constructor(t,n){this.segments=t,this.children=n,this.parent=null,ft(n,(s,a)=>s.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return xu(this)}}class ya{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=jr(this.parameters)),this._parameterMap}toString(){return MS(this)}}function No(i,t){return i.length===t.length&&i.every((n,s)=>n.path===t[s].path)}class RS{}class DS{parse(t){const n=new vU(t);return new Oo(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${Ca(t.root,!0)}`,s=function(i){const t=Object.keys(i).map(n=>{const s=i[n];return Array.isArray(s)?s.map(a=>`${Fu(n)}=${Fu(a)}`).join("&"):`${Fu(n)}=${Fu(s)}`}).filter(n=>!!n);return t.length?`?${t.join("&")}`:""}(t.queryParams);var i;return`${n}${s}${"string"==typeof t.fragment?`#${i=t.fragment,encodeURI(i)}`:""}`}}const hU=new DS;function xu(i){return i.segments.map(t=>MS(t)).join("/")}function Ca(i,t){if(!i.hasChildren())return xu(i);if(t){const n=i.children[pe]?Ca(i.children[pe],!1):"",s=[];return ft(i.children,(a,u)=>{u!==pe&&s.push(`${u}:${Ca(a,!1)}`)}),s.length>0?`${n}(${s.join("//")})`:n}{const n=function(i,t){let n=[];return ft(i.children,(s,a)=>{a===pe&&(n=n.concat(t(s,a)))}),ft(i.children,(s,a)=>{a!==pe&&(n=n.concat(t(s,a)))}),n}(i,(s,a)=>a===pe?[Ca(i.children[pe],!1)]:[`${a}:${Ca(s,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[pe]?`${xu(i)}/${n[0]}`:`${xu(i)}/(${n.join("//")})`}}function AS(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Fu(i){return AS(i).replace(/%3B/gi,";")}function yf(i){return AS(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Vu(i){return decodeURIComponent(i)}function wS(i){return Vu(i.replace(/\+/g,"%20"))}function MS(i){return`${yf(i.path)}${function(i){return Object.keys(i).map(t=>`;${yf(t)}=${yf(i[t])}`).join("")}(i.parameters)}`}const gU=/^[^\/()?;=#]+/;function Bu(i){const t=i.match(gU);return t?t[0]:""}const _U=/^[^=?&#]+/,EU=/^[^&#]+/;class vU{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ge([],{}):new ge([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let s={};return this.peekStartsWith("(")&&(s=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(s[pe]=new ge(t,n)),s}parseSegment(){const t=Bu(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new ya(Vu(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=Bu(this.remaining);if(!n)return;this.capture(n);let s="";if(this.consumeOptional("=")){const a=Bu(this.remaining);a&&(s=a,this.capture(s))}t[Vu(n)]=Vu(s)}parseQueryParam(t){const n=function(i){const t=i.match(_U);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let s="";if(this.consumeOptional("=")){const h=function(i){const t=i.match(EU);return t?t[0]:""}(this.remaining);h&&(s=h,this.capture(s))}const a=wS(n),u=wS(s);if(t.hasOwnProperty(a)){let h=t[a];Array.isArray(h)||(h=[h],t[a]=h),h.push(u)}else t[a]=u}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const s=Bu(this.remaining),a=this.remaining[s.length];if("/"!==a&&")"!==a&&";"!==a)throw new Error(`Cannot parse url '${this.url}'`);let u;s.indexOf(":")>-1?(u=s.substr(0,s.indexOf(":")),this.capture(u),this.capture(":")):t&&(u=pe);const h=this.parseChildren();n[u]=1===Object.keys(h).length?h[pe]:new ge([],h),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class OS{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=Cf(t,this._root);return n?n.children.map(s=>s.value):[]}firstChild(t){const n=Cf(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=bf(t,this._root);return n.length<2?[]:n[n.length-2].children.map(a=>a.value).filter(a=>a!==t)}pathFromRoot(t){return bf(t,this._root).map(n=>n.value)}}function Cf(i,t){if(i===t.value)return t;for(const n of t.children){const s=Cf(i,n);if(s)return s}return null}function bf(i,t){if(i===t.value)return[t];for(const n of t.children){const s=bf(i,n);if(s.length)return s.unshift(t),s}return[]}class wi{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function Xr(i){const t={};return i&&i.children.forEach(n=>t[n.value.outlet]=n),t}class NS extends OS{constructor(t,n){super(t),this.snapshot=n,Sf(this,t)}toString(){return this.snapshot.toString()}}function kS(i,t){const n=function(i,t){const h=new Uu([],{},{},"",{},pe,t,null,i.root,-1,{});return new PS("",new wi(h,[]))}(i,t),s=new gn([new ya("",{})]),a=new gn({}),u=new gn({}),h=new gn({}),d=new gn(""),f=new zr(s,a,h,d,u,pe,t,n.root);return f.snapshot=n.root,new NS(new wi(f,[]),n)}class zr{constructor(t,n,s,a,u,h,d,f){this.url=t,this.params=n,this.queryParams=s,this.fragment=a,this.data=u,this.outlet=h,this.component=d,this._futureSnapshot=f}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(De(t=>jr(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(De(t=>jr(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function LS(i,t="emptyOnly"){const n=i.pathFromRoot;let s=0;if("always"!==t)for(s=n.length-1;s>=1;){const a=n[s],u=n[s-1];if(a.routeConfig&&""===a.routeConfig.path)s--;else{if(u.component)break;s--}}return function(i){return i.reduce((t,n)=>({params:U(U({},t.params),n.params),data:U(U({},t.data),n.data),resolve:U(U({},t.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(s))}class Uu{constructor(t,n,s,a,u,h,d,f,g,m,E){this.url=t,this.params=n,this.queryParams=s,this.fragment=a,this.data=u,this.outlet=h,this.component=d,this.routeConfig=f,this._urlSegment=g,this._lastPathIndex=m,this._resolve=E}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=jr(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=jr(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(s=>s.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class PS extends OS{constructor(t,n){super(n),this.url=t,Sf(this,n)}toString(){return xS(this._root)}}function Sf(i,t){t.value._routerState=i,t.children.forEach(n=>Sf(i,n))}function xS(i){const t=i.children.length>0?` { ${i.children.map(xS).join(", ")} } `:"";return`${i.value}${t}`}function If(i){if(i.snapshot){const t=i.snapshot,n=i._futureSnapshot;i.snapshot=n,oi(t.queryParams,n.queryParams)||i.queryParams.next(n.queryParams),t.fragment!==n.fragment&&i.fragment.next(n.fragment),oi(t.params,n.params)||i.params.next(n.params),function(i,t){if(i.length!==t.length)return!1;for(let n=0;n<i.length;++n)if(!oi(i[n],t[n]))return!1;return!0}(t.url,n.url)||i.url.next(n.url),oi(t.data,n.data)||i.data.next(n.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function Rf(i,t){const n=oi(i.params,t.params)&&function(i,t){return No(i,t)&&i.every((n,s)=>oi(n.parameters,t[s].parameters))}(i.url,t.url);return n&&!(!i.parent!=!t.parent)&&(!i.parent||Rf(i.parent,t.parent))}function ba(i,t,n){if(n&&i.shouldReuseRoute(t.value,n.value.snapshot)){const s=n.value;s._futureSnapshot=t.value;const a=function(i,t,n){return t.children.map(s=>{for(const a of n.children)if(i.shouldReuseRoute(s.value,a.value.snapshot))return ba(i,s,a);return ba(i,s)})}(i,t,n);return new wi(s,a)}{if(i.shouldAttach(t.value)){const u=i.retrieve(t.value);if(null!==u){const h=u.route;return h.value._futureSnapshot=t.value,h.children=t.children.map(d=>ba(i,d)),h}}const s=function(i){return new zr(new gn(i.url),new gn(i.params),new gn(i.queryParams),new gn(i.fragment),new gn(i.data),i.outlet,i.component,i)}(t.value),a=t.children.map(u=>ba(i,u));return new wi(s,a)}}function Hu(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Sa(i){return"object"==typeof i&&null!=i&&i.outlets}function Df(i,t,n,s,a){let u={};return s&&ft(s,(h,d)=>{u[d]=Array.isArray(h)?h.map(f=>`${f}`):`${h}`}),new Oo(n.root===i?t:FS(n.root,i,t),u,a)}function FS(i,t,n){const s={};return ft(i.children,(a,u)=>{s[u]=a===t?n:FS(a,t,n)}),new ge(i.segments,s)}class VS{constructor(t,n,s){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=s,t&&s.length>0&&Hu(s[0]))throw new Error("Root segment cannot have matrix parameters");const a=s.find(Sa);if(a&&a!==vS(s))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Af{constructor(t,n,s){this.segmentGroup=t,this.processChildren=n,this.index=s}}function BS(i,t,n){if(i||(i=new ge([],{})),0===i.segments.length&&i.hasChildren())return Gu(i,t,n);const s=function(i,t,n){let s=0,a=t;const u={match:!1,pathIndex:0,commandIndex:0};for(;a<i.segments.length;){if(s>=n.length)return u;const h=i.segments[a],d=n[s];if(Sa(d))break;const f=`${d}`,g=s<n.length-1?n[s+1]:null;if(a>0&&void 0===f)break;if(f&&g&&"object"==typeof g&&void 0===g.outlets){if(!HS(f,g,h))return u;s+=2}else{if(!HS(f,{},h))return u;s++}a++}return{match:!0,pathIndex:a,commandIndex:s}}(i,t,n),a=n.slice(s.commandIndex);if(s.match&&s.pathIndex<i.segments.length){const u=new ge(i.segments.slice(0,s.pathIndex),{});return u.children[pe]=new ge(i.segments.slice(s.pathIndex),i.children),Gu(u,0,a)}return s.match&&0===a.length?new ge(i.segments,{}):s.match&&!i.hasChildren()?wf(i,t,n):s.match?Gu(i,0,a):wf(i,t,n)}function Gu(i,t,n){if(0===n.length)return new ge(i.segments,{});{const s=function(i){return Sa(i[0])?i[0].outlets:{[pe]:i}}(n),a={};return ft(s,(u,h)=>{"string"==typeof u&&(u=[u]),null!==u&&(a[h]=BS(i.children[h],t,u))}),ft(i.children,(u,h)=>{void 0===s[h]&&(a[h]=u)}),new ge(i.segments,a)}}function wf(i,t,n){const s=i.segments.slice(0,t);let a=0;for(;a<n.length;){const u=n[a];if(Sa(u)){const f=NU(u.outlets);return new ge(s,f)}if(0===a&&Hu(n[0])){s.push(new ya(i.segments[t].path,US(n[0]))),a++;continue}const h=Sa(u)?u.outlets[pe]:`${u}`,d=a<n.length-1?n[a+1]:null;h&&d&&Hu(d)?(s.push(new ya(h,US(d))),a+=2):(s.push(new ya(h,{})),a++)}return new ge(s,{})}function NU(i){const t={};return ft(i,(n,s)=>{"string"==typeof n&&(n=[n]),null!==n&&(t[s]=wf(new ge([],{}),0,n))}),t}function US(i){const t={};return ft(i,(n,s)=>t[s]=`${n}`),t}function HS(i,t,n){return i==n.path&&oi(t,n.parameters)}class LU{constructor(t,n,s,a){this.routeReuseStrategy=t,this.futureState=n,this.currState=s,this.forwardEvent=a}activate(t){const n=this.futureState._root,s=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,s,t),If(this.futureState.root),this.activateChildRoutes(n,s,t)}deactivateChildRoutes(t,n,s){const a=Xr(n);t.children.forEach(u=>{const h=u.value.outlet;this.deactivateRoutes(u,a[h],s),delete a[h]}),ft(a,(u,h)=>{this.deactivateRouteAndItsChildren(u,s)})}deactivateRoutes(t,n,s){const a=t.value,u=n?n.value:null;if(a===u)if(a.component){const h=s.getContext(a.outlet);h&&this.deactivateChildRoutes(t,n,h.children)}else this.deactivateChildRoutes(t,n,s);else u&&this.deactivateRouteAndItsChildren(n,s)}deactivateRouteAndItsChildren(t,n){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const s=n.getContext(t.value.outlet),a=s&&t.value.component?s.children:n,u=Xr(t);for(const h of Object.keys(u))this.deactivateRouteAndItsChildren(u[h],a);if(s&&s.outlet){const h=s.outlet.detach(),d=s.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:h,route:t,contexts:d})}}deactivateRouteAndOutlet(t,n){const s=n.getContext(t.value.outlet),a=s&&t.value.component?s.children:n,u=Xr(t);for(const h of Object.keys(u))this.deactivateRouteAndItsChildren(u[h],a);s&&s.outlet&&(s.outlet.deactivate(),s.children.onOutletDeactivated(),s.attachRef=null,s.resolver=null,s.route=null)}activateChildRoutes(t,n,s){const a=Xr(n);t.children.forEach(u=>{this.activateRoutes(u,a[u.value.outlet],s),this.forwardEvent(new eU(u.value.snapshot))}),t.children.length&&this.forwardEvent(new QB(t.value.snapshot))}activateRoutes(t,n,s){const a=t.value,u=n?n.value:null;if(If(a),a===u)if(a.component){const h=s.getOrCreateContext(a.outlet);this.activateChildRoutes(t,n,h.children)}else this.activateChildRoutes(t,n,s);else if(a.component){const h=s.getOrCreateContext(a.outlet);if(this.routeReuseStrategy.shouldAttach(a.snapshot)){const d=this.routeReuseStrategy.retrieve(a.snapshot);this.routeReuseStrategy.store(a.snapshot,null),h.children.onOutletReAttached(d.contexts),h.attachRef=d.componentRef,h.route=d.route.value,h.outlet&&h.outlet.attach(d.componentRef,d.route.value),If(d.route.value),this.activateChildRoutes(t,null,h.children)}else{const d=function(i){for(let t=i.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(a.snapshot),f=d?d.module.componentFactoryResolver:null;h.attachRef=null,h.route=a,h.resolver=f,h.outlet&&h.outlet.activateWith(a,f),this.activateChildRoutes(t,null,h.children)}}else this.activateChildRoutes(t,null,s)}}class Mf{constructor(t,n){this.routes=t,this.module=n}}function eo(i){return"function"==typeof i}function ko(i){return i instanceof Oo}const Ia=Symbol("INITIAL_VALUE");function Ra(){return wo(i=>function(...i){const t=ss(i),n=Hg(i),{args:s,keys:a}=ob(i);if(0===s.length)return st([],t);const u=new Be(function(i,t,n=Li){return s=>{aS(t,()=>{const{length:a}=i,u=new Array(a);let h=a,d=a;for(let f=0;f<a;f++)aS(t,()=>{const g=st(i[f],t);let m=!1;g.subscribe(new Je(s,E=>{u[f]=E,m||(m=!0,d--),d||s.next(n(u.slice()))},()=>{--h||s.complete()}))},s)},s)}}(s,t,a?h=>sb(a,h):Li));return n?u.pipe(rb(n)):u}(i.map(t=>t.pipe(Ga(1),function(...i){const t=ss(i);return Ze((n,s)=>{(t?mf(i,n,t):mf(i,n)).subscribe(s)})}(Ia)))).pipe(cS((t,n)=>{let s=!1;return n.reduce((a,u,h)=>a!==Ia?a:(u===Ia&&(s=!0),s||!1!==u&&h!==n.length-1&&!ko(u)?a:u),t)},Ia),Mo(t=>t!==Ia),De(t=>ko(t)?t:!0===t),Ga(1)))}class HU{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Da,this.attachRef=null}}class Da{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const s=this.getOrCreateContext(t);s.outlet=n,this.contexts.set(t,s)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new HU,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}let Of=(()=>{class i{constructor(n,s,a,u,h){this.parentContexts=n,this.location=s,this.resolver=a,this.changeDetector=h,this.activated=null,this._activatedRoute=null,this.activateEvents=new Me,this.deactivateEvents=new Me,this.attachEvents=new Me,this.detachEvents=new Me,this.name=u||pe,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,s){this.activated=n,this._activatedRoute=s,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,s){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const h=(s=s||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),d=this.parentContexts.getOrCreateContext(this.name).children,f=new GU(n,d,this.location.injector);this.activated=this.location.createComponent(h,this.location.length,f),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(n){return new(n||i)(M(Da),M(kn),M(yo),function(i){return function(i,t){if("class"===t)return i.classes;if("style"===t)return i.styles;const n=i.attrs;if(n){const s=n.length;let a=0;for(;a<s;){const u=n[a];if(C_(u))break;if(0===u)a+=2;else if("number"==typeof u)for(a++;a<s&&"string"==typeof n[a];)a++;else{if(u===t)return n[a+1];a+=2}}}return null}(tt(),i)}("name"),M(Yl))},i.\u0275dir=$({type:i,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),i})();class GU{constructor(t,n,s){this.route=t,this.childContexts=n,this.parent=s}get(t,n){return t===zr?this.route:t===Da?this.childContexts:this.parent.get(t,n)}}let GS=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=so({type:i,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,s){1&n&&Mn(0,"router-outlet")},directives:[Of],encapsulation:2}),i})();function WS(i,t=""){for(let n=0;n<i.length;n++){const s=i[n];WU(s,jU(t,s))}}function WU(i,t){i.children&&WS(i.children,t)}function jU(i,t){return t?i||t.path?i&&!t.path?`${i}/`:!i&&t.path?t.path:`${i}/${t.path}`:"":i}function Nf(i){const t=i.children&&i.children.map(Nf),n=t?dt(U({},i),{children:t}):U({},i);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==pe&&(n.component=GS),n}function _n(i){return i.outlet||pe}function jS(i,t){const n=i.filter(s=>_n(s)===t);return n.push(...i.filter(s=>_n(s)!==t)),n}const XS={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Wu(i,t,n){var d;if(""===t.path)return"full"===t.pathMatch&&(i.hasChildren()||n.length>0)?U({},XS):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const a=(t.matcher||iU)(n,i,t);if(!a)return U({},XS);const u={};ft(a.posParams,(f,g)=>{u[g]=f.path});const h=a.consumed.length>0?U(U({},u),a.consumed[a.consumed.length-1].parameters):u;return{matched:!0,consumedSegments:a.consumed,lastChild:a.consumed.length,parameters:h,positionalParamSegments:null!=(d=a.posParams)?d:{}}}function ju(i,t,n,s,a="corrected"){if(n.length>0&&function(i,t,n){return n.some(s=>Xu(i,t,s)&&_n(s)!==pe)}(i,n,s)){const h=new ge(t,function(i,t,n,s){const a={};a[pe]=s,s._sourceSegment=i,s._segmentIndexShift=t.length;for(const u of n)if(""===u.path&&_n(u)!==pe){const h=new ge([],{});h._sourceSegment=i,h._segmentIndexShift=t.length,a[_n(u)]=h}return a}(i,t,s,new ge(n,i.children)));return h._sourceSegment=i,h._segmentIndexShift=t.length,{segmentGroup:h,slicedSegments:[]}}if(0===n.length&&function(i,t,n){return n.some(s=>Xu(i,t,s))}(i,n,s)){const h=new ge(i.segments,function(i,t,n,s,a,u){const h={};for(const d of s)if(Xu(i,n,d)&&!a[_n(d)]){const f=new ge([],{});f._sourceSegment=i,f._segmentIndexShift="legacy"===u?i.segments.length:t.length,h[_n(d)]=f}return U(U({},a),h)}(i,t,n,s,i.children,a));return h._sourceSegment=i,h._segmentIndexShift=t.length,{segmentGroup:h,slicedSegments:n}}const u=new ge(i.segments,i.children);return u._sourceSegment=i,u._segmentIndexShift=t.length,{segmentGroup:u,slicedSegments:n}}function Xu(i,t,n){return(!(i.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function zS(i,t,n,s){return!!(_n(i)===s||s!==pe&&Xu(t,n,i))&&("**"===i.path||Wu(t,i,n).matched)}function KS(i,t,n){return 0===t.length&&!i.children[n]}class Aa{constructor(t){this.segmentGroup=t||null}}class YS{constructor(t){this.urlTree=t}}function zu(i){return new Be(t=>t.error(new Aa(i)))}function JS(i){return new Be(t=>t.error(new YS(i)))}function JU(i){return new Be(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${i}'`)))}class QU{constructor(t,n,s,a,u){this.configLoader=n,this.urlSerializer=s,this.urlTree=a,this.config=u,this.allowRedirects=!0,this.ngModule=t.get(ni)}apply(){const t=ju(this.urlTree.root,[],[],this.config).segmentGroup,n=new ge(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,pe).pipe(De(u=>this.createUrlTree(kf(u),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Zi(u=>{if(u instanceof YS)return this.allowRedirects=!1,this.match(u.urlTree);throw u instanceof Aa?this.noMatchError(u):u}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,pe).pipe(De(a=>this.createUrlTree(kf(a),t.queryParams,t.fragment))).pipe(Zi(a=>{throw a instanceof Aa?this.noMatchError(a):a}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,n,s){const a=t.segments.length>0?new ge([],{[pe]:t}):t;return new Oo(a,n,s)}expandSegmentGroup(t,n,s,a){return 0===s.segments.length&&s.hasChildren()?this.expandChildren(t,n,s).pipe(De(u=>new ge([],u))):this.expandSegment(t,s,n,s.segments,a,!0)}expandChildren(t,n,s){const a=[];for(const u of Object.keys(s.children))"primary"===u?a.unshift(u):a.push(u);return st(a).pipe(Ta(u=>{const h=s.children[u],d=jS(n,u);return this.expandSegmentGroup(t,d,h,u).pipe(De(f=>({segment:f,outlet:u})))}),cS((u,h)=>(u[h.outlet]=h.segment,u),{}),function(i,t){const n=arguments.length>=2;return s=>s.pipe(i?Mo((a,u)=>i(a,u,s)):Li,Ef(1),n?dS(t):hS(()=>new Lu))}())}expandSegment(t,n,s,a,u,h){return st(s).pipe(Ta(d=>this.expandSegmentAgainstRoute(t,n,s,d,a,u,h).pipe(Zi(g=>{if(g instanceof Aa)return ae(null);throw g}))),Wr(d=>!!d),Zi((d,f)=>{if(d instanceof Lu||"EmptyError"===d.name){if(KS(n,a,u))return ae(new ge([],{}));throw new Aa(n)}throw d}))}expandSegmentAgainstRoute(t,n,s,a,u,h,d){return zS(a,n,u,h)?void 0===a.redirectTo?this.matchSegmentAgainstRoute(t,n,a,u,h):d&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,n,s,a,u,h):zu(n):zu(n)}expandSegmentAgainstRouteUsingRedirect(t,n,s,a,u,h){return"**"===a.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,s,a,h):this.expandRegularSegmentAgainstRouteUsingRedirect(t,n,s,a,u,h)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,s,a){const u=this.applyRedirectCommands([],s.redirectTo,{});return s.redirectTo.startsWith("/")?JS(u):this.lineralizeSegments(s,u).pipe(rt(h=>{const d=new ge(h,{});return this.expandSegment(t,d,n,h,a,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,n,s,a,u,h){const{matched:d,consumedSegments:f,lastChild:g,positionalParamSegments:m}=Wu(n,a,u);if(!d)return zu(n);const E=this.applyRedirectCommands(f,a.redirectTo,m);return a.redirectTo.startsWith("/")?JS(E):this.lineralizeSegments(a,E).pipe(rt(T=>this.expandSegment(t,n,s,T.concat(u.slice(g)),h,!1)))}matchSegmentAgainstRoute(t,n,s,a,u){if("**"===s.path)return s.loadChildren?(s._loadedConfig?ae(s._loadedConfig):this.configLoader.load(t.injector,s)).pipe(De(T=>(s._loadedConfig=T,new ge(a,{})))):ae(new ge(a,{}));const{matched:h,consumedSegments:d,lastChild:f}=Wu(n,s,a);if(!h)return zu(n);const g=a.slice(f);return this.getChildConfig(t,s,a).pipe(rt(E=>{const T=E.module,y=E.routes,{segmentGroup:C,slicedSegments:I}=ju(n,d,g,y),S=new ge(C.segments,C.children);if(0===I.length&&S.hasChildren())return this.expandChildren(T,y,S).pipe(De(x=>new ge(d,x)));if(0===y.length&&0===I.length)return ae(new ge(d,{}));const D=_n(s)===u;return this.expandSegment(T,S,y,I,D?pe:u,!0).pipe(De(k=>new ge(d.concat(k.segments),k.children)))}))}getChildConfig(t,n,s){return n.children?ae(new Mf(n.children,t)):n.loadChildren?void 0!==n._loadedConfig?ae(n._loadedConfig):this.runCanLoadGuards(t.injector,n,s).pipe(rt(a=>{return a?this.configLoader.load(t.injector,n).pipe(De(u=>(n._loadedConfig=u,u))):(i=n,new Be(t=>t.error(vf(`Cannot load children because the guard of the route "path: '${i.path}'" returned false`))));var i})):ae(new Mf([],t))}runCanLoadGuards(t,n,s){const a=n.canLoad;return a&&0!==a.length?ae(a.map(h=>{const d=t.get(h);let f;if((i=d)&&eo(i.canLoad))f=d.canLoad(n,s);else{if(!eo(d))throw new Error("Invalid CanLoad guard");f=d(n,s)}var i;return ri(f)})).pipe(Ra(),$t(h=>{if(!ko(h))return;const d=vf(`Redirecting to "${this.urlSerializer.serialize(h)}"`);throw d.url=h,d}),De(h=>!0===h)):ae(!0)}lineralizeSegments(t,n){let s=[],a=n.root;for(;;){if(s=s.concat(a.segments),0===a.numberOfChildren)return ae(s);if(a.numberOfChildren>1||!a.children[pe])return JU(t.redirectTo);a=a.children[pe]}}applyRedirectCommands(t,n,s){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),t,s)}applyRedirectCreatreUrlTree(t,n,s,a){const u=this.createSegmentGroup(t,n.root,s,a);return new Oo(u,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const s={};return ft(t,(a,u)=>{if("string"==typeof a&&a.startsWith(":")){const d=a.substring(1);s[u]=n[d]}else s[u]=a}),s}createSegmentGroup(t,n,s,a){const u=this.createSegments(t,n.segments,s,a);let h={};return ft(n.children,(d,f)=>{h[f]=this.createSegmentGroup(t,d,s,a)}),new ge(u,h)}createSegments(t,n,s,a){return n.map(u=>u.path.startsWith(":")?this.findPosParam(t,u,a):this.findOrReturn(u,s))}findPosParam(t,n,s){const a=s[n.path.substring(1)];if(!a)throw new Error(`Cannot redirect to '${t}'. Cannot find '${n.path}'.`);return a}findOrReturn(t,n){let s=0;for(const a of n){if(a.path===t.path)return n.splice(s),a;s++}return t}}function kf(i){const t={};for(const s of Object.keys(i.children)){const u=kf(i.children[s]);(u.segments.length>0||u.hasChildren())&&(t[s]=u)}return function(i){if(1===i.numberOfChildren&&i.children[pe]){const t=i.children[pe];return new ge(i.segments.concat(t.segments),t.children)}return i}(new ge(i.segments,t))}class $S{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Ku{constructor(t,n){this.component=t,this.route=n}}function tH(i,t,n){const s=i._root;return wa(s,t?t._root:null,n,[s.value])}function Yu(i,t,n){const s=function(i){if(!i)return null;for(let t=i.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(s?s.module.injector:n).get(i)}function wa(i,t,n,s,a={canDeactivateChecks:[],canActivateChecks:[]}){const u=Xr(t);return i.children.forEach(h=>{(function(i,t,n,s,a={canDeactivateChecks:[],canActivateChecks:[]}){const u=i.value,h=t?t.value:null,d=n?n.getContext(i.value.outlet):null;if(h&&u.routeConfig===h.routeConfig){const f=function(i,t,n){if("function"==typeof n)return n(i,t);switch(n){case"pathParamsChange":return!No(i.url,t.url);case"pathParamsOrQueryParamsChange":return!No(i.url,t.url)||!oi(i.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Rf(i,t)||!oi(i.queryParams,t.queryParams);default:return!Rf(i,t)}}(h,u,u.routeConfig.runGuardsAndResolvers);f?a.canActivateChecks.push(new $S(s)):(u.data=h.data,u._resolvedData=h._resolvedData),wa(i,t,u.component?d?d.children:null:n,s,a),f&&d&&d.outlet&&d.outlet.isActivated&&a.canDeactivateChecks.push(new Ku(d.outlet.component,h))}else h&&Ma(t,d,a),a.canActivateChecks.push(new $S(s)),wa(i,null,u.component?d?d.children:null:n,s,a)})(h,u[h.value.outlet],n,s.concat([h.value]),a),delete u[h.value.outlet]}),ft(u,(h,d)=>Ma(h,n.getContext(d),a)),a}function Ma(i,t,n){const s=Xr(i),a=i.value;ft(s,(u,h)=>{Ma(u,a.component?t?t.children.getContext(h):null:t,n)}),n.canDeactivateChecks.push(new Ku(a.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,a))}class fH{}function qS(i){return new Be(t=>t.error(i))}class _H{constructor(t,n,s,a,u,h){this.rootComponentType=t,this.config=n,this.urlTree=s,this.url=a,this.paramsInheritanceStrategy=u,this.relativeLinkResolution=h}recognize(){const t=ju(this.urlTree.root,[],[],this.config.filter(h=>void 0===h.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,t,pe);if(null===n)return null;const s=new Uu([],Object.freeze({}),Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,{},pe,this.rootComponentType,null,this.urlTree.root,-1,{}),a=new wi(s,n),u=new PS(this.url,a);return this.inheritParamsAndData(u._root),u}inheritParamsAndData(t){const n=t.value,s=LS(n,this.paramsInheritanceStrategy);n.params=Object.freeze(s.params),n.data=Object.freeze(s.data),t.children.forEach(a=>this.inheritParamsAndData(a))}processSegmentGroup(t,n,s){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,n):this.processSegment(t,n,n.segments,s)}processChildren(t,n){const s=[];for(const u of Object.keys(n.children)){const h=n.children[u],d=jS(t,u),f=this.processSegmentGroup(d,h,u);if(null===f)return null;s.push(...f)}const a=QS(s);return a.sort((t,n)=>t.value.outlet===pe?-1:n.value.outlet===pe?1:t.value.outlet.localeCompare(n.value.outlet)),a}processSegment(t,n,s,a){for(const u of t){const h=this.processSegmentAgainstRoute(u,n,s,a);if(null!==h)return h}return KS(n,s,a)?[]:null}processSegmentAgainstRoute(t,n,s,a){if(t.redirectTo||!zS(t,n,s,a))return null;let u,h=[],d=[];if("**"===t.path){const y=s.length>0?vS(s).parameters:{};u=new Uu(s,y,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,tI(t),_n(t),t.component,t,ZS(n),eI(n)+s.length,nI(t))}else{const y=Wu(n,t,s);if(!y.matched)return null;h=y.consumedSegments,d=s.slice(y.lastChild),u=new Uu(h,y.parameters,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,tI(t),_n(t),t.component,t,ZS(n),eI(n)+h.length,nI(t))}const f=(i=t).children?i.children:i.loadChildren?i._loadedConfig.routes:[],{segmentGroup:g,slicedSegments:m}=ju(n,h,d,f.filter(y=>void 0===y.redirectTo),this.relativeLinkResolution);var i;if(0===m.length&&g.hasChildren()){const y=this.processChildren(f,g);return null===y?null:[new wi(u,y)]}if(0===f.length&&0===m.length)return[new wi(u,[])];const E=_n(t)===a,T=this.processSegment(f,g,m,E?pe:a);return null===T?null:[new wi(u,T)]}}function TH(i){const t=i.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function QS(i){const t=[],n=new Set;for(const s of i){if(!TH(s)){t.push(s);continue}const a=t.find(u=>s.value.routeConfig===u.value.routeConfig);void 0!==a?(a.children.push(...s.children),n.add(a)):t.push(s)}for(const s of n){const a=QS(s.children);t.push(new wi(s.value,a))}return t.filter(s=>!n.has(s))}function ZS(i){let t=i;for(;t._sourceSegment;)t=t._sourceSegment;return t}function eI(i){let t=i,n=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,n+=t._segmentIndexShift?t._segmentIndexShift:0;return n-1}function tI(i){return i.data||{}}function nI(i){return i.resolve||{}}function Lf(i){return wo(t=>{const n=i(t);return n?st(n).pipe(De(()=>t)):ae(t)})}class DH extends class{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}{}const Pf=new K("ROUTES");class iI{constructor(t,n,s,a){this.injector=t,this.compiler=n,this.onLoadStartListener=s,this.onLoadEndListener=a}load(t,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const a=this.loadModuleFactory(n.loadChildren).pipe(De(u=>{this.onLoadEndListener&&this.onLoadEndListener(n);const h=u.create(t);return new Mf(TS(h.injector.get(Pf,void 0,z.Self|z.Optional)).map(Nf),h)}),Zi(u=>{throw n._loader$=void 0,u}));return n._loader$=new BB(a,()=>new yn).pipe(uS()),n._loader$}loadModuleFactory(t){return ri(t()).pipe(rt(n=>n instanceof Lv?ae(n):st(this.compiler.compileModuleAsync(n))))}}class wH{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}function MH(i){throw i}function OH(i,t,n){return t.parse("/")}function oI(i,t){return ae(null)}const NH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},kH={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let qt=(()=>{class i{constructor(n,s,a,u,h,d,f){this.rootComponentType=n,this.urlSerializer=s,this.rootContexts=a,this.location=u,this.config=f,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new yn,this.errorHandler=MH,this.malformedUriErrorHandler=OH,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:oI,afterPreactivation:oI},this.urlHandlingStrategy=new wH,this.routeReuseStrategy=new DH,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=h.get(ni),this.console=h.get(zl);const E=h.get(Oe);this.isNgZoneEnabled=E instanceof Oe&&Oe.isInAngularZone(),this.resetConfig(f),this.currentUrlTree=new Oo(new ge([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new iI(h,d,T=>this.triggerEvent(new fS(T)),T=>this.triggerEvent(new gS(T))),this.routerState=kS(this.currentUrlTree,this.rootComponentType),this.transitions=new gn({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null==(n=this.location.getState())?void 0:n.\u0275routerPageId}setupNavigations(n){const s=this.events;return n.pipe(Mo(a=>0!==a.id),De(a=>dt(U({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),wo(a=>{let u=!1,h=!1;return ae(a).pipe($t(d=>{this.currentNavigation={id:d.id,initialUrl:d.currentRawUrl,extractedUrl:d.extractedUrl,trigger:d.source,extras:d.extras,previousNavigation:this.lastSuccessfulNavigation?dt(U({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),wo(d=>{const f=this.browserUrlTree.toString(),g=!this.navigated||d.extractedUrl.toString()!==f||f!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||g)&&this.urlHandlingStrategy.shouldProcessUrl(d.rawUrl))return Ju(d.source)&&(this.browserUrlTree=d.extractedUrl),ae(d).pipe(wo(E=>{const T=this.transitions.getValue();return s.next(new Tf(E.id,this.serializeUrl(E.extractedUrl),E.source,E.restoredState)),T!==this.transitions.getValue()?hi:Promise.resolve(E)}),function(i,t,n,s){return wo(a=>function(i,t,n,s,a){return new QU(i,t,n,s,a).apply()}(i,t,n,a.extractedUrl,s).pipe(De(u=>dt(U({},a),{urlAfterRedirects:u}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),$t(E=>{this.currentNavigation=dt(U({},this.currentNavigation),{finalUrl:E.urlAfterRedirects})}),function(i,t,n,s,a){return rt(u=>function(i,t,n,s,a="emptyOnly",u="legacy"){try{const h=new _H(i,t,n,s,a,u).recognize();return null===h?qS(new fH):ae(h)}catch(h){return qS(h)}}(i,t,u.urlAfterRedirects,n(u.urlAfterRedirects),s,a).pipe(De(h=>dt(U({},u),{targetSnapshot:h}))))}(this.rootComponentType,this.config,E=>this.serializeUrl(E),this.paramsInheritanceStrategy,this.relativeLinkResolution),$t(E=>{if("eager"===this.urlUpdateStrategy){if(!E.extras.skipLocationChange){const y=this.urlHandlingStrategy.merge(E.urlAfterRedirects,E.rawUrl);this.setBrowserUrl(y,E)}this.browserUrlTree=E.urlAfterRedirects}const T=new zB(E.id,this.serializeUrl(E.extractedUrl),this.serializeUrl(E.urlAfterRedirects),E.targetSnapshot);s.next(T)}));if(g&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:T,extractedUrl:y,source:C,restoredState:I,extras:S}=d,D=new Tf(T,this.serializeUrl(y),C,I);s.next(D);const R=kS(y,this.rootComponentType).snapshot;return ae(dt(U({},d),{targetSnapshot:R,urlAfterRedirects:y,extras:dt(U({},S),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=d.rawUrl,d.resolve(null),hi}),Lf(d=>{const{targetSnapshot:f,id:g,extractedUrl:m,rawUrl:E,extras:{skipLocationChange:T,replaceUrl:y}}=d;return this.hooks.beforePreactivation(f,{navigationId:g,appliedUrlTree:m,rawUrlTree:E,skipLocationChange:!!T,replaceUrl:!!y})}),$t(d=>{const f=new KB(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);this.triggerEvent(f)}),De(d=>dt(U({},d),{guards:tH(d.targetSnapshot,d.currentSnapshot,this.rootContexts)})),function(i,t){return rt(n=>{const{targetSnapshot:s,currentSnapshot:a,guards:{canActivateChecks:u,canDeactivateChecks:h}}=n;return 0===h.length&&0===u.length?ae(dt(U({},n),{guardsResult:!0})):function(i,t,n,s){return st(i).pipe(rt(a=>function(i,t,n,s,a){const u=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return u&&0!==u.length?ae(u.map(d=>{const f=Yu(d,t,a);let g;if(function(i){return i&&eo(i.canDeactivate)}(f))g=ri(f.canDeactivate(i,t,n,s));else{if(!eo(f))throw new Error("Invalid CanDeactivate guard");g=ri(f(i,t,n,s))}return g.pipe(Wr())})).pipe(Ra()):ae(!0)}(a.component,a.route,n,t,s)),Wr(a=>!0!==a,!0))}(h,s,a,i).pipe(rt(d=>d&&function(i){return"boolean"==typeof i}(d)?function(i,t,n,s){return st(t).pipe(Ta(a=>mf(function(i,t){return null!==i&&t&&t(new qB(i)),ae(!0)}(a.route.parent,s),function(i,t){return null!==i&&t&&t(new ZB(i)),ae(!0)}(a.route,s),function(i,t,n){const s=t[t.length-1],u=t.slice(0,t.length-1).reverse().map(h=>function(i){const t=i.routeConfig?i.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:i,guards:t}:null}(h)).filter(h=>null!==h).map(h=>lS(()=>ae(h.guards.map(f=>{const g=Yu(f,h.node,n);let m;if(function(i){return i&&eo(i.canActivateChild)}(g))m=ri(g.canActivateChild(s,i));else{if(!eo(g))throw new Error("Invalid CanActivateChild guard");m=ri(g(s,i))}return m.pipe(Wr())})).pipe(Ra())));return ae(u).pipe(Ra())}(i,a.path,n),function(i,t,n){const s=t.routeConfig?t.routeConfig.canActivate:null;if(!s||0===s.length)return ae(!0);const a=s.map(u=>lS(()=>{const h=Yu(u,t,n);let d;if(function(i){return i&&eo(i.canActivate)}(h))d=ri(h.canActivate(t,i));else{if(!eo(h))throw new Error("Invalid CanActivate guard");d=ri(h(t,i))}return d.pipe(Wr())}));return ae(a).pipe(Ra())}(i,a.route,n))),Wr(a=>!0!==a,!0))}(s,u,i,t):ae(d)),De(d=>dt(U({},n),{guardsResult:d})))})}(this.ngModule.injector,d=>this.triggerEvent(d)),$t(d=>{if(ko(d.guardsResult)){const g=vf(`Redirecting to "${this.serializeUrl(d.guardsResult)}"`);throw g.url=d.guardsResult,g}const f=new YB(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot,!!d.guardsResult);this.triggerEvent(f)}),Mo(d=>!!d.guardsResult||(this.restoreHistory(d),this.cancelNavigationTransition(d,""),!1)),Lf(d=>{if(d.guards.canActivateChecks.length)return ae(d).pipe($t(f=>{const g=new JB(f.id,this.serializeUrl(f.extractedUrl),this.serializeUrl(f.urlAfterRedirects),f.targetSnapshot);this.triggerEvent(g)}),wo(f=>{let g=!1;return ae(f).pipe(function(i,t){return rt(n=>{const{targetSnapshot:s,guards:{canActivateChecks:a}}=n;if(!a.length)return ae(n);let u=0;return st(a).pipe(Ta(h=>function(i,t,n,s){return function(i,t,n,s){const a=Object.keys(i);if(0===a.length)return ae({});const u={};return st(a).pipe(rt(h=>function(i,t,n,s){const a=Yu(i,t,s);return ri(a.resolve?a.resolve(t,n):a(t,n))}(i[h],t,n,s).pipe($t(d=>{u[h]=d}))),Ef(1),rt(()=>Object.keys(u).length===a.length?ae(u):hi))}(i._resolve,i,t,s).pipe(De(u=>(i._resolvedData=u,i.data=U(U({},i.data),LS(i,n).resolve),null)))}(h.route,s,i,t)),$t(()=>u++),Ef(1),rt(h=>u===a.length?ae(n):hi))})}(this.paramsInheritanceStrategy,this.ngModule.injector),$t({next:()=>g=!0,complete:()=>{g||(this.restoreHistory(f),this.cancelNavigationTransition(f,"At least one route resolver didn't emit any value."))}}))}),$t(f=>{const g=new $B(f.id,this.serializeUrl(f.extractedUrl),this.serializeUrl(f.urlAfterRedirects),f.targetSnapshot);this.triggerEvent(g)}))}),Lf(d=>{const{targetSnapshot:f,id:g,extractedUrl:m,rawUrl:E,extras:{skipLocationChange:T,replaceUrl:y}}=d;return this.hooks.afterPreactivation(f,{navigationId:g,appliedUrlTree:m,rawUrlTree:E,skipLocationChange:!!T,replaceUrl:!!y})}),De(d=>{const f=function(i,t,n){const s=ba(i,t._root,n?n._root:void 0);return new NS(s,t)}(this.routeReuseStrategy,d.targetSnapshot,d.currentRouterState);return dt(U({},d),{targetRouterState:f})}),$t(d=>{this.currentUrlTree=d.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl),this.routerState=d.targetRouterState,"deferred"===this.urlUpdateStrategy&&(d.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,d),this.browserUrlTree=d.urlAfterRedirects)}),((i,t,n)=>De(s=>(new LU(t,s.targetRouterState,s.currentRouterState,n).activate(i),s)))(this.rootContexts,this.routeReuseStrategy,d=>this.triggerEvent(d)),$t({next(){u=!0},complete(){u=!0}}),function(i){return Ze((t,n)=>{try{t.subscribe(n)}finally{n.add(i)}})}(()=>{var d;u||h||this.cancelNavigationTransition(a,`Navigation ID ${a.id} is not equal to the current navigation id ${this.navigationId}`),(null==(d=this.currentNavigation)?void 0:d.id)===a.id&&(this.currentNavigation=null)}),Zi(d=>{if(h=!0,function(i){return i&&i[mS]}(d)){const f=ko(d.url);f||(this.navigated=!0,this.restoreHistory(a,!0));const g=new pS(a.id,this.serializeUrl(a.extractedUrl),d.message);s.next(g),f?setTimeout(()=>{const m=this.urlHandlingStrategy.merge(d.url,this.rawUrlTree),E={skipLocationChange:a.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Ju(a.source)};this.scheduleNavigation(m,"imperative",null,E,{resolve:a.resolve,reject:a.reject,promise:a.promise})},0):a.resolve(!1)}else{this.restoreHistory(a,!0);const f=new XB(a.id,this.serializeUrl(a.extractedUrl),d);s.next(f);try{a.resolve(this.errorHandler(d))}catch(g){a.reject(g)}}return hi}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next(U(U({},this.transitions.value),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const s="popstate"===n.type?"popstate":"hashchange";"popstate"===s&&setTimeout(()=>{var d;const a={replaceUrl:!0},u=(null==(d=n.state)?void 0:d.navigationId)?n.state:null;if(u){const f=U({},u);delete f.navigationId,delete f.\u0275routerPageId,0!==Object.keys(f).length&&(a.state=f)}const h=this.parseUrl(n.url);this.scheduleNavigation(h,s,u,a)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){WS(n),this.config=n.map(Nf),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,s={}){const{relativeTo:a,queryParams:u,fragment:h,queryParamsHandling:d,preserveFragment:f}=s,g=a||this.routerState.root,m=f?this.currentUrlTree.fragment:h;let E=null;switch(d){case"merge":E=U(U({},this.currentUrlTree.queryParams),u);break;case"preserve":E=this.currentUrlTree.queryParams;break;default:E=u||null}return null!==E&&(E=this.removeEmptyProps(E)),function(i,t,n,s,a){if(0===n.length)return Df(t.root,t.root,t,s,a);const u=function(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new VS(!0,0,i);let t=0,n=!1;const s=i.reduce((a,u,h)=>{if("object"==typeof u&&null!=u){if(u.outlets){const d={};return ft(u.outlets,(f,g)=>{d[g]="string"==typeof f?f.split("/"):f}),[...a,{outlets:d}]}if(u.segmentPath)return[...a,u.segmentPath]}return"string"!=typeof u?[...a,u]:0===h?(u.split("/").forEach((d,f)=>{0==f&&"."===d||(0==f&&""===d?n=!0:".."===d?t++:""!=d&&a.push(d))}),a):[...a,u]},[]);return new VS(n,t,s)}(n);if(u.toRoot())return Df(t.root,new ge([],{}),t,s,a);const h=function(i,t,n){if(i.isAbsolute)return new Af(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){const u=n.snapshot._urlSegment;return new Af(u,u===t.root,0)}const s=Hu(i.commands[0])?0:1;return function(i,t,n){let s=i,a=t,u=n;for(;u>a;){if(u-=a,s=s.parent,!s)throw new Error("Invalid number of '../'");a=s.segments.length}return new Af(s,!1,a-u)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+s,i.numberOfDoubleDots)}(u,t,i),d=h.processChildren?Gu(h.segmentGroup,h.index,u.commands):BS(h.segmentGroup,h.index,u.commands);return Df(h.segmentGroup,d,t,s,a)}(g,this.currentUrlTree,n,E,null!=m?m:null)}navigateByUrl(n,s={skipLocationChange:!1}){const a=ko(n)?n:this.parseUrl(n),u=this.urlHandlingStrategy.merge(a,this.rawUrlTree);return this.scheduleNavigation(u,"imperative",null,s)}navigate(n,s={skipLocationChange:!1}){return function(i){for(let t=0;t<i.length;t++){const n=i[t];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${t}`)}}(n),this.navigateByUrl(this.createUrlTree(n,s),s)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let s;try{s=this.urlSerializer.parse(n)}catch(a){s=this.malformedUriErrorHandler(a,this.urlSerializer,n)}return s}isActive(n,s){let a;if(a=!0===s?U({},NH):!1===s?U({},kH):s,ko(n))return CS(this.currentUrlTree,n,a);const u=this.parseUrl(n);return CS(this.currentUrlTree,u,a)}removeEmptyProps(n){return Object.keys(n).reduce((s,a)=>{const u=n[a];return null!=u&&(s[a]=u),s},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new va(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,s,a,u,h){var D,R,k;if(this.disposed)return Promise.resolve(!1);const d=this.transitions.value,f=Ju(s)&&d&&!Ju(d.source),g=d.rawUrl.toString()===n.toString(),m=d.id===(null==(D=this.currentNavigation)?void 0:D.id);if(f&&g&&m)return Promise.resolve(!0);let T,y,C;h?(T=h.resolve,y=h.reject,C=h.promise):C=new Promise((x,Q)=>{T=x,y=Q});const I=++this.navigationId;let S;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(a=this.location.getState()),S=a&&a.\u0275routerPageId?a.\u0275routerPageId:u.replaceUrl||u.skipLocationChange?null!=(R=this.browserPageId)?R:0:(null!=(k=this.browserPageId)?k:0)+1):S=0,this.setTransition({id:I,targetPageId:S,source:s,restoredState:a,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:u,resolve:T,reject:y,promise:C,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),C.catch(x=>Promise.reject(x))}setBrowserUrl(n,s){const a=this.urlSerializer.serialize(n),u=U(U({},s.extras.state),this.generateNgRouterState(s.id,s.targetPageId));this.location.isCurrentPathEqualTo(a)||s.extras.replaceUrl?this.location.replaceState(a,"",u):this.location.go(a,"",u)}restoreHistory(n,s=!1){var a,u;if("computed"===this.canceledNavigationResolution){const h=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null==(a=this.currentNavigation)?void 0:a.finalUrl)||0===h?this.currentUrlTree===(null==(u=this.currentNavigation)?void 0:u.finalUrl)&&0===h&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(h)}else"replace"===this.canceledNavigationResolution&&(s&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,s){const a=new pS(n.id,this.serializeUrl(n.extractedUrl),s);this.triggerEvent(a),n.resolve(!1)}generateNgRouterState(n,s){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:s}:{navigationId:n}}}return i.\u0275fac=function(n){ld()},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();function Ju(i){return"imperative"!==i}class rI{}class sI{preload(t,n){return ae(null)}}let aI=(()=>{class i{constructor(n,s,a,u){this.router=n,this.injector=a,this.preloadingStrategy=u,this.loader=new iI(a,s,f=>n.triggerEvent(new fS(f)),f=>n.triggerEvent(new gS(f)))}setUpPreloading(){this.subscription=this.router.events.pipe(Mo(n=>n instanceof va),Ta(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get(ni);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,s){const a=[];for(const u of s)if(u.loadChildren&&!u.canLoad&&u._loadedConfig){const h=u._loadedConfig;a.push(this.processRoutes(h.module,h.routes))}else u.loadChildren&&!u.canLoad?a.push(this.preloadConfig(n,u)):u.children&&a.push(this.processRoutes(n,u.children));return st(a).pipe(rs(),De(u=>{}))}preloadConfig(n,s){return this.preloadingStrategy.preload(s,()=>(s._loadedConfig?ae(s._loadedConfig):this.loader.load(n.injector,s)).pipe(rt(u=>(s._loadedConfig=u,this.processRoutes(u.module,u.routes)))))}}return i.\u0275fac=function(n){return new(n||i)(P(qt),P(Kl),P(Ce),P(rI))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})(),Vf=(()=>{class i{constructor(n,s,a={}){this.router=n,this.viewportScroller=s,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof Tf?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof va&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof _S&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,s){this.router.triggerEvent(new _S(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,s))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return i.\u0275fac=function(n){ld()},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();const Lo=new K("ROUTER_CONFIGURATION"),lI=new K("ROUTER_FORROOT_GUARD"),VH=[Rp,{provide:RS,useClass:DS},{provide:qt,useFactory:function(i,t,n,s,a,u,h={},d,f){const g=new qt(null,i,t,n,s,a,TS(u));return d&&(g.urlHandlingStrategy=d),f&&(g.routeReuseStrategy=f),function(i,t){i.errorHandler&&(t.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(t.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(t.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.relativeLinkResolution&&(t.relativeLinkResolution=i.relativeLinkResolution),i.urlUpdateStrategy&&(t.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(t.canceledNavigationResolution=i.canceledNavigationResolution)}(h,g),h.enableTracing&&g.events.subscribe(m=>{var E,T;null==(E=console.group)||E.call(console,`Router Event: ${m.constructor.name}`),console.log(m.toString()),console.log(m),null==(T=console.groupEnd)||T.call(console)}),g},deps:[RS,Da,Rp,Ce,Kl,Pf,Lo,[class{},new Ut],[class{},new Ut]]},Da,{provide:zr,useFactory:function(i){return i.routerState.root},deps:[qt]},aI,sI,class{preload(t,n){return n().pipe(Zi(()=>ae(null)))}},{provide:Lo,useValue:{enableTracing:!1}}];function BH(){return new Jd("Router",qt)}let uI=(()=>{class i{constructor(n,s){}static forRoot(n,s){return{ngModule:i,providers:[VH,cI(n),{provide:lI,useFactory:GH,deps:[[qt,new Ut,new Gi]]},{provide:Lo,useValue:s||{}},{provide:Hr,useFactory:HH,deps:[Do,[new rr(Ip),new Ut],Lo]},{provide:Vf,useFactory:UH,deps:[qt,x1,Lo]},{provide:rI,useExisting:s&&s.preloadingStrategy?s.preloadingStrategy:sI},{provide:Jd,multi:!0,useFactory:BH},[Bf,{provide:$s,multi:!0,useFactory:zH,deps:[Bf]},{provide:hI,useFactory:KH,deps:[Bf]},{provide:fy,multi:!0,useExisting:hI}]]}}static forChild(n){return{ngModule:i,providers:[cI(n)]}}}return i.\u0275fac=function(n){return new(n||i)(P(lI,8),P(qt,8))},i.\u0275mod=pt({type:i}),i.\u0275inj=et({}),i})();function UH(i,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new Vf(i,t,n)}function HH(i,t,n={}){return n.useHash?new fF(i,t):new RC(i,t)}function GH(i){return"guarded"}function cI(i){return[{provide:mA,multi:!0,useValue:i},{provide:Pf,multi:!0,useValue:i}]}let Bf=(()=>{class i{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new yn}appInitializer(){return this.injector.get(hF,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let s=null;const a=new Promise(d=>s=d),u=this.injector.get(qt),h=this.injector.get(Lo);return"disabled"===h.initialNavigation?(u.setUpLocationChangeListener(),s(!0)):"enabled"===h.initialNavigation||"enabledBlocking"===h.initialNavigation?(u.hooks.afterPreactivation=()=>this.initNavigation?ae(null):(this.initNavigation=!0,s(!0),this.resultOfPreactivationDone),u.initialNavigation()):s(!0),a})}bootstrapListener(n){const s=this.injector.get(Lo),a=this.injector.get(aI),u=this.injector.get(Vf),h=this.injector.get(qt),d=this.injector.get(Lr);n===d.components[0]&&(("enabledNonBlocking"===s.initialNavigation||void 0===s.initialNavigation)&&h.initialNavigation(),a.setUpPreloading(),u.init(),h.resetRootComponentType(d.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return i.\u0275fac=function(n){return new(n||i)(P(Ce))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();function zH(i){return i.appInitializer.bind(i)}function KH(i){return i.bootstrapListener.bind(i)}const hI=new K("Router Initializer");var Po=G(389),Oa=G(610),Mi=G(11);function hG(i,t){return i===t}function Na(i){return null!=i&&"false"!=`${i}`}function ka(i){return i instanceof Xe?i.nativeElement:i}let Uf;try{Uf="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(i){Uf=!1}let La,Hf,$u=(()=>{class i{constructor(n){this._platformId=n,this.isBrowser=this._platformId?function(i){return i===WC}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!Uf)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(n){return new(n||i)(P(Xl))},i.\u0275prov=ee({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),fG=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({}),i})();function qu(i){return function(){if(null==La&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>La=!0}))}finally{La=La||!1}return La}()?i:!!i.capture}function Pa(i){return i.composedPath?i.composedPath()[0]:i.target}function _I(i){return 0===i.offsetX&&0===i.offsetY}function mI(i){const t=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const RG=new K("cdk-input-modality-detector-options"),DG={ignoreKeys:[18,17,224,91,16]},$r=qu({passive:!0,capture:!0});let AG=(()=>{class i{constructor(n,s,a,u){this._platform=n,this._mostRecentTarget=null,this._modality=new gn(null),this._lastTouchMs=0,this._onKeydown=h=>{var d,f;(null==(f=null==(d=this._options)?void 0:d.ignoreKeys)?void 0:f.some(g=>g===h.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=Pa(h))},this._onMousedown=h=>{Date.now()-this._lastTouchMs<650||(this._modality.next(_I(h)?"keyboard":"mouse"),this._mostRecentTarget=Pa(h))},this._onTouchstart=h=>{mI(h)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Pa(h))},this._options=U(U({},DG),u),this.modalityDetected=this._modality.pipe(Mo((t,n)=>1<=n)),this.modalityChanged=this.modalityDetected.pipe(function(i,t=Li){return i=null!=i?i:hG,Ze((n,s)=>{let a,u=!0;n.subscribe(new Je(s,h=>{const d=t(h);(u||!i(a,d))&&(u=!1,a=d,s.next(h))}))})}()),n.isBrowser&&s.runOutsideAngular(()=>{a.addEventListener("keydown",this._onKeydown,$r),a.addEventListener("mousedown",this._onMousedown,$r),a.addEventListener("touchstart",this._onTouchstart,$r)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,$r),document.removeEventListener("mousedown",this._onMousedown,$r),document.removeEventListener("touchstart",this._onTouchstart,$r))}}return i.\u0275fac=function(n){return new(n||i)(P($u),P(Oe),P(Pe),P(RG,8))},i.\u0275prov=ee({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const MG=new K("cdk-focus-monitor-default-options"),Zu=qu({passive:!0,capture:!0});let TI=(()=>{class i{constructor(n,s,a,u,h){this._ngZone=n,this._platform=s,this._inputModalityDetector=a,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new yn,this._rootNodeFocusAndBlurListener=d=>{const f=Pa(d),g="focus"===d.type?this._onFocus:this._onBlur;for(let m=f;m;m=m.parentElement)g.call(this,d,m)},this._document=u,this._detectionMode=(null==h?void 0:h.detectionMode)||0}monitor(n,s=!1){const a=ka(n);if(!this._platform.isBrowser||1!==a.nodeType)return ae(null);const u=function(i){if(function(){if(null==Hf){const i="undefined"!=typeof document?document.head:null;Hf=!(!i||!i.createShadowRoot&&!i.attachShadow)}return Hf}()){const t=i.getRootNode?i.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(a)||this._getDocument(),h=this._elementInfo.get(a);if(h)return s&&(h.checkChildren=!0),h.subject;const d={checkChildren:s,subject:new yn,rootNode:u};return this._elementInfo.set(a,d),this._registerGlobalListeners(d),d.subject}stopMonitoring(n){const s=ka(n),a=this._elementInfo.get(s);a&&(a.subject.complete(),this._setClasses(s),this._elementInfo.delete(s),this._removeGlobalListeners(a))}focusVia(n,s,a){const u=ka(n);u===this._getDocument().activeElement?this._getClosestElementsInfo(u).forEach(([d,f])=>this._originChanged(d,s,f)):(this._setOrigin(s),"function"==typeof u.focus&&u.focus(a))}ngOnDestroy(){this._elementInfo.forEach((n,s)=>this.stopMonitoring(s))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(n){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(n)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(n){return 1===this._detectionMode||!!(null==n?void 0:n.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(n,s){n.classList.toggle("cdk-focused",!!s),n.classList.toggle("cdk-touch-focused","touch"===s),n.classList.toggle("cdk-keyboard-focused","keyboard"===s),n.classList.toggle("cdk-mouse-focused","mouse"===s),n.classList.toggle("cdk-program-focused","program"===s)}_setOrigin(n,s=!1){this._ngZone.runOutsideAngular(()=>{this._origin=n,this._originFromTouchInteraction="touch"===n&&s,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(n,s){const a=this._elementInfo.get(s),u=Pa(n);!a||!a.checkChildren&&s!==u||this._originChanged(s,this._getFocusOrigin(u),a)}_onBlur(n,s){const a=this._elementInfo.get(s);!a||a.checkChildren&&n.relatedTarget instanceof Node&&s.contains(n.relatedTarget)||(this._setClasses(s),this._emitOrigin(a.subject,null))}_emitOrigin(n,s){this._ngZone.run(()=>n.next(s))}_registerGlobalListeners(n){if(!this._platform.isBrowser)return;const s=n.rootNode,a=this._rootNodeFocusListenerCount.get(s)||0;a||this._ngZone.runOutsideAngular(()=>{s.addEventListener("focus",this._rootNodeFocusAndBlurListener,Zu),s.addEventListener("blur",this._rootNodeFocusAndBlurListener,Zu)}),this._rootNodeFocusListenerCount.set(s,a+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(function(i){return Ze((t,n)=>{Cn(i).subscribe(new Je(n,()=>n.complete(),w)),!n.closed&&t.subscribe(n)})}(this._stopInputModalityDetector)).subscribe(u=>{this._setOrigin(u,!0)}))}_removeGlobalListeners(n){const s=n.rootNode;if(this._rootNodeFocusListenerCount.has(s)){const a=this._rootNodeFocusListenerCount.get(s);a>1?this._rootNodeFocusListenerCount.set(s,a-1):(s.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Zu),s.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Zu),this._rootNodeFocusListenerCount.delete(s))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(n,s,a){this._setClasses(n,s),this._emitOrigin(a.subject,s),this._lastFocusOrigin=s}_getClosestElementsInfo(n){const s=[];return this._elementInfo.forEach((a,u)=>{(u===n||a.checkChildren&&u.contains(n))&&s.push([u,a])}),s}}return i.\u0275fac=function(n){return new(n||i)(P(Oe),P($u),P(AG),P(Pe,8),P(MG,8))},i.\u0275prov=ee({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const vI="cdk-high-contrast-black-on-white",yI="cdk-high-contrast-white-on-black",Gf="cdk-high-contrast-active";let OG=(()=>{class i{constructor(n,s){this._platform=n,this._document=s}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);const s=this._document.defaultView||window,a=s&&s.getComputedStyle?s.getComputedStyle(n):null,u=(a&&a.backgroundColor||"").replace(/ /g,"");switch(n.remove(),u){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const n=this._document.body.classList;n.remove(Gf),n.remove(vI),n.remove(yI),this._hasCheckedHighContrastMode=!0;const s=this.getHighContrastMode();1===s?(n.add(Gf),n.add(vI)):2===s&&(n.add(Gf),n.add(yI))}}}return i.\u0275fac=function(n){return new(n||i)(P($u),P(Pe))},i.\u0275prov=ee({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),CI=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({}),i})();const bI=new zi("13.0.1");class SI{}const Oi="*";function II(i,t=null){return{type:2,steps:i,options:t}}function RI(i){return{type:6,styles:i,offset:null}}function DI(i){Promise.resolve(null).then(i)}class qr{constructor(t=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){DI(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(s=>s()),n.length=0}}class AI{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let n=0,s=0,a=0;const u=this.players.length;0==u?DI(()=>this._onFinish()):this.players.forEach(h=>{h.onDone(()=>{++n==u&&this._onFinish()}),h.onDestroy(()=>{++s==u&&this._onDestroy()}),h.onStart(()=>{++a==u&&this._onStart()})}),this.totalTime=this.players.reduce((h,d)=>Math.max(h,d.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const n=t*this.totalTime;this.players.forEach(s=>{const a=s.totalTime?Math.min(1,n/s.totalTime):1;s.setPosition(a)})}getPosition(){const t=this.players.reduce((n,s)=>null===n||s.totalTime>n.totalTime?s:n,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(s=>s()),n.length=0}}function wI(){return"undefined"!=typeof window&&void 0!==window.document}function jf(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function to(i){switch(i.length){case 0:return new qr;case 1:return i[0];default:return new AI(i)}}function MI(i,t,n,s,a={},u={}){const h=[],d=[];let f=-1,g=null;if(s.forEach(m=>{const E=m.offset,T=E==f,y=T&&g||{};Object.keys(m).forEach(C=>{let I=C,S=m[C];if("offset"!==C)switch(I=t.normalizePropertyName(I,h),S){case"!":S=a[C];break;case Oi:S=u[C];break;default:S=t.normalizeStyleValue(C,I,S,h)}y[I]=S}),T||d.push(y),g=y,f=E}),h.length){const m="\n - ";throw new Error(`Unable to animate due to the following errors:${m}${h.join(m)}`)}return d}function Xf(i,t,n,s){switch(t){case"start":i.onStart(()=>s(n&&zf(n,"start",i)));break;case"done":i.onDone(()=>s(n&&zf(n,"done",i)));break;case"destroy":i.onDestroy(()=>s(n&&zf(n,"destroy",i)))}}function zf(i,t,n){const s=n.totalTime,u=Kf(i.element,i.triggerName,i.fromState,i.toState,t||i.phaseName,null==s?i.totalTime:s,!!n.disabled),h=i._data;return null!=h&&(u._data=h),u}function Kf(i,t,n,s,a="",u=0,h){return{element:i,triggerName:t,fromState:n,toState:s,phaseName:a,totalTime:u,disabled:!!h}}function Qt(i,t,n){let s;return i instanceof Map?(s=i.get(t),s||i.set(t,s=n)):(s=i[t],s||(s=i[t]=n)),s}function OI(i){const t=i.indexOf(":");return[i.substring(1,t),i.substr(t+1)]}let Yf=(i,t)=>!1,Jf=(i,t)=>!1,NI=(i,t,n)=>[];const kI=jf();(kI||"undefined"!=typeof Element)&&(Yf=wI()?(i,t)=>{for(;t&&t!==document.documentElement;){if(t===i)return!0;t=t.parentNode||t.host}return!1}:(i,t)=>i.contains(t),Jf=(()=>{if(kI||Element.prototype.matches)return(i,t)=>i.matches(t);{const i=Element.prototype,t=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector;return t?(n,s)=>t.apply(n,[s]):Jf}})(),NI=(i,t,n)=>{let s=[];if(n){const a=i.querySelectorAll(t);for(let u=0;u<a.length;u++)s.push(a[u])}else{const a=i.querySelector(t);a&&s.push(a)}return s});let Fo=null,LI=!1;function $f(i){Fo||(Fo=("undefined"!=typeof document?document.body:null)||{},LI=!!Fo.style&&"WebkitAppearance"in Fo.style);let t=!0;return Fo.style&&!function(i){return"ebkit"==i.substring(1,6)}(i)&&(t=i in Fo.style,!t&&LI&&(t="Webkit"+i.charAt(0).toUpperCase()+i.substr(1)in Fo.style)),t}const qf=Jf,Qf=Yf,Zf=NI;function PI(i){const t={};return Object.keys(i).forEach(n=>{const s=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[s]=i[n]}),t}let xI=(()=>{class i{validateStyleProperty(n){return $f(n)}matchesElement(n,s){return qf(n,s)}containsElement(n,s){return Qf(n,s)}query(n,s,a){return Zf(n,s,a)}computeStyle(n,s,a){return a||""}animate(n,s,a,u,h,d=[],f){return new qr(a,u)}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})(),eg=(()=>{class i{}return i.NOOP=new xI,i})();const tg="ng-enter",ec="ng-leave",tc="ng-trigger",nc=".ng-trigger",VI="ng-animating",ng=".ng-animating";function Vo(i){if("number"==typeof i)return i;const t=i.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:ig(parseFloat(t[1]),t[2])}function ig(i,t){return"s"===t?1e3*i:i}function ic(i,t,n){return i.hasOwnProperty("duration")?i:function(i,t,n){let a,u=0,h="";if("string"==typeof i){const d=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===d)return t.push(`The provided timing value "${i}" is invalid.`),{duration:0,delay:0,easing:""};a=ig(parseFloat(d[1]),d[2]);const f=d[3];null!=f&&(u=ig(parseFloat(f),d[4]));const g=d[5];g&&(h=g)}else a=i;if(!n){let d=!1,f=t.length;a<0&&(t.push("Duration values below 0 are not allowed for this animation step."),d=!0),u<0&&(t.push("Delay values below 0 are not allowed for this animation step."),d=!0),d&&t.splice(f,0,`The provided timing value "${i}" is invalid.`)}return{duration:a,delay:u,easing:h}}(i,t,n)}function Qr(i,t={}){return Object.keys(i).forEach(n=>{t[n]=i[n]}),t}function no(i,t,n={}){if(t)for(let s in i)n[s]=i[s];else Qr(i,n);return n}function UI(i,t,n){return n?t+":"+n+";":""}function HI(i){let t="";for(let n=0;n<i.style.length;n++){const s=i.style.item(n);t+=UI(0,s,i.style.getPropertyValue(s))}for(const n in i.style)i.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=UI(0,WG(n),i.style[n]));i.setAttribute("style",t)}function si(i,t,n){i.style&&(Object.keys(t).forEach(s=>{const a=rg(s);n&&!n.hasOwnProperty(s)&&(n[s]=i.style[a]),i.style[a]=t[s]}),jf()&&HI(i))}function Bo(i,t){i.style&&(Object.keys(t).forEach(n=>{const s=rg(n);i.style[s]=""}),jf()&&HI(i))}function xa(i){return Array.isArray(i)?1==i.length?i[0]:II(i):i}const og=new RegExp("{{\\s*(.+?)\\s*}}","g");function GI(i){let t=[];if("string"==typeof i){let n;for(;n=og.exec(i);)t.push(n[1]);og.lastIndex=0}return t}function oc(i,t,n){const s=i.toString(),a=s.replace(og,(u,h)=>{let d=t[h];return t.hasOwnProperty(h)||(n.push(`Please provide a value for the animation param ${h}`),d=""),d.toString()});return a==s?i:a}function rc(i){const t=[];let n=i.next();for(;!n.done;)t.push(n.value),n=i.next();return t}const GG=/-+([a-z0-9])/g;function rg(i){return i.replace(GG,(...t)=>t[1].toUpperCase())}function WG(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function WI(i,t){return 0===i||0===t}function jI(i,t,n){const s=Object.keys(n);if(s.length&&t.length){let u=t[0],h=[];if(s.forEach(d=>{u.hasOwnProperty(d)||h.push(d),u[d]=n[d]}),h.length)for(var a=1;a<t.length;a++){let d=t[a];h.forEach(function(f){d[f]=sg(i,f)})}}return t}function Zt(i,t,n){switch(t.type){case 7:return i.visitTrigger(t,n);case 0:return i.visitState(t,n);case 1:return i.visitTransition(t,n);case 2:return i.visitSequence(t,n);case 3:return i.visitGroup(t,n);case 4:return i.visitAnimate(t,n);case 5:return i.visitKeyframes(t,n);case 6:return i.visitStyle(t,n);case 8:return i.visitReference(t,n);case 9:return i.visitAnimateChild(t,n);case 10:return i.visitAnimateRef(t,n);case 11:return i.visitQuery(t,n);case 12:return i.visitStagger(t,n);default:throw new Error(`Unable to resolve animation metadata node #${t.type}`)}}function sg(i,t){return window.getComputedStyle(i)[t]}function jG(i,t){const n=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(s=>function(i,t,n){if(":"==i[0]){const f=function(i,t){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,s)=>parseFloat(s)>parseFloat(n);case":decrement":return(n,s)=>parseFloat(s)<parseFloat(n);default:return t.push(`The transition alias value "${i}" is not supported`),"* => *"}}(i,n);if("function"==typeof f)return void t.push(f);i=f}const s=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==s||s.length<4)return n.push(`The provided transition expression "${i}" is not supported`),t;const a=s[1],u=s[2],h=s[3];t.push(XI(a,h));"<"==u[0]&&!("*"==a&&"*"==h)&&t.push(XI(h,a))}(s,n,t)):n.push(i),n}const ac=new Set(["true","1"]),lc=new Set(["false","0"]);function XI(i,t){const n=ac.has(i)||lc.has(i),s=ac.has(t)||lc.has(t);return(a,u)=>{let h="*"==i||i==a,d="*"==t||t==u;return!h&&n&&"boolean"==typeof a&&(h=a?ac.has(i):lc.has(i)),!d&&s&&"boolean"==typeof u&&(d=u?ac.has(t):lc.has(t)),h&&d}}const KG=new RegExp("s*:selfs*,?","g");function ag(i,t,n){return new YG(i).build(t,n)}class YG{constructor(t){this._driver=t}build(t,n){const s=new qG(n);return this._resetContextStyleTimingState(s),Zt(this,xa(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,n){let s=n.queryCount=0,a=n.depCount=0;const u=[],h=[];return"@"==t.name.charAt(0)&&n.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(d=>{if(this._resetContextStyleTimingState(n),0==d.type){const f=d,g=f.name;g.toString().split(/\s*,\s*/).forEach(m=>{f.name=m,u.push(this.visitState(f,n))}),f.name=g}else if(1==d.type){const f=this.visitTransition(d,n);s+=f.queryCount,a+=f.depCount,h.push(f)}else n.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:u,transitions:h,queryCount:s,depCount:a,options:null}}visitState(t,n){const s=this.visitStyle(t.styles,n),a=t.options&&t.options.params||null;if(s.containsDynamicStyles){const u=new Set,h=a||{};if(s.styles.forEach(d=>{if(uc(d)){const f=d;Object.keys(f).forEach(g=>{GI(f[g]).forEach(m=>{h.hasOwnProperty(m)||u.add(m)})})}}),u.size){const d=rc(u.values());n.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${d.join(", ")}`)}}return{type:0,name:t.name,style:s,options:a?{params:a}:null}}visitTransition(t,n){n.queryCount=0,n.depCount=0;const s=Zt(this,xa(t.animation),n);return{type:1,matchers:jG(t.expr,n.errors),animation:s,queryCount:n.queryCount,depCount:n.depCount,options:Uo(t.options)}}visitSequence(t,n){return{type:2,steps:t.steps.map(s=>Zt(this,s,n)),options:Uo(t.options)}}visitGroup(t,n){const s=n.currentTime;let a=0;const u=t.steps.map(h=>{n.currentTime=s;const d=Zt(this,h,n);return a=Math.max(a,n.currentTime),d});return n.currentTime=a,{type:3,steps:u,options:Uo(t.options)}}visitAnimate(t,n){const s=function(i,t){let n=null;if(i.hasOwnProperty("duration"))n=i;else if("number"==typeof i)return lg(ic(i,t).duration,0,"");const s=i;if(s.split(/\s+/).some(u=>"{"==u.charAt(0)&&"{"==u.charAt(1))){const u=lg(0,0,"");return u.dynamic=!0,u.strValue=s,u}return n=n||ic(s,t),lg(n.duration,n.delay,n.easing)}(t.timings,n.errors);n.currentAnimateTimings=s;let a,u=t.styles?t.styles:RI({});if(5==u.type)a=this.visitKeyframes(u,n);else{let h=t.styles,d=!1;if(!h){d=!0;const g={};s.easing&&(g.easing=s.easing),h=RI(g)}n.currentTime+=s.duration+s.delay;const f=this.visitStyle(h,n);f.isEmptyStep=d,a=f}return n.currentAnimateTimings=null,{type:4,timings:s,style:a,options:null}}visitStyle(t,n){const s=this._makeStyleAst(t,n);return this._validateStyleAst(s,n),s}_makeStyleAst(t,n){const s=[];Array.isArray(t.styles)?t.styles.forEach(h=>{"string"==typeof h?h==Oi?s.push(h):n.errors.push(`The provided style string value ${h} is not allowed.`):s.push(h)}):s.push(t.styles);let a=!1,u=null;return s.forEach(h=>{if(uc(h)){const d=h,f=d.easing;if(f&&(u=f,delete d.easing),!a)for(let g in d)if(d[g].toString().indexOf("{{")>=0){a=!0;break}}}),{type:6,styles:s,easing:u,offset:t.offset,containsDynamicStyles:a,options:null}}_validateStyleAst(t,n){const s=n.currentAnimateTimings;let a=n.currentTime,u=n.currentTime;s&&u>0&&(u-=s.duration+s.delay),t.styles.forEach(h=>{"string"!=typeof h&&Object.keys(h).forEach(d=>{if(!this._driver.validateStyleProperty(d))return void n.errors.push(`The provided animation property "${d}" is not a supported CSS property for animations`);const f=n.collectedStyles[n.currentQuerySelector],g=f[d];let m=!0;g&&(u!=a&&u>=g.startTime&&a<=g.endTime&&(n.errors.push(`The CSS property "${d}" that exists between the times of "${g.startTime}ms" and "${g.endTime}ms" is also being animated in a parallel animation between the times of "${u}ms" and "${a}ms"`),m=!1),u=g.startTime),m&&(f[d]={startTime:u,endTime:a}),n.options&&function(i,t,n){const s=t.params||{},a=GI(i);a.length&&a.forEach(u=>{s.hasOwnProperty(u)||n.push(`Unable to resolve the local animation param ${u} in the given list of values`)})}(h[d],n.options,n.errors)})})}visitKeyframes(t,n){const s={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push("keyframes() must be placed inside of a call to animate()"),s;let u=0;const h=[];let d=!1,f=!1,g=0;const m=t.steps.map(D=>{const R=this._makeStyleAst(D,n);let k=null!=R.offset?R.offset:function(i){if("string"==typeof i)return null;let t=null;if(Array.isArray(i))i.forEach(n=>{if(uc(n)&&n.hasOwnProperty("offset")){const s=n;t=parseFloat(s.offset),delete s.offset}});else if(uc(i)&&i.hasOwnProperty("offset")){const n=i;t=parseFloat(n.offset),delete n.offset}return t}(R.styles),x=0;return null!=k&&(u++,x=R.offset=k),f=f||x<0||x>1,d=d||x<g,g=x,h.push(x),R});f&&n.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),d&&n.errors.push("Please ensure that all keyframe offsets are in order");const E=t.steps.length;let T=0;u>0&&u<E?n.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==u&&(T=1/(E-1));const y=E-1,C=n.currentTime,I=n.currentAnimateTimings,S=I.duration;return m.forEach((D,R)=>{const k=T>0?R==y?1:T*R:h[R],x=k*S;n.currentTime=C+I.delay+x,I.duration=x,this._validateStyleAst(D,n),D.offset=k,s.styles.push(D)}),s}visitReference(t,n){return{type:8,animation:Zt(this,xa(t.animation),n),options:Uo(t.options)}}visitAnimateChild(t,n){return n.depCount++,{type:9,options:Uo(t.options)}}visitAnimateRef(t,n){return{type:10,animation:this.visitReference(t.animation,n),options:Uo(t.options)}}visitQuery(t,n){const s=n.currentQuerySelector,a=t.options||{};n.queryCount++,n.currentQuery=t;const[u,h]=function(i){const t=!!i.split(/\s*,\s*/).find(n=>":self"==n);return t&&(i=i.replace(KG,"")),i=i.replace(/@\*/g,nc).replace(/@\w+/g,n=>nc+"-"+n.substr(1)).replace(/:animating/g,ng),[i,t]}(t.selector);n.currentQuerySelector=s.length?s+" "+u:u,Qt(n.collectedStyles,n.currentQuerySelector,{});const d=Zt(this,xa(t.animation),n);return n.currentQuery=null,n.currentQuerySelector=s,{type:11,selector:u,limit:a.limit||0,optional:!!a.optional,includeSelf:h,animation:d,originalSelector:t.selector,options:Uo(t.options)}}visitStagger(t,n){n.currentQuery||n.errors.push("stagger() can only be used inside of query()");const s="full"===t.timings?{duration:0,delay:0,easing:"full"}:ic(t.timings,n.errors,!0);return{type:12,animation:Zt(this,xa(t.animation),n),timings:s,options:null}}}class qG{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function uc(i){return!Array.isArray(i)&&"object"==typeof i}function Uo(i){return i?(i=Qr(i)).params&&(i.params=function(i){return i?Qr(i):null}(i.params)):i={},i}function lg(i,t,n){return{duration:i,delay:t,easing:n}}function ug(i,t,n,s,a,u,h=null,d=!1){return{type:1,element:i,keyframes:t,preStyleProps:n,postStyleProps:s,duration:a,delay:u,totalTime:a+u,easing:h,subTimeline:d}}class cc{constructor(){this._map=new Map}consume(t){let n=this._map.get(t);return n?this._map.delete(t):n=[],n}append(t,n){let s=this._map.get(t);s||this._map.set(t,s=[]),s.push(...n)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const nW=new RegExp(":enter","g"),oW=new RegExp(":leave","g");function cg(i,t,n,s,a,u={},h={},d,f,g=[]){return(new rW).buildKeyframes(i,t,n,s,a,u,h,d,f,g)}class rW{buildKeyframes(t,n,s,a,u,h,d,f,g,m=[]){g=g||new cc;const E=new hg(t,n,g,a,u,m,[]);E.options=f,E.currentTimeline.setStyles([h],null,E.errors,f),Zt(this,s,E);const T=E.timelines.filter(y=>y.containsAnimation());if(T.length&&Object.keys(d).length){const y=T[T.length-1];y.allowOnlyTimelineStyles()||y.setStyles([d],null,E.errors,f)}return T.length?T.map(y=>y.buildKeyframes()):[ug(n,[],[],[],0,0,"",!1)]}visitTrigger(t,n){}visitState(t,n){}visitTransition(t,n){}visitAnimateChild(t,n){const s=n.subInstructions.consume(n.element);if(s){const a=n.createSubContext(t.options),u=n.currentTimeline.currentTime,h=this._visitSubInstructions(s,a,a.options);u!=h&&n.transformIntoNewTimeline(h)}n.previousNode=t}visitAnimateRef(t,n){const s=n.createSubContext(t.options);s.transformIntoNewTimeline(),this.visitReference(t.animation,s),n.transformIntoNewTimeline(s.currentTimeline.currentTime),n.previousNode=t}_visitSubInstructions(t,n,s){let u=n.currentTimeline.currentTime;const h=null!=s.duration?Vo(s.duration):null,d=null!=s.delay?Vo(s.delay):null;return 0!==h&&t.forEach(f=>{const g=n.appendInstructionToTimeline(f,h,d);u=Math.max(u,g.duration+g.delay)}),u}visitReference(t,n){n.updateOptions(t.options,!0),Zt(this,t.animation,n),n.previousNode=t}visitSequence(t,n){const s=n.subContextCount;let a=n;const u=t.options;if(u&&(u.params||u.delay)&&(a=n.createSubContext(u),a.transformIntoNewTimeline(),null!=u.delay)){6==a.previousNode.type&&(a.currentTimeline.snapshotCurrentStyles(),a.previousNode=hc);const h=Vo(u.delay);a.delayNextStep(h)}t.steps.length&&(t.steps.forEach(h=>Zt(this,h,a)),a.currentTimeline.applyStylesToKeyframe(),a.subContextCount>s&&a.transformIntoNewTimeline()),n.previousNode=t}visitGroup(t,n){const s=[];let a=n.currentTimeline.currentTime;const u=t.options&&t.options.delay?Vo(t.options.delay):0;t.steps.forEach(h=>{const d=n.createSubContext(t.options);u&&d.delayNextStep(u),Zt(this,h,d),a=Math.max(a,d.currentTimeline.currentTime),s.push(d.currentTimeline)}),s.forEach(h=>n.currentTimeline.mergeTimelineCollectedStyles(h)),n.transformIntoNewTimeline(a),n.previousNode=t}_visitTiming(t,n){if(t.dynamic){const s=t.strValue;return ic(n.params?oc(s,n.params,n.errors):s,n.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,n){const s=n.currentAnimateTimings=this._visitTiming(t.timings,n),a=n.currentTimeline;s.delay&&(n.incrementTime(s.delay),a.snapshotCurrentStyles());const u=t.style;5==u.type?this.visitKeyframes(u,n):(n.incrementTime(s.duration),this.visitStyle(u,n),a.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=t}visitStyle(t,n){const s=n.currentTimeline,a=n.currentAnimateTimings;!a&&s.getCurrentStyleProperties().length&&s.forwardFrame();const u=a&&a.easing||t.easing;t.isEmptyStep?s.applyEmptyStep(u):s.setStyles(t.styles,u,n.errors,n.options),n.previousNode=t}visitKeyframes(t,n){const s=n.currentAnimateTimings,a=n.currentTimeline.duration,u=s.duration,d=n.createSubContext().currentTimeline;d.easing=s.easing,t.styles.forEach(f=>{d.forwardTime((f.offset||0)*u),d.setStyles(f.styles,f.easing,n.errors,n.options),d.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(d),n.transformIntoNewTimeline(a+u),n.previousNode=t}visitQuery(t,n){const s=n.currentTimeline.currentTime,a=t.options||{},u=a.delay?Vo(a.delay):0;u&&(6===n.previousNode.type||0==s&&n.currentTimeline.getCurrentStyleProperties().length)&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=hc);let h=s;const d=n.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!a.optional,n.errors);n.currentQueryTotal=d.length;let f=null;d.forEach((g,m)=>{n.currentQueryIndex=m;const E=n.createSubContext(t.options,g);u&&E.delayNextStep(u),g===n.element&&(f=E.currentTimeline),Zt(this,t.animation,E),E.currentTimeline.applyStylesToKeyframe(),h=Math.max(h,E.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(h),f&&(n.currentTimeline.mergeTimelineCollectedStyles(f),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=t}visitStagger(t,n){const s=n.parentContext,a=n.currentTimeline,u=t.timings,h=Math.abs(u.duration),d=h*(n.currentQueryTotal-1);let f=h*n.currentQueryIndex;switch(u.duration<0?"reverse":u.easing){case"reverse":f=d-f;break;case"full":f=s.currentStaggerTime}const m=n.currentTimeline;f&&m.delayNextStep(f);const E=m.currentTime;Zt(this,t.animation,n),n.previousNode=t,s.currentStaggerTime=a.currentTime-E+(a.startTime-s.currentTimeline.startTime)}}const hc={};class hg{constructor(t,n,s,a,u,h,d,f){this._driver=t,this.element=n,this.subInstructions=s,this._enterClassName=a,this._leaveClassName=u,this.errors=h,this.timelines=d,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=hc,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=f||new dc(this._driver,n,0),d.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,n){if(!t)return;const s=t;let a=this.options;null!=s.duration&&(a.duration=Vo(s.duration)),null!=s.delay&&(a.delay=Vo(s.delay));const u=s.params;if(u){let h=a.params;h||(h=this.options.params={}),Object.keys(u).forEach(d=>{(!n||!h.hasOwnProperty(d))&&(h[d]=oc(u[d],h,this.errors))})}}_copyOptions(){const t={};if(this.options){const n=this.options.params;if(n){const s=t.params={};Object.keys(n).forEach(a=>{s[a]=n[a]})}}return t}createSubContext(t=null,n,s){const a=n||this.element,u=new hg(this._driver,a,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(a,s||0));return u.previousNode=this.previousNode,u.currentAnimateTimings=this.currentAnimateTimings,u.options=this._copyOptions(),u.updateOptions(t),u.currentQueryIndex=this.currentQueryIndex,u.currentQueryTotal=this.currentQueryTotal,u.parentContext=this,this.subContextCount++,u}transformIntoNewTimeline(t){return this.previousNode=hc,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,n,s){const a={duration:null!=n?n:t.duration,delay:this.currentTimeline.currentTime+(null!=s?s:0)+t.delay,easing:""},u=new sW(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,a,t.stretchStartingKeyframe);return this.timelines.push(u),a}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,n,s,a,u,h){let d=[];if(a&&d.push(this.element),t.length>0){t=(t=t.replace(nW,"."+this._enterClassName)).replace(oW,"."+this._leaveClassName);let g=this._driver.query(this.element,t,1!=s);0!==s&&(g=s<0?g.slice(g.length+s,g.length):g.slice(0,s)),d.push(...g)}return!u&&0==d.length&&h.push(`\`query("${n}")\` returned zero elements. (Use \`query("${n}", { optional: true })\` if you wish to allow this.)`),d}}class dc{constructor(t,n,s,a){this._driver=t,this.element=n,this.startTime=s,this._elementTimelineStylesLookup=a,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const n=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||n?(this.forwardTime(this.currentTime+t),n&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,n){return this.applyStylesToKeyframe(),new dc(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,n){this._localTimelineStyles[t]=n,this._globalTimelineStyles[t]=n,this._styleSummary[t]={time:this.currentTime,value:n}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(n=>{this._backFill[n]=this._globalTimelineStyles[n]||Oi,this._currentKeyframe[n]=Oi}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,n,s,a){n&&(this._previousKeyframe.easing=n);const u=a&&a.params||{},h=function(i,t){const n={};let s;return i.forEach(a=>{"*"===a?(s=s||Object.keys(t),s.forEach(u=>{n[u]=Oi})):no(a,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(h).forEach(d=>{const f=oc(h[d],u,s);this._pendingStyles[d]=f,this._localTimelineStyles.hasOwnProperty(d)||(this._backFill[d]=this._globalTimelineStyles.hasOwnProperty(d)?this._globalTimelineStyles[d]:Oi),this._updateStyle(d,f)})}applyStylesToKeyframe(){const t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(s=>{this._currentKeyframe[s]=t[s]}),Object.keys(this._localTimelineStyles).forEach(s=>{this._currentKeyframe.hasOwnProperty(s)||(this._currentKeyframe[s]=this._localTimelineStyles[s])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const n=this._localTimelineStyles[t];this._pendingStyles[t]=n,this._updateStyle(t,n)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let n in this._currentKeyframe)t.push(n);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(n=>{const s=this._styleSummary[n],a=t._styleSummary[n];(!s||a.time>s.time)&&this._updateStyle(n,a.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,n=new Set,s=1===this._keyframes.size&&0===this.duration;let a=[];this._keyframes.forEach((d,f)=>{const g=no(d,!0);Object.keys(g).forEach(m=>{const E=g[m];"!"==E?t.add(m):E==Oi&&n.add(m)}),s||(g.offset=f/this.duration),a.push(g)});const u=t.size?rc(t.values()):[],h=n.size?rc(n.values()):[];if(s){const d=a[0],f=Qr(d);d.offset=0,f.offset=1,a=[d,f]}return ug(this.element,a,u,h,this.duration,this.startTime,this.easing,!1)}}class sW extends dc{constructor(t,n,s,a,u,h,d=!1){super(t,n,h.delay),this.keyframes=s,this.preStyleProps=a,this.postStyleProps=u,this._stretchStartingKeyframe=d,this.timings={duration:h.duration,delay:h.delay,easing:h.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:n,duration:s,easing:a}=this.timings;if(this._stretchStartingKeyframe&&n){const u=[],h=s+n,d=n/h,f=no(t[0],!1);f.offset=0,u.push(f);const g=no(t[0],!1);g.offset=YI(d),u.push(g);const m=t.length-1;for(let E=1;E<=m;E++){let T=no(t[E],!1);T.offset=YI((n+T.offset*s)/h),u.push(T)}s=h,n=0,a="",t=u}return ug(this.element,t,this.preStyleProps,this.postStyleProps,s,n,a,!0)}}function YI(i,t=3){const n=Math.pow(10,t-1);return Math.round(i*n)/n}class dg{}class lW extends dg{normalizePropertyName(t,n){return rg(t)}normalizeStyleValue(t,n,s,a){let u="";const h=s.toString().trim();if(uW[n]&&0!==s&&"0"!==s)if("number"==typeof s)u="px";else{const d=s.match(/^[+-]?[\d\.]+([a-z]*)$/);d&&0==d[1].length&&a.push(`Please provide a CSS unit value for ${t}:${s}`)}return h+u}}const uW=(()=>function(i){const t={};return i.forEach(n=>t[n]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function JI(i,t,n,s,a,u,h,d,f,g,m,E,T){return{type:0,element:i,triggerName:t,isRemovalTransition:a,fromState:n,fromStyles:u,toState:s,toStyles:h,timelines:d,queriedElements:f,preStyleProps:g,postStyleProps:m,totalTime:E,errors:T}}const pg={};class $I{constructor(t,n,s){this._triggerName=t,this.ast=n,this._stateStyles=s}match(t,n,s,a){return function(i,t,n,s,a){return i.some(u=>u(t,n,s,a))}(this.ast.matchers,t,n,s,a)}buildStyles(t,n,s){const a=this._stateStyles["*"],u=this._stateStyles[t],h=a?a.buildStyles(n,s):{};return u?u.buildStyles(n,s):h}build(t,n,s,a,u,h,d,f,g,m){const E=[],T=this.ast.options&&this.ast.options.params||pg,C=this.buildStyles(s,d&&d.params||pg,E),I=f&&f.params||pg,S=this.buildStyles(a,I,E),D=new Set,R=new Map,k=new Map,x="void"===a,Q={params:U(U({},T),I)},ve=m?[]:cg(t,n,this.ast.animation,u,h,C,S,Q,g,E);let Se=0;if(ve.forEach(bt=>{Se=Math.max(bt.duration+bt.delay,Se)}),E.length)return JI(n,this._triggerName,s,a,x,C,S,[],[],R,k,Se,E);ve.forEach(bt=>{const St=bt.element,Ni=Qt(R,St,{});bt.preStyleProps.forEach(Gn=>Ni[Gn]=!0);const ki=Qt(k,St,{});bt.postStyleProps.forEach(Gn=>ki[Gn]=!0),St!==n&&D.add(St)});const xt=rc(D.values());return JI(n,this._triggerName,s,a,x,C,S,ve,xt,R,k,Se)}}class dW{constructor(t,n,s){this.styles=t,this.defaultParams=n,this.normalizer=s}buildStyles(t,n){const s={},a=Qr(this.defaultParams);return Object.keys(t).forEach(u=>{const h=t[u];null!=h&&(a[u]=h)}),this.styles.styles.forEach(u=>{if("string"!=typeof u){const h=u;Object.keys(h).forEach(d=>{let f=h[d];f.length>1&&(f=oc(f,a,n));const g=this.normalizer.normalizePropertyName(d,n);f=this.normalizer.normalizeStyleValue(d,g,f,n),s[g]=f})}}),s}}class fW{constructor(t,n,s){this.name=t,this.ast=n,this._normalizer=s,this.transitionFactories=[],this.states={},n.states.forEach(a=>{this.states[a.name]=new dW(a.style,a.options&&a.options.params||{},s)}),qI(this.states,"true","1"),qI(this.states,"false","0"),n.transitions.forEach(a=>{this.transitionFactories.push(new $I(t,a,this.states))}),this.fallbackTransition=function(i,t,n){return new $I(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(h,d)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,n,s,a){return this.transitionFactories.find(h=>h.match(t,n,s,a))||null}matchStyles(t,n,s){return this.fallbackTransition.buildStyles(t,n,s)}}function qI(i,t,n){i.hasOwnProperty(t)?i.hasOwnProperty(n)||(i[n]=i[t]):i.hasOwnProperty(n)&&(i[t]=i[n])}const _W=new cc;class mW{constructor(t,n,s){this.bodyNode=t,this._driver=n,this._normalizer=s,this._animations={},this._playersById={},this.players=[]}register(t,n){const s=[],a=ag(this._driver,n,s);if(s.length)throw new Error(`Unable to build the animation due to the following errors: ${s.join("\n")}`);this._animations[t]=a}_buildPlayer(t,n,s){const a=t.element,u=MI(0,this._normalizer,0,t.keyframes,n,s);return this._driver.animate(a,u,t.duration,t.delay,t.easing,[],!0)}create(t,n,s={}){const a=[],u=this._animations[t];let h;const d=new Map;if(u?(h=cg(this._driver,n,u,tg,ec,{},{},s,_W,a),h.forEach(m=>{const E=Qt(d,m.element,{});m.postStyleProps.forEach(T=>E[T]=null)})):(a.push("The requested animation doesn't exist or has already been destroyed"),h=[]),a.length)throw new Error(`Unable to create the animation due to the following errors: ${a.join("\n")}`);d.forEach((m,E)=>{Object.keys(m).forEach(T=>{m[T]=this._driver.computeStyle(E,T,Oi)})});const g=to(h.map(m=>{const E=d.get(m.element);return this._buildPlayer(m,{},E)}));return this._playersById[t]=g,g.onDestroy(()=>this.destroy(t)),this.players.push(g),g}destroy(t){const n=this._getPlayer(t);n.destroy(),delete this._playersById[t];const s=this.players.indexOf(n);s>=0&&this.players.splice(s,1)}_getPlayer(t){const n=this._playersById[t];if(!n)throw new Error(`Unable to find the timeline player referenced by ${t}`);return n}listen(t,n,s,a){const u=Kf(n,"","","");return Xf(this._getPlayer(t),s,u,a),()=>{}}command(t,n,s,a){if("register"==s)return void this.register(t,a[0]);if("create"==s)return void this.create(t,n,a[0]||{});const u=this._getPlayer(t);switch(s){case"play":u.play();break;case"pause":u.pause();break;case"reset":u.reset();break;case"restart":u.restart();break;case"finish":u.finish();break;case"init":u.init();break;case"setPosition":u.setPosition(parseFloat(a[0]));break;case"destroy":this.destroy(t)}}}const QI="ng-animate-queued",ZI="ng-animate-disabled",eR=".ng-animate-disabled",yW=[],tR={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},CW={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},mn="__ng_removed";class fg{constructor(t,n=""){this.namespaceId=n;const s=t&&t.hasOwnProperty("value");if(this.value=null!=(i=s?t.value:t)?i:null,s){const u=Qr(t);delete u.value,this.options=u}else this.options={};var i;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const n=t.params;if(n){const s=this.options.params;Object.keys(n).forEach(a=>{null==s[a]&&(s[a]=n[a])})}}}const Fa="void",gg=new fg(Fa);class bW{constructor(t,n,s){this.id=t,this.hostElement=n,this._engine=s,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,En(n,this._hostClassName)}listen(t,n,s,a){if(!this._triggers.hasOwnProperty(n))throw new Error(`Unable to listen on the animation trigger event "${s}" because the animation trigger "${n}" doesn't exist!`);if(null==s||0==s.length)throw new Error(`Unable to listen on the animation trigger "${n}" because the provided event is undefined!`);if("start"!=(i=s)&&"done"!=i)throw new Error(`The provided animation trigger event "${s}" for the animation trigger "${n}" is not supported!`);var i;const u=Qt(this._elementListeners,t,[]),h={name:n,phase:s,callback:a};u.push(h);const d=Qt(this._engine.statesByElement,t,{});return d.hasOwnProperty(n)||(En(t,tc),En(t,tc+"-"+n),d[n]=gg),()=>{this._engine.afterFlush(()=>{const f=u.indexOf(h);f>=0&&u.splice(f,1),this._triggers[n]||delete d[n]})}}register(t,n){return!this._triggers[t]&&(this._triggers[t]=n,!0)}_getTrigger(t){const n=this._triggers[t];if(!n)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return n}trigger(t,n,s,a=!0){const u=this._getTrigger(n),h=new _g(this.id,n,t);let d=this._engine.statesByElement.get(t);d||(En(t,tc),En(t,tc+"-"+n),this._engine.statesByElement.set(t,d={}));let f=d[n];const g=new fg(s,this.id);if(!(s&&s.hasOwnProperty("value"))&&f&&g.absorbOptions(f.options),d[n]=g,f||(f=gg),g.value!==Fa&&f.value===g.value){if(!function(i,t){const n=Object.keys(i),s=Object.keys(t);if(n.length!=s.length)return!1;for(let a=0;a<n.length;a++){const u=n[a];if(!t.hasOwnProperty(u)||i[u]!==t[u])return!1}return!0}(f.params,g.params)){const I=[],S=u.matchStyles(f.value,f.params,I),D=u.matchStyles(g.value,g.params,I);I.length?this._engine.reportError(I):this._engine.afterFlush(()=>{Bo(t,S),si(t,D)})}return}const T=Qt(this._engine.playersByElement,t,[]);T.forEach(I=>{I.namespaceId==this.id&&I.triggerName==n&&I.queued&&I.destroy()});let y=u.matchTransition(f.value,g.value,t,g.params),C=!1;if(!y){if(!a)return;y=u.fallbackTransition,C=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:n,transition:y,fromState:f,toState:g,player:h,isFallbackTransition:C}),C||(En(t,QI),h.onStart(()=>{Zr(t,QI)})),h.onDone(()=>{let I=this.players.indexOf(h);I>=0&&this.players.splice(I,1);const S=this._engine.playersByElement.get(t);if(S){let D=S.indexOf(h);D>=0&&S.splice(D,1)}}),this.players.push(h),T.push(h),h}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((n,s)=>{delete n[t]}),this._elementListeners.forEach((n,s)=>{this._elementListeners.set(s,n.filter(a=>a.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const n=this._engine.playersByElement.get(t);n&&(n.forEach(s=>s.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,n){const s=this._engine.driver.query(t,nc,!0);s.forEach(a=>{if(a[mn])return;const u=this._engine.fetchNamespacesByElement(a);u.size?u.forEach(h=>h.triggerLeaveAnimation(a,n,!1,!0)):this.clearElementCache(a)}),this._engine.afterFlushAnimationsDone(()=>s.forEach(a=>this.clearElementCache(a)))}triggerLeaveAnimation(t,n,s,a){const u=this._engine.statesByElement.get(t);if(u){const h=[];if(Object.keys(u).forEach(d=>{if(this._triggers[d]){const f=this.trigger(t,d,Fa,a);f&&h.push(f)}}),h.length)return this._engine.markElementAsRemoved(this.id,t,!0,n),s&&to(h).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const n=this._elementListeners.get(t),s=this._engine.statesByElement.get(t);if(n&&s){const a=new Set;n.forEach(u=>{const h=u.name;if(a.has(h))return;a.add(h);const f=this._triggers[h].fallbackTransition,g=s[h]||gg,m=new fg(Fa),E=new _g(this.id,h,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:h,transition:f,fromState:g,toState:m,player:E,isFallbackTransition:!0})})}}removeNode(t,n){const s=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,n),this.triggerLeaveAnimation(t,n,!0))return;let a=!1;if(s.totalAnimations){const u=s.players.length?s.playersByQueriedElement.get(t):[];if(u&&u.length)a=!0;else{let h=t;for(;h=h.parentNode;)if(s.statesByElement.get(h)){a=!0;break}}}if(this.prepareLeaveAnimationListeners(t),a)s.markElementAsRemoved(this.id,t,!1,n);else{const u=t[mn];(!u||u===tR)&&(s.afterFlush(()=>this.clearElementCache(t)),s.destroyInnerAnimations(t),s._onRemovalComplete(t,n))}}insertNode(t,n){En(t,this._hostClassName)}drainQueuedTransitions(t){const n=[];return this._queue.forEach(s=>{const a=s.player;if(a.destroyed)return;const u=s.element,h=this._elementListeners.get(u);h&&h.forEach(d=>{if(d.name==s.triggerName){const f=Kf(u,s.triggerName,s.fromState.value,s.toState.value);f._data=t,Xf(s.player,d.phase,f,d.callback)}}),a.markedForDestroy?this._engine.afterFlush(()=>{a.destroy()}):n.push(s)}),this._queue=[],n.sort((s,a)=>{const u=s.transition.ast.depCount,h=a.transition.ast.depCount;return 0==u||0==h?u-h:this._engine.driver.containsElement(s.element,a.element)?1:-1})}destroy(t){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let n=!1;return this._elementListeners.has(t)&&(n=!0),n=!!this._queue.find(s=>s.element===t)||n,n}}class SW{constructor(t,n,s){this.bodyNode=t,this.driver=n,this._normalizer=s,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(a,u)=>{}}_onRemovalComplete(t,n){this.onRemovalComplete(t,n)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(n=>{n.players.forEach(s=>{s.queued&&t.push(s)})}),t}createNamespace(t,n){const s=new bW(t,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(s,n):(this.newHostElements.set(n,s),this.collectEnterElement(n)),this._namespaceLookup[t]=s}_balanceNamespaceList(t,n){const s=this._namespaceList.length-1;if(s>=0){let a=!1;for(let u=s;u>=0;u--)if(this.driver.containsElement(this._namespaceList[u].hostElement,n)){this._namespaceList.splice(u+1,0,t),a=!0;break}a||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(n,t),t}register(t,n){let s=this._namespaceLookup[t];return s||(s=this.createNamespace(t,n)),s}registerTrigger(t,n,s){let a=this._namespaceLookup[t];a&&a.register(n,s)&&this.totalAnimations++}destroy(t,n){if(!t)return;const s=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(s.hostElement),delete this._namespaceLookup[t];const a=this._namespaceList.indexOf(s);a>=0&&this._namespaceList.splice(a,1)}),this.afterFlushAnimationsDone(()=>s.destroy(n))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const n=new Set,s=this.statesByElement.get(t);if(s){const a=Object.keys(s);for(let u=0;u<a.length;u++){const h=s[a[u]].namespaceId;if(h){const d=this._fetchNamespace(h);d&&n.add(d)}}}return n}trigger(t,n,s,a){if(pc(n)){const u=this._fetchNamespace(t);if(u)return u.trigger(n,s,a),!0}return!1}insertNode(t,n,s,a){if(!pc(n))return;const u=n[mn];if(u&&u.setForRemoval){u.setForRemoval=!1,u.setForMove=!0;const h=this.collectedLeaveElements.indexOf(n);h>=0&&this.collectedLeaveElements.splice(h,1)}if(t){const h=this._fetchNamespace(t);h&&h.insertNode(n,s)}a&&this.collectEnterElement(n)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,n){n?this.disabledNodes.has(t)||(this.disabledNodes.add(t),En(t,ZI)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Zr(t,ZI))}removeNode(t,n,s,a){if(pc(n)){const u=t?this._fetchNamespace(t):null;if(u?u.removeNode(n,a):this.markElementAsRemoved(t,n,!1,a),s){const h=this.namespacesByHostElement.get(n);h&&h.id!==t&&h.removeNode(n,a)}}else this._onRemovalComplete(n,a)}markElementAsRemoved(t,n,s,a){this.collectedLeaveElements.push(n),n[mn]={namespaceId:t,setForRemoval:a,hasAnimation:s,removedBeforeQueried:!1}}listen(t,n,s,a,u){return pc(n)?this._fetchNamespace(t).listen(n,s,a,u):()=>{}}_buildInstruction(t,n,s,a,u){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,s,a,t.fromState.options,t.toState.options,n,u)}destroyInnerAnimations(t){let n=this.driver.query(t,nc,!0);n.forEach(s=>this.destroyActiveAnimationsForElement(s)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(t,ng,!0),n.forEach(s=>this.finishActiveQueriedAnimationOnElement(s)))}destroyActiveAnimationsForElement(t){const n=this.playersByElement.get(t);n&&n.forEach(s=>{s.queued?s.markedForDestroy=!0:s.destroy()})}finishActiveQueriedAnimationOnElement(t){const n=this.playersByQueriedElement.get(t);n&&n.forEach(s=>s.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return to(this.players).onDone(()=>t());t()})}processLeaveNode(t){const n=t[mn];if(n&&n.setForRemoval){if(t[mn]=tR,n.namespaceId){this.destroyInnerAnimations(t);const s=this._fetchNamespace(n.namespaceId);s&&s.clearElementCache(t)}this._onRemovalComplete(t,n.setForRemoval)}this.driver.matchesElement(t,eR)&&this.markElementAsDisabled(t,!1),this.driver.query(t,eR,!0).forEach(s=>{this.markElementAsDisabled(s,!1)})}flush(t=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((s,a)=>this._balanceNamespaceList(s,a)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let s=0;s<this.collectedEnterElements.length;s++)En(this.collectedEnterElements[s],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const s=[];try{n=this._flushAnimations(s,t)}finally{for(let a=0;a<s.length;a++)s[a]()}}else for(let s=0;s<this.collectedLeaveElements.length;s++)this.processLeaveNode(this.collectedLeaveElements[s]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(s=>s()),this._flushFns=[],this._whenQuietFns.length){const s=this._whenQuietFns;this._whenQuietFns=[],n.length?to(n).onDone(()=>{s.forEach(a=>a())}):s.forEach(a=>a())}}reportError(t){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${t.join("\n")}`)}_flushAnimations(t,n){const s=new cc,a=[],u=new Map,h=[],d=new Map,f=new Map,g=new Map,m=new Set;this.disabledNodes.forEach(H=>{m.add(H);const j=this.driver.query(H,".ng-animate-queued",!0);for(let oe=0;oe<j.length;oe++)m.add(j[oe])});const E=this.bodyNode,T=Array.from(this.statesByElement.keys()),y=oR(T,this.collectedEnterElements),C=new Map;let I=0;y.forEach((H,j)=>{const oe=tg+I++;C.set(j,oe),H.forEach(me=>En(me,oe))});const S=[],D=new Set,R=new Set;for(let H=0;H<this.collectedLeaveElements.length;H++){const j=this.collectedLeaveElements[H],oe=j[mn];oe&&oe.setForRemoval&&(S.push(j),D.add(j),oe.hasAnimation?this.driver.query(j,".ng-star-inserted",!0).forEach(me=>D.add(me)):R.add(j))}const k=new Map,x=oR(T,Array.from(D));x.forEach((H,j)=>{const oe=ec+I++;k.set(j,oe),H.forEach(me=>En(me,oe))}),t.push(()=>{y.forEach((H,j)=>{const oe=C.get(j);H.forEach(me=>Zr(me,oe))}),x.forEach((H,j)=>{const oe=k.get(j);H.forEach(me=>Zr(me,oe))}),S.forEach(H=>{this.processLeaveNode(H)})});const Q=[],ve=[];for(let H=this._namespaceList.length-1;H>=0;H--)this._namespaceList[H].drainQueuedTransitions(n).forEach(oe=>{const me=oe.player,ht=oe.element;if(Q.push(me),this.collectedEnterElements.length){const li=ht[mn];if(li&&li.setForMove)return void me.destroy()}const ai=!E||!this.driver.containsElement(E,ht),en=k.get(ht),io=C.get(ht),ze=this._buildInstruction(oe,s,io,en,ai);if(ze.errors&&ze.errors.length)ve.push(ze);else{if(ai)return me.onStart(()=>Bo(ht,ze.fromStyles)),me.onDestroy(()=>si(ht,ze.toStyles)),void a.push(me);if(oe.isFallbackTransition)return me.onStart(()=>Bo(ht,ze.fromStyles)),me.onDestroy(()=>si(ht,ze.toStyles)),void a.push(me);ze.timelines.forEach(li=>li.stretchStartingKeyframe=!0),s.append(ht,ze.timelines),h.push({instruction:ze,player:me,element:ht}),ze.queriedElements.forEach(li=>Qt(d,li,[]).push(me)),ze.preStyleProps.forEach((li,Ha)=>{const Ec=Object.keys(li);if(Ec.length){let Ho=f.get(Ha);Ho||f.set(Ha,Ho=new Set),Ec.forEach(Cg=>Ho.add(Cg))}}),ze.postStyleProps.forEach((li,Ha)=>{const Ec=Object.keys(li);let Ho=g.get(Ha);Ho||g.set(Ha,Ho=new Set),Ec.forEach(Cg=>Ho.add(Cg))})}});if(ve.length){const H=[];ve.forEach(j=>{H.push(`@${j.triggerName} has failed due to:\n`),j.errors.forEach(oe=>H.push(`- ${oe}\n`))}),Q.forEach(j=>j.destroy()),this.reportError(H)}const Se=new Map,xt=new Map;h.forEach(H=>{const j=H.element;s.has(j)&&(xt.set(j,j),this._beforeAnimationBuild(H.player.namespaceId,H.instruction,Se))}),a.forEach(H=>{const j=H.element;this._getPreviousPlayers(j,!1,H.namespaceId,H.triggerName,null).forEach(me=>{Qt(Se,j,[]).push(me),me.destroy()})});const bt=S.filter(H=>sR(H,f,g)),St=new Map;iR(St,this.driver,R,g,Oi).forEach(H=>{sR(H,f,g)&&bt.push(H)});const ki=new Map;y.forEach((H,j)=>{iR(ki,this.driver,new Set(H),f,"!")}),bt.forEach(H=>{const j=St.get(H),oe=ki.get(H);St.set(H,U(U({},j),oe))});const Gn=[],ts=[],ns={};h.forEach(H=>{const{element:j,player:oe,instruction:me}=H;if(s.has(j)){if(m.has(j))return oe.onDestroy(()=>si(j,me.toStyles)),oe.disabled=!0,oe.overrideTotalTime(me.totalTime),void a.push(oe);let ht=ns;if(xt.size>1){let en=j;const io=[];for(;en=en.parentNode;){const ze=xt.get(en);if(ze){ht=ze;break}io.push(en)}io.forEach(ze=>xt.set(ze,ht))}const ai=this._buildAnimation(oe.namespaceId,me,Se,u,ki,St);if(oe.setRealPlayer(ai),ht===ns)Gn.push(oe);else{const en=this.playersByElement.get(ht);en&&en.length&&(oe.parentPlayer=to(en)),a.push(oe)}}else Bo(j,me.fromStyles),oe.onDestroy(()=>si(j,me.toStyles)),ts.push(oe),m.has(j)&&a.push(oe)}),ts.forEach(H=>{const j=u.get(H.element);if(j&&j.length){const oe=to(j);H.setRealPlayer(oe)}}),a.forEach(H=>{H.parentPlayer?H.syncPlayerEvents(H.parentPlayer):H.destroy()});for(let H=0;H<S.length;H++){const j=S[H],oe=j[mn];if(Zr(j,ec),oe&&oe.hasAnimation)continue;let me=[];if(d.size){let ai=d.get(j);ai&&ai.length&&me.push(...ai);let en=this.driver.query(j,ng,!0);for(let io=0;io<en.length;io++){let ze=d.get(en[io]);ze&&ze.length&&me.push(...ze)}}const ht=me.filter(ai=>!ai.destroyed);ht.length?AW(this,j,ht):this.processLeaveNode(j)}return S.length=0,Gn.forEach(H=>{this.players.push(H),H.onDone(()=>{H.destroy();const j=this.players.indexOf(H);this.players.splice(j,1)}),H.play()}),Gn}elementContainsData(t,n){let s=!1;const a=n[mn];return a&&a.setForRemoval&&(s=!0),this.playersByElement.has(n)&&(s=!0),this.playersByQueriedElement.has(n)&&(s=!0),this.statesByElement.has(n)&&(s=!0),this._fetchNamespace(t).elementContainsData(n)||s}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,n,s,a,u){let h=[];if(n){const d=this.playersByQueriedElement.get(t);d&&(h=d)}else{const d=this.playersByElement.get(t);if(d){const f=!u||u==Fa;d.forEach(g=>{g.queued||!f&&g.triggerName!=a||h.push(g)})}}return(s||a)&&(h=h.filter(d=>!(s&&s!=d.namespaceId||a&&a!=d.triggerName))),h}_beforeAnimationBuild(t,n,s){const u=n.element,h=n.isRemovalTransition?void 0:t,d=n.isRemovalTransition?void 0:n.triggerName;for(const f of n.timelines){const g=f.element,m=g!==u,E=Qt(s,g,[]);this._getPreviousPlayers(g,m,h,d,n.toState).forEach(y=>{const C=y.getRealPlayer();C.beforeDestroy&&C.beforeDestroy(),y.destroy(),E.push(y)})}Bo(u,n.fromStyles)}_buildAnimation(t,n,s,a,u,h){const d=n.triggerName,f=n.element,g=[],m=new Set,E=new Set,T=n.timelines.map(C=>{const I=C.element;m.add(I);const S=I[mn];if(S&&S.removedBeforeQueried)return new qr(C.duration,C.delay);const D=I!==f,R=function(i){const t=[];return rR(i,t),t}((s.get(I)||yW).map(Se=>Se.getRealPlayer())).filter(Se=>!!Se.element&&Se.element===I),k=u.get(I),x=h.get(I),Q=MI(0,this._normalizer,0,C.keyframes,k,x),ve=this._buildPlayer(C,Q,R);if(C.subTimeline&&a&&E.add(I),D){const Se=new _g(t,d,I);Se.setRealPlayer(ve),g.push(Se)}return ve});g.forEach(C=>{Qt(this.playersByQueriedElement,C.element,[]).push(C),C.onDone(()=>function(i,t,n){let s;if(i instanceof Map){if(s=i.get(t),s){if(s.length){const a=s.indexOf(n);s.splice(a,1)}0==s.length&&i.delete(t)}}else if(s=i[t],s){if(s.length){const a=s.indexOf(n);s.splice(a,1)}0==s.length&&delete i[t]}return s}(this.playersByQueriedElement,C.element,C))}),m.forEach(C=>En(C,VI));const y=to(T);return y.onDestroy(()=>{m.forEach(C=>Zr(C,VI)),si(f,n.toStyles)}),E.forEach(C=>{Qt(a,C,[]).push(y)}),y}_buildPlayer(t,n,s){return n.length>0?this.driver.animate(t.element,n,t.duration,t.delay,t.easing,s):new qr(t.duration,t.delay)}}class _g{constructor(t,n,s){this.namespaceId=t,this.triggerName=n,this.element=s,this._player=new qr,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(n=>{this._queuedCallbacks[n].forEach(s=>Xf(t,n,void 0,s))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const n=this._player;n.triggerCallback&&t.onStart(()=>n.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,n){Qt(this._queuedCallbacks,t,[]).push(n)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const n=this._player;n.triggerCallback&&n.triggerCallback(t)}}function pc(i){return i&&1===i.nodeType}function nR(i,t){const n=i.style.display;return i.style.display=null!=t?t:"none",n}function iR(i,t,n,s,a){const u=[];n.forEach(f=>u.push(nR(f)));const h=[];s.forEach((f,g)=>{const m={};f.forEach(E=>{const T=m[E]=t.computeStyle(g,E,a);(!T||0==T.length)&&(g[mn]=CW,h.push(g))}),i.set(g,m)});let d=0;return n.forEach(f=>nR(f,u[d++])),h}function oR(i,t){const n=new Map;if(i.forEach(d=>n.set(d,[])),0==t.length)return n;const a=new Set(t),u=new Map;function h(d){if(!d)return 1;let f=u.get(d);if(f)return f;const g=d.parentNode;return f=n.has(g)?g:a.has(g)?1:h(g),u.set(d,f),f}return t.forEach(d=>{const f=h(d);1!==f&&n.get(f).push(d)}),n}const fc="$$classes";function En(i,t){if(i.classList)i.classList.add(t);else{let n=i[fc];n||(n=i[fc]={}),n[t]=!0}}function Zr(i,t){if(i.classList)i.classList.remove(t);else{let n=i[fc];n&&delete n[t]}}function AW(i,t,n){to(n).onDone(()=>i.processLeaveNode(t))}function rR(i,t){for(let n=0;n<i.length;n++){const s=i[n];s instanceof AI?rR(s.players,t):t.push(s)}}function sR(i,t,n){const s=n.get(i);if(!s)return!1;let a=t.get(i);return a?s.forEach(u=>a.add(u)):t.set(i,s),n.delete(i),!0}class gc{constructor(t,n,s){this.bodyNode=t,this._driver=n,this._normalizer=s,this._triggerCache={},this.onRemovalComplete=(a,u)=>{},this._transitionEngine=new SW(t,n,s),this._timelineEngine=new mW(t,n,s),this._transitionEngine.onRemovalComplete=(a,u)=>this.onRemovalComplete(a,u)}registerTrigger(t,n,s,a,u){const h=t+"-"+a;let d=this._triggerCache[h];if(!d){const f=[],g=ag(this._driver,u,f);if(f.length)throw new Error(`The animation trigger "${a}" has failed to build due to the following errors:\n - ${f.join("\n - ")}`);d=function(i,t,n){return new fW(i,t,n)}(a,g,this._normalizer),this._triggerCache[h]=d}this._transitionEngine.registerTrigger(n,a,d)}register(t,n){this._transitionEngine.register(t,n)}destroy(t,n){this._transitionEngine.destroy(t,n)}onInsert(t,n,s,a){this._transitionEngine.insertNode(t,n,s,a)}onRemove(t,n,s,a){this._transitionEngine.removeNode(t,n,a||!1,s)}disableAnimations(t,n){this._transitionEngine.markElementAsDisabled(t,n)}process(t,n,s,a){if("@"==s.charAt(0)){const[u,h]=OI(s);this._timelineEngine.command(u,n,h,a)}else this._transitionEngine.trigger(t,n,s,a)}listen(t,n,s,a,u){if("@"==s.charAt(0)){const[h,d]=OI(s);return this._timelineEngine.listen(h,n,d,u)}return this._transitionEngine.listen(t,n,s,a,u)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function aR(i,t){let n=null,s=null;return Array.isArray(t)&&t.length?(n=mg(t[0]),t.length>1&&(s=mg(t[t.length-1]))):t&&(n=mg(t)),n||s?new OW(i,n,s):null}let OW=(()=>{class i{constructor(n,s,a){this._element=n,this._startStyles=s,this._endStyles=a,this._state=0;let u=i.initialStylesByElement.get(n);u||i.initialStylesByElement.set(n,u={}),this._initialStyles=u}start(){this._state<1&&(this._startStyles&&si(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(si(this._element,this._initialStyles),this._endStyles&&(si(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(Bo(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Bo(this._element,this._endStyles),this._endStyles=null),si(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function mg(i){let t=null;const n=Object.keys(i);for(let s=0;s<n.length;s++){const a=n[s];NW(a)&&(t=t||{},t[a]=i[a])}return t}function NW(i){return"display"===i||"position"===i}const lR="animation",uR="animationend";class PW{constructor(t,n,s,a,u,h,d){this._element=t,this._name=n,this._duration=s,this._delay=a,this._easing=u,this._fillMode=h,this._onDoneFn=d,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=f=>this._handleCallback(f)}apply(){(function(i,t){const n=Tg(i,"").trim();let s=0;n.length&&(function(i,t){let n=0;for(let s=0;s<i.length;s++)","===i.charAt(s)&&n++;return n}(n)+1,t=`${n}, ${t}`),_c(i,"",t)})(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),dR(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){cR(this._element,this._name,"paused")}resume(){cR(this._element,this._name,"running")}setPosition(t){const n=hR(this._element,this._name);this._position=t*this._duration,_c(this._element,"Delay",`-${this._position}ms`,n)}getPosition(){return this._position}_handleCallback(t){const n=t._ngTestManualTimestamp||Date.now(),s=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(n-this._startTime,0)>=this._delay&&s>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),dR(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(i,t){const s=Tg(i,"").split(","),a=Eg(s,t);a>=0&&(s.splice(a,1),_c(i,"",s.join(",")))}(this._element,this._name))}}function cR(i,t,n){_c(i,"PlayState",n,hR(i,t))}function hR(i,t){const n=Tg(i,"");return n.indexOf(",")>0?Eg(n.split(","),t):Eg([n],t)}function Eg(i,t){for(let n=0;n<i.length;n++)if(i[n].indexOf(t)>=0)return n;return-1}function dR(i,t,n){n?i.removeEventListener(uR,t):i.addEventListener(uR,t)}function _c(i,t,n,s){const a=lR+t;if(null!=s){const u=i.style[a];if(u.length){const h=u.split(",");h[s]=n,n=h.join(",")}}i.style[a]=n}function Tg(i,t){return i.style[lR+t]||""}class pR{constructor(t,n,s,a,u,h,d,f){this.element=t,this.keyframes=n,this.animationName=s,this._duration=a,this._delay=u,this._finalStyles=d,this._specialStyles=f,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=h||"linear",this.totalTime=a+u,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new PW(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(s=>s()),n.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const n=this._state>=3;Object.keys(this._finalStyles).forEach(s=>{"offset"!=s&&(t[s]=n?this._finalStyles[s]:sg(this.element,s))})}this.currentSnapshot=t}}class HW extends qr{constructor(t,n){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=PI(n)}init(){this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){!this._startingStyles||(Object.keys(this._startingStyles).forEach(t=>{const n=this._startingStyles[t];n?this.element.style.setProperty(t,n):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}class gR{constructor(){this._count=0}validateStyleProperty(t){return $f(t)}matchesElement(t,n){return qf(t,n)}containsElement(t,n){return Qf(t,n)}query(t,n,s){return Zf(t,n,s)}computeStyle(t,n,s){return window.getComputedStyle(t)[n]}buildKeyframeElement(t,n,s){s=s.map(d=>PI(d));let a=`@keyframes ${n} {\n`,u="";s.forEach(d=>{u=" ";const f=parseFloat(d.offset);a+=`${u}${100*f}% {\n`,u+=" ",Object.keys(d).forEach(g=>{const m=d[g];switch(g){case"offset":return;case"easing":return void(m&&(a+=`${u}animation-timing-function: ${m};\n`));default:return void(a+=`${u}${g}: ${m};\n`)}}),a+=`${u}}\n`}),a+="}\n";const h=document.createElement("style");return h.textContent=a,h}animate(t,n,s,a,u,h=[],d){const f=h.filter(S=>S instanceof pR),g={};WI(s,a)&&f.forEach(S=>{let D=S.currentSnapshot;Object.keys(D).forEach(R=>g[R]=D[R])});const m=function(i){let t={};return i&&(Array.isArray(i)?i:[i]).forEach(s=>{Object.keys(s).forEach(a=>{"offset"==a||"easing"==a||(t[a]=s[a])})}),t}(n=jI(t,n,g));if(0==s)return new HW(t,m);const E="gen_css_kf_"+this._count++,T=this.buildKeyframeElement(t,E,n);(function(i){var n;const t=null==(n=i.getRootNode)?void 0:n.call(i);return"undefined"!=typeof ShadowRoot&&t instanceof ShadowRoot?t:document.head})(t).appendChild(T);const C=aR(t,n),I=new pR(t,n,E,s,a,u,m,C);return I.onDestroy(()=>{var i;(i=T).parentNode.removeChild(i)}),I}}class mR{constructor(t,n,s,a){this.element=t,this.keyframes=n,this.options=s,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=s.duration,this._delay=s.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,n,s){return t.animate(n,s)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(n=>{"offset"!=n&&(t[n]=this._finished?this._finalKeyframe[n]:sg(this.element,n))}),this.currentSnapshot=t}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(s=>s()),n.length=0}}class zW{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(ER().toString()),this._cssKeyframesDriver=new gR}validateStyleProperty(t){return $f(t)}matchesElement(t,n){return qf(t,n)}containsElement(t,n){return Qf(t,n)}query(t,n,s){return Zf(t,n,s)}computeStyle(t,n,s){return window.getComputedStyle(t)[n]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,n,s,a,u,h=[],d){if(!d&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,n,s,a,u,h);const m={duration:s,delay:a,fill:0==a?"both":"forwards"};u&&(m.easing=u);const E={},T=h.filter(C=>C instanceof mR);WI(s,a)&&T.forEach(C=>{let I=C.currentSnapshot;Object.keys(I).forEach(S=>E[S]=I[S])});const y=aR(t,n=jI(t,n=n.map(C=>no(C,!1)),E));return new mR(t,n,m,y)}}function ER(){return wI()&&Element.prototype.animate||{}}let YW=(()=>{class i extends SI{constructor(n,s){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(s.body,{id:"0",encapsulation:Ft.None,styles:[],data:{animation:[]}})}build(n){const s=this._nextAnimationId.toString();this._nextAnimationId++;const a=Array.isArray(n)?II(n):n;return TR(this._renderer,null,s,"register",[a]),new JW(s,this._renderer)}}return i.\u0275fac=function(n){return new(n||i)(P(Co),P(Pe))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();class JW extends class{}{constructor(t,n){super(),this._id=t,this._renderer=n}create(t,n){return new $W(this._id,t,n||{},this._renderer)}}class $W{constructor(t,n,s,a){this.id=t,this.element=n,this._renderer=a,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",s)}_listen(t,n){return this._renderer.listen(this.element,`@@${this.id}:${t}`,n)}_command(t,...n){return TR(this._renderer,this.element,this.id,t,n)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,n;return null!=(n=null==(t=this._renderer.engine.players[+this.id])?void 0:t.getPosition())?n:0}}function TR(i,t,n,s,a){return i.setProperty(t,`@@${n}:${s}`,a)}const vR="@.disabled";let qW=(()=>{class i{constructor(n,s,a){this.delegate=n,this.engine=s,this._zone=a,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),s.onRemovalComplete=(u,h)=>{h&&h.parentNode(u)&&h.removeChild(u.parentNode,u)}}createRenderer(n,s){const u=this.delegate.createRenderer(n,s);if(!(n&&s&&s.data&&s.data.animation)){let m=this._rendererCache.get(u);return m||(m=new yR("",u,this.engine),this._rendererCache.set(u,m)),m}const h=s.id,d=s.id+"-"+this._currentId;this._currentId++,this.engine.register(d,n);const f=m=>{Array.isArray(m)?m.forEach(f):this.engine.registerTrigger(h,d,n,m.name,m)};return s.data.animation.forEach(f),new QW(this,d,u,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(n,s,a){n>=0&&n<this._microtaskId?this._zone.run(()=>s(a)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(u=>{const[h,d]=u;h(d)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([s,a]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(n){return new(n||i)(P(Co),P(gc),P(Oe))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();class yR{constructor(t,n,s){this.namespaceId=t,this.delegate=n,this.engine=s,this.destroyNode=this.delegate.destroyNode?a=>n.destroyNode(a):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,n){this.delegate.appendChild(t,n),this.engine.onInsert(this.namespaceId,n,t,!1)}insertBefore(t,n,s,a=!0){this.delegate.insertBefore(t,n,s),this.engine.onInsert(this.namespaceId,n,t,a)}removeChild(t,n,s){this.engine.onRemove(this.namespaceId,n,this.delegate,s)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,s,a){this.delegate.setAttribute(t,n,s,a)}removeAttribute(t,n,s){this.delegate.removeAttribute(t,n,s)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,s,a){this.delegate.setStyle(t,n,s,a)}removeStyle(t,n,s){this.delegate.removeStyle(t,n,s)}setProperty(t,n,s){"@"==n.charAt(0)&&n==vR?this.disableAnimations(t,!!s):this.delegate.setProperty(t,n,s)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,s){return this.delegate.listen(t,n,s)}disableAnimations(t,n){this.engine.disableAnimations(t,n)}}class QW extends yR{constructor(t,n,s,a){super(n,s,a),this.factory=t,this.namespaceId=n}setProperty(t,n,s){"@"==n.charAt(0)?"."==n.charAt(1)&&n==vR?this.disableAnimations(t,s=void 0===s||!!s):this.engine.process(this.namespaceId,t,n.substr(1),s):this.delegate.setProperty(t,n,s)}listen(t,n,s){if("@"==n.charAt(0)){const a=function(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(t);let u=n.substr(1),h="";return"@"!=u.charAt(0)&&([u,h]=function(i){const t=i.indexOf(".");return[i.substring(0,t),i.substr(t+1)]}(u)),this.engine.listen(this.namespaceId,a,u,h,d=>{this.factory.scheduleListenerCallback(d._data||-1,s,d)})}return this.delegate.listen(t,n,s)}}let t2=(()=>{class i extends gc{constructor(n,s,a){super(n.body,s,a)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(n){return new(n||i)(P(Pe),P(eg),P(dg))},i.\u0275prov=ee({token:i,factory:i.\u0275fac}),i})();const Va=new K("AnimationModuleType"),CR=[{provide:SI,useClass:YW},{provide:dg,useFactory:function(){return new lW}},{provide:gc,useClass:t2},{provide:Co,useFactory:function(i,t,n){return new qW(i,t,n)},deps:[bu,gc,Oe]}],bR=[{provide:eg,useFactory:function(){return"function"==typeof ER()?new zW:new gR}},{provide:Va,useValue:"BrowserAnimations"},...CR],s2=[{provide:eg,useClass:xI},{provide:Va,useValue:"NoopAnimations"},...CR];let a2=(()=>{class i{static withConfig(n){return{ngModule:i,providers:n.disableAnimations?s2:bR}}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({providers:bR,imports:[nb]}),i})();const SR=new zi("13.0.1"),u2=new K("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let es=(()=>{class i{constructor(n,s,a){this._hasDoneGlobalChecks=!1,this._document=a,n._applyBodyHighContrastModeCssClasses(),this._sanityChecks=s,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return!(!Yd()||"undefined"!=typeof __karma__&&__karma__||"undefined"!=typeof jasmine&&jasmine||"undefined"!=typeof jest&&jest||"undefined"!=typeof Mocha&&Mocha)&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[n])}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const n=this._document.createElement("div");n.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(n);const s=getComputedStyle(n);s&&"none"!==s.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),n.remove()}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&SR.full!==bI.full&&console.warn("The Angular Material version ("+SR.full+") does not match the Angular CDK version ("+bI.full+").\nPlease ensure the versions of these two packages exactly match.")}}return i.\u0275fac=function(n){return new(n||i)(P(OG),P(u2,8),P(Pe))},i.\u0275mod=pt({type:i}),i.\u0275inj=et({imports:[[CI],CI]}),i})();function IR(i){return class extends i{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=Na(t)}}}function RR(i,t){return class extends i{constructor(...n){super(...n),this.defaultColor=t,this.color=t}get color(){return this._color}set color(n){const s=n||this.defaultColor;s!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),s&&this._elementRef.nativeElement.classList.add(`mat-${s}`),this._color=s)}}}function c2(i){return class extends i{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Na(t)}}}class p2{constructor(t,n,s){this._renderer=t,this.element=n,this.config=s,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const DR={enterDuration:225,exitDuration:150},vg=qu({passive:!0}),AR=["mousedown","touchstart"],wR=["mouseup","mouseleave","touchend","touchcancel"];class g2{constructor(t,n,s,a){this._target=t,this._ngZone=n,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,a.isBrowser&&(this._containerElement=ka(s))}fadeInRipple(t,n,s={}){const a=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),u=U(U({},DR),s.animation);s.centered&&(t=a.left+a.width/2,n=a.top+a.height/2);const h=s.radius||function(i,t,n){const s=Math.max(Math.abs(i-n.left),Math.abs(i-n.right)),a=Math.max(Math.abs(t-n.top),Math.abs(t-n.bottom));return Math.sqrt(s*s+a*a)}(t,n,a),d=t-a.left,f=n-a.top,g=u.enterDuration,m=document.createElement("div");m.classList.add("mat-ripple-element"),m.style.left=d-h+"px",m.style.top=f-h+"px",m.style.height=2*h+"px",m.style.width=2*h+"px",null!=s.color&&(m.style.backgroundColor=s.color),m.style.transitionDuration=`${g}ms`,this._containerElement.appendChild(m),window.getComputedStyle(m).getPropertyValue("opacity"),m.style.transform="scale(1)";const E=new p2(this,m,s);return E.state=0,this._activeRipples.add(E),s.persistent||(this._mostRecentTransientRipple=E),this._runTimeoutOutsideZone(()=>{const T=E===this._mostRecentTransientRipple;E.state=1,!s.persistent&&(!T||!this._isPointerDown)&&E.fadeOut()},g),E}fadeOutRipple(t){const n=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!n)return;const s=t.element,a=U(U({},DR),t.config.animation);s.style.transitionDuration=`${a.exitDuration}ms`,s.style.opacity="0",t.state=2,this._runTimeoutOutsideZone(()=>{t.state=3,s.remove()},a.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const n=ka(t);!n||n===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=n,this._registerEvents(AR))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(wR),this._pointerUpEventsRegistered=!0)}_onMousedown(t){const n=_I(t),s=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!n&&!s&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!mI(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const n=t.changedTouches;for(let s=0;s<n.length;s++)this.fadeInRipple(n[s].clientX,n[s].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_runTimeoutOutsideZone(t,n=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,n))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(n=>{this._triggerElement.addEventListener(n,this,vg)})})}_removeTriggerEvents(){this._triggerElement&&(AR.forEach(t=>{this._triggerElement.removeEventListener(t,this,vg)}),this._pointerUpEventsRegistered&&wR.forEach(t=>{this._triggerElement.removeEventListener(t,this,vg)}))}}const E2=new K("mat-ripple-global-options");let MR=(()=>{class i{constructor(n,s,a,u,h){this._elementRef=n,this._animationMode=h,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=u||{},this._rippleRenderer=new g2(this,s,n,a)}get disabled(){return this._disabled}set disabled(n){n&&this.fadeOutAllNonPersistent(),this._disabled=n,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(n){this._trigger=n,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:U(U(U({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(n,s=0,a){return"number"==typeof n?this._rippleRenderer.fadeInRipple(n,s,U(U({},this.rippleConfig),a)):this._rippleRenderer.fadeInRipple(0,0,U(U({},this.rippleConfig),n))}}return i.\u0275fac=function(n){return new(n||i)(M(Xe),M(Oe),M($u),M(E2,8),M(Va,8))},i.\u0275dir=$({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(n,s){2&n&&Xi("mat-ripple-unbounded",s.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),T2=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({imports:[[es,fG],es]}),i})();const v2=["mat-button",""],y2=["*"],b2=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],S2=RR(IR(c2(class{constructor(i){this._elementRef=i}})));let I2=(()=>{class i extends S2{constructor(n,s,a){super(n),this._focusMonitor=s,this._animationMode=a,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const u of b2)this._hasHostAttributes(u)&&this._getHostElement().classList.add(u);n.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(n,s){n?this._focusMonitor.focusVia(this._getHostElement(),n,s):this._getHostElement().focus(s)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...n){return n.some(s=>this._getHostElement().hasAttribute(s))}}return i.\u0275fac=function(n){return new(n||i)(M(Xe),M(TI),M(Va,8))},i.\u0275cmp=so({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(n,s){if(1&n&&Ld(MR,5),2&n){let a;Ks(a=function(){return i=O(),t=g_(),i[19].queries[t].queryList;var i,t}())&&(s.ripple=a.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(n,s){2&n&&(cn("disabled",s.disabled||null),Xi("_mat-animation-noopable","NoopAnimations"===s._animationMode)("mat-button-disabled",s.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[we],attrs:v2,ngContentSelectors:y2,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(n,s){1&n&&(function(i){const t=O()[16][6];if(!t.projection){const s=t.projection=Hi(i?i.length:1,null),a=s.slice();let u=t.child;for(;null!==u;){const h=i?eN(u,i):0;null!==h&&(a[h]?a[h].projectionNext=u:s[h]=u,a[h]=u),u=u.next}}}(),Mt(0,"span",0),function(i,t=0,n){const s=O(),a=_e(),u=cr(a,20+i,16,null,n||null);null===u.projection&&(u.projection=t),Wc(),64!=(64&u.flags)&&function(i,t,n){Om(t[11],0,t,n,ym(i,n,t),Im(n.parent||t[6],n,t))}(a,s,u)}(1),Ot(),Mn(2,"span",1),Mn(3,"span",2)),2&n&&(Jn(2),Xi("mat-button-ripple-round",s.isRoundButton||s.isIconButton),Qn("matRippleDisabled",s._isRippleDisabled())("matRippleCentered",s.isIconButton)("matRippleTrigger",s._getHostElement()))},directives:[MR],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),i})(),R2=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({imports:[[T2,es],es]}),i})();function D2(i,t){1&i&&(Mt(0,"span"),ti(1,"Loading"),Ot())}const A2=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:(()=>{class i{constructor(){this.demoWorkspace=null,this.showInner=""}RunCode(){this.run=Mi.interpreterHelper.createInterpreter(this.demoWorkspace,Oa),this.run.runCode((s,a)=>new Interpreter(this.run.latestCode,a))}ngOnInit(){Mi.filterBlocks.definitionBlocks(Po.Blocks,Oa),Mi.waitBlocks.definitionBlocks(Po.defineBlocksWithJsonArray,Oa);var n=[Mi.defaultBlocks.generalBlocks(),Mi.filterBlocks.filterXML(),`<category id="catHelpers" colour="160" name="Helpers">\n          ${Mi.waitBlocks.waitXml()}\n        </category>`];this.initialize(n),Mi.saveBlocksUrl.restoreState(Po.Xml,this.demoWorkspace)}SaveBlocks(){Mi.saveBlocksUrl.saveState(Po.Xml,this.demoWorkspace)}ShowInnerWorkings(){if(null!=document.getElementById("output"))if(null!=this.demoWorkspace){var s=Po.Xml.workspaceToDom(this.demoWorkspace,!0),a=Po.Xml.domToPrettyText(s);this.showInner=`\n            ========\n            ${a}\n            ========\n            ${this.run.latestCode}\n            `}else window.alert("demoWorkspace is null");else window.alert("outputArea is null")}initialize(n){const s=document.getElementById("blocklyDiv");if(null!=s){var u=`<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox-simple" style="display: none">\n    ${n.map(f=>`<sep></sep>${f}`)}\n    </xml>`;document.getElementById("toolbox"),this.demoWorkspace=Po.inject(s,{readOnly:!1,media:"media/",trashcan:!0,move:{scrollbars:!0,drag:!0,wheel:!0},toolbox:u}),console.log(Oa),this.run=Mi.interpreterHelper.createInterpreter(this.demoWorkspace,Oa);var d=this;this.demoWorkspace.addChangeListener(function(f){f.isUiEvent||(d.run.resetInterpreter(),d.run.generateCodeAndLoadIntoInterpreter(),d.ShowInnerWorkings())})}else window.alert("blocklyDiv is null")}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=so({type:i,selectors:[["app-display-blockly"]],decls:13,vars:2,consts:[["mat-raised-button","","color","primary",3,"click"],[4,"ngIf"],[2,"width","100%"],["id","blocklyDiv",2,"display","inline-block","height","480px","width","58%"],["id","output","disabled","disabled",2,"display","inline-block","height","480px","width","38%",3,"ngModel","ngModelChange"]],template:function(n,s){1&n&&(Mt(0,"button",0),lt("click",function(){return s.ShowInnerWorkings()}),ti(1,"Show blocks"),Ot(),ti(2," \xa0 "),Mt(3,"button",0),lt("click",function(){return s.SaveBlocks()}),ti(4,"Save Blocks"),Ot(),ti(5," \xa0 "),Mt(6,"button",0),lt("click",function(){return s.RunCode()}),ti(7,"Run Code"),Ot(),function(i,t,n,s,a,u,h,d){const f=O(),g=_e(),m=i+20,E=g.firstCreatePass?function(i,t,n,s,a,u,h,d,f){const g=t.consts,m=cr(t,i,4,h||null,Vi(g,d));Gh(t,n,m,Vi(g,f)),nl(t,m);const E=m.tViews=Rl(2,m,s,a,u,t.directiveRegistry,t.pipeRegistry,null,t.schemas,g);return null!==t.queries&&(t.queries.template(t,m),E.queries=t.queries.embeddedTView(m)),m}(m,g,f,t,n,s,a,u,h):g.data[m];jn(E,!1);const T=f[11].createComment("");yl(g,f,T,E),Et(T,f),Dl(f,f[m]=lE(T,f,T,E)),$a(E)&&Uh(g,f,E),null!=h&&Hh(f,E,d)}(8,D2,2,0,"span",1),Mt(9,"div",2),Mn(10,"div",3),Mt(11,"textarea",4),lt("ngModelChange",function(u){return s.showInner=u}),ti(12,"    "),Ot(),Ot()),2&n&&(Jn(8),Qn("ngIf",null==s.demoWorkspace),Jn(3),Qn("ngModel",s.showInner))},directives:[I2,FC,Su,Nb,cf],styles:[""]}),i})()}];let w2=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({imports:[[uI.forRoot(A2)],uI]}),i})(),M2=(()=>{class i{constructor(){this.title="AutoBlocklyApp"}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=so({type:i,selectors:[["app-root"]],decls:2,vars:0,template:function(n,s){1&n&&(ti(0,"This is blockly automation "),Mn(1,"router-outlet"))},directives:[Of],styles:[""]}),i})(),H2=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i}),i.\u0275inj=et({imports:[[GC,es],es]}),i})(),G2=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=pt({type:i,bootstrap:[M2]}),i.\u0275inj=et({providers:[],imports:[[nb,w2,PB,a2,H2,R2]]}),i})();(function(){if(Cy)throw new Error("Cannot enable prod mode after platform setup.");yy=!1})(),IV().bootstrapModule(G2).catch(i=>console.error(i))},175:(ce,J)=>{J.generalBlocks=function(){return'\n    \n    <category name="BlocklyCore=>">\n\n    <category id="catLogic" colour="210" name="Logic">\n        <block type="controls_if"></block>\n        <block type="logic_compare"></block>\n        <block type="logic_operation"></block>\n        <block type="logic_negate"></block>\n        <block type="logic_boolean"></block>\n        <block type="logic_null"></block>\n        <block type="logic_ternary"></block>\n    </category>\n    <category id="catLoops" colour="120" name="Loops">\n        <block type="controls_repeat_ext">\n            <value name="TIMES">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_whileUntil"></block>\n        <block type="controls_for">\n            <value name="FROM">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n            <value name="BY">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_forEach"></block>\n        <block type="controls_flow_statements"></block>\n    </category>\n    <category id="catMath" colour="230" name="Math">\n        <block type="math_number"></block>\n        <block type="math_arithmetic">\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_single">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">9</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_trig">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">45</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_constant"></block>\n        <block type="math_number_property">\n            <value name="NUMBER_TO_CHECK">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_change">\n            <value name="DELTA">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_round">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">3.1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_on_list"></block>\n        <block type="math_modulo">\n            <value name="DIVIDEND">\n                <shadow type="math_number">\n                    <field name="NUM">64</field>\n                </shadow>\n            </value>\n            <value name="DIVISOR">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_constrain">\n            <value name="VALUE">\n                <shadow type="math_number">\n                    <field name="NUM">50</field>\n                </shadow>\n            </value>\n            <value name="LOW">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="HIGH">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_random_int">\n            <value name="FROM">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_random_float"></block>\n    </category>\n    <category id="catText" colour="160" name="Text">\n        <block type="text"></block>\n        <block type="text_join"></block>\n        <block type="text_append">\n            <value name="TEXT">\n                <shadow type="text"></shadow>\n            </value>\n        </block>\n        <block type="text_length">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_isEmpty">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT"></field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_indexOf">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n            <value name="FIND">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_charAt">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n        </block>\n        <block type="text_getSubstring">\n            <value name="STRING">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n        </block>\n        <block type="text_changeCase">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_trim">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_print">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_prompt_ext">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category id="catLists" colour="260" name="Lists">\n        <block type="lists_create_with">\n            <mutation items="0"></mutation>\n        </block>\n        <block type="lists_create_with"></block>\n        <block type="lists_repeat">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">5</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_length"></block>\n        <block type="lists_isEmpty"></block>\n        <block type="lists_indexOf">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getIndex">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_setIndex">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getSublist">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_split">\n            <value name="DELIM">\n                <shadow type="text">\n                    <field name="TEXT">,</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_sort"></block>\n    </category>\n    <category id="catColour" colour="20" name="Color">\n        <block type="colour_picker"></block>\n        <block type="colour_random"></block>\n        <block type="colour_rgb">\n            <value name="RED">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n            <value name="GREEN">\n                <shadow type="math_number">\n                    <field name="NUM">50</field>\n                </shadow>\n            </value>\n            <value name="BLUE">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="colour_blend">\n            <value name="COLOUR1">\n                <shadow type="colour_picker">\n                    <field name="COLOUR">#ff0000</field>\n                </shadow>\n            </value>\n            <value name="COLOUR2">\n                <shadow type="colour_picker">\n                    <field name="COLOUR">#3333ff</field>\n                </shadow>\n            </value>\n            <value name="RATIO">\n                <shadow type="math_number">\n                    <field name="NUM">0.5</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category id="catVariables" colour="330" custom="VARIABLE" name="Variables"></category>\n    <category id="catFunctions" colour="290" custom="PROCEDURE" name="Functions"></category>\n</category>\n\n      '}},944:(ce,J)=>{J.definitionBlocks=function(G,N){G.filterList={init:function(){this.appendDummyInput().appendField("filterList"),this.appendValueInput("LIST").setCheck("Array"),this.appendValueInput("Logic").setCheck("String").appendField("item=>"),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},N.filterList=function(L){var o=N.valueToCode(L,"LIST",N.ORDER_MEMBER)||"[]",e=N.valueToCode(L,"Logic",N.ORDER_ATOMIC);"string"==typeof e&&(e=e.substr(1,e.length-2));var r="";return r+='(function(t){ if (typeof t === "string") return JSON.parse(t);  return t;}('+o+")).filter(function (item){ return "+e+";})",[r+="",N.ORDER_FUNCTION_CALL]},G.mapList={init:function(){this.appendDummyInput().appendField("mapList"),this.appendValueInput("LIST").setCheck("Array"),this.appendValueInput("Logic").setCheck("String").appendField("item=>"),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},N.mapList=function(L){var o=N.valueToCode(L,"LIST",N.ORDER_MEMBER)||"[]",e=N.valueToCode(L,"Logic",N.ORDER_ATOMIC);"string"==typeof e&&(e=e.substr(1,e.length-2));var r="";return r+='(function(t){ if (typeof t === "string") return JSON.parse(t);  return t;}('+o+")).map(function (item){ return "+e+";})",[r+="",N.ORDER_FUNCTION_CALL]}},J.filterXML=function(){return'\n    <category name="Advanced=>">\n        <category id="catArray" name="Array">\n            <block type="filterList">\n                <value name="LIST">\n                    <block type="variables_get">\n                        <field name="VAR">list</field>\n                    </block>\n                </value>\n                <value name="Logic">\n                    <shadow type="text">\n                        <field name="TEXT">item.property == "value"</field>\n                    </shadow>\n                </value>\n            </block>\n            <block type="mapList">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n            <value name="Logic">\n                <shadow type="text">\n                    <field name="TEXT">item.property</field>\n                </shadow>\n            </value>\n        </block>\n\n        </category>\n    </category>\n\n'}},11:(ce,J,G)=>{ce.exports={defaultBlocks:G(175),filterBlocks:G(944),interpreterHelper:G(738),saveBlocksUrl:G(81),waitBlocks:G(851)}},738:(ce,J)=>{J.createInterpreter=function(G,N){return{latestCode:"",workspace:G,BlocklyJavaScript:N,step:0,highlightPause:!1,myInterpreter:null,runner:null,generateCodeAndLoadIntoInterpreter:function(){this.BlocklyJavaScript.STATEMENT_PREFIX="highlightBlock(%1);\n",this.BlocklyJavaScript.addReservedWords("highlightBlock"),this.latestCode=this.BlocklyJavaScript.workspaceToCode(G),this.resetStepUi(!0)},resetStepUi:function(L){this.step=0,this.workspace.highlightBlock(null),this.highlightPause=!1},resetInterpreter:function(){this.myInterpreter=null,this.runner&&(window.clearTimeout(this.runner),this.runner=null)},runnerThis:function(){this.myInterpreter&&(this.myInterpreter.run()?setTimeout(this.runner,10):(console.log("\n\n<< Program complete >>"),this.resetInterpreter(),this.resetStepUi(!1)))},highlightBlock:function(L){this.workspace.highlightBlock(L),highlightPause=!0},runCode:function(L){this.myInterpreter||this.resetStepUi(!0),this.generateCodeAndLoadIntoInterpreter();var o=this;setTimeout(function(){this.highlightPause=!1,o.myInterpreter=L(o.latestCode,(e,r)=>o.initApiJS(e,r,o)),o.runner=function(){o.myInterpreter&&(o.myInterpreter.run()?setTimeout(o.runner,10):(console.log("\n\n<< Program complete >>"),o.resetInterpreter(),o.resetStepUi(!1)))},o.runner&&o.runner()},100)},initInterpreterWaitForSeconds:function(L,o){this.BlocklyJavaScript.addReservedWords("waitForSeconds");var e=L.createAsyncFunction(function(r,l){setTimeout(l,1e3*r)});L.setProperty(o,"waitForSeconds",e)},initApiJS:function(L,o,e){L.setProperty(o,"alert",L.createNativeFunction(r=function(l){l=l?l.toString():"",console.log(l)}));var r=function(l){return l=l?l.toString():"",L.createPrimitive(prompt(l))};L.setProperty(o,"prompt",L.createNativeFunction(r)),e.BlocklyJavaScript.addReservedWords("waitForSeconds"),r=L.createAsyncFunction(function(l,c){setTimeout(c,1e3*l)}),L.setProperty(o,"waitForSeconds",r),r=function(l){return l=l?l.toString():"",L.createPrimitive(e.highlightBlock(l))},L.setProperty(o,"highlightBlock",L.createNativeFunction(r))}}}},81:(ce,J)=>{J.saveState=function(L,o){var r=L.workspaceToDom(o,!0),l=L.domToPrettyText(r);window.localStorage.setItem("BlocklyState",l)},J.restoreState=function(L,o){var r=window.localStorage.getItem("BlocklyState");if(r){var l=L.textToDom(r);L.clearWorkspaceAndLoadFromXml(l,o)}return""}},851:(ce,J)=>{J.definitionBlocks=function(G,N){G([{type:"wait_seconds",message0:" wait %1 seconds",args0:[{type:"field_number",name:"SECONDS",min:0,max:600,value:1}],previousStatement:null,nextStatement:null,colour:"%{BKY_LOOPS_HUE}"}]),N.wait_seconds=function(L){return"waitForSeconds("+Number(L.getFieldValue("SECONDS"))+");\n"}},J.waitXml=function(){return'\n  <block type="wait_seconds"></block>\n'}}},ce=>{ce(ce.s=382)}]);